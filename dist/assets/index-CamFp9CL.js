(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var Yw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Jw(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Av={exports:{}},t0={},Pv={exports:{}},Xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zl=Symbol.for("react.element"),Qw=Symbol.for("react.portal"),ek=Symbol.for("react.fragment"),tk=Symbol.for("react.strict_mode"),rk=Symbol.for("react.profiler"),nk=Symbol.for("react.provider"),ik=Symbol.for("react.context"),ak=Symbol.for("react.forward_ref"),sk=Symbol.for("react.suspense"),ok=Symbol.for("react.memo"),lk=Symbol.for("react.lazy"),Mm=Symbol.iterator;function ck(e){return e===null||typeof e!="object"?null:(e=Mm&&e[Mm]||e["@@iterator"],typeof e=="function"?e:null)}var Ov={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Rv=Object.assign,Fv={};function ao(e,t,r){this.props=e,this.context=t,this.refs=Fv,this.updater=r||Ov}ao.prototype.isReactComponent={};ao.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ao.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Lv(){}Lv.prototype=ao.prototype;function kd(e,t,r){this.props=e,this.context=t,this.refs=Fv,this.updater=r||Ov}var Ed=kd.prototype=new Lv;Ed.constructor=kd;Rv(Ed,ao.prototype);Ed.isPureReactComponent=!0;var Bm=Array.isArray,Iv=Object.prototype.hasOwnProperty,Sd={current:null},Nv={key:!0,ref:!0,__self:!0,__source:!0};function Dv(e,t,r){var n,i={},a=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)Iv.call(t,n)&&!Nv.hasOwnProperty(n)&&(i[n]=t[n]);var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){for(var u=Array(l),f=0;f<l;f++)u[f]=arguments[f+2];i.children=u}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return{$$typeof:Zl,type:e,key:a,ref:o,props:i,_owner:Sd.current}}function uk(e,t){return{$$typeof:Zl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Td(e){return typeof e=="object"&&e!==null&&e.$$typeof===Zl}function fk(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var jm=/\/+/g;function nf(e,t){return typeof e=="object"&&e!==null&&e.key!=null?fk(""+e.key):t.toString(36)}function iu(e,t,r,n,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Zl:case Qw:o=!0}}if(o)return o=e,i=i(o),e=n===""?"."+nf(o,0):n,Bm(i)?(r="",e!=null&&(r=e.replace(jm,"$&/")+"/"),iu(i,t,r,"",function(f){return f})):i!=null&&(Td(i)&&(i=uk(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(jm,"$&/")+"/")+e)),t.push(i)),1;if(o=0,n=n===""?".":n+":",Bm(e))for(var l=0;l<e.length;l++){a=e[l];var u=n+nf(a,l);o+=iu(a,t,r,u,i)}else if(u=ck(e),typeof u=="function")for(e=u.call(e),l=0;!(a=e.next()).done;)a=a.value,u=n+nf(a,l++),o+=iu(a,t,r,u,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function bc(e,t,r){if(e==null)return e;var n=[],i=0;return iu(e,n,"","",function(a){return t.call(r,a,i++)}),n}function hk(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Fr={current:null},au={transition:null},dk={ReactCurrentDispatcher:Fr,ReactCurrentBatchConfig:au,ReactCurrentOwner:Sd};function Mv(){throw Error("act(...) is not supported in production builds of React.")}Xe.Children={map:bc,forEach:function(e,t,r){bc(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return bc(e,function(){t++}),t},toArray:function(e){return bc(e,function(t){return t})||[]},only:function(e){if(!Td(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Xe.Component=ao;Xe.Fragment=ek;Xe.Profiler=rk;Xe.PureComponent=kd;Xe.StrictMode=tk;Xe.Suspense=sk;Xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dk;Xe.act=Mv;Xe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Rv({},e.props),i=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=Sd.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)Iv.call(t,u)&&!Nv.hasOwnProperty(u)&&(n[u]=t[u]===void 0&&l!==void 0?l[u]:t[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){l=Array(u);for(var f=0;f<u;f++)l[f]=arguments[f+2];n.children=l}return{$$typeof:Zl,type:e.type,key:i,ref:a,props:n,_owner:o}};Xe.createContext=function(e){return e={$$typeof:ik,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:nk,_context:e},e.Consumer=e};Xe.createElement=Dv;Xe.createFactory=function(e){var t=Dv.bind(null,e);return t.type=e,t};Xe.createRef=function(){return{current:null}};Xe.forwardRef=function(e){return{$$typeof:ak,render:e}};Xe.isValidElement=Td;Xe.lazy=function(e){return{$$typeof:lk,_payload:{_status:-1,_result:e},_init:hk}};Xe.memo=function(e,t){return{$$typeof:ok,type:e,compare:t===void 0?null:t}};Xe.startTransition=function(e){var t=au.transition;au.transition={};try{e()}finally{au.transition=t}};Xe.unstable_act=Mv;Xe.useCallback=function(e,t){return Fr.current.useCallback(e,t)};Xe.useContext=function(e){return Fr.current.useContext(e)};Xe.useDebugValue=function(){};Xe.useDeferredValue=function(e){return Fr.current.useDeferredValue(e)};Xe.useEffect=function(e,t){return Fr.current.useEffect(e,t)};Xe.useId=function(){return Fr.current.useId()};Xe.useImperativeHandle=function(e,t,r){return Fr.current.useImperativeHandle(e,t,r)};Xe.useInsertionEffect=function(e,t){return Fr.current.useInsertionEffect(e,t)};Xe.useLayoutEffect=function(e,t){return Fr.current.useLayoutEffect(e,t)};Xe.useMemo=function(e,t){return Fr.current.useMemo(e,t)};Xe.useReducer=function(e,t,r){return Fr.current.useReducer(e,t,r)};Xe.useRef=function(e){return Fr.current.useRef(e)};Xe.useState=function(e){return Fr.current.useState(e)};Xe.useSyncExternalStore=function(e,t,r){return Fr.current.useSyncExternalStore(e,t,r)};Xe.useTransition=function(){return Fr.current.useTransition()};Xe.version="18.3.1";Pv.exports=Xe;var ie=Pv.exports;const Q=Jw(ie);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pk=ie,mk=Symbol.for("react.element"),gk=Symbol.for("react.fragment"),vk=Object.prototype.hasOwnProperty,_k=pk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xk={key:!0,ref:!0,__self:!0,__source:!0};function Bv(e,t,r){var n,i={},a=null,o=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)vk.call(t,n)&&!xk.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:mk,type:e,key:a,ref:o,props:i,_owner:_k.current}}t0.Fragment=gk;t0.jsx=Bv;t0.jsxs=Bv;Av.exports=t0;var T=Av.exports,nh={},jv={exports:{}},en={},Uv={exports:{}},zv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(J,q){var ce=J.length;J.push(q);e:for(;0<ce;){var _e=ce-1>>>1,N=J[_e];if(0<i(N,q))J[_e]=q,J[ce]=N,ce=_e;else break e}}function r(J){return J.length===0?null:J[0]}function n(J){if(J.length===0)return null;var q=J[0],ce=J.pop();if(ce!==q){J[0]=ce;e:for(var _e=0,N=J.length,Z=N>>>1;_e<Z;){var H=2*(_e+1)-1,W=J[H],te=H+1,xe=J[te];if(0>i(W,ce))te<N&&0>i(xe,W)?(J[_e]=xe,J[te]=ce,_e=te):(J[_e]=W,J[H]=ce,_e=H);else if(te<N&&0>i(xe,ce))J[_e]=xe,J[te]=ce,_e=te;else break e}}return q}function i(J,q){var ce=J.sortIndex-q.sortIndex;return ce!==0?ce:J.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var u=[],f=[],d=1,m=null,p=3,v=!1,x=!1,_=!1,S=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(J){for(var q=r(f);q!==null;){if(q.callback===null)n(f);else if(q.startTime<=J)n(f),q.sortIndex=q.expirationTime,t(u,q);else break;q=r(f)}}function b(J){if(_=!1,y(J),!x)if(r(u)!==null)x=!0,me(O);else{var q=r(f);q!==null&&ge(b,q.startTime-J)}}function O(J,q){x=!1,_&&(_=!1,w(z),z=-1),v=!0;var ce=p;try{for(y(q),m=r(u);m!==null&&(!(m.expirationTime>q)||J&&!G());){var _e=m.callback;if(typeof _e=="function"){m.callback=null,p=m.priorityLevel;var N=_e(m.expirationTime<=q);q=e.unstable_now(),typeof N=="function"?m.callback=N:m===r(u)&&n(u),y(q)}else n(u);m=r(u)}if(m!==null)var Z=!0;else{var H=r(f);H!==null&&ge(b,H.startTime-q),Z=!1}return Z}finally{m=null,p=ce,v=!1}}var R=!1,C=null,z=-1,M=5,K=-1;function G(){return!(e.unstable_now()-K<M)}function X(){if(C!==null){var J=e.unstable_now();K=J;var q=!0;try{q=C(!0,J)}finally{q?Y():(R=!1,C=null)}}else R=!1}var Y;if(typeof k=="function")Y=function(){k(X)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,he=de.port2;de.port1.onmessage=X,Y=function(){he.postMessage(null)}}else Y=function(){S(X,0)};function me(J){C=J,R||(R=!0,Y())}function ge(J,q){z=S(function(){J(e.unstable_now())},q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(J){J.callback=null},e.unstable_continueExecution=function(){x||v||(x=!0,me(O))},e.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<J?Math.floor(1e3/J):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(J){switch(p){case 1:case 2:case 3:var q=3;break;default:q=p}var ce=p;p=q;try{return J()}finally{p=ce}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(J,q){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var ce=p;p=J;try{return q()}finally{p=ce}},e.unstable_scheduleCallback=function(J,q,ce){var _e=e.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?_e+ce:_e):ce=_e,J){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=ce+N,J={id:d++,callback:q,priorityLevel:J,startTime:ce,expirationTime:N,sortIndex:-1},ce>_e?(J.sortIndex=ce,t(f,J),r(u)===null&&J===r(f)&&(_?(w(z),z=-1):_=!0,ge(b,ce-_e))):(J.sortIndex=N,t(u,J),x||v||(x=!0,me(O))),J},e.unstable_shouldYield=G,e.unstable_wrapCallback=function(J){var q=p;return function(){var ce=p;p=q;try{return J.apply(this,arguments)}finally{p=ce}}}})(zv);Uv.exports=zv;var yk=Uv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wk=ie,Jr=yk;function we(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var $v=new Set,ml={};function Ka(e,t){Xs(e,t),Xs(e+"Capture",t)}function Xs(e,t){for(ml[e]=t,e=0;e<t.length;e++)$v.add(t[e])}var wi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ih=Object.prototype.hasOwnProperty,kk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Um={},zm={};function Ek(e){return ih.call(zm,e)?!0:ih.call(Um,e)?!1:kk.test(e)?zm[e]=!0:(Um[e]=!0,!1)}function Sk(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Tk(e,t,r,n){if(t===null||typeof t>"u"||Sk(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Lr(e,t,r,n,i,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var lr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){lr[e]=new Lr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];lr[t]=new Lr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){lr[e]=new Lr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){lr[e]=new Lr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){lr[e]=new Lr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){lr[e]=new Lr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){lr[e]=new Lr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){lr[e]=new Lr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){lr[e]=new Lr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Cd=/[\-:]([a-z])/g;function bd(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Cd,bd);lr[t]=new Lr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Cd,bd);lr[t]=new Lr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Cd,bd);lr[t]=new Lr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){lr[e]=new Lr(e,1,!1,e.toLowerCase(),null,!1,!1)});lr.xlinkHref=new Lr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){lr[e]=new Lr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ad(e,t,r,n){var i=lr.hasOwnProperty(t)?lr[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Tk(t,r,i,n)&&(r=null),n||i===null?Ek(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var bi=wk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ac=Symbol.for("react.element"),Ts=Symbol.for("react.portal"),Cs=Symbol.for("react.fragment"),Pd=Symbol.for("react.strict_mode"),ah=Symbol.for("react.profiler"),Wv=Symbol.for("react.provider"),Hv=Symbol.for("react.context"),Od=Symbol.for("react.forward_ref"),sh=Symbol.for("react.suspense"),oh=Symbol.for("react.suspense_list"),Rd=Symbol.for("react.memo"),Bi=Symbol.for("react.lazy"),Vv=Symbol.for("react.offscreen"),$m=Symbol.iterator;function Ao(e){return e===null||typeof e!="object"?null:(e=$m&&e[$m]||e["@@iterator"],typeof e=="function"?e:null)}var kt=Object.assign,af;function jo(e){if(af===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);af=t&&t[1]||""}return`
`+af+e}var sf=!1;function of(e,t){if(!e||sf)return"";sf=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(f){var n=f}Reflect.construct(e,[],t)}else{try{t.call()}catch(f){n=f}e.call(t.prototype)}else{try{throw Error()}catch(f){n=f}e()}}catch(f){if(f&&n&&typeof f.stack=="string"){for(var i=f.stack.split(`
`),a=n.stack.split(`
`),o=i.length-1,l=a.length-1;1<=o&&0<=l&&i[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==a[l]){var u=`
`+i[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=o&&0<=l);break}}}finally{sf=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?jo(e):""}function Ck(e){switch(e.tag){case 5:return jo(e.type);case 16:return jo("Lazy");case 13:return jo("Suspense");case 19:return jo("SuspenseList");case 0:case 2:case 15:return e=of(e.type,!1),e;case 11:return e=of(e.type.render,!1),e;case 1:return e=of(e.type,!0),e;default:return""}}function lh(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Cs:return"Fragment";case Ts:return"Portal";case ah:return"Profiler";case Pd:return"StrictMode";case sh:return"Suspense";case oh:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Hv:return(e.displayName||"Context")+".Consumer";case Wv:return(e._context.displayName||"Context")+".Provider";case Od:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Rd:return t=e.displayName||null,t!==null?t:lh(e.type)||"Memo";case Bi:t=e._payload,e=e._init;try{return lh(e(t))}catch{}}return null}function bk(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return lh(t);case 8:return t===Pd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function sa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Gv(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Ak(e){var t=Gv(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Pc(e){e._valueTracker||(e._valueTracker=Ak(e))}function Zv(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Gv(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function vu(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ch(e,t){var r=t.checked;return kt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Wm(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=sa(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Kv(e,t){t=t.checked,t!=null&&Ad(e,"checked",t,!1)}function uh(e,t){Kv(e,t);var r=sa(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?fh(e,t.type,r):t.hasOwnProperty("defaultValue")&&fh(e,t.type,sa(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Hm(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function fh(e,t,r){(t!=="number"||vu(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Uo=Array.isArray;function Us(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+sa(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function hh(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(we(91));return kt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Vm(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(we(92));if(Uo(r)){if(1<r.length)throw Error(we(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:sa(r)}}function qv(e,t){var r=sa(t.value),n=sa(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Gm(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Xv(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dh(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Xv(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Oc,Yv=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Oc=Oc||document.createElement("div"),Oc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Oc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function gl(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var qo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Pk=["Webkit","ms","Moz","O"];Object.keys(qo).forEach(function(e){Pk.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),qo[t]=qo[e]})});function Jv(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||qo.hasOwnProperty(e)&&qo[e]?(""+t).trim():t+"px"}function Qv(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Jv(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var Ok=kt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ph(e,t){if(t){if(Ok[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(we(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(we(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(we(61))}if(t.style!=null&&typeof t.style!="object")throw Error(we(62))}}function mh(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gh=null;function Fd(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var vh=null,zs=null,$s=null;function Zm(e){if(e=Xl(e)){if(typeof vh!="function")throw Error(we(280));var t=e.stateNode;t&&(t=s0(t),vh(e.stateNode,e.type,t))}}function e_(e){zs?$s?$s.push(e):$s=[e]:zs=e}function t_(){if(zs){var e=zs,t=$s;if($s=zs=null,Zm(e),t)for(e=0;e<t.length;e++)Zm(t[e])}}function r_(e,t){return e(t)}function n_(){}var lf=!1;function i_(e,t,r){if(lf)return e(t,r);lf=!0;try{return r_(e,t,r)}finally{lf=!1,(zs!==null||$s!==null)&&(n_(),t_())}}function vl(e,t){var r=e.stateNode;if(r===null)return null;var n=s0(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(we(231,t,typeof r));return r}var _h=!1;if(wi)try{var Po={};Object.defineProperty(Po,"passive",{get:function(){_h=!0}}),window.addEventListener("test",Po,Po),window.removeEventListener("test",Po,Po)}catch{_h=!1}function Rk(e,t,r,n,i,a,o,l,u){var f=Array.prototype.slice.call(arguments,3);try{t.apply(r,f)}catch(d){this.onError(d)}}var Xo=!1,_u=null,xu=!1,xh=null,Fk={onError:function(e){Xo=!0,_u=e}};function Lk(e,t,r,n,i,a,o,l,u){Xo=!1,_u=null,Rk.apply(Fk,arguments)}function Ik(e,t,r,n,i,a,o,l,u){if(Lk.apply(this,arguments),Xo){if(Xo){var f=_u;Xo=!1,_u=null}else throw Error(we(198));xu||(xu=!0,xh=f)}}function qa(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function a_(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Km(e){if(qa(e)!==e)throw Error(we(188))}function Nk(e){var t=e.alternate;if(!t){if(t=qa(e),t===null)throw Error(we(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return Km(i),e;if(a===n)return Km(i),t;a=a.sibling}throw Error(we(188))}if(r.return!==n.return)r=i,n=a;else{for(var o=!1,l=i.child;l;){if(l===r){o=!0,r=i,n=a;break}if(l===n){o=!0,n=i,r=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===r){o=!0,r=a,n=i;break}if(l===n){o=!0,n=a,r=i;break}l=l.sibling}if(!o)throw Error(we(189))}}if(r.alternate!==n)throw Error(we(190))}if(r.tag!==3)throw Error(we(188));return r.stateNode.current===r?e:t}function s_(e){return e=Nk(e),e!==null?o_(e):null}function o_(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=o_(e);if(t!==null)return t;e=e.sibling}return null}var l_=Jr.unstable_scheduleCallback,qm=Jr.unstable_cancelCallback,Dk=Jr.unstable_shouldYield,Mk=Jr.unstable_requestPaint,Rt=Jr.unstable_now,Bk=Jr.unstable_getCurrentPriorityLevel,Ld=Jr.unstable_ImmediatePriority,c_=Jr.unstable_UserBlockingPriority,yu=Jr.unstable_NormalPriority,jk=Jr.unstable_LowPriority,u_=Jr.unstable_IdlePriority,r0=null,Xn=null;function Uk(e){if(Xn&&typeof Xn.onCommitFiberRoot=="function")try{Xn.onCommitFiberRoot(r0,e,void 0,(e.current.flags&128)===128)}catch{}}var Mn=Math.clz32?Math.clz32:Wk,zk=Math.log,$k=Math.LN2;function Wk(e){return e>>>=0,e===0?32:31-(zk(e)/$k|0)|0}var Rc=64,Fc=4194304;function zo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function wu(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~i;l!==0?n=zo(l):(a&=o,a!==0&&(n=zo(a)))}else o=r&~i,o!==0?n=zo(o):a!==0&&(n=zo(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Mn(t),i=1<<r,n|=e[r],t&=~i;return n}function Hk(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Vk(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-Mn(a),l=1<<o,u=i[o];u===-1?(!(l&r)||l&n)&&(i[o]=Hk(l,t)):u<=t&&(e.expiredLanes|=l),a&=~l}}function yh(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function f_(){var e=Rc;return Rc<<=1,!(Rc&4194240)&&(Rc=64),e}function cf(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Kl(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Mn(t),e[t]=r}function Gk(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Mn(r),a=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~a}}function Id(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Mn(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var at=0;function h_(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var d_,Nd,p_,m_,g_,wh=!1,Lc=[],qi=null,Xi=null,Yi=null,_l=new Map,xl=new Map,zi=[],Zk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Xm(e,t){switch(e){case"focusin":case"focusout":qi=null;break;case"dragenter":case"dragleave":Xi=null;break;case"mouseover":case"mouseout":Yi=null;break;case"pointerover":case"pointerout":_l.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":xl.delete(t.pointerId)}}function Oo(e,t,r,n,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},t!==null&&(t=Xl(t),t!==null&&Nd(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function Kk(e,t,r,n,i){switch(t){case"focusin":return qi=Oo(qi,e,t,r,n,i),!0;case"dragenter":return Xi=Oo(Xi,e,t,r,n,i),!0;case"mouseover":return Yi=Oo(Yi,e,t,r,n,i),!0;case"pointerover":var a=i.pointerId;return _l.set(a,Oo(_l.get(a)||null,e,t,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,xl.set(a,Oo(xl.get(a)||null,e,t,r,n,i)),!0}return!1}function v_(e){var t=Aa(e.target);if(t!==null){var r=qa(t);if(r!==null){if(t=r.tag,t===13){if(t=a_(r),t!==null){e.blockedOn=t,g_(e.priority,function(){p_(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function su(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=kh(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);gh=n,r.target.dispatchEvent(n),gh=null}else return t=Xl(r),t!==null&&Nd(t),e.blockedOn=r,!1;t.shift()}return!0}function Ym(e,t,r){su(e)&&r.delete(t)}function qk(){wh=!1,qi!==null&&su(qi)&&(qi=null),Xi!==null&&su(Xi)&&(Xi=null),Yi!==null&&su(Yi)&&(Yi=null),_l.forEach(Ym),xl.forEach(Ym)}function Ro(e,t){e.blockedOn===t&&(e.blockedOn=null,wh||(wh=!0,Jr.unstable_scheduleCallback(Jr.unstable_NormalPriority,qk)))}function yl(e){function t(i){return Ro(i,e)}if(0<Lc.length){Ro(Lc[0],e);for(var r=1;r<Lc.length;r++){var n=Lc[r];n.blockedOn===e&&(n.blockedOn=null)}}for(qi!==null&&Ro(qi,e),Xi!==null&&Ro(Xi,e),Yi!==null&&Ro(Yi,e),_l.forEach(t),xl.forEach(t),r=0;r<zi.length;r++)n=zi[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<zi.length&&(r=zi[0],r.blockedOn===null);)v_(r),r.blockedOn===null&&zi.shift()}var Ws=bi.ReactCurrentBatchConfig,ku=!0;function Xk(e,t,r,n){var i=at,a=Ws.transition;Ws.transition=null;try{at=1,Dd(e,t,r,n)}finally{at=i,Ws.transition=a}}function Yk(e,t,r,n){var i=at,a=Ws.transition;Ws.transition=null;try{at=4,Dd(e,t,r,n)}finally{at=i,Ws.transition=a}}function Dd(e,t,r,n){if(ku){var i=kh(e,t,r,n);if(i===null)xf(e,t,n,Eu,r),Xm(e,n);else if(Kk(i,e,t,r,n))n.stopPropagation();else if(Xm(e,n),t&4&&-1<Zk.indexOf(e)){for(;i!==null;){var a=Xl(i);if(a!==null&&d_(a),a=kh(e,t,r,n),a===null&&xf(e,t,n,Eu,r),a===i)break;i=a}i!==null&&n.stopPropagation()}else xf(e,t,n,null,r)}}var Eu=null;function kh(e,t,r,n){if(Eu=null,e=Fd(n),e=Aa(e),e!==null)if(t=qa(e),t===null)e=null;else if(r=t.tag,r===13){if(e=a_(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Eu=e,null}function __(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Bk()){case Ld:return 1;case c_:return 4;case yu:case jk:return 16;case u_:return 536870912;default:return 16}default:return 16}}var Vi=null,Md=null,ou=null;function x_(){if(ou)return ou;var e,t=Md,r=t.length,n,i="value"in Vi?Vi.value:Vi.textContent,a=i.length;for(e=0;e<r&&t[e]===i[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===i[a-n];n++);return ou=i.slice(e,1<n?1-n:void 0)}function lu(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ic(){return!0}function Jm(){return!1}function tn(e){function t(r,n,i,a,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Ic:Jm,this.isPropagationStopped=Jm,this}return kt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ic)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ic)},persist:function(){},isPersistent:Ic}),t}var so={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bd=tn(so),ql=kt({},so,{view:0,detail:0}),Jk=tn(ql),uf,ff,Fo,n0=kt({},ql,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Fo&&(Fo&&e.type==="mousemove"?(uf=e.screenX-Fo.screenX,ff=e.screenY-Fo.screenY):ff=uf=0,Fo=e),uf)},movementY:function(e){return"movementY"in e?e.movementY:ff}}),Qm=tn(n0),Qk=kt({},n0,{dataTransfer:0}),eE=tn(Qk),tE=kt({},ql,{relatedTarget:0}),hf=tn(tE),rE=kt({},so,{animationName:0,elapsedTime:0,pseudoElement:0}),nE=tn(rE),iE=kt({},so,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),aE=tn(iE),sE=kt({},so,{data:0}),e1=tn(sE),oE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},lE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function uE(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=cE[e])?!!t[e]:!1}function jd(){return uE}var fE=kt({},ql,{key:function(e){if(e.key){var t=oE[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=lu(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?lE[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jd,charCode:function(e){return e.type==="keypress"?lu(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?lu(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),hE=tn(fE),dE=kt({},n0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),t1=tn(dE),pE=kt({},ql,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jd}),mE=tn(pE),gE=kt({},so,{propertyName:0,elapsedTime:0,pseudoElement:0}),vE=tn(gE),_E=kt({},n0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),xE=tn(_E),yE=[9,13,27,32],Ud=wi&&"CompositionEvent"in window,Yo=null;wi&&"documentMode"in document&&(Yo=document.documentMode);var wE=wi&&"TextEvent"in window&&!Yo,y_=wi&&(!Ud||Yo&&8<Yo&&11>=Yo),r1=" ",n1=!1;function w_(e,t){switch(e){case"keyup":return yE.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function k_(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var bs=!1;function kE(e,t){switch(e){case"compositionend":return k_(t);case"keypress":return t.which!==32?null:(n1=!0,r1);case"textInput":return e=t.data,e===r1&&n1?null:e;default:return null}}function EE(e,t){if(bs)return e==="compositionend"||!Ud&&w_(e,t)?(e=x_(),ou=Md=Vi=null,bs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return y_&&t.locale!=="ko"?null:t.data;default:return null}}var SE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function i1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!SE[e.type]:t==="textarea"}function E_(e,t,r,n){e_(n),t=Su(t,"onChange"),0<t.length&&(r=new Bd("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Jo=null,wl=null;function TE(e){I_(e,0)}function i0(e){var t=Os(e);if(Zv(t))return e}function CE(e,t){if(e==="change")return t}var S_=!1;if(wi){var df;if(wi){var pf="oninput"in document;if(!pf){var a1=document.createElement("div");a1.setAttribute("oninput","return;"),pf=typeof a1.oninput=="function"}df=pf}else df=!1;S_=df&&(!document.documentMode||9<document.documentMode)}function s1(){Jo&&(Jo.detachEvent("onpropertychange",T_),wl=Jo=null)}function T_(e){if(e.propertyName==="value"&&i0(wl)){var t=[];E_(t,wl,e,Fd(e)),i_(TE,t)}}function bE(e,t,r){e==="focusin"?(s1(),Jo=t,wl=r,Jo.attachEvent("onpropertychange",T_)):e==="focusout"&&s1()}function AE(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return i0(wl)}function PE(e,t){if(e==="click")return i0(t)}function OE(e,t){if(e==="input"||e==="change")return i0(t)}function RE(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Un=typeof Object.is=="function"?Object.is:RE;function kl(e,t){if(Un(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!ih.call(t,i)||!Un(e[i],t[i]))return!1}return!0}function o1(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function l1(e,t){var r=o1(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=o1(r)}}function C_(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?C_(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function b_(){for(var e=window,t=vu();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=vu(e.document)}return t}function zd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function FE(e){var t=b_(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&C_(r.ownerDocument.documentElement,r)){if(n!==null&&zd(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=n.end===void 0?a:Math.min(n.end,i),!e.extend&&a>n&&(i=n,n=a,a=i),i=l1(r,a);var o=l1(r,n);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var LE=wi&&"documentMode"in document&&11>=document.documentMode,As=null,Eh=null,Qo=null,Sh=!1;function c1(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Sh||As==null||As!==vu(n)||(n=As,"selectionStart"in n&&zd(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Qo&&kl(Qo,n)||(Qo=n,n=Su(Eh,"onSelect"),0<n.length&&(t=new Bd("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=As)))}function Nc(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ps={animationend:Nc("Animation","AnimationEnd"),animationiteration:Nc("Animation","AnimationIteration"),animationstart:Nc("Animation","AnimationStart"),transitionend:Nc("Transition","TransitionEnd")},mf={},A_={};wi&&(A_=document.createElement("div").style,"AnimationEvent"in window||(delete Ps.animationend.animation,delete Ps.animationiteration.animation,delete Ps.animationstart.animation),"TransitionEvent"in window||delete Ps.transitionend.transition);function a0(e){if(mf[e])return mf[e];if(!Ps[e])return e;var t=Ps[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in A_)return mf[e]=t[r];return e}var P_=a0("animationend"),O_=a0("animationiteration"),R_=a0("animationstart"),F_=a0("transitionend"),L_=new Map,u1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ua(e,t){L_.set(e,t),Ka(t,[e])}for(var gf=0;gf<u1.length;gf++){var vf=u1[gf],IE=vf.toLowerCase(),NE=vf[0].toUpperCase()+vf.slice(1);ua(IE,"on"+NE)}ua(P_,"onAnimationEnd");ua(O_,"onAnimationIteration");ua(R_,"onAnimationStart");ua("dblclick","onDoubleClick");ua("focusin","onFocus");ua("focusout","onBlur");ua(F_,"onTransitionEnd");Xs("onMouseEnter",["mouseout","mouseover"]);Xs("onMouseLeave",["mouseout","mouseover"]);Xs("onPointerEnter",["pointerout","pointerover"]);Xs("onPointerLeave",["pointerout","pointerover"]);Ka("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ka("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ka("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ka("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ka("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ka("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $o="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),DE=new Set("cancel close invalid load scroll toggle".split(" ").concat($o));function f1(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Ik(n,t,void 0,e),e.currentTarget=null}function I_(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],u=l.instance,f=l.currentTarget;if(l=l.listener,u!==a&&i.isPropagationStopped())break e;f1(i,l,f),a=u}else for(o=0;o<n.length;o++){if(l=n[o],u=l.instance,f=l.currentTarget,l=l.listener,u!==a&&i.isPropagationStopped())break e;f1(i,l,f),a=u}}}if(xu)throw e=xh,xu=!1,xh=null,e}function dt(e,t){var r=t[Ph];r===void 0&&(r=t[Ph]=new Set);var n=e+"__bubble";r.has(n)||(N_(t,e,2,!1),r.add(n))}function _f(e,t,r){var n=0;t&&(n|=4),N_(r,e,n,t)}var Dc="_reactListening"+Math.random().toString(36).slice(2);function El(e){if(!e[Dc]){e[Dc]=!0,$v.forEach(function(r){r!=="selectionchange"&&(DE.has(r)||_f(r,!1,e),_f(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Dc]||(t[Dc]=!0,_f("selectionchange",!1,t))}}function N_(e,t,r,n){switch(__(t)){case 1:var i=Xk;break;case 4:i=Yk;break;default:i=Dd}r=i.bind(null,t,r,e),i=void 0,!_h||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function xf(e,t,r,n,i){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Aa(l),o===null)return;if(u=o.tag,u===5||u===6){n=a=o;continue e}l=l.parentNode}}n=n.return}i_(function(){var f=a,d=Fd(r),m=[];e:{var p=L_.get(e);if(p!==void 0){var v=Bd,x=e;switch(e){case"keypress":if(lu(r)===0)break e;case"keydown":case"keyup":v=hE;break;case"focusin":x="focus",v=hf;break;case"focusout":x="blur",v=hf;break;case"beforeblur":case"afterblur":v=hf;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=Qm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=eE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=mE;break;case P_:case O_:case R_:v=nE;break;case F_:v=vE;break;case"scroll":v=Jk;break;case"wheel":v=xE;break;case"copy":case"cut":case"paste":v=aE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=t1}var _=(t&4)!==0,S=!_&&e==="scroll",w=_?p!==null?p+"Capture":null:p;_=[];for(var k=f,y;k!==null;){y=k;var b=y.stateNode;if(y.tag===5&&b!==null&&(y=b,w!==null&&(b=vl(k,w),b!=null&&_.push(Sl(k,b,y)))),S)break;k=k.return}0<_.length&&(p=new v(p,x,null,r,d),m.push({event:p,listeners:_}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",p&&r!==gh&&(x=r.relatedTarget||r.fromElement)&&(Aa(x)||x[ki]))break e;if((v||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,v?(x=r.relatedTarget||r.toElement,v=f,x=x?Aa(x):null,x!==null&&(S=qa(x),x!==S||x.tag!==5&&x.tag!==6)&&(x=null)):(v=null,x=f),v!==x)){if(_=Qm,b="onMouseLeave",w="onMouseEnter",k="mouse",(e==="pointerout"||e==="pointerover")&&(_=t1,b="onPointerLeave",w="onPointerEnter",k="pointer"),S=v==null?p:Os(v),y=x==null?p:Os(x),p=new _(b,k+"leave",v,r,d),p.target=S,p.relatedTarget=y,b=null,Aa(d)===f&&(_=new _(w,k+"enter",x,r,d),_.target=y,_.relatedTarget=S,b=_),S=b,v&&x)t:{for(_=v,w=x,k=0,y=_;y;y=hs(y))k++;for(y=0,b=w;b;b=hs(b))y++;for(;0<k-y;)_=hs(_),k--;for(;0<y-k;)w=hs(w),y--;for(;k--;){if(_===w||w!==null&&_===w.alternate)break t;_=hs(_),w=hs(w)}_=null}else _=null;v!==null&&h1(m,p,v,_,!1),x!==null&&S!==null&&h1(m,S,x,_,!0)}}e:{if(p=f?Os(f):window,v=p.nodeName&&p.nodeName.toLowerCase(),v==="select"||v==="input"&&p.type==="file")var O=CE;else if(i1(p))if(S_)O=OE;else{O=AE;var R=bE}else(v=p.nodeName)&&v.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(O=PE);if(O&&(O=O(e,f))){E_(m,O,r,d);break e}R&&R(e,p,f),e==="focusout"&&(R=p._wrapperState)&&R.controlled&&p.type==="number"&&fh(p,"number",p.value)}switch(R=f?Os(f):window,e){case"focusin":(i1(R)||R.contentEditable==="true")&&(As=R,Eh=f,Qo=null);break;case"focusout":Qo=Eh=As=null;break;case"mousedown":Sh=!0;break;case"contextmenu":case"mouseup":case"dragend":Sh=!1,c1(m,r,d);break;case"selectionchange":if(LE)break;case"keydown":case"keyup":c1(m,r,d)}var C;if(Ud)e:{switch(e){case"compositionstart":var z="onCompositionStart";break e;case"compositionend":z="onCompositionEnd";break e;case"compositionupdate":z="onCompositionUpdate";break e}z=void 0}else bs?w_(e,r)&&(z="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(z="onCompositionStart");z&&(y_&&r.locale!=="ko"&&(bs||z!=="onCompositionStart"?z==="onCompositionEnd"&&bs&&(C=x_()):(Vi=d,Md="value"in Vi?Vi.value:Vi.textContent,bs=!0)),R=Su(f,z),0<R.length&&(z=new e1(z,e,null,r,d),m.push({event:z,listeners:R}),C?z.data=C:(C=k_(r),C!==null&&(z.data=C)))),(C=wE?kE(e,r):EE(e,r))&&(f=Su(f,"onBeforeInput"),0<f.length&&(d=new e1("onBeforeInput","beforeinput",null,r,d),m.push({event:d,listeners:f}),d.data=C))}I_(m,t)})}function Sl(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Su(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=vl(e,r),a!=null&&n.unshift(Sl(e,a,i)),a=vl(e,t),a!=null&&n.push(Sl(e,a,i))),e=e.return}return n}function hs(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function h1(e,t,r,n,i){for(var a=t._reactName,o=[];r!==null&&r!==n;){var l=r,u=l.alternate,f=l.stateNode;if(u!==null&&u===n)break;l.tag===5&&f!==null&&(l=f,i?(u=vl(r,a),u!=null&&o.unshift(Sl(r,u,l))):i||(u=vl(r,a),u!=null&&o.push(Sl(r,u,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var ME=/\r\n?/g,BE=/\u0000|\uFFFD/g;function d1(e){return(typeof e=="string"?e:""+e).replace(ME,`
`).replace(BE,"")}function Mc(e,t,r){if(t=d1(t),d1(e)!==t&&r)throw Error(we(425))}function Tu(){}var Th=null,Ch=null;function bh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ah=typeof setTimeout=="function"?setTimeout:void 0,jE=typeof clearTimeout=="function"?clearTimeout:void 0,p1=typeof Promise=="function"?Promise:void 0,UE=typeof queueMicrotask=="function"?queueMicrotask:typeof p1<"u"?function(e){return p1.resolve(null).then(e).catch(zE)}:Ah;function zE(e){setTimeout(function(){throw e})}function yf(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),yl(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);yl(t)}function Ji(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function m1(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var oo=Math.random().toString(36).slice(2),qn="__reactFiber$"+oo,Tl="__reactProps$"+oo,ki="__reactContainer$"+oo,Ph="__reactEvents$"+oo,$E="__reactListeners$"+oo,WE="__reactHandles$"+oo;function Aa(e){var t=e[qn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ki]||r[qn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=m1(e);e!==null;){if(r=e[qn])return r;e=m1(e)}return t}e=r,r=e.parentNode}return null}function Xl(e){return e=e[qn]||e[ki],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Os(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(we(33))}function s0(e){return e[Tl]||null}var Oh=[],Rs=-1;function fa(e){return{current:e}}function pt(e){0>Rs||(e.current=Oh[Rs],Oh[Rs]=null,Rs--)}function ct(e,t){Rs++,Oh[Rs]=e.current,e.current=t}var oa={},yr=fa(oa),Ur=fa(!1),ja=oa;function Ys(e,t){var r=e.type.contextTypes;if(!r)return oa;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in r)i[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function zr(e){return e=e.childContextTypes,e!=null}function Cu(){pt(Ur),pt(yr)}function g1(e,t,r){if(yr.current!==oa)throw Error(we(168));ct(yr,t),ct(Ur,r)}function D_(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(we(108,bk(e)||"Unknown",i));return kt({},r,n)}function bu(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||oa,ja=yr.current,ct(yr,e),ct(Ur,Ur.current),!0}function v1(e,t,r){var n=e.stateNode;if(!n)throw Error(we(169));r?(e=D_(e,t,ja),n.__reactInternalMemoizedMergedChildContext=e,pt(Ur),pt(yr),ct(yr,e)):pt(Ur),ct(Ur,r)}var hi=null,o0=!1,wf=!1;function M_(e){hi===null?hi=[e]:hi.push(e)}function HE(e){o0=!0,M_(e)}function ha(){if(!wf&&hi!==null){wf=!0;var e=0,t=at;try{var r=hi;for(at=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}hi=null,o0=!1}catch(i){throw hi!==null&&(hi=hi.slice(e+1)),l_(Ld,ha),i}finally{at=t,wf=!1}}return null}var Fs=[],Ls=0,Au=null,Pu=0,hn=[],dn=0,Ua=null,mi=1,gi="";function ka(e,t){Fs[Ls++]=Pu,Fs[Ls++]=Au,Au=e,Pu=t}function B_(e,t,r){hn[dn++]=mi,hn[dn++]=gi,hn[dn++]=Ua,Ua=e;var n=mi;e=gi;var i=32-Mn(n)-1;n&=~(1<<i),r+=1;var a=32-Mn(t)+i;if(30<a){var o=i-i%5;a=(n&(1<<o)-1).toString(32),n>>=o,i-=o,mi=1<<32-Mn(t)+i|r<<i|n,gi=a+e}else mi=1<<a|r<<i|n,gi=e}function $d(e){e.return!==null&&(ka(e,1),B_(e,1,0))}function Wd(e){for(;e===Au;)Au=Fs[--Ls],Fs[Ls]=null,Pu=Fs[--Ls],Fs[Ls]=null;for(;e===Ua;)Ua=hn[--dn],hn[dn]=null,gi=hn[--dn],hn[dn]=null,mi=hn[--dn],hn[dn]=null}var Yr=null,Xr=null,vt=!1,Ln=null;function j_(e,t){var r=pn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function _1(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Yr=e,Xr=Ji(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Yr=e,Xr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Ua!==null?{id:mi,overflow:gi}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=pn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Yr=e,Xr=null,!0):!1;default:return!1}}function Rh(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Fh(e){if(vt){var t=Xr;if(t){var r=t;if(!_1(e,t)){if(Rh(e))throw Error(we(418));t=Ji(r.nextSibling);var n=Yr;t&&_1(e,t)?j_(n,r):(e.flags=e.flags&-4097|2,vt=!1,Yr=e)}}else{if(Rh(e))throw Error(we(418));e.flags=e.flags&-4097|2,vt=!1,Yr=e}}}function x1(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Yr=e}function Bc(e){if(e!==Yr)return!1;if(!vt)return x1(e),vt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!bh(e.type,e.memoizedProps)),t&&(t=Xr)){if(Rh(e))throw U_(),Error(we(418));for(;t;)j_(e,t),t=Ji(t.nextSibling)}if(x1(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(we(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Xr=Ji(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Xr=null}}else Xr=Yr?Ji(e.stateNode.nextSibling):null;return!0}function U_(){for(var e=Xr;e;)e=Ji(e.nextSibling)}function Js(){Xr=Yr=null,vt=!1}function Hd(e){Ln===null?Ln=[e]:Ln.push(e)}var VE=bi.ReactCurrentBatchConfig;function Lo(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(we(309));var n=r.stateNode}if(!n)throw Error(we(147,e));var i=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var l=i.refs;o===null?delete l[a]:l[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(we(284));if(!r._owner)throw Error(we(290,e))}return e}function jc(e,t){throw e=Object.prototype.toString.call(t),Error(we(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function y1(e){var t=e._init;return t(e._payload)}function z_(e){function t(w,k){if(e){var y=w.deletions;y===null?(w.deletions=[k],w.flags|=16):y.push(k)}}function r(w,k){if(!e)return null;for(;k!==null;)t(w,k),k=k.sibling;return null}function n(w,k){for(w=new Map;k!==null;)k.key!==null?w.set(k.key,k):w.set(k.index,k),k=k.sibling;return w}function i(w,k){return w=ra(w,k),w.index=0,w.sibling=null,w}function a(w,k,y){return w.index=y,e?(y=w.alternate,y!==null?(y=y.index,y<k?(w.flags|=2,k):y):(w.flags|=2,k)):(w.flags|=1048576,k)}function o(w){return e&&w.alternate===null&&(w.flags|=2),w}function l(w,k,y,b){return k===null||k.tag!==6?(k=Af(y,w.mode,b),k.return=w,k):(k=i(k,y),k.return=w,k)}function u(w,k,y,b){var O=y.type;return O===Cs?d(w,k,y.props.children,b,y.key):k!==null&&(k.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Bi&&y1(O)===k.type)?(b=i(k,y.props),b.ref=Lo(w,k,y),b.return=w,b):(b=mu(y.type,y.key,y.props,null,w.mode,b),b.ref=Lo(w,k,y),b.return=w,b)}function f(w,k,y,b){return k===null||k.tag!==4||k.stateNode.containerInfo!==y.containerInfo||k.stateNode.implementation!==y.implementation?(k=Pf(y,w.mode,b),k.return=w,k):(k=i(k,y.children||[]),k.return=w,k)}function d(w,k,y,b,O){return k===null||k.tag!==7?(k=Na(y,w.mode,b,O),k.return=w,k):(k=i(k,y),k.return=w,k)}function m(w,k,y){if(typeof k=="string"&&k!==""||typeof k=="number")return k=Af(""+k,w.mode,y),k.return=w,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Ac:return y=mu(k.type,k.key,k.props,null,w.mode,y),y.ref=Lo(w,null,k),y.return=w,y;case Ts:return k=Pf(k,w.mode,y),k.return=w,k;case Bi:var b=k._init;return m(w,b(k._payload),y)}if(Uo(k)||Ao(k))return k=Na(k,w.mode,y,null),k.return=w,k;jc(w,k)}return null}function p(w,k,y,b){var O=k!==null?k.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return O!==null?null:l(w,k,""+y,b);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ac:return y.key===O?u(w,k,y,b):null;case Ts:return y.key===O?f(w,k,y,b):null;case Bi:return O=y._init,p(w,k,O(y._payload),b)}if(Uo(y)||Ao(y))return O!==null?null:d(w,k,y,b,null);jc(w,y)}return null}function v(w,k,y,b,O){if(typeof b=="string"&&b!==""||typeof b=="number")return w=w.get(y)||null,l(k,w,""+b,O);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ac:return w=w.get(b.key===null?y:b.key)||null,u(k,w,b,O);case Ts:return w=w.get(b.key===null?y:b.key)||null,f(k,w,b,O);case Bi:var R=b._init;return v(w,k,y,R(b._payload),O)}if(Uo(b)||Ao(b))return w=w.get(y)||null,d(k,w,b,O,null);jc(k,b)}return null}function x(w,k,y,b){for(var O=null,R=null,C=k,z=k=0,M=null;C!==null&&z<y.length;z++){C.index>z?(M=C,C=null):M=C.sibling;var K=p(w,C,y[z],b);if(K===null){C===null&&(C=M);break}e&&C&&K.alternate===null&&t(w,C),k=a(K,k,z),R===null?O=K:R.sibling=K,R=K,C=M}if(z===y.length)return r(w,C),vt&&ka(w,z),O;if(C===null){for(;z<y.length;z++)C=m(w,y[z],b),C!==null&&(k=a(C,k,z),R===null?O=C:R.sibling=C,R=C);return vt&&ka(w,z),O}for(C=n(w,C);z<y.length;z++)M=v(C,w,z,y[z],b),M!==null&&(e&&M.alternate!==null&&C.delete(M.key===null?z:M.key),k=a(M,k,z),R===null?O=M:R.sibling=M,R=M);return e&&C.forEach(function(G){return t(w,G)}),vt&&ka(w,z),O}function _(w,k,y,b){var O=Ao(y);if(typeof O!="function")throw Error(we(150));if(y=O.call(y),y==null)throw Error(we(151));for(var R=O=null,C=k,z=k=0,M=null,K=y.next();C!==null&&!K.done;z++,K=y.next()){C.index>z?(M=C,C=null):M=C.sibling;var G=p(w,C,K.value,b);if(G===null){C===null&&(C=M);break}e&&C&&G.alternate===null&&t(w,C),k=a(G,k,z),R===null?O=G:R.sibling=G,R=G,C=M}if(K.done)return r(w,C),vt&&ka(w,z),O;if(C===null){for(;!K.done;z++,K=y.next())K=m(w,K.value,b),K!==null&&(k=a(K,k,z),R===null?O=K:R.sibling=K,R=K);return vt&&ka(w,z),O}for(C=n(w,C);!K.done;z++,K=y.next())K=v(C,w,z,K.value,b),K!==null&&(e&&K.alternate!==null&&C.delete(K.key===null?z:K.key),k=a(K,k,z),R===null?O=K:R.sibling=K,R=K);return e&&C.forEach(function(X){return t(w,X)}),vt&&ka(w,z),O}function S(w,k,y,b){if(typeof y=="object"&&y!==null&&y.type===Cs&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Ac:e:{for(var O=y.key,R=k;R!==null;){if(R.key===O){if(O=y.type,O===Cs){if(R.tag===7){r(w,R.sibling),k=i(R,y.props.children),k.return=w,w=k;break e}}else if(R.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Bi&&y1(O)===R.type){r(w,R.sibling),k=i(R,y.props),k.ref=Lo(w,R,y),k.return=w,w=k;break e}r(w,R);break}else t(w,R);R=R.sibling}y.type===Cs?(k=Na(y.props.children,w.mode,b,y.key),k.return=w,w=k):(b=mu(y.type,y.key,y.props,null,w.mode,b),b.ref=Lo(w,k,y),b.return=w,w=b)}return o(w);case Ts:e:{for(R=y.key;k!==null;){if(k.key===R)if(k.tag===4&&k.stateNode.containerInfo===y.containerInfo&&k.stateNode.implementation===y.implementation){r(w,k.sibling),k=i(k,y.children||[]),k.return=w,w=k;break e}else{r(w,k);break}else t(w,k);k=k.sibling}k=Pf(y,w.mode,b),k.return=w,w=k}return o(w);case Bi:return R=y._init,S(w,k,R(y._payload),b)}if(Uo(y))return x(w,k,y,b);if(Ao(y))return _(w,k,y,b);jc(w,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,k!==null&&k.tag===6?(r(w,k.sibling),k=i(k,y),k.return=w,w=k):(r(w,k),k=Af(y,w.mode,b),k.return=w,w=k),o(w)):r(w,k)}return S}var Qs=z_(!0),$_=z_(!1),Ou=fa(null),Ru=null,Is=null,Vd=null;function Gd(){Vd=Is=Ru=null}function Zd(e){var t=Ou.current;pt(Ou),e._currentValue=t}function Lh(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Hs(e,t){Ru=e,Vd=Is=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(jr=!0),e.firstContext=null)}function gn(e){var t=e._currentValue;if(Vd!==e)if(e={context:e,memoizedValue:t,next:null},Is===null){if(Ru===null)throw Error(we(308));Is=e,Ru.dependencies={lanes:0,firstContext:e}}else Is=Is.next=e;return t}var Pa=null;function Kd(e){Pa===null?Pa=[e]:Pa.push(e)}function W_(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,Kd(t)):(r.next=i.next,i.next=r),t.interleaved=r,Ei(e,n)}function Ei(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var ji=!1;function qd(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function H_(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function _i(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Qi(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,tt&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Ei(e,r)}return i=n.interleaved,i===null?(t.next=t,Kd(n)):(t.next=i.next,i.next=t),n.interleaved=t,Ei(e,r)}function cu(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Id(e,r)}}function w1(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?i=a=o:a=a.next=o,r=r.next}while(r!==null);a===null?i=a=t:a=a.next=t}else i=a=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Fu(e,t,r,n){var i=e.updateQueue;ji=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var u=l,f=u.next;u.next=null,o===null?a=f:o.next=f,o=u;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=f:l.next=f,d.lastBaseUpdate=u))}if(a!==null){var m=i.baseState;o=0,d=f=u=null,l=a;do{var p=l.lane,v=l.eventTime;if((n&p)===p){d!==null&&(d=d.next={eventTime:v,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,_=l;switch(p=t,v=r,_.tag){case 1:if(x=_.payload,typeof x=="function"){m=x.call(v,m,p);break e}m=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=_.payload,p=typeof x=="function"?x.call(v,m,p):x,p==null)break e;m=kt({},m,p);break e;case 2:ji=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=i.effects,p===null?i.effects=[l]:p.push(l))}else v={eventTime:v,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(f=d=v,u=m):d=d.next=v,o|=p;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;p=l,l=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(d===null&&(u=m),i.baseState=u,i.firstBaseUpdate=f,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);$a|=o,e.lanes=o,e.memoizedState=m}}function k1(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(we(191,i));i.call(n)}}}var Yl={},Yn=fa(Yl),Cl=fa(Yl),bl=fa(Yl);function Oa(e){if(e===Yl)throw Error(we(174));return e}function Xd(e,t){switch(ct(bl,t),ct(Cl,e),ct(Yn,Yl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:dh(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=dh(t,e)}pt(Yn),ct(Yn,t)}function eo(){pt(Yn),pt(Cl),pt(bl)}function V_(e){Oa(bl.current);var t=Oa(Yn.current),r=dh(t,e.type);t!==r&&(ct(Cl,e),ct(Yn,r))}function Yd(e){Cl.current===e&&(pt(Yn),pt(Cl))}var yt=fa(0);function Lu(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var kf=[];function Jd(){for(var e=0;e<kf.length;e++)kf[e]._workInProgressVersionPrimary=null;kf.length=0}var uu=bi.ReactCurrentDispatcher,Ef=bi.ReactCurrentBatchConfig,za=0,wt=null,zt=null,Xt=null,Iu=!1,el=!1,Al=0,GE=0;function hr(){throw Error(we(321))}function Qd(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Un(e[r],t[r]))return!1;return!0}function ep(e,t,r,n,i,a){if(za=a,wt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,uu.current=e===null||e.memoizedState===null?XE:YE,e=r(n,i),el){a=0;do{if(el=!1,Al=0,25<=a)throw Error(we(301));a+=1,Xt=zt=null,t.updateQueue=null,uu.current=JE,e=r(n,i)}while(el)}if(uu.current=Nu,t=zt!==null&&zt.next!==null,za=0,Xt=zt=wt=null,Iu=!1,t)throw Error(we(300));return e}function tp(){var e=Al!==0;return Al=0,e}function Kn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xt===null?wt.memoizedState=Xt=e:Xt=Xt.next=e,Xt}function vn(){if(zt===null){var e=wt.alternate;e=e!==null?e.memoizedState:null}else e=zt.next;var t=Xt===null?wt.memoizedState:Xt.next;if(t!==null)Xt=t,zt=e;else{if(e===null)throw Error(we(310));zt=e,e={memoizedState:zt.memoizedState,baseState:zt.baseState,baseQueue:zt.baseQueue,queue:zt.queue,next:null},Xt===null?wt.memoizedState=Xt=e:Xt=Xt.next=e}return Xt}function Pl(e,t){return typeof t=="function"?t(e):t}function Sf(e){var t=vn(),r=t.queue;if(r===null)throw Error(we(311));r.lastRenderedReducer=e;var n=zt,i=n.baseQueue,a=r.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}n.baseQueue=i=a,r.pending=null}if(i!==null){a=i.next,n=n.baseState;var l=o=null,u=null,f=a;do{var d=f.lane;if((za&d)===d)u!==null&&(u=u.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),n=f.hasEagerState?f.eagerState:e(n,f.action);else{var m={lane:d,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};u===null?(l=u=m,o=n):u=u.next=m,wt.lanes|=d,$a|=d}f=f.next}while(f!==null&&f!==a);u===null?o=n:u.next=l,Un(n,t.memoizedState)||(jr=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=u,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do a=i.lane,wt.lanes|=a,$a|=a,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Tf(e){var t=vn(),r=t.queue;if(r===null)throw Error(we(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,a=t.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do a=e(a,o.action),o=o.next;while(o!==i);Un(a,t.memoizedState)||(jr=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function G_(){}function Z_(e,t){var r=wt,n=vn(),i=t(),a=!Un(n.memoizedState,i);if(a&&(n.memoizedState=i,jr=!0),n=n.queue,rp(X_.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||Xt!==null&&Xt.memoizedState.tag&1){if(r.flags|=2048,Ol(9,q_.bind(null,r,n,i,t),void 0,null),Yt===null)throw Error(we(349));za&30||K_(r,t,i)}return i}function K_(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=wt.updateQueue,t===null?(t={lastEffect:null,stores:null},wt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function q_(e,t,r,n){t.value=r,t.getSnapshot=n,Y_(t)&&J_(e)}function X_(e,t,r){return r(function(){Y_(t)&&J_(e)})}function Y_(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Un(e,r)}catch{return!0}}function J_(e){var t=Ei(e,1);t!==null&&Bn(t,e,1,-1)}function E1(e){var t=Kn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Pl,lastRenderedState:e},t.queue=e,e=e.dispatch=qE.bind(null,wt,e),[t.memoizedState,e]}function Ol(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=wt.updateQueue,t===null?(t={lastEffect:null,stores:null},wt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Q_(){return vn().memoizedState}function fu(e,t,r,n){var i=Kn();wt.flags|=e,i.memoizedState=Ol(1|t,r,void 0,n===void 0?null:n)}function l0(e,t,r,n){var i=vn();n=n===void 0?null:n;var a=void 0;if(zt!==null){var o=zt.memoizedState;if(a=o.destroy,n!==null&&Qd(n,o.deps)){i.memoizedState=Ol(t,r,a,n);return}}wt.flags|=e,i.memoizedState=Ol(1|t,r,a,n)}function S1(e,t){return fu(8390656,8,e,t)}function rp(e,t){return l0(2048,8,e,t)}function ex(e,t){return l0(4,2,e,t)}function tx(e,t){return l0(4,4,e,t)}function rx(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function nx(e,t,r){return r=r!=null?r.concat([e]):null,l0(4,4,rx.bind(null,t,e),r)}function np(){}function ix(e,t){var r=vn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Qd(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function ax(e,t){var r=vn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Qd(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function sx(e,t,r){return za&21?(Un(r,t)||(r=f_(),wt.lanes|=r,$a|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,jr=!0),e.memoizedState=r)}function ZE(e,t){var r=at;at=r!==0&&4>r?r:4,e(!0);var n=Ef.transition;Ef.transition={};try{e(!1),t()}finally{at=r,Ef.transition=n}}function ox(){return vn().memoizedState}function KE(e,t,r){var n=ta(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},lx(e))cx(t,r);else if(r=W_(e,t,r,n),r!==null){var i=Pr();Bn(r,e,n,i),ux(r,t,n)}}function qE(e,t,r){var n=ta(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(lx(e))cx(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,l=a(o,r);if(i.hasEagerState=!0,i.eagerState=l,Un(l,o)){var u=t.interleaved;u===null?(i.next=i,Kd(t)):(i.next=u.next,u.next=i),t.interleaved=i;return}}catch{}finally{}r=W_(e,t,i,n),r!==null&&(i=Pr(),Bn(r,e,n,i),ux(r,t,n))}}function lx(e){var t=e.alternate;return e===wt||t!==null&&t===wt}function cx(e,t){el=Iu=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function ux(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Id(e,r)}}var Nu={readContext:gn,useCallback:hr,useContext:hr,useEffect:hr,useImperativeHandle:hr,useInsertionEffect:hr,useLayoutEffect:hr,useMemo:hr,useReducer:hr,useRef:hr,useState:hr,useDebugValue:hr,useDeferredValue:hr,useTransition:hr,useMutableSource:hr,useSyncExternalStore:hr,useId:hr,unstable_isNewReconciler:!1},XE={readContext:gn,useCallback:function(e,t){return Kn().memoizedState=[e,t===void 0?null:t],e},useContext:gn,useEffect:S1,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,fu(4194308,4,rx.bind(null,t,e),r)},useLayoutEffect:function(e,t){return fu(4194308,4,e,t)},useInsertionEffect:function(e,t){return fu(4,2,e,t)},useMemo:function(e,t){var r=Kn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Kn();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=KE.bind(null,wt,e),[n.memoizedState,e]},useRef:function(e){var t=Kn();return e={current:e},t.memoizedState=e},useState:E1,useDebugValue:np,useDeferredValue:function(e){return Kn().memoizedState=e},useTransition:function(){var e=E1(!1),t=e[0];return e=ZE.bind(null,e[1]),Kn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=wt,i=Kn();if(vt){if(r===void 0)throw Error(we(407));r=r()}else{if(r=t(),Yt===null)throw Error(we(349));za&30||K_(n,t,r)}i.memoizedState=r;var a={value:r,getSnapshot:t};return i.queue=a,S1(X_.bind(null,n,a,e),[e]),n.flags|=2048,Ol(9,q_.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=Kn(),t=Yt.identifierPrefix;if(vt){var r=gi,n=mi;r=(n&~(1<<32-Mn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Al++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=GE++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},YE={readContext:gn,useCallback:ix,useContext:gn,useEffect:rp,useImperativeHandle:nx,useInsertionEffect:ex,useLayoutEffect:tx,useMemo:ax,useReducer:Sf,useRef:Q_,useState:function(){return Sf(Pl)},useDebugValue:np,useDeferredValue:function(e){var t=vn();return sx(t,zt.memoizedState,e)},useTransition:function(){var e=Sf(Pl)[0],t=vn().memoizedState;return[e,t]},useMutableSource:G_,useSyncExternalStore:Z_,useId:ox,unstable_isNewReconciler:!1},JE={readContext:gn,useCallback:ix,useContext:gn,useEffect:rp,useImperativeHandle:nx,useInsertionEffect:ex,useLayoutEffect:tx,useMemo:ax,useReducer:Tf,useRef:Q_,useState:function(){return Tf(Pl)},useDebugValue:np,useDeferredValue:function(e){var t=vn();return zt===null?t.memoizedState=e:sx(t,zt.memoizedState,e)},useTransition:function(){var e=Tf(Pl)[0],t=vn().memoizedState;return[e,t]},useMutableSource:G_,useSyncExternalStore:Z_,useId:ox,unstable_isNewReconciler:!1};function Pn(e,t){if(e&&e.defaultProps){t=kt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Ih(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:kt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var c0={isMounted:function(e){return(e=e._reactInternals)?qa(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Pr(),i=ta(e),a=_i(n,i);a.payload=t,r!=null&&(a.callback=r),t=Qi(e,a,i),t!==null&&(Bn(t,e,i,n),cu(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Pr(),i=ta(e),a=_i(n,i);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=Qi(e,a,i),t!==null&&(Bn(t,e,i,n),cu(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Pr(),n=ta(e),i=_i(r,n);i.tag=2,t!=null&&(i.callback=t),t=Qi(e,i,n),t!==null&&(Bn(t,e,n,r),cu(t,e,n))}};function T1(e,t,r,n,i,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,o):t.prototype&&t.prototype.isPureReactComponent?!kl(r,n)||!kl(i,a):!0}function fx(e,t,r){var n=!1,i=oa,a=t.contextType;return typeof a=="object"&&a!==null?a=gn(a):(i=zr(t)?ja:yr.current,n=t.contextTypes,a=(n=n!=null)?Ys(e,i):oa),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=c0,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function C1(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&c0.enqueueReplaceState(t,t.state,null)}function Nh(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},qd(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=gn(a):(a=zr(t)?ja:yr.current,i.context=Ys(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Ih(e,t,a,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&c0.enqueueReplaceState(i,i.state,null),Fu(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function to(e,t){try{var r="",n=t;do r+=Ck(n),n=n.return;while(n);var i=r}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function Cf(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Dh(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var QE=typeof WeakMap=="function"?WeakMap:Map;function hx(e,t,r){r=_i(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Mu||(Mu=!0,Gh=n),Dh(e,t)},r}function dx(e,t,r){r=_i(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Dh(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Dh(e,t),typeof n!="function"&&(ea===null?ea=new Set([this]):ea.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function b1(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new QE;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=dS.bind(null,e,t,r),t.then(e,e))}function A1(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function P1(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=_i(-1,1),t.tag=2,Qi(r,t,1))),r.lanes|=1),e)}var eS=bi.ReactCurrentOwner,jr=!1;function Tr(e,t,r,n){t.child=e===null?$_(t,null,r,n):Qs(t,e.child,r,n)}function O1(e,t,r,n,i){r=r.render;var a=t.ref;return Hs(t,i),n=ep(e,t,r,n,a,i),r=tp(),e!==null&&!jr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Si(e,t,i)):(vt&&r&&$d(t),t.flags|=1,Tr(e,t,n,i),t.child)}function R1(e,t,r,n,i){if(e===null){var a=r.type;return typeof a=="function"&&!fp(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,px(e,t,a,n,i)):(e=mu(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var o=a.memoizedProps;if(r=r.compare,r=r!==null?r:kl,r(o,n)&&e.ref===t.ref)return Si(e,t,i)}return t.flags|=1,e=ra(a,n),e.ref=t.ref,e.return=t,t.child=e}function px(e,t,r,n,i){if(e!==null){var a=e.memoizedProps;if(kl(a,n)&&e.ref===t.ref)if(jr=!1,t.pendingProps=n=a,(e.lanes&i)!==0)e.flags&131072&&(jr=!0);else return t.lanes=e.lanes,Si(e,t,i)}return Mh(e,t,r,n,i)}function mx(e,t,r){var n=t.pendingProps,i=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ct(Ds,Vr),Vr|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ct(Ds,Vr),Vr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,ct(Ds,Vr),Vr|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,ct(Ds,Vr),Vr|=n;return Tr(e,t,i,r),t.child}function gx(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Mh(e,t,r,n,i){var a=zr(r)?ja:yr.current;return a=Ys(t,a),Hs(t,i),r=ep(e,t,r,n,a,i),n=tp(),e!==null&&!jr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Si(e,t,i)):(vt&&n&&$d(t),t.flags|=1,Tr(e,t,r,i),t.child)}function F1(e,t,r,n,i){if(zr(r)){var a=!0;bu(t)}else a=!1;if(Hs(t,i),t.stateNode===null)hu(e,t),fx(t,r,n),Nh(t,r,n,i),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var u=o.context,f=r.contextType;typeof f=="object"&&f!==null?f=gn(f):(f=zr(r)?ja:yr.current,f=Ys(t,f));var d=r.getDerivedStateFromProps,m=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||u!==f)&&C1(t,o,n,f),ji=!1;var p=t.memoizedState;o.state=p,Fu(t,n,o,i),u=t.memoizedState,l!==n||p!==u||Ur.current||ji?(typeof d=="function"&&(Ih(t,r,d,n),u=t.memoizedState),(l=ji||T1(t,r,l,n,p,u,f))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),o.props=n,o.state=u,o.context=f,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,H_(e,t),l=t.memoizedProps,f=t.type===t.elementType?l:Pn(t.type,l),o.props=f,m=t.pendingProps,p=o.context,u=r.contextType,typeof u=="object"&&u!==null?u=gn(u):(u=zr(r)?ja:yr.current,u=Ys(t,u));var v=r.getDerivedStateFromProps;(d=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||p!==u)&&C1(t,o,n,u),ji=!1,p=t.memoizedState,o.state=p,Fu(t,n,o,i);var x=t.memoizedState;l!==m||p!==x||Ur.current||ji?(typeof v=="function"&&(Ih(t,r,v,n),x=t.memoizedState),(f=ji||T1(t,r,f,n,p,x,u)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,x,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,x,u)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),o.props=n,o.state=x,o.context=u,n=f):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return Bh(e,t,r,n,a,i)}function Bh(e,t,r,n,i,a){gx(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return i&&v1(t,r,!1),Si(e,t,a);n=t.stateNode,eS.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=Qs(t,e.child,null,a),t.child=Qs(t,null,l,a)):Tr(e,t,l,a),t.memoizedState=n.state,i&&v1(t,r,!0),t.child}function vx(e){var t=e.stateNode;t.pendingContext?g1(e,t.pendingContext,t.pendingContext!==t.context):t.context&&g1(e,t.context,!1),Xd(e,t.containerInfo)}function L1(e,t,r,n,i){return Js(),Hd(i),t.flags|=256,Tr(e,t,r,n),t.child}var jh={dehydrated:null,treeContext:null,retryLane:0};function Uh(e){return{baseLanes:e,cachePool:null,transitions:null}}function _x(e,t,r){var n=t.pendingProps,i=yt.current,a=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),ct(yt,i&1),e===null)return Fh(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,a?(n=t.mode,a=t.child,o={mode:"hidden",children:o},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=h0(o,n,0,null),e=Na(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Uh(r),t.memoizedState=jh,e):ip(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return tS(e,t,o,n,l,i,r);if(a){a=n.fallback,o=t.mode,i=e.child,l=i.sibling;var u={mode:"hidden",children:n.children};return!(o&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=u,t.deletions=null):(n=ra(i,u),n.subtreeFlags=i.subtreeFlags&14680064),l!==null?a=ra(l,a):(a=Na(a,o,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,o=e.child.memoizedState,o=o===null?Uh(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~r,t.memoizedState=jh,n}return a=e.child,e=a.sibling,n=ra(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function ip(e,t){return t=h0({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Uc(e,t,r,n){return n!==null&&Hd(n),Qs(t,e.child,null,r),e=ip(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function tS(e,t,r,n,i,a,o){if(r)return t.flags&256?(t.flags&=-257,n=Cf(Error(we(422))),Uc(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,i=t.mode,n=h0({mode:"visible",children:n.children},i,0,null),a=Na(a,i,o,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&Qs(t,e.child,null,o),t.child.memoizedState=Uh(o),t.memoizedState=jh,a);if(!(t.mode&1))return Uc(e,t,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var l=n.dgst;return n=l,a=Error(we(419)),n=Cf(a,n,void 0),Uc(e,t,o,n)}if(l=(o&e.childLanes)!==0,jr||l){if(n=Yt,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,Ei(e,i),Bn(n,e,i,-1))}return up(),n=Cf(Error(we(421))),Uc(e,t,o,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=pS.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,Xr=Ji(i.nextSibling),Yr=t,vt=!0,Ln=null,e!==null&&(hn[dn++]=mi,hn[dn++]=gi,hn[dn++]=Ua,mi=e.id,gi=e.overflow,Ua=t),t=ip(t,n.children),t.flags|=4096,t)}function I1(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Lh(e.return,t,r)}function bf(e,t,r,n,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function xx(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(Tr(e,t,n.children,r),n=yt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&I1(e,r,t);else if(e.tag===19)I1(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(ct(yt,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&Lu(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),bf(t,!1,i,r,a);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Lu(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}bf(t,!0,r,null,a);break;case"together":bf(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function hu(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Si(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),$a|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(we(153));if(t.child!==null){for(e=t.child,r=ra(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ra(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function rS(e,t,r){switch(t.tag){case 3:vx(t),Js();break;case 5:V_(t);break;case 1:zr(t.type)&&bu(t);break;case 4:Xd(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;ct(Ou,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(ct(yt,yt.current&1),t.flags|=128,null):r&t.child.childLanes?_x(e,t,r):(ct(yt,yt.current&1),e=Si(e,t,r),e!==null?e.sibling:null);ct(yt,yt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return xx(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ct(yt,yt.current),n)break;return null;case 22:case 23:return t.lanes=0,mx(e,t,r)}return Si(e,t,r)}var yx,zh,wx,kx;yx=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};zh=function(){};wx=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Oa(Yn.current);var a=null;switch(r){case"input":i=ch(e,i),n=ch(e,n),a=[];break;case"select":i=kt({},i,{value:void 0}),n=kt({},n,{value:void 0}),a=[];break;case"textarea":i=hh(e,i),n=hh(e,n),a=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Tu)}ph(r,n);var o;r=null;for(f in i)if(!n.hasOwnProperty(f)&&i.hasOwnProperty(f)&&i[f]!=null)if(f==="style"){var l=i[f];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(ml.hasOwnProperty(f)?a||(a=[]):(a=a||[]).push(f,null));for(f in n){var u=n[f];if(l=i!=null?i[f]:void 0,n.hasOwnProperty(f)&&u!==l&&(u!=null||l!=null))if(f==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(r||(r={}),r[o]=u[o])}else r||(a||(a=[]),a.push(f,r)),r=u;else f==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(a=a||[]).push(f,u)):f==="children"?typeof u!="string"&&typeof u!="number"||(a=a||[]).push(f,""+u):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(ml.hasOwnProperty(f)?(u!=null&&f==="onScroll"&&dt("scroll",e),a||l===u||(a=[])):(a=a||[]).push(f,u))}r&&(a=a||[]).push("style",r);var f=a;(t.updateQueue=f)&&(t.flags|=4)}};kx=function(e,t,r,n){r!==n&&(t.flags|=4)};function Io(e,t){if(!vt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function dr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function nS(e,t,r){var n=t.pendingProps;switch(Wd(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dr(t),null;case 1:return zr(t.type)&&Cu(),dr(t),null;case 3:return n=t.stateNode,eo(),pt(Ur),pt(yr),Jd(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Bc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ln!==null&&(qh(Ln),Ln=null))),zh(e,t),dr(t),null;case 5:Yd(t);var i=Oa(bl.current);if(r=t.type,e!==null&&t.stateNode!=null)wx(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(we(166));return dr(t),null}if(e=Oa(Yn.current),Bc(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[qn]=t,n[Tl]=a,e=(t.mode&1)!==0,r){case"dialog":dt("cancel",n),dt("close",n);break;case"iframe":case"object":case"embed":dt("load",n);break;case"video":case"audio":for(i=0;i<$o.length;i++)dt($o[i],n);break;case"source":dt("error",n);break;case"img":case"image":case"link":dt("error",n),dt("load",n);break;case"details":dt("toggle",n);break;case"input":Wm(n,a),dt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},dt("invalid",n);break;case"textarea":Vm(n,a),dt("invalid",n)}ph(r,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?n.textContent!==l&&(a.suppressHydrationWarning!==!0&&Mc(n.textContent,l,e),i=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&Mc(n.textContent,l,e),i=["children",""+l]):ml.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&dt("scroll",n)}switch(r){case"input":Pc(n),Hm(n,a,!0);break;case"textarea":Pc(n),Gm(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=Tu)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Xv(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[qn]=t,e[Tl]=n,yx(e,t,!1,!1),t.stateNode=e;e:{switch(o=mh(r,n),r){case"dialog":dt("cancel",e),dt("close",e),i=n;break;case"iframe":case"object":case"embed":dt("load",e),i=n;break;case"video":case"audio":for(i=0;i<$o.length;i++)dt($o[i],e);i=n;break;case"source":dt("error",e),i=n;break;case"img":case"image":case"link":dt("error",e),dt("load",e),i=n;break;case"details":dt("toggle",e),i=n;break;case"input":Wm(e,n),i=ch(e,n),dt("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=kt({},n,{value:void 0}),dt("invalid",e);break;case"textarea":Vm(e,n),i=hh(e,n),dt("invalid",e);break;default:i=n}ph(r,i),l=i;for(a in l)if(l.hasOwnProperty(a)){var u=l[a];a==="style"?Qv(e,u):a==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Yv(e,u)):a==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&gl(e,u):typeof u=="number"&&gl(e,""+u):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(ml.hasOwnProperty(a)?u!=null&&a==="onScroll"&&dt("scroll",e):u!=null&&Ad(e,a,u,o))}switch(r){case"input":Pc(e),Hm(e,n,!1);break;case"textarea":Pc(e),Gm(e);break;case"option":n.value!=null&&e.setAttribute("value",""+sa(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Us(e,!!n.multiple,a,!1):n.defaultValue!=null&&Us(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Tu)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return dr(t),null;case 6:if(e&&t.stateNode!=null)kx(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(we(166));if(r=Oa(bl.current),Oa(Yn.current),Bc(t)){if(n=t.stateNode,r=t.memoizedProps,n[qn]=t,(a=n.nodeValue!==r)&&(e=Yr,e!==null))switch(e.tag){case 3:Mc(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Mc(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[qn]=t,t.stateNode=n}return dr(t),null;case 13:if(pt(yt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(vt&&Xr!==null&&t.mode&1&&!(t.flags&128))U_(),Js(),t.flags|=98560,a=!1;else if(a=Bc(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(we(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(we(317));a[qn]=t}else Js(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;dr(t),a=!1}else Ln!==null&&(qh(Ln),Ln=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||yt.current&1?$t===0&&($t=3):up())),t.updateQueue!==null&&(t.flags|=4),dr(t),null);case 4:return eo(),zh(e,t),e===null&&El(t.stateNode.containerInfo),dr(t),null;case 10:return Zd(t.type._context),dr(t),null;case 17:return zr(t.type)&&Cu(),dr(t),null;case 19:if(pt(yt),a=t.memoizedState,a===null)return dr(t),null;if(n=(t.flags&128)!==0,o=a.rendering,o===null)if(n)Io(a,!1);else{if($t!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Lu(e),o!==null){for(t.flags|=128,Io(a,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ct(yt,yt.current&1|2),t.child}e=e.sibling}a.tail!==null&&Rt()>ro&&(t.flags|=128,n=!0,Io(a,!1),t.lanes=4194304)}else{if(!n)if(e=Lu(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Io(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!vt)return dr(t),null}else 2*Rt()-a.renderingStartTime>ro&&r!==1073741824&&(t.flags|=128,n=!0,Io(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(r=a.last,r!==null?r.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Rt(),t.sibling=null,r=yt.current,ct(yt,n?r&1|2:r&1),t):(dr(t),null);case 22:case 23:return cp(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Vr&1073741824&&(dr(t),t.subtreeFlags&6&&(t.flags|=8192)):dr(t),null;case 24:return null;case 25:return null}throw Error(we(156,t.tag))}function iS(e,t){switch(Wd(t),t.tag){case 1:return zr(t.type)&&Cu(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return eo(),pt(Ur),pt(yr),Jd(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Yd(t),null;case 13:if(pt(yt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(we(340));Js()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return pt(yt),null;case 4:return eo(),null;case 10:return Zd(t.type._context),null;case 22:case 23:return cp(),null;case 24:return null;default:return null}}var zc=!1,gr=!1,aS=typeof WeakSet=="function"?WeakSet:Set,Oe=null;function Ns(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Tt(e,t,n)}else r.current=null}function $h(e,t,r){try{r()}catch(n){Tt(e,t,n)}}var N1=!1;function sS(e,t){if(Th=ku,e=b_(),zd(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var o=0,l=-1,u=-1,f=0,d=0,m=e,p=null;t:for(;;){for(var v;m!==r||i!==0&&m.nodeType!==3||(l=o+i),m!==a||n!==0&&m.nodeType!==3||(u=o+n),m.nodeType===3&&(o+=m.nodeValue.length),(v=m.firstChild)!==null;)p=m,m=v;for(;;){if(m===e)break t;if(p===r&&++f===i&&(l=o),p===a&&++d===n&&(u=o),(v=m.nextSibling)!==null)break;m=p,p=m.parentNode}m=v}r=l===-1||u===-1?null:{start:l,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(Ch={focusedElem:e,selectionRange:r},ku=!1,Oe=t;Oe!==null;)if(t=Oe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Oe=e;else for(;Oe!==null;){t=Oe;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var _=x.memoizedProps,S=x.memoizedState,w=t.stateNode,k=w.getSnapshotBeforeUpdate(t.elementType===t.type?_:Pn(t.type,_),S);w.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(we(163))}}catch(b){Tt(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,Oe=e;break}Oe=t.return}return x=N1,N1=!1,x}function tl(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&$h(t,r,a)}i=i.next}while(i!==n)}}function u0(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Wh(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Ex(e){var t=e.alternate;t!==null&&(e.alternate=null,Ex(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[qn],delete t[Tl],delete t[Ph],delete t[$E],delete t[WE])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Sx(e){return e.tag===5||e.tag===3||e.tag===4}function D1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Sx(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Hh(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Tu));else if(n!==4&&(e=e.child,e!==null))for(Hh(e,t,r),e=e.sibling;e!==null;)Hh(e,t,r),e=e.sibling}function Vh(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Vh(e,t,r),e=e.sibling;e!==null;)Vh(e,t,r),e=e.sibling}var nr=null,Rn=!1;function Ni(e,t,r){for(r=r.child;r!==null;)Tx(e,t,r),r=r.sibling}function Tx(e,t,r){if(Xn&&typeof Xn.onCommitFiberUnmount=="function")try{Xn.onCommitFiberUnmount(r0,r)}catch{}switch(r.tag){case 5:gr||Ns(r,t);case 6:var n=nr,i=Rn;nr=null,Ni(e,t,r),nr=n,Rn=i,nr!==null&&(Rn?(e=nr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):nr.removeChild(r.stateNode));break;case 18:nr!==null&&(Rn?(e=nr,r=r.stateNode,e.nodeType===8?yf(e.parentNode,r):e.nodeType===1&&yf(e,r),yl(e)):yf(nr,r.stateNode));break;case 4:n=nr,i=Rn,nr=r.stateNode.containerInfo,Rn=!0,Ni(e,t,r),nr=n,Rn=i;break;case 0:case 11:case 14:case 15:if(!gr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&$h(r,t,o),i=i.next}while(i!==n)}Ni(e,t,r);break;case 1:if(!gr&&(Ns(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Tt(r,t,l)}Ni(e,t,r);break;case 21:Ni(e,t,r);break;case 22:r.mode&1?(gr=(n=gr)||r.memoizedState!==null,Ni(e,t,r),gr=n):Ni(e,t,r);break;default:Ni(e,t,r)}}function M1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new aS),t.forEach(function(n){var i=mS.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Tn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var a=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:nr=l.stateNode,Rn=!1;break e;case 3:nr=l.stateNode.containerInfo,Rn=!0;break e;case 4:nr=l.stateNode.containerInfo,Rn=!0;break e}l=l.return}if(nr===null)throw Error(we(160));Tx(a,o,i),nr=null,Rn=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(f){Tt(i,t,f)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Cx(t,e),t=t.sibling}function Cx(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Tn(t,e),Vn(e),n&4){try{tl(3,e,e.return),u0(3,e)}catch(_){Tt(e,e.return,_)}try{tl(5,e,e.return)}catch(_){Tt(e,e.return,_)}}break;case 1:Tn(t,e),Vn(e),n&512&&r!==null&&Ns(r,r.return);break;case 5:if(Tn(t,e),Vn(e),n&512&&r!==null&&Ns(r,r.return),e.flags&32){var i=e.stateNode;try{gl(i,"")}catch(_){Tt(e,e.return,_)}}if(n&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,o=r!==null?r.memoizedProps:a,l=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&Kv(i,a),mh(l,o);var f=mh(l,a);for(o=0;o<u.length;o+=2){var d=u[o],m=u[o+1];d==="style"?Qv(i,m):d==="dangerouslySetInnerHTML"?Yv(i,m):d==="children"?gl(i,m):Ad(i,d,m,f)}switch(l){case"input":uh(i,a);break;case"textarea":qv(i,a);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var v=a.value;v!=null?Us(i,!!a.multiple,v,!1):p!==!!a.multiple&&(a.defaultValue!=null?Us(i,!!a.multiple,a.defaultValue,!0):Us(i,!!a.multiple,a.multiple?[]:"",!1))}i[Tl]=a}catch(_){Tt(e,e.return,_)}}break;case 6:if(Tn(t,e),Vn(e),n&4){if(e.stateNode===null)throw Error(we(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(_){Tt(e,e.return,_)}}break;case 3:if(Tn(t,e),Vn(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{yl(t.containerInfo)}catch(_){Tt(e,e.return,_)}break;case 4:Tn(t,e),Vn(e);break;case 13:Tn(t,e),Vn(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(op=Rt())),n&4&&M1(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(gr=(f=gr)||d,Tn(t,e),gr=f):Tn(t,e),Vn(e),n&8192){if(f=e.memoizedState!==null,(e.stateNode.isHidden=f)&&!d&&e.mode&1)for(Oe=e,d=e.child;d!==null;){for(m=Oe=d;Oe!==null;){switch(p=Oe,v=p.child,p.tag){case 0:case 11:case 14:case 15:tl(4,p,p.return);break;case 1:Ns(p,p.return);var x=p.stateNode;if(typeof x.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(_){Tt(n,r,_)}}break;case 5:Ns(p,p.return);break;case 22:if(p.memoizedState!==null){j1(m);continue}}v!==null?(v.return=p,Oe=v):j1(m)}d=d.sibling}e:for(d=null,m=e;;){if(m.tag===5){if(d===null){d=m;try{i=m.stateNode,f?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=m.stateNode,u=m.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=Jv("display",o))}catch(_){Tt(e,e.return,_)}}}else if(m.tag===6){if(d===null)try{m.stateNode.nodeValue=f?"":m.memoizedProps}catch(_){Tt(e,e.return,_)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;d===m&&(d=null),m=m.return}d===m&&(d=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Tn(t,e),Vn(e),n&4&&M1(e);break;case 21:break;default:Tn(t,e),Vn(e)}}function Vn(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Sx(r)){var n=r;break e}r=r.return}throw Error(we(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(gl(i,""),n.flags&=-33);var a=D1(e);Vh(e,a,i);break;case 3:case 4:var o=n.stateNode.containerInfo,l=D1(e);Hh(e,l,o);break;default:throw Error(we(161))}}catch(u){Tt(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function oS(e,t,r){Oe=e,bx(e)}function bx(e,t,r){for(var n=(e.mode&1)!==0;Oe!==null;){var i=Oe,a=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||zc;if(!o){var l=i.alternate,u=l!==null&&l.memoizedState!==null||gr;l=zc;var f=gr;if(zc=o,(gr=u)&&!f)for(Oe=i;Oe!==null;)o=Oe,u=o.child,o.tag===22&&o.memoizedState!==null?U1(i):u!==null?(u.return=o,Oe=u):U1(i);for(;a!==null;)Oe=a,bx(a),a=a.sibling;Oe=i,zc=l,gr=f}B1(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,Oe=a):B1(e)}}function B1(e){for(;Oe!==null;){var t=Oe;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:gr||u0(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!gr)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Pn(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&k1(t,a,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}k1(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var f=t.alternate;if(f!==null){var d=f.memoizedState;if(d!==null){var m=d.dehydrated;m!==null&&yl(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(we(163))}gr||t.flags&512&&Wh(t)}catch(p){Tt(t,t.return,p)}}if(t===e){Oe=null;break}if(r=t.sibling,r!==null){r.return=t.return,Oe=r;break}Oe=t.return}}function j1(e){for(;Oe!==null;){var t=Oe;if(t===e){Oe=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Oe=r;break}Oe=t.return}}function U1(e){for(;Oe!==null;){var t=Oe;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{u0(4,t)}catch(u){Tt(t,r,u)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(u){Tt(t,i,u)}}var a=t.return;try{Wh(t)}catch(u){Tt(t,a,u)}break;case 5:var o=t.return;try{Wh(t)}catch(u){Tt(t,o,u)}}}catch(u){Tt(t,t.return,u)}if(t===e){Oe=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Oe=l;break}Oe=t.return}}var lS=Math.ceil,Du=bi.ReactCurrentDispatcher,ap=bi.ReactCurrentOwner,mn=bi.ReactCurrentBatchConfig,tt=0,Yt=null,Bt=null,ar=0,Vr=0,Ds=fa(0),$t=0,Rl=null,$a=0,f0=0,sp=0,rl=null,Br=null,op=0,ro=1/0,ui=null,Mu=!1,Gh=null,ea=null,$c=!1,Gi=null,Bu=0,nl=0,Zh=null,du=-1,pu=0;function Pr(){return tt&6?Rt():du!==-1?du:du=Rt()}function ta(e){return e.mode&1?tt&2&&ar!==0?ar&-ar:VE.transition!==null?(pu===0&&(pu=f_()),pu):(e=at,e!==0||(e=window.event,e=e===void 0?16:__(e.type)),e):1}function Bn(e,t,r,n){if(50<nl)throw nl=0,Zh=null,Error(we(185));Kl(e,r,n),(!(tt&2)||e!==Yt)&&(e===Yt&&(!(tt&2)&&(f0|=r),$t===4&&$i(e,ar)),$r(e,n),r===1&&tt===0&&!(t.mode&1)&&(ro=Rt()+500,o0&&ha()))}function $r(e,t){var r=e.callbackNode;Vk(e,t);var n=wu(e,e===Yt?ar:0);if(n===0)r!==null&&qm(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&qm(r),t===1)e.tag===0?HE(z1.bind(null,e)):M_(z1.bind(null,e)),UE(function(){!(tt&6)&&ha()}),r=null;else{switch(h_(n)){case 1:r=Ld;break;case 4:r=c_;break;case 16:r=yu;break;case 536870912:r=u_;break;default:r=yu}r=Nx(r,Ax.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Ax(e,t){if(du=-1,pu=0,tt&6)throw Error(we(327));var r=e.callbackNode;if(Vs()&&e.callbackNode!==r)return null;var n=wu(e,e===Yt?ar:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=ju(e,n);else{t=n;var i=tt;tt|=2;var a=Ox();(Yt!==e||ar!==t)&&(ui=null,ro=Rt()+500,Ia(e,t));do try{fS();break}catch(l){Px(e,l)}while(!0);Gd(),Du.current=a,tt=i,Bt!==null?t=0:(Yt=null,ar=0,t=$t)}if(t!==0){if(t===2&&(i=yh(e),i!==0&&(n=i,t=Kh(e,i))),t===1)throw r=Rl,Ia(e,0),$i(e,n),$r(e,Rt()),r;if(t===6)$i(e,n);else{if(i=e.current.alternate,!(n&30)&&!cS(i)&&(t=ju(e,n),t===2&&(a=yh(e),a!==0&&(n=a,t=Kh(e,a))),t===1))throw r=Rl,Ia(e,0),$i(e,n),$r(e,Rt()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(we(345));case 2:Ea(e,Br,ui);break;case 3:if($i(e,n),(n&130023424)===n&&(t=op+500-Rt(),10<t)){if(wu(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Pr(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Ah(Ea.bind(null,e,Br,ui),t);break}Ea(e,Br,ui);break;case 4:if($i(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-Mn(n);a=1<<o,o=t[o],o>i&&(i=o),n&=~a}if(n=i,n=Rt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*lS(n/1960))-n,10<n){e.timeoutHandle=Ah(Ea.bind(null,e,Br,ui),n);break}Ea(e,Br,ui);break;case 5:Ea(e,Br,ui);break;default:throw Error(we(329))}}}return $r(e,Rt()),e.callbackNode===r?Ax.bind(null,e):null}function Kh(e,t){var r=rl;return e.current.memoizedState.isDehydrated&&(Ia(e,t).flags|=256),e=ju(e,t),e!==2&&(t=Br,Br=r,t!==null&&qh(t)),e}function qh(e){Br===null?Br=e:Br.push.apply(Br,e)}function cS(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!Un(a(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function $i(e,t){for(t&=~sp,t&=~f0,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Mn(t),n=1<<r;e[r]=-1,t&=~n}}function z1(e){if(tt&6)throw Error(we(327));Vs();var t=wu(e,0);if(!(t&1))return $r(e,Rt()),null;var r=ju(e,t);if(e.tag!==0&&r===2){var n=yh(e);n!==0&&(t=n,r=Kh(e,n))}if(r===1)throw r=Rl,Ia(e,0),$i(e,t),$r(e,Rt()),r;if(r===6)throw Error(we(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ea(e,Br,ui),$r(e,Rt()),null}function lp(e,t){var r=tt;tt|=1;try{return e(t)}finally{tt=r,tt===0&&(ro=Rt()+500,o0&&ha())}}function Wa(e){Gi!==null&&Gi.tag===0&&!(tt&6)&&Vs();var t=tt;tt|=1;var r=mn.transition,n=at;try{if(mn.transition=null,at=1,e)return e()}finally{at=n,mn.transition=r,tt=t,!(tt&6)&&ha()}}function cp(){Vr=Ds.current,pt(Ds)}function Ia(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,jE(r)),Bt!==null)for(r=Bt.return;r!==null;){var n=r;switch(Wd(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Cu();break;case 3:eo(),pt(Ur),pt(yr),Jd();break;case 5:Yd(n);break;case 4:eo();break;case 13:pt(yt);break;case 19:pt(yt);break;case 10:Zd(n.type._context);break;case 22:case 23:cp()}r=r.return}if(Yt=e,Bt=e=ra(e.current,null),ar=Vr=t,$t=0,Rl=null,sp=f0=$a=0,Br=rl=null,Pa!==null){for(t=0;t<Pa.length;t++)if(r=Pa[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,a=r.pending;if(a!==null){var o=a.next;a.next=i,n.next=o}r.pending=n}Pa=null}return e}function Px(e,t){do{var r=Bt;try{if(Gd(),uu.current=Nu,Iu){for(var n=wt.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Iu=!1}if(za=0,Xt=zt=wt=null,el=!1,Al=0,ap.current=null,r===null||r.return===null){$t=1,Rl=t,Bt=null;break}e:{var a=e,o=r.return,l=r,u=t;if(t=ar,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var f=u,d=l,m=d.tag;if(!(d.mode&1)&&(m===0||m===11||m===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var v=A1(o);if(v!==null){v.flags&=-257,P1(v,o,l,a,t),v.mode&1&&b1(a,f,t),t=v,u=f;var x=t.updateQueue;if(x===null){var _=new Set;_.add(u),t.updateQueue=_}else x.add(u);break e}else{if(!(t&1)){b1(a,f,t),up();break e}u=Error(we(426))}}else if(vt&&l.mode&1){var S=A1(o);if(S!==null){!(S.flags&65536)&&(S.flags|=256),P1(S,o,l,a,t),Hd(to(u,l));break e}}a=u=to(u,l),$t!==4&&($t=2),rl===null?rl=[a]:rl.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var w=hx(a,u,t);w1(a,w);break e;case 1:l=u;var k=a.type,y=a.stateNode;if(!(a.flags&128)&&(typeof k.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(ea===null||!ea.has(y)))){a.flags|=65536,t&=-t,a.lanes|=t;var b=dx(a,l,t);w1(a,b);break e}}a=a.return}while(a!==null)}Fx(r)}catch(O){t=O,Bt===r&&r!==null&&(Bt=r=r.return);continue}break}while(!0)}function Ox(){var e=Du.current;return Du.current=Nu,e===null?Nu:e}function up(){($t===0||$t===3||$t===2)&&($t=4),Yt===null||!($a&268435455)&&!(f0&268435455)||$i(Yt,ar)}function ju(e,t){var r=tt;tt|=2;var n=Ox();(Yt!==e||ar!==t)&&(ui=null,Ia(e,t));do try{uS();break}catch(i){Px(e,i)}while(!0);if(Gd(),tt=r,Du.current=n,Bt!==null)throw Error(we(261));return Yt=null,ar=0,$t}function uS(){for(;Bt!==null;)Rx(Bt)}function fS(){for(;Bt!==null&&!Dk();)Rx(Bt)}function Rx(e){var t=Ix(e.alternate,e,Vr);e.memoizedProps=e.pendingProps,t===null?Fx(e):Bt=t,ap.current=null}function Fx(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=iS(r,t),r!==null){r.flags&=32767,Bt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{$t=6,Bt=null;return}}else if(r=nS(r,t,Vr),r!==null){Bt=r;return}if(t=t.sibling,t!==null){Bt=t;return}Bt=t=e}while(t!==null);$t===0&&($t=5)}function Ea(e,t,r){var n=at,i=mn.transition;try{mn.transition=null,at=1,hS(e,t,r,n)}finally{mn.transition=i,at=n}return null}function hS(e,t,r,n){do Vs();while(Gi!==null);if(tt&6)throw Error(we(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(we(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(Gk(e,a),e===Yt&&(Bt=Yt=null,ar=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||$c||($c=!0,Nx(yu,function(){return Vs(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=mn.transition,mn.transition=null;var o=at;at=1;var l=tt;tt|=4,ap.current=null,sS(e,r),Cx(r,e),FE(Ch),ku=!!Th,Ch=Th=null,e.current=r,oS(r),Mk(),tt=l,at=o,mn.transition=a}else e.current=r;if($c&&($c=!1,Gi=e,Bu=i),a=e.pendingLanes,a===0&&(ea=null),Uk(r.stateNode),$r(e,Rt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Mu)throw Mu=!1,e=Gh,Gh=null,e;return Bu&1&&e.tag!==0&&Vs(),a=e.pendingLanes,a&1?e===Zh?nl++:(nl=0,Zh=e):nl=0,ha(),null}function Vs(){if(Gi!==null){var e=h_(Bu),t=mn.transition,r=at;try{if(mn.transition=null,at=16>e?16:e,Gi===null)var n=!1;else{if(e=Gi,Gi=null,Bu=0,tt&6)throw Error(we(331));var i=tt;for(tt|=4,Oe=e.current;Oe!==null;){var a=Oe,o=a.child;if(Oe.flags&16){var l=a.deletions;if(l!==null){for(var u=0;u<l.length;u++){var f=l[u];for(Oe=f;Oe!==null;){var d=Oe;switch(d.tag){case 0:case 11:case 15:tl(8,d,a)}var m=d.child;if(m!==null)m.return=d,Oe=m;else for(;Oe!==null;){d=Oe;var p=d.sibling,v=d.return;if(Ex(d),d===f){Oe=null;break}if(p!==null){p.return=v,Oe=p;break}Oe=v}}}var x=a.alternate;if(x!==null){var _=x.child;if(_!==null){x.child=null;do{var S=_.sibling;_.sibling=null,_=S}while(_!==null)}}Oe=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,Oe=o;else e:for(;Oe!==null;){if(a=Oe,a.flags&2048)switch(a.tag){case 0:case 11:case 15:tl(9,a,a.return)}var w=a.sibling;if(w!==null){w.return=a.return,Oe=w;break e}Oe=a.return}}var k=e.current;for(Oe=k;Oe!==null;){o=Oe;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,Oe=y;else e:for(o=k;Oe!==null;){if(l=Oe,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:u0(9,l)}}catch(O){Tt(l,l.return,O)}if(l===o){Oe=null;break e}var b=l.sibling;if(b!==null){b.return=l.return,Oe=b;break e}Oe=l.return}}if(tt=i,ha(),Xn&&typeof Xn.onPostCommitFiberRoot=="function")try{Xn.onPostCommitFiberRoot(r0,e)}catch{}n=!0}return n}finally{at=r,mn.transition=t}}return!1}function $1(e,t,r){t=to(r,t),t=hx(e,t,1),e=Qi(e,t,1),t=Pr(),e!==null&&(Kl(e,1,t),$r(e,t))}function Tt(e,t,r){if(e.tag===3)$1(e,e,r);else for(;t!==null;){if(t.tag===3){$1(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ea===null||!ea.has(n))){e=to(r,e),e=dx(t,e,1),t=Qi(t,e,1),e=Pr(),t!==null&&(Kl(t,1,e),$r(t,e));break}}t=t.return}}function dS(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Pr(),e.pingedLanes|=e.suspendedLanes&r,Yt===e&&(ar&r)===r&&($t===4||$t===3&&(ar&130023424)===ar&&500>Rt()-op?Ia(e,0):sp|=r),$r(e,t)}function Lx(e,t){t===0&&(e.mode&1?(t=Fc,Fc<<=1,!(Fc&130023424)&&(Fc=4194304)):t=1);var r=Pr();e=Ei(e,t),e!==null&&(Kl(e,t,r),$r(e,r))}function pS(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Lx(e,r)}function mS(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(we(314))}n!==null&&n.delete(t),Lx(e,r)}var Ix;Ix=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ur.current)jr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return jr=!1,rS(e,t,r);jr=!!(e.flags&131072)}else jr=!1,vt&&t.flags&1048576&&B_(t,Pu,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;hu(e,t),e=t.pendingProps;var i=Ys(t,yr.current);Hs(t,r),i=ep(null,t,n,e,i,r);var a=tp();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,zr(n)?(a=!0,bu(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,qd(t),i.updater=c0,t.stateNode=i,i._reactInternals=t,Nh(t,n,e,r),t=Bh(null,t,n,!0,a,r)):(t.tag=0,vt&&a&&$d(t),Tr(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(hu(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=vS(n),e=Pn(n,e),i){case 0:t=Mh(null,t,n,e,r);break e;case 1:t=F1(null,t,n,e,r);break e;case 11:t=O1(null,t,n,e,r);break e;case 14:t=R1(null,t,n,Pn(n.type,e),r);break e}throw Error(we(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Pn(n,i),Mh(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Pn(n,i),F1(e,t,n,i,r);case 3:e:{if(vx(t),e===null)throw Error(we(387));n=t.pendingProps,a=t.memoizedState,i=a.element,H_(e,t),Fu(t,n,null,r);var o=t.memoizedState;if(n=o.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=to(Error(we(423)),t),t=L1(e,t,n,r,i);break e}else if(n!==i){i=to(Error(we(424)),t),t=L1(e,t,n,r,i);break e}else for(Xr=Ji(t.stateNode.containerInfo.firstChild),Yr=t,vt=!0,Ln=null,r=$_(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Js(),n===i){t=Si(e,t,r);break e}Tr(e,t,n,r)}t=t.child}return t;case 5:return V_(t),e===null&&Fh(t),n=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,o=i.children,bh(n,i)?o=null:a!==null&&bh(n,a)&&(t.flags|=32),gx(e,t),Tr(e,t,o,r),t.child;case 6:return e===null&&Fh(t),null;case 13:return _x(e,t,r);case 4:return Xd(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Qs(t,null,n,r):Tr(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Pn(n,i),O1(e,t,n,i,r);case 7:return Tr(e,t,t.pendingProps,r),t.child;case 8:return Tr(e,t,t.pendingProps.children,r),t.child;case 12:return Tr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,ct(Ou,n._currentValue),n._currentValue=o,a!==null)if(Un(a.value,o)){if(a.children===i.children&&!Ur.current){t=Si(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var u=l.firstContext;u!==null;){if(u.context===n){if(a.tag===1){u=_i(-1,r&-r),u.tag=2;var f=a.updateQueue;if(f!==null){f=f.shared;var d=f.pending;d===null?u.next=u:(u.next=d.next,d.next=u),f.pending=u}}a.lanes|=r,u=a.alternate,u!==null&&(u.lanes|=r),Lh(a.return,r,t),l.lanes|=r;break}u=u.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(we(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Lh(o,r,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}Tr(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Hs(t,r),i=gn(i),n=n(i),t.flags|=1,Tr(e,t,n,r),t.child;case 14:return n=t.type,i=Pn(n,t.pendingProps),i=Pn(n.type,i),R1(e,t,n,i,r);case 15:return px(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Pn(n,i),hu(e,t),t.tag=1,zr(n)?(e=!0,bu(t)):e=!1,Hs(t,r),fx(t,n,i),Nh(t,n,i,r),Bh(null,t,n,!0,e,r);case 19:return xx(e,t,r);case 22:return mx(e,t,r)}throw Error(we(156,t.tag))};function Nx(e,t){return l_(e,t)}function gS(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pn(e,t,r,n){return new gS(e,t,r,n)}function fp(e){return e=e.prototype,!(!e||!e.isReactComponent)}function vS(e){if(typeof e=="function")return fp(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Od)return 11;if(e===Rd)return 14}return 2}function ra(e,t){var r=e.alternate;return r===null?(r=pn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function mu(e,t,r,n,i,a){var o=2;if(n=e,typeof e=="function")fp(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Cs:return Na(r.children,i,a,t);case Pd:o=8,i|=8;break;case ah:return e=pn(12,r,t,i|2),e.elementType=ah,e.lanes=a,e;case sh:return e=pn(13,r,t,i),e.elementType=sh,e.lanes=a,e;case oh:return e=pn(19,r,t,i),e.elementType=oh,e.lanes=a,e;case Vv:return h0(r,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Wv:o=10;break e;case Hv:o=9;break e;case Od:o=11;break e;case Rd:o=14;break e;case Bi:o=16,n=null;break e}throw Error(we(130,e==null?e:typeof e,""))}return t=pn(o,r,t,i),t.elementType=e,t.type=n,t.lanes=a,t}function Na(e,t,r,n){return e=pn(7,e,n,t),e.lanes=r,e}function h0(e,t,r,n){return e=pn(22,e,n,t),e.elementType=Vv,e.lanes=r,e.stateNode={isHidden:!1},e}function Af(e,t,r){return e=pn(6,e,null,t),e.lanes=r,e}function Pf(e,t,r){return t=pn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function _S(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=cf(0),this.expirationTimes=cf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cf(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function hp(e,t,r,n,i,a,o,l,u){return e=new _S(e,t,r,l,u),t===1?(t=1,a===!0&&(t|=8)):t=0,a=pn(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},qd(a),e}function xS(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ts,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Dx(e){if(!e)return oa;e=e._reactInternals;e:{if(qa(e)!==e||e.tag!==1)throw Error(we(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(zr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(we(171))}if(e.tag===1){var r=e.type;if(zr(r))return D_(e,r,t)}return t}function Mx(e,t,r,n,i,a,o,l,u){return e=hp(r,n,!0,e,i,a,o,l,u),e.context=Dx(null),r=e.current,n=Pr(),i=ta(r),a=_i(n,i),a.callback=t??null,Qi(r,a,i),e.current.lanes=i,Kl(e,i,n),$r(e,n),e}function d0(e,t,r,n){var i=t.current,a=Pr(),o=ta(i);return r=Dx(r),t.context===null?t.context=r:t.pendingContext=r,t=_i(a,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Qi(i,t,o),e!==null&&(Bn(e,i,o,a),cu(e,i,o)),o}function Uu(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function W1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function dp(e,t){W1(e,t),(e=e.alternate)&&W1(e,t)}function yS(){return null}var Bx=typeof reportError=="function"?reportError:function(e){console.error(e)};function pp(e){this._internalRoot=e}p0.prototype.render=pp.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(we(409));d0(e,t,null,null)};p0.prototype.unmount=pp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Wa(function(){d0(null,e,null,null)}),t[ki]=null}};function p0(e){this._internalRoot=e}p0.prototype.unstable_scheduleHydration=function(e){if(e){var t=m_();e={blockedOn:null,target:e,priority:t};for(var r=0;r<zi.length&&t!==0&&t<zi[r].priority;r++);zi.splice(r,0,e),r===0&&v_(e)}};function mp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function m0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function H1(){}function wS(e,t,r,n,i){if(i){if(typeof n=="function"){var a=n;n=function(){var f=Uu(o);a.call(f)}}var o=Mx(t,n,e,0,null,!1,!1,"",H1);return e._reactRootContainer=o,e[ki]=o.current,El(e.nodeType===8?e.parentNode:e),Wa(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var l=n;n=function(){var f=Uu(u);l.call(f)}}var u=hp(e,0,!1,null,null,!1,!1,"",H1);return e._reactRootContainer=u,e[ki]=u.current,El(e.nodeType===8?e.parentNode:e),Wa(function(){d0(t,u,r,n)}),u}function g0(e,t,r,n,i){var a=r._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var l=i;i=function(){var u=Uu(o);l.call(u)}}d0(t,o,e,i)}else o=wS(r,t,e,i,n);return Uu(o)}d_=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=zo(t.pendingLanes);r!==0&&(Id(t,r|1),$r(t,Rt()),!(tt&6)&&(ro=Rt()+500,ha()))}break;case 13:Wa(function(){var n=Ei(e,1);if(n!==null){var i=Pr();Bn(n,e,1,i)}}),dp(e,1)}};Nd=function(e){if(e.tag===13){var t=Ei(e,134217728);if(t!==null){var r=Pr();Bn(t,e,134217728,r)}dp(e,134217728)}};p_=function(e){if(e.tag===13){var t=ta(e),r=Ei(e,t);if(r!==null){var n=Pr();Bn(r,e,t,n)}dp(e,t)}};m_=function(){return at};g_=function(e,t){var r=at;try{return at=e,t()}finally{at=r}};vh=function(e,t,r){switch(t){case"input":if(uh(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=s0(n);if(!i)throw Error(we(90));Zv(n),uh(n,i)}}}break;case"textarea":qv(e,r);break;case"select":t=r.value,t!=null&&Us(e,!!r.multiple,t,!1)}};r_=lp;n_=Wa;var kS={usingClientEntryPoint:!1,Events:[Xl,Os,s0,e_,t_,lp]},No={findFiberByHostInstance:Aa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ES={bundleType:No.bundleType,version:No.version,rendererPackageName:No.rendererPackageName,rendererConfig:No.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:bi.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=s_(e),e===null?null:e.stateNode},findFiberByHostInstance:No.findFiberByHostInstance||yS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wc.isDisabled&&Wc.supportsFiber)try{r0=Wc.inject(ES),Xn=Wc}catch{}}en.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kS;en.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!mp(t))throw Error(we(200));return xS(e,t,null,r)};en.createRoot=function(e,t){if(!mp(e))throw Error(we(299));var r=!1,n="",i=Bx;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=hp(e,1,!1,null,null,r,!1,n,i),e[ki]=t.current,El(e.nodeType===8?e.parentNode:e),new pp(t)};en.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(we(188)):(e=Object.keys(e).join(","),Error(we(268,e)));return e=s_(t),e=e===null?null:e.stateNode,e};en.flushSync=function(e){return Wa(e)};en.hydrate=function(e,t,r){if(!m0(t))throw Error(we(200));return g0(null,e,t,!0,r)};en.hydrateRoot=function(e,t,r){if(!mp(e))throw Error(we(405));var n=r!=null&&r.hydratedSources||null,i=!1,a="",o=Bx;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=Mx(t,null,e,1,r??null,i,!1,a,o),e[ki]=t.current,El(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new p0(t)};en.render=function(e,t,r){if(!m0(t))throw Error(we(200));return g0(null,e,t,!1,r)};en.unmountComponentAtNode=function(e){if(!m0(e))throw Error(we(40));return e._reactRootContainer?(Wa(function(){g0(null,null,e,!1,function(){e._reactRootContainer=null,e[ki]=null})}),!0):!1};en.unstable_batchedUpdates=lp;en.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!m0(r))throw Error(we(200));if(e==null||e._reactInternals===void 0)throw Error(we(38));return g0(e,t,r,!1,n)};en.version="18.3.1-next-f1338f8080-20240426";function jx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(jx)}catch(e){console.error(e)}}jx(),jv.exports=en;var SS=jv.exports,V1=SS;nh.createRoot=V1.createRoot,nh.hydrateRoot=V1.hydrateRoot;function v0(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function TS(e,t,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(d){try{f(n.next(d))}catch(m){o(m)}}function u(d){try{f(n.throw(d))}catch(m){o(m)}}function f(d){d.done?a(d.value):i(d.value).then(l,u)}f((n=n.apply(e,t||[])).next())})}const CS=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class gp extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class bS extends gp{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class G1 extends gp{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Z1 extends gp{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Xh;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Xh||(Xh={}));class AS{constructor(t,{headers:r={},customFetch:n,region:i=Xh.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=CS(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return TS(this,arguments,void 0,function*(r,n={}){var i;let a,o;try{const{headers:l,method:u,body:f,signal:d,timeout:m}=n;let p={},{region:v}=n;v||(v=this.region);const x=new URL(`${this.url}/${r}`);v&&v!=="any"&&(p["x-region"]=v,x.searchParams.set("forceFunctionRegion",v));let _;f&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&f instanceof Blob||f instanceof ArrayBuffer?(p["Content-Type"]="application/octet-stream",_=f):typeof f=="string"?(p["Content-Type"]="text/plain",_=f):typeof FormData<"u"&&f instanceof FormData?_=f:(p["Content-Type"]="application/json",_=JSON.stringify(f)):f&&typeof f!="string"&&!(typeof Blob<"u"&&f instanceof Blob)&&!(f instanceof ArrayBuffer)&&!(typeof FormData<"u"&&f instanceof FormData)?_=JSON.stringify(f):_=f;let S=d;m&&(o=new AbortController,a=setTimeout(()=>o.abort(),m),d?(S=o.signal,d.addEventListener("abort",()=>o.abort())):S=o.signal);const w=yield this.fetch(x.toString(),{method:u||"POST",headers:Object.assign(Object.assign(Object.assign({},p),this.headers),l),body:_,signal:S}).catch(O=>{throw new bS(O)}),k=w.headers.get("x-relay-error");if(k&&k==="true")throw new G1(w);if(!w.ok)throw new Z1(w);let y=((i=w.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),b;return y==="application/json"?b=yield w.json():y==="application/octet-stream"||y==="application/pdf"?b=yield w.blob():y==="text/event-stream"?b=w:y==="multipart/form-data"?b=yield w.formData():b=yield w.text(),{data:b,error:null,response:w}}catch(l){return{data:null,error:l,response:l instanceof Z1||l instanceof G1?l.context:void 0}}finally{a&&clearTimeout(a)}})}}var PS=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},OS=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{let o=null,l=null,u=null,f=a.status,d=a.statusText;if(a.ok){var m,p;if(r.method!=="HEAD"){var v;const w=await a.text();w===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((v=r.headers.get("Accept"))===null||v===void 0)&&v.includes("application/vnd.pgrst.plan+text"))?l=w:l=JSON.parse(w))}const _=(m=r.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),S=(p=a.headers.get("content-range"))===null||p===void 0?void 0:p.split("/");_&&S&&S.length>1&&(u=parseInt(S[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(l)&&(l.length>1?(o={code:"PGRST116",details:`Results contain ${l.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,u=null,f=406,d="Not Acceptable"):l.length===1?l=l[0]:l=null)}else{var x;const _=await a.text();try{o=JSON.parse(_),Array.isArray(o)&&a.status===404&&(l=[],o=null,f=200,d="OK")}catch{a.status===404&&_===""?(f=204,d="No Content"):o={message:_}}if(o&&r.isMaybeSingle&&(!(o==null||(x=o.details)===null||x===void 0)&&x.includes("0 rows"))&&(o=null,f=200,d="OK"),o&&r.shouldThrowOnError)throw new PS(o)}return{error:o,data:l,count:u,status:f,statusText:d}});return this.shouldThrowOnError||(i=i.catch(a=>{var o;let l="";const u=a==null?void 0:a.cause;if(u){var f,d,m,p;const x=(f=u==null?void 0:u.message)!==null&&f!==void 0?f:"",_=(d=u==null?void 0:u.code)!==null&&d!==void 0?d:"";l=`${(m=a==null?void 0:a.name)!==null&&m!==void 0?m:"FetchError"}: ${a==null?void 0:a.message}`,l+=`

Caused by: ${(p=u==null?void 0:u.name)!==null&&p!==void 0?p:"Error"}: ${x}`,_&&(l+=` (${_})`),u!=null&&u.stack&&(l+=`
${u.stack}`)}else{var v;l=(v=a==null?void 0:a.stack)!==null&&v!==void 0?v:""}return{error:{message:`${(o=a==null?void 0:a.name)!==null&&o!==void 0?o:"FetchError"}: ${a==null?void 0:a.message}`,details:l,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}},RS=class extends OS{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){const a=i?`${i}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"offset":`${n}.offset`,a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:a="text"}={}){var o;const l=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${u}"; options=${l};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const K1=new RegExp("[,()]");var ws=class extends RS{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&K1.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&K1.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const a=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},FS=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:n}=t??{},i=r?"HEAD":"GET";let a=!1;const o=(e??"*").split("").map(f=>/\s/.test(f)&&!a?"":(f==='"'&&(a=!a),f)).join(""),{url:l,headers:u}=this.cloneRequestState();return l.searchParams.set("select",o),n&&u.append("Prefer",`count=${n}`),new ws({method:i,url:l,headers:u,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const i="POST",{url:a,headers:o}=this.cloneRequestState();if(t&&o.append("Prefer",`count=${t}`),r||o.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((u,f)=>u.concat(Object.keys(f)),[]);if(l.length>0){const u=[...new Set(l)].map(f=>`"${f}"`);a.searchParams.set("columns",u.join(","))}}return new ws({method:i,url:a,headers:o,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:i=!0}={}){var a;const o="POST",{url:l,headers:u}=this.cloneRequestState();if(u.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&l.searchParams.set("on_conflict",t),n&&u.append("Prefer",`count=${n}`),i||u.append("Prefer","missing=default"),Array.isArray(e)){const f=e.reduce((d,m)=>d.concat(Object.keys(m)),[]);if(f.length>0){const d=[...new Set(f)].map(m=>`"${m}"`);l.searchParams.set("columns",d.join(","))}}return new ws({method:o,url:l,headers:u,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(e,{count:t}={}){var r;const n="PATCH",{url:i,headers:a}=this.cloneRequestState();return t&&a.append("Prefer",`count=${t}`),new ws({method:n,url:i,headers:a,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE",{url:n,headers:i}=this.cloneRequestState();return e&&i.append("Prefer",`count=${e}`),new ws({method:r,url:n,headers:i,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},LS=class Ux{constructor(t,{headers:r={},schema:n,fetch:i}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=i}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new FS(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Ux(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:i=!1,count:a}={}){var o;let l;const u=new URL(`${this.url}/rpc/${t}`);let f;const d=v=>v!==null&&typeof v=="object"&&(!Array.isArray(v)||v.some(d)),m=n&&Object.values(r).some(d);m?(l="POST",f=r):n||i?(l=n?"HEAD":"GET",Object.entries(r).filter(([v,x])=>x!==void 0).map(([v,x])=>[v,Array.isArray(x)?`{${x.join(",")}}`:`${x}`]).forEach(([v,x])=>{u.searchParams.append(v,x)})):(l="POST",f=r);const p=new Headers(this.headers);return m?p.set("Prefer",a?`count=${a},return=minimal`:"return=minimal"):a&&p.set("Prefer",`count=${a}`),new ws({method:l,url:u,headers:p,schema:this.schemaName,body:f,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class IS{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const n=r.versions;if(n&&n.node){const i=n.node,a=parseInt(i.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const NS="2.90.1",DS=`realtime-js/${NS}`,zx="1.0.0",MS="2.0.0",q1=zx,Yh=1e4,BS=1e3,jS=100;var Ui;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Ui||(Ui={}));var jt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(jt||(jt={}));var Fn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Fn||(Fn={}));var Jh;(function(e){e.websocket="websocket"})(Jh||(Jh={}));var Ta;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Ta||(Ta={}));class US{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},o=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(t,r,n){var i,a;const o=t.topic,l=(i=t.ref)!==null&&i!==void 0?i:"",u=(a=t.join_ref)!==null&&a!==void 0?a:"",f=t.payload.event,d=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},m=Object.keys(d).length===0?"":JSON.stringify(d);if(u.length>255)throw new Error(`joinRef length ${u.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`userEvent length ${f.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`metadata length ${m.length} exceeds maximum of 255`);const p=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+l.length+o.length+f.length+m.length,v=new ArrayBuffer(this.HEADER_LENGTH+p);let x=new DataView(v),_=0;x.setUint8(_++,this.KINDS.userBroadcastPush),x.setUint8(_++,u.length),x.setUint8(_++,l.length),x.setUint8(_++,o.length),x.setUint8(_++,f.length),x.setUint8(_++,m.length),x.setUint8(_++,r),Array.from(u,w=>x.setUint8(_++,w.charCodeAt(0))),Array.from(l,w=>x.setUint8(_++,w.charCodeAt(0))),Array.from(o,w=>x.setUint8(_++,w.charCodeAt(0))),Array.from(f,w=>x.setUint8(_++,w.charCodeAt(0))),Array.from(m,w=>x.setUint8(_++,w.charCodeAt(0)));var S=new Uint8Array(v.byteLength+n.byteLength);return S.set(new Uint8Array(v),0),S.set(new Uint8Array(n),v.byteLength),S.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[i,a,o,l,u]=n;return r({join_ref:i,ref:a,topic:o,event:l,payload:u})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),i=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,i)}}_decodeUserBroadcast(t,r,n){const i=r.getUint8(1),a=r.getUint8(2),o=r.getUint8(3),l=r.getUint8(4);let u=this.HEADER_LENGTH+4;const f=n.decode(t.slice(u,u+i));u=u+i;const d=n.decode(t.slice(u,u+a));u=u+a;const m=n.decode(t.slice(u,u+o));u=u+o;const p=t.slice(u,t.byteLength),v=l===this.JSON_ENCODING?JSON.parse(n.decode(p)):p,x={type:this.BROADCAST_EVENT,event:d,payload:v};return o>0&&(x.meta=JSON.parse(m)),{join_ref:null,ref:null,topic:f,event:this.BROADCAST_EVENT,payload:x}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class $x{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var lt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(lt||(lt={}));const X1=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((a,o)=>(a[o]=zS(o,e,t,i),a),{}):{}},zS=(e,t,r,n)=>{const i=t.find(l=>l.name===e),a=i==null?void 0:i.type,o=r[e];return a&&!n.includes(a)?Wx(a,o):Qh(o)},Wx=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return VS(t,r)}switch(e){case lt.bool:return $S(t);case lt.float4:case lt.float8:case lt.int2:case lt.int4:case lt.int8:case lt.numeric:case lt.oid:return WS(t);case lt.json:case lt.jsonb:return HS(t);case lt.timestamp:return GS(t);case lt.abstime:case lt.date:case lt.daterange:case lt.int4range:case lt.int8range:case lt.money:case lt.reltime:case lt.text:case lt.time:case lt.timestamptz:case lt.timetz:case lt.tsrange:case lt.tstzrange:return Qh(t);default:return Qh(t)}},Qh=e=>e,$S=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},WS=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},HS=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},VS=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let a;const o=e.slice(1,r);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(l=>Wx(t,l))}return e},GS=e=>typeof e=="string"?e.replace(" ","T"):e,Hx=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Of{constructor(t,r,n={},i=Yh){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Y1;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Y1||(Y1={}));class il{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=il.syncState(this.state,i,a,o),this.pendingDiffs.forEach(u=>{this.state=il.syncDiff(this.state,u,a,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},i=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=il.syncDiff(this.state,i,a,o),l())}),this.onJoin((i,a,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:a,newPresences:o})}),this.onLeave((i,a,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const a=this.cloneDeep(t),o=this.transformState(r),l={},u={};return this.map(a,(f,d)=>{o[f]||(u[f]=d)}),this.map(o,(f,d)=>{const m=a[f];if(m){const p=d.map(S=>S.presence_ref),v=m.map(S=>S.presence_ref),x=d.filter(S=>v.indexOf(S.presence_ref)<0),_=m.filter(S=>p.indexOf(S.presence_ref)<0);x.length>0&&(l[f]=x),_.length>0&&(u[f]=_)}else l[f]=d}),this.syncDiff(a,{joins:l,leaves:u},n,i)}static syncDiff(t,r,n,i){const{joins:a,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(a,(l,u)=>{var f;const d=(f=t[l])!==null&&f!==void 0?f:[];if(t[l]=this.cloneDeep(u),d.length>0){const m=t[l].map(v=>v.presence_ref),p=d.filter(v=>m.indexOf(v.presence_ref)<0);t[l].unshift(...p)}n(l,d,u)}),this.map(o,(l,u)=>{let f=t[l];if(!f)return;const d=u.map(m=>m.presence_ref);f=f.filter(m=>d.indexOf(m.presence_ref)<0),t[l]=f,i(l,f,u),f.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var J1;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(J1||(J1={}));var al;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(al||(al={}));var fi;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(fi||(fi={}));class Ms{constructor(t,r={config:{}},n){var i,a;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=jt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Of(this,Fn.join,this.params,this.timeout),this.rejoinTimer=new $x(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=jt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=jt.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=jt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=jt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=jt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Fn.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new il(this),this.broadcastEndpointURL=Hx(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,i,a;if(this.socket.isConnected()||this.socket.connect(),this.state==jt.closed){const{config:{broadcast:o,presence:l,private:u}}=this.params,f=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(v=>v.filter))!==null&&i!==void 0?i:[],d=!!this.bindings[al.PRESENCE]&&this.bindings[al.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,m={},p={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:f,private:u};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(v=>t==null?void 0:t(fi.CHANNEL_ERROR,v)),this._onClose(()=>t==null?void 0:t(fi.CLOSED)),this.updateJoinPayload(Object.assign({config:p},m)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:v})=>{var x;if(this.socket._isManualToken()||this.socket.setAuth(),v===void 0){t==null||t(fi.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,S=(x=_==null?void 0:_.length)!==null&&x!==void 0?x:0,w=[];for(let k=0;k<S;k++){const y=_[k],{filter:{event:b,schema:O,table:R,filter:C}}=y,z=v&&v[k];if(z&&z.event===b&&Ms.isFilterValueEqual(z.schema,O)&&Ms.isFilterValueEqual(z.table,R)&&Ms.isFilterValueEqual(z.filter,C))w.push(Object.assign(Object.assign({},y),{id:z.id}));else{this.unsubscribe(),this.state=jt.errored,t==null||t(fi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,t&&t(fi.SUBSCRIBED);return}}).receive("error",v=>{this.state=jt.errored,t==null||t(fi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(fi.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===jt.joined&&t===al.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var i;if(r==null)return Promise.reject("Payload is required for httpSend()");const a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(l.status===202)return{success:!0};let u=l.statusText;try{const f=await l.json();u=f.error||f.message||u}catch{}return Promise.reject(new Error(u))}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:o}=t,l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const u={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=f.body)===null||i===void 0?void 0:i.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,l,u;const f=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((u=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||u===void 0)&&u.ack)&&a("ok"),f.receive("ok",()=>a("ok")),f.receive("error",()=>a("error")),f.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=jt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Fn.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new Of(this,Fn.leave,{},t),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=jt.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const i=new AbortController,a=setTimeout(()=>i.abort(),n),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(a),o}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Of(this,t,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>jS){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,a;const o=t.toLocaleLowerCase(),{close:l,error:u,leave:f,join:d}=Fn;if(n&&[l,u,f,d].indexOf(o)>=0&&n!==this._joinRef())return;let p=this._onMessage(o,r,n);if(r&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(v=>{var x,_,S;return((x=v.filter)===null||x===void 0?void 0:x.event)==="*"||((S=(_=v.filter)===null||_===void 0?void 0:_.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===o}).map(v=>v.callback(p,n)):(a=this.bindings[o])===null||a===void 0||a.filter(v=>{var x,_,S,w,k,y,b,O;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in v){const R=v.id,C=(x=v.filter)===null||x===void 0?void 0:x.event;return R&&((_=r.ids)===null||_===void 0?void 0:_.includes(R))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((S=r.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))&&(!(!((w=v.filter)===null||w===void 0)&&w.table)||v.filter.table===((k=r.data)===null||k===void 0?void 0:k.table))}else{const R=(b=(y=v==null?void 0:v.filter)===null||y===void 0?void 0:y.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return R==="*"||R===((O=r==null?void 0:r.event)===null||O===void 0?void 0:O.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===o}).map(v=>{if(typeof p=="object"&&"ids"in p){const x=p.data,{schema:_,table:S,commit_timestamp:w,type:k,errors:y}=x;p=Object.assign(Object.assign({},{schema:_,table:S,commit_timestamp:w,eventType:k,new:{},old:{},errors:y}),this._getPayloadRecords(x))}v.callback(p,n)})}_isClosed(){return this.state===jt.closed}_isJoined(){return this.state===jt.joined}_isJoining(){return this.state===jt.joining}_isLeaving(){return this.state===jt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),a={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(a):this.bindings[i]=[a],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var a;return!(((a=i.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&Ms.isEqual(i.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Fn.close,{},t)}_onError(t){this._on(Fn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=jt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=X1(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=X1(t.columns,t.old_record)),r}}const Rf=()=>{},Hc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},ZS=[1e3,2e3,5e3,1e4],KS=1e4,qS=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class XS{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Yh,this.transport=null,this.heartbeatIntervalMs=Hc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Rf,this.ref=0,this.reconnectTimer=null,this.vsn=q1,this.logger=Rf,this.conn=null,this.sendBuffer=[],this.serializer=new US,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=i=>i?(...a)=>i(...a):(...a)=>fetch(...a),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Jh.websocket}`,this.httpEndpoint=Hx(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=IS.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Ui.connecting:return Ta.Connecting;case Ui.open:return Ta.Open;case Ui.closing:return Ta.Closing;default:return Ta.Closed}}isConnected(){return this.connectionState()===Ta.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(a=>a.topic===n);if(i)return i;{const a=new Ms(`realtime:${t}`,r,this);return this.channels.push(a),a}}push(t){const{topic:r,event:n,payload:i,ref:a}=t,o=()=>{this.encode(t,l=>{var u;(u=this.conn)===null||u===void 0||u.send(l)})};this.log("push",`${r} ${n} (${a})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(BS,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Hc.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const f=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",f)}catch(d){this.log("error","error in heartbeat callback",d)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:i,payload:a,ref:o}=r,l=o?`(${o})`:"",u=a.status||"";this.log("receive",`${u} ${n} ${i} ${l}`.trim(),a),this.channels.filter(f=>f._isMember(n)).forEach(f=>f._trigger(i,a,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===Ui.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Ui.open||this.conn.readyState===Ui.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Fn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([qS],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(i){this.log("error","Error fetching access token from callback",i),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(i=>{const a={access_token:r,version:DS};r&&i.updateJoinPayload(a),i.joinedOnce&&i._isJoined()&&i._push(Fn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new $x(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Hc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,i,a,o,l,u,f,d,m,p,v;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:Yh,this.heartbeatIntervalMs=(i=t==null?void 0:t.heartbeatIntervalMs)!==null&&i!==void 0?i:Hc.HEARTBEAT_INTERVAL,this.worker=(a=t==null?void 0:t.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:Rf,this.vsn=(u=t==null?void 0:t.vsn)!==null&&u!==void 0?u:q1,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(f=t==null?void 0:t.reconnectAfterMs)!==null&&f!==void 0?f:x=>ZS[x-1]||KS,this.vsn){case zx:this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(x,_)=>_(JSON.stringify(x)),this.decode=(m=t==null?void 0:t.decode)!==null&&m!==void 0?m:(x,_)=>_(JSON.parse(x));break;case MS:this.encode=(p=t==null?void 0:t.encode)!==null&&p!==void 0?p:this.serializer.encode.bind(this.serializer),this.decode=(v=t==null?void 0:t.decode)!==null&&v!==void 0?v:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var Fl=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function YS(e,t,r){const n=new URL(t,e);if(r)for(const[i,a]of Object.entries(r))a!==void 0&&n.searchParams.set(i,a);return n.toString()}async function JS(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function QS(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:i,body:a,headers:o}){const l=YS(e.baseUrl,n,i),u=await JS(e.auth),f=await t(l,{method:r,headers:{...a?{"Content-Type":"application/json"}:{},...u,...o},body:a?JSON.stringify(a):void 0}),d=await f.text(),m=(f.headers.get("content-type")||"").includes("application/json"),p=m&&d?JSON.parse(d):d;if(!f.ok){const v=m?p:void 0,x=v==null?void 0:v.error;throw new Fl((x==null?void 0:x.message)??`Request failed with status ${f.status}`,{status:f.status,icebergType:x==null?void 0:x.type,icebergCode:x==null?void 0:x.code,details:v})}return{status:f.status,headers:f.headers,data:p}}}}function Vc(e){return e.join("")}var eT=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:Vc(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Vc(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Vc(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Vc(e.namespace)}`}),!0}catch(t){if(t instanceof Fl&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof Fl&&r.status===409)return;throw r}}};function ds(e){return e.join("")}var tT=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ds(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ds(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ds(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ds(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ds(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ds(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof Fl&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof Fl&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},rT=class{constructor(e){var n;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=QS({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(n=e.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new eT(this.client,t),this.tableOps=new tT(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},_0=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function xt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var nT=class extends _0{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},ed=class extends _0{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const vp=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),iT=()=>Response,td=e=>{if(Array.isArray(e))return e.map(r=>td(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[i]=td(n)}),t},aT=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},sT=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function Ll(e){"@babel/helpers - typeof";return Ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ll(e)}function oT(e,t){if(Ll(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ll(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lT(e){var t=oT(e,"string");return Ll(t)=="symbol"?t:t+""}function cT(e,t,r){return(t=lT(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ne(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Q1(Object(r),!0).forEach(function(n){cT(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const Ff=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},uT=async(e,t,r)=>{e instanceof await iT()&&!(r!=null&&r.noResolveJson)?e.json().then(n=>{const i=e.status||500,a=(n==null?void 0:n.statusCode)||i+"";t(new nT(Ff(n),i,a))}).catch(n=>{t(new ed(Ff(n),n))}):t(new ed(Ff(e),e))},fT=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?i:(aT(n)?(i.headers=Ne({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,t!=null&&t.duplex&&(i.duplex=t.duplex),Ne(Ne({},i),r))};async function Jl(e,t,r,n,i,a){return new Promise((o,l)=>{e(r,fT(t,n,i,a)).then(u=>{if(!u.ok)throw u;return n!=null&&n.noResolveJson?u:u.json()}).then(u=>o(u)).catch(u=>uT(u,l,n))})}async function Il(e,t,r,n){return Jl(e,"GET",t,r,n)}async function On(e,t,r,n,i){return Jl(e,"POST",t,n,i,r)}async function rd(e,t,r,n,i){return Jl(e,"PUT",t,n,i,r)}async function hT(e,t,r,n){return Jl(e,"HEAD",t,Ne(Ne({},r),{},{noResolveJson:!0}),n)}async function _p(e,t,r,n,i){return Jl(e,"DELETE",t,n,i,r)}var dT=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(xt(t))return{data:null,error:t};throw t}}};let Vx;Vx=Symbol.toStringTag;var pT=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[Vx]="BlobDownloadBuilder",this.promise=null}asStream(){return new dT(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(xt(t))return{data:null,error:t};throw t}}};const mT={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},eg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var gT=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=vp(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,n){var i=this;try{let a;const o=Ne(Ne({},eg),n);let l=Ne(Ne({},i.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const u=o.metadata;typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),u&&a.append("metadata",i.encodeMetadata(u)),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.has("cacheControl")||a.append("cacheControl",o.cacheControl),u&&!a.has("metadata")&&a.append("metadata",i.encodeMetadata(u))):(a=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,u&&(l["x-metadata"]=i.toBase64(i.encodeMetadata(u))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!o.duplex&&(o.duplex="half")),n!=null&&n.headers&&(l=Ne(Ne({},l),n.headers));const f=i._removeEmptyFolders(t),d=i._getFinalPath(f),m=await(e=="PUT"?rd:On)(i.fetch,`${i.url}/object/${d}`,a,Ne({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:f,id:m.Id,fullPath:m.Key},error:null}}catch(a){if(i.shouldThrowOnError)throw a;if(xt(a))return{data:null,error:a};throw a}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var i=this;const a=i._removeEmptyFolders(e),o=i._getFinalPath(a),l=new URL(i.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let u;const f=Ne({upsert:eg.upsert},n),d=Ne(Ne({},i.headers),{"x-upsert":String(f.upsert)});return typeof Blob<"u"&&r instanceof Blob?(u=new FormData,u.append("cacheControl",f.cacheControl),u.append("",r)):typeof FormData<"u"&&r instanceof FormData?(u=r,u.append("cacheControl",f.cacheControl)):(u=r,d["cache-control"]=`max-age=${f.cacheControl}`,d["content-type"]=f.contentType),{data:{path:a,fullPath:(await rd(i.fetch,l.toString(),u,{headers:d})).Key},error:null}}catch(u){if(i.shouldThrowOnError)throw u;if(xt(u))return{data:null,error:u};throw u}}async createSignedUploadUrl(e,t){var r=this;try{let n=r._getFinalPath(e);const i=Ne({},r.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const a=await On(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:i}),o=new URL(r.url+a.url),l=o.searchParams.get("token");if(!l)throw new _0("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(xt(n))return{data:null,error:n};throw n}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;try{return{data:await On(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers}),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(xt(i))return{data:null,error:i};throw i}}async copy(e,t,r){var n=this;try{return{data:{path:(await On(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers})).Key},error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(xt(i))return{data:null,error:i};throw i}}async createSignedUrl(e,t,r){var n=this;try{let i=n._getFinalPath(e),a=await On(n.fetch,`${n.url}/object/sign/${i}`,Ne({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:n.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return a={signedUrl:encodeURI(`${n.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(xt(i))return{data:null,error:i};throw i}}async createSignedUrls(e,t,r){var n=this;try{const i=await On(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(o=>Ne(Ne({},o),{},{signedUrl:o.signedURL?encodeURI(`${n.url}${o.signedURL}${a}`):null})),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(xt(i))return{data:null,error:i};throw i}}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),i=n?`?${n}`:"",a=this._getFinalPath(e),o=()=>Il(this.fetch,`${this.url}/${r}/${a}${i}`,{headers:this.headers,noResolveJson:!0});return new pT(o,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:td(await Il(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(xt(n))return{data:null,error:n};throw n}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await hT(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(xt(n)&&n instanceof ed){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&n.push(i);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",o=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});o!==""&&n.push(o);let l=n.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${l}`)}}}async remove(e){var t=this;try{return{data:await _p(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(xt(r))return{data:null,error:r};throw r}}async list(e,t,r){var n=this;try{const i=Ne(Ne(Ne({},mT),t),{},{prefix:e||""});return{data:await On(n.fetch,`${n.url}/object/list/${n.bucketId}`,i,{headers:n.headers},r),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(xt(i))return{data:null,error:i};throw i}}async listV2(e,t){var r=this;try{const n=Ne({},e);return{data:await On(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(xt(n))return{data:null,error:n};throw n}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const Gx="2.90.1",Zx={"X-Client-Info":`storage-js/${Gx}`};var vT=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1;const i=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Ne(Ne({},Zx),t),this.fetch=vp(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await Il(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(xt(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Il(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(xt(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await On(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(xt(n))return{data:null,error:n};throw n}}async updateBucket(e,t){var r=this;try{return{data:await rd(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(xt(n))return{data:null,error:n};throw n}}async emptyBucket(e){var t=this;try{return{data:await On(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(xt(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await _p(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(xt(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},_T=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ne(Ne({},Zx),t),this.fetch=vp(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await On(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(xt(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const n=r.toString(),i=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return{data:await Il(t.fetch,i,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(xt(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await _p(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(xt(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!sT(e))throw new _0("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new rT({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(i,a){const o=i[a];return typeof o!="function"?o:async(...l)=>{try{return{data:await o.apply(i,l),error:null}}catch(u){if(n)throw u;return{data:null,error:u}}}}})}};const xp={"X-Client-Info":`storage-js/${Gx}`,"Content-Type":"application/json"};var Kx=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Zr(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var Lf=class extends Kx{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},xT=class extends Kx{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const yp=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),yT=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},tg=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),wT=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const n=e.status||500,i=e;if(typeof i.json=="function")i.json().then(a=>{const o=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||n+"";t(new Lf(tg(a),n,o))}).catch(()=>{const a=n+"";t(new Lf(i.statusText||`HTTP ${n} error`,n,a))});else{const a=n+"";t(new Lf(i.statusText||`HTTP ${n} error`,n,a))}}else t(new xT(tg(e),e))},kT=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return n?(yT(n)?(i.headers=Ne({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,Ne(Ne({},i),r)):i};async function ET(e,t,r,n,i,a){return new Promise((o,l)=>{e(r,kT(t,n,i,a)).then(u=>{if(!u.ok)throw u;if(n!=null&&n.noResolveJson)return u;const f=u.headers.get("content-type");return!f||!f.includes("application/json")?{}:u.json()}).then(u=>o(u)).catch(u=>wT(u,l,n))})}async function Kr(e,t,r,n,i){return ET(e,"POST",t,n,i,r)}var ST=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ne(Ne({},xp),t),this.fetch=yp(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await Kr(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Zr(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await Kr(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Zr(n))return{data:null,error:n};throw n}}async listIndexes(e){var t=this;try{return{data:await Kr(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Zr(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await Kr(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Zr(n))return{data:null,error:n};throw n}}},TT=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ne(Ne({},xp),t),this.fetch=yp(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Kr(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Zr(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await Kr(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Zr(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await Kr(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Zr(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await Kr(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Zr(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Kr(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Zr(r))return{data:null,error:r};throw r}}},CT=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ne(Ne({},xp),t),this.fetch=yp(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Kr(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Zr(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Kr(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Zr(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await Kr(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Zr(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Kr(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Zr(r))return{data:null,error:r};throw r}}},bT=class extends CT{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new AT(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},AT=class extends ST{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,Ne(Ne({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,Ne(Ne({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new PT(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},PT=class extends TT{constructor(e,t,r,n,i){super(e,t,i),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,Ne(Ne({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,Ne(Ne({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,Ne(Ne({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,Ne(Ne({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,Ne(Ne({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},OT=class extends vT{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new gT(this.url,this.headers,e,this.fetch)}get vectors(){return new bT(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new _T(this.url+"/iceberg",this.headers,this.fetch)}};const qx="2.90.1",ks=30*1e3,nd=3,If=nd*ks,RT="http://localhost:9999",FT="supabase.auth.token",LT={"X-Client-Info":`gotrue-js/${qx}`},id="X-Supabase-Api-Version",Xx={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},IT=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,NT=10*60*1e3;class Nl extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Le(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class DT extends Nl{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function MT(e){return Le(e)&&e.name==="AuthApiError"}class Ca extends Nl{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Ai extends Nl{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class Hr extends Ai{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function BT(e){return Le(e)&&e.name==="AuthSessionMissingError"}class ps extends Ai{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Gc extends Ai{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Zc extends Ai{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function jT(e){return Le(e)&&e.name==="AuthImplicitGrantRedirectError"}class rg extends Ai{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class UT extends Ai{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class ad extends Ai{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Nf(e){return Le(e)&&e.name==="AuthRetryableFetchError"}class ng extends Ai{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class sd extends Ai{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const zu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ig=` 	
\r=`.split(""),zT=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<ig.length;t+=1)e[ig[t].charCodeAt(0)]=-2;for(let t=0;t<zu.length;t+=1)e[zu[t].charCodeAt(0)]=t;return e})();function ag(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(zu[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(zu[n]),t.queuedBits-=6}}function Yx(e,t,r){const n=zT[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function sg(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},a=o=>{HT(o,n,r)};for(let o=0;o<e.length;o+=1)Yx(e.charCodeAt(o),i,a);return t.join("")}function $T(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function WT(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}$T(n,t)}}function HT(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Gs(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)Yx(e.charCodeAt(i),r,n);return new Uint8Array(t)}function VT(e){const t=[];return WT(e,r=>t.push(r)),new Uint8Array(t)}function Ra(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>ag(i,r,n)),ag(null,r,n),t.join("")}function GT(e){return Math.round(Date.now()/1e3)+e}function ZT(){return Symbol("auth-callback")}const rr=()=>typeof window<"u"&&typeof document<"u",ya={tested:!1,writable:!1},Jx=()=>{if(!rr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ya.tested)return ya.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),ya.tested=!0,ya.writable=!0}catch{ya.tested=!0,ya.writable=!1}return ya.writable};function KT(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,a)=>{t[a]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const Qx=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),qT=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Es=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},wa=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},tr=async(e,t)=>{await e.removeItem(t)};class x0{constructor(){this.promise=new x0.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}x0.promiseConstructor=Promise;function Df(e){const t=e.split(".");if(t.length!==3)throw new sd("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!IT.test(t[n]))throw new sd("JWT not in base64url format");return{header:JSON.parse(sg(t[0])),payload:JSON.parse(sg(t[1])),signature:Gs(t[2]),raw:{header:t[0],payload:t[1]}}}async function XT(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function YT(e,t){return new Promise((n,i)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await e(a);if(!t(a,null,o)){n(o);return}}catch(o){if(!t(a,o)){i(o);return}}})()})}function JT(e){return("0"+e.toString(16)).substr(-2)}function QT(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let a=0;a<56;a++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,JT).join("")}async function e4(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(a=>String.fromCharCode(a)).join("")}async function t4(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await e4(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ms(e,t,r=!1){const n=QT();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await Es(e,`${t}-code-verifier`,i);const a=await t4(n);return[a,n===a?"plain":"s256"]}const r4=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function n4(e){const t=e.headers.get(id);if(!t||!t.match(r4))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function i4(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function a4(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const s4=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function gs(e){if(!s4.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Mf(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function o4(e,t){return new Proxy(e,{get:(r,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const a=n.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,i)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,i)}})}function og(e){return JSON.parse(JSON.stringify(e))}const Sa=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),l4=[502,503,504];async function lg(e){var t;if(!qT(e))throw new ad(Sa(e),0);if(l4.includes(e.status))throw new ad(Sa(e),e.status);let r;try{r=await e.json()}catch(a){throw new Ca(Sa(a),a)}let n;const i=n4(e);if(i&&i.getTime()>=Xx["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new ng(Sa(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Hr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new ng(Sa(r),e.status,r.weak_password.reasons);throw new DT(Sa(r),e.status||500,n)}const c4=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function Ie(e,t,r,n){var i;const a=Object.assign({},n==null?void 0:n.headers);a[id]||(a[id]=Xx["2024-01-01"].name),n!=null&&n.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const o=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",u=await u4(e,t,r+l,{headers:a,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(u):{data:Object.assign({},u),error:null}}async function u4(e,t,r,n,i,a){const o=c4(t,n,i,a);let l;try{l=await e(r,Object.assign({},o))}catch(u){throw console.error(u),new ad(Sa(u),0)}if(l.ok||await lg(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(u){await lg(u)}}function An(e){var t;let r=null;d4(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=GT(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function cg(e){const t=An(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Wi(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function f4(e){return{data:e,error:null}}function h4(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:a}=e,o=v0(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:a},u=Object.assign({},o);return{data:{properties:l,user:u},error:null}}function ug(e){return e}function d4(e){return e.access_token&&e.refresh_token&&e.expires_in}const Bf=["global","local","others"];class p4{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=Qx(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Bf[0]){if(Bf.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Bf.join(", ")}`);try{return await Ie(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Le(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Ie(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Wi})}catch(n){if(Le(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=v0(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await Ie(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:h4,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Le(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ie(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Wi})}catch(r){if(Le(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,a,o,l,u;try{const f={nextPage:null,lastPage:0,total:0},d=await Ie(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:ug});if(d.error)throw d.error;const m=await d.json(),p=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,v=(u=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&u!==void 0?u:[];return v.length>0&&(v.forEach(x=>{const _=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(x.split(";")[1].split("=")[1]);f[`${S}Page`]=_}),f.total=parseInt(p)),{data:Object.assign(Object.assign({},m),f),error:null}}catch(f){if(Le(f))return{data:{users:[]},error:f};throw f}}async getUserById(t){gs(t);try{return await Ie(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Wi})}catch(r){if(Le(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){gs(t);try{return await Ie(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Wi})}catch(n){if(Le(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){gs(t);try{return await Ie(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Wi})}catch(n){if(Le(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){gs(t.userId);try{const{data:r,error:n}=await Ie(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _deleteFactor(t){gs(t.userId),gs(t.id);try{return{data:await Ie(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,i,a,o,l,u;try{const f={nextPage:null,lastPage:0,total:0},d=await Ie(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:ug});if(d.error)throw d.error;const m=await d.json(),p=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,v=(u=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&u!==void 0?u:[];return v.length>0&&(v.forEach(x=>{const _=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(x.split(";")[1].split("=")[1]);f[`${S}Page`]=_}),f.total=parseInt(p)),{data:Object.assign(Object.assign({},m),f),error:null}}catch(f){if(Le(f))return{data:{clients:[]},error:f};throw f}}async _createOAuthClient(t){try{return await Ie(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Ie(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Ie(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Le(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Ie(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Le(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Ie(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Le(r))return{data:null,error:r};throw r}}}function fg(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const vs={debug:!!(globalThis&&Jx()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ey extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class m4 extends ey{}async function g4(e,t,r){vs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),vs.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){vs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{vs.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw vs.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new m4(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(vs.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function v4(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function ty(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function _4(e){return parseInt(e,16)}function x4(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function y4(e){var t;const{chainId:r,domain:n,expirationTime:i,issuedAt:a=new Date,nonce:o,notBefore:l,requestId:u,resources:f,scheme:d,uri:m,version:p}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!m)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(p!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${p}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const v=ty(e.address),x=d?`${d}://${n}`:n,_=e.statement?`${e.statement}
`:"",S=`${x} wants you to sign in with your Ethereum account:
${v}

${_}`;let w=`URI: ${m}
Version: ${p}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${a.toISOString()}`;if(i&&(w+=`
Expiration Time: ${i.toISOString()}`),l&&(w+=`
Not Before: ${l.toISOString()}`),u&&(w+=`
Request ID: ${u}`),f){let k=`
Resources:`;for(const y of f){if(!y||typeof y!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${y}`);k+=`
- ${y}`}w+=k}return`${S}
${w}`}class Mt extends Error{constructor({message:t,code:r,cause:n,name:i}){var a;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(a=i??(n instanceof Error?n.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=r}}class $u extends Mt{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function w4({error:e,options:t}){var r,n,i;const{publicKey:a}=t;if(!a)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Mt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=a.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Mt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Mt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((i=a.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Mt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Mt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Mt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return a.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Mt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Mt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const o=window.location.hostname;if(ry(o)){if(a.rp.id!==o)return new Mt({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Mt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new Mt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Mt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Mt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function k4({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Mt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Mt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(ry(n)){if(r.rpId!==n)return new Mt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Mt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Mt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Mt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class E4{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const S4=new E4;function T4(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,i=v0(e,["challenge","user","excludeCredentials"]),a=Gs(t).buffer,o=Object.assign(Object.assign({},r),{id:Gs(r.id).buffer}),l=Object.assign(Object.assign({},i),{challenge:a,user:o});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let u=0;u<n.length;u++){const f=n[u];l.excludeCredentials[u]=Object.assign(Object.assign({},f),{id:Gs(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return l}function C4(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=v0(e,["challenge","allowCredentials"]),i=Gs(t).buffer,a=Object.assign(Object.assign({},n),{challenge:i});if(r&&r.length>0){a.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const l=r[o];a.allowCredentials[o]=Object.assign(Object.assign({},l),{id:Gs(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return a}function b4(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Ra(new Uint8Array(e.response.attestationObject)),clientDataJSON:Ra(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function A4(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),i=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Ra(new Uint8Array(i.authenticatorData)),clientDataJSON:Ra(new Uint8Array(i.clientDataJSON)),signature:Ra(new Uint8Array(i.signature)),userHandle:i.userHandle?Ra(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function ry(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function hg(){var e,t;return!!(rr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function P4(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new $u("Browser returned unexpected credential type",t)}:{data:null,error:new $u("Empty credential response",t)}}catch(t){return{data:null,error:w4({error:t,options:e})}}}async function O4(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new $u("Browser returned unexpected credential type",t)}:{data:null,error:new $u("Empty credential response",t)}}catch(t){return{data:null,error:k4({error:t,options:e})}}}const R4={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},F4={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Wu(...e){const t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of e)if(i)for(const a in i){const o=i[a];if(o!==void 0)if(Array.isArray(o))n[a]=o;else if(r(o))n[a]=o;else if(t(o)){const l=n[a];t(l)?n[a]=Wu(l,o):n[a]=Wu(o)}else n[a]=o}return n}function L4(e,t){return Wu(R4,e,t||{})}function I4(e,t){return Wu(F4,e,t||{})}class N4{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:i},a){try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!o)return{data:null,error:l};const u=i??S4.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:f}=o.webauthn.credential_options.publicKey;f.name||(f.name=`${f.id}:${n}`),f.displayName||(f.displayName=f.name)}switch(o.webauthn.type){case"create":{const f=L4(o.webauthn.credential_options.publicKey,a==null?void 0:a.create),{data:d,error:m}=await P4({publicKey:f,signal:u});return d?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:m}}case"request":{const f=I4(o.webauthn.credential_options.publicKey,a==null?void 0:a.request),{data:d,error:m}=await O4(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:f,signal:u}));return d?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:m}}}}catch(o){return Le(o)?{data:null,error:o}:{data:null,error:new Ca("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},a){if(!r)return{data:null,error:new Nl("rpId is required for WebAuthn authentication")};try{if(!hg())return{data:null,error:new Ca("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:i},{request:a});if(!o)return{data:null,error:l};const{webauthn:u}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:u.type,rpId:r,rpOrigins:n,credential_response:u.credential_response}})}catch(o){return Le(o)?{data:null,error:o}:{data:null,error:new Ca("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},a){if(!r)return{data:null,error:new Nl("rpId is required for WebAuthn registration")};try{if(!hg())return{data:null,error:new Ca("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(d=>{var m;return(m=d.data)===null||m===void 0?void 0:m.all.find(p=>p.factor_type==="webauthn"&&p.friendly_name===t&&p.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:l};const{data:u,error:f}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:i},{create:a});return u?this._verify({factorId:o.id,challengeId:u.challengeId,webauthn:{rpId:r,rpOrigins:n,type:u.webauthn.type,credential_response:u.webauthn.credential_response}}):{data:null,error:f}}catch(o){return Le(o)?{data:null,error:o}:{data:null,error:new Ca("Unexpected error in register",o)}}}}v4();const D4={url:RT,storageKey:FT,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:LT,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function dg(e,t,r){return await r()}const _s={};class Dl{get jwks(){var t,r;return(r=(t=_s[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){_s[this.storageKey]=Object.assign(Object.assign({},_s[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=_s[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){_s[this.storageKey]=Object.assign(Object.assign({},_s[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},D4),t);if(this.storageKey=a.storageKey,this.instanceID=(r=Dl.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Dl.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&rr()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new p4({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Qx(a.fetch),this.lock=a.lock||dg,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,this.lockAcquireTimeout=a.lockAcquireTimeout,a.lock?this.lock=a.lock:this.persistSession&&rr()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=g4:this.lock=dg,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new N4(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:Jx()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=fg(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=fg(this.memoryStorage)),rr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${qx}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(rr()&&(r=KT(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),rr()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:a}=await this._getSessionFromURL(r,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),jT(a)){const u=(t=a.details)===null||t===void 0?void 0:t.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:a}}return{error:a}}const{session:o,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Le(r)?this._returnResult({error:r}):this._returnResult({error:new Ca("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const a=await Ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:An}),{data:o,error:l}=a;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const u=o.session,f=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",u)),this._returnResult({data:{user:f,session:u},error:null})}catch(a){if(Le(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(t){var r,n,i;try{let a;if("email"in t){const{email:d,password:m,options:p}=t;let v=null,x=null;this.flowType==="pkce"&&([v,x]=await ms(this.storage,this.storageKey)),a=await Ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:d,password:m,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:v,code_challenge_method:x},xform:An})}else if("phone"in t){const{phone:d,password:m,options:p}=t;a=await Ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:m,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},channel:(i=p==null?void 0:p.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:An})}else throw new Gc("You must provide either an email or phone number and a password");const{data:o,error:l}=a;if(l||!o)return await tr(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const u=o.session,f=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",u)),this._returnResult({data:{user:f,session:u},error:null})}catch(a){if(await tr(this.storage,`${this.storageKey}-code-verifier`),Le(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(t){try{let r;if("email"in t){const{email:a,password:o,options:l}=t;r=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:cg})}else if("phone"in t){const{phone:a,password:o,options:l}=t;r=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:cg})}else throw new Gc("You must provide either an email or phone number and a password");const{data:n,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const a=new ps;return this._returnResult({data:{user:null,session:null},error:a})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(Le(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,i,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,i,a,o,l,u,f,d,m,p;let v,x;if("message"in t)v=t.message,x=t.signature;else{const{chain:_,wallet:S,statement:w,options:k}=t;let y;if(rr())if(typeof S=="object")y=S;else{const M=window;if("ethereum"in M&&typeof M.ethereum=="object"&&"request"in M.ethereum&&typeof M.ethereum.request=="function")y=M.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!(k!=null&&k.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=S}const b=new URL((r=k==null?void 0:k.url)!==null&&r!==void 0?r:window.location.href),O=await y.request({method:"eth_requestAccounts"}).then(M=>M).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!O||O.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const R=ty(O[0]);let C=(n=k==null?void 0:k.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!C){const M=await y.request({method:"eth_chainId"});C=_4(M)}const z={domain:b.host,address:R,statement:w,uri:b.href,version:"1",chainId:C,nonce:(i=k==null?void 0:k.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(o=(a=k==null?void 0:k.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=k==null?void 0:k.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(u=k==null?void 0:k.signInWithEthereum)===null||u===void 0?void 0:u.notBefore,requestId:(f=k==null?void 0:k.signInWithEthereum)===null||f===void 0?void 0:f.requestId,resources:(d=k==null?void 0:k.signInWithEthereum)===null||d===void 0?void 0:d.resources};v=y4(z),x=await y.request({method:"personal_sign",params:[x4(v),R]})}try{const{data:_,error:S}=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:v,signature:x},!((m=t.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:An});if(S)throw S;if(!_||!_.session||!_.user){const w=new ps;return this._returnResult({data:{user:null,session:null},error:w})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:S})}catch(_){if(Le(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signInWithSolana(t){var r,n,i,a,o,l,u,f,d,m,p,v;let x,_;if("message"in t)x=t.message,_=t.signature;else{const{chain:S,wallet:w,statement:k,options:y}=t;let b;if(rr())if(typeof w=="object")b=w;else{const R=window;if("solana"in R&&typeof R.solana=="object"&&("signIn"in R.solana&&typeof R.solana.signIn=="function"||"signMessage"in R.solana&&typeof R.solana.signMessage=="function"))b=R.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=w}const O=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in b&&b.signIn){const R=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y==null?void 0:y.signInWithSolana),{version:"1",domain:O.host,uri:O.href}),k?{statement:k}:null));let C;if(Array.isArray(R)&&R[0]&&typeof R[0]=="object")C=R[0];else if(R&&typeof R=="object"&&"signedMessage"in R&&"signature"in R)C=R;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)x=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),_=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in b)||typeof b.signMessage!="function"||!("publicKey"in b)||typeof b!="object"||!b.publicKey||!("toBase58"in b.publicKey)||typeof b.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${O.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...k?["",k,""]:[""],"Version: 1",`URI: ${O.href}`,`Issued At: ${(i=(n=y==null?void 0:y.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((a=y==null?void 0:y.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((o=y==null?void 0:y.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((l=y==null?void 0:y.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((u=y==null?void 0:y.signInWithSolana)===null||u===void 0)&&u.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((f=y==null?void 0:y.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((m=(d=y==null?void 0:y.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||m===void 0)&&m.length?["Resources",...y.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const R=await b.signMessage(new TextEncoder().encode(x),"utf8");if(!R||!(R instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=R}}try{const{data:S,error:w}=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:Ra(_)},!((p=t.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(v=t.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:An});if(w)throw w;if(!S||!S.session||!S.user){const k=new ps;return this._returnResult({data:{user:null,session:null},error:k})}return S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),this._returnResult({data:Object.assign({},S),error:w})}catch(S){if(Le(S))return this._returnResult({data:{user:null,session:null},error:S});throw S}}async _exchangeCodeForSession(t){const r=await wa(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new UT;const{data:a,error:o}=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:An});if(await tr(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!a||!a.session||!a.user){const l=new ps;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:i??null}),error:o})}catch(a){if(await tr(this.storage,`${this.storageKey}-code-verifier`),Le(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:a,nonce:o}=t,l=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:An}),{data:u,error:f}=l;if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!u||!u.session||!u.user){const d=new ps;return this._returnResult({data:{user:null,session:null},error:d})}return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),this._returnResult({data:u,error:f})}catch(r){if(Le(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,i,a,o;try{if("email"in t){const{email:l,options:u}=t;let f=null,d=null;this.flowType==="pkce"&&([f,d]=await ms(this.storage,this.storageKey));const{error:m}=await Ie(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=u==null?void 0:u.data)!==null&&r!==void 0?r:{},create_user:(n=u==null?void 0:u.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:f,code_challenge_method:d},redirectTo:u==null?void 0:u.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:m})}if("phone"in t){const{phone:l,options:u}=t,{data:f,error:d}=await Ie(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=u==null?void 0:u.data)!==null&&i!==void 0?i:{},create_user:(a=u==null?void 0:u.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(o=u==null?void 0:u.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:d})}throw new Gc("You must provide either an email or phone number.")}catch(l){if(await tr(this.storage,`${this.storageKey}-code-verifier`),Le(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(t){var r,n;try{let i,a;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,a=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=await Ie(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:i,xform:An});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const u=o.session,f=o.user;return u!=null&&u.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),this._returnResult({data:{user:f,session:u},error:null})}catch(i){if(Le(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(t){var r,n,i,a,o;try{let l=null,u=null;this.flowType==="pkce"&&([l,u]=await ms(this.storage,this.storageKey));const f=await Ie(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:u}),headers:this.headers,xform:f4});return!((a=f.data)===null||a===void 0)&&a.url&&rr()&&!(!((o=t.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(f.data.url),this._returnResult(f)}catch(l){if(await tr(this.storage,`${this.storageKey}-code-verifier`),Le(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Hr;const{error:i}=await Ie(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(t){if(Le(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:a}=t,{error:o}=await Ie(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in t){const{phone:n,type:i,options:a}=t,{data:o,error:l}=await Ie(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l})}throw new Gc("You must provide either an email or phone number and a type")}catch(r){if(Le(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await wa(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<If:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const o=await wa(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=Mf()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};t.user=o4(t.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:i,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await Ie(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Wi}):await this._useSession(async r=>{var n,i,a;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Hr}:await Ie(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:void 0,xform:Wi})})}catch(r){if(Le(r))return BT(r)&&(await this._removeSession(),await tr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:a}=n;if(a)throw a;if(!i.session)throw new Hr;const o=i.session;let l=null,u=null;this.flowType==="pkce"&&t.email!=null&&([l,u]=await ms(this.storage,this.storageKey));const{data:f,error:d}=await Ie(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:u}),jwt:o.access_token,xform:Wi});if(d)throw d;return o.user=f.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(n){if(await tr(this.storage,`${this.storageKey}-code-verifier`),Le(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Hr;const r=Date.now()/1e3;let n=r,i=!0,a=null;const{payload:o}=Df(t.access_token);if(o.exp&&(n=o.exp,i=n<=r),i){const{data:l,error:u}=await this._callRefreshToken(t.refresh_token);if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:u}=await this._getUser(t.access_token);if(u)throw u;a={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(r){if(Le(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:o,error:l}=r;if(l)throw l;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Hr;const{data:i,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Le(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!rr())throw new Zc("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Zc(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new rg("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Zc("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new rg("No code detected.");const{data:k,error:y}=await this._exchangeCodeForSession(t.code);if(y)throw y;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:k.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:a,refresh_token:o,expires_in:l,expires_at:u,token_type:f}=t;if(!a||!l||!o||!f)throw new Zc("No session defined in URL");const d=Math.round(Date.now()/1e3),m=parseInt(l);let p=d+m;u&&(p=parseInt(u));const v=p-d;v*1e3<=ks&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${m}s`);const x=p-m;d-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,p,d):d-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,p,d);const{data:_,error:S}=await this._getUser(a);if(S)throw S;const w={provider_token:n,provider_refresh_token:i,access_token:a,expires_in:m,expires_at:p,refresh_token:o,token_type:f,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:w,redirectType:t.type},error:null})}catch(n){if(Le(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await wa(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:a}=r;if(a)return this._returnResult({error:a});const o=(n=i.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(MT(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return t!=="others"&&(await this._removeSession(),await tr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=ZT(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:a},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await ms(this.storage,this.storageKey,!0));try{return await Ie(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(await tr(this.storage,`${this.storageKey}-code-verifier`),Le(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:i}=await this._useSession(async a=>{var o,l,u,f,d;const{data:m,error:p}=a;if(p)throw p;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(u=t.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await Ie(this.fetch,"GET",v,{headers:this.headers,jwt:(d=(f=m.session)===null||f===void 0?void 0:f.access_token)!==null&&d!==void 0?d:void 0})});if(i)throw i;return rr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(Le(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:i,data:{session:a}}=r;if(i)throw i;const{options:o,provider:l,token:u,access_token:f,nonce:d}=t,m=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=a==null?void 0:a.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:u,access_token:f,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:An}),{data:p,error:v}=m;return v?this._returnResult({data:{user:null,session:null},error:v}):!p||!p.session||!p.user?this._returnResult({data:{user:null,session:null},error:new ps}):(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("USER_UPDATED",p.session)),this._returnResult({data:p,error:v}))}catch(i){if(await tr(this.storage,`${this.storageKey}-code-verifier`),Le(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:a,error:o}=r;if(o)throw o;return await Ie(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await YT(async i=>(i>0&&await XT(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await Ie(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:An})),(i,a)=>{const o=200*Math.pow(2,i);return a&&Nf(a)&&Date.now()+o-n<ks})}catch(n){if(this._debug(r,"error",n),Le(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),rr()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await wa(this.storage,this.storageKey);if(i&&this.userStorage){let o=await wa(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await Es(this.userStorage,this.storageKey+"-user",o)),i.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:Mf()}else if(i&&!i.user&&!i.user){const o=await wa(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(i.user=o.user,await tr(this.storage,this.storageKey+"-user"),await Es(this.storage,this.storageKey,i)):i.user=Mf()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const a=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<If;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${If}s`),a){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),Nf(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(i.access_token);!l&&(o!=null&&o.user)?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Hr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new x0;const{data:a,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!a.session)throw new Hr;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={data:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(i,"error",a),Le(a)){const o={data:null,error:a};return Nf(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(u){a.push(u)}});if(await Promise.all(o),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await tr(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Es(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const a=og(i);await Es(this.storage,this.storageKey,a)}else{const i=og(r);await Es(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await tr(this.storage,this.storageKey),await tr(this.storage,this.storageKey+"-code-verifier"),await tr(this.storage,this.storageKey+"-user"),this.userStorage&&await tr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&rr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),ks);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/ks);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${ks}ms, refresh threshold is ${nd} ticks`),i<=nd&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof ey)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!rr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,o]=await ms(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(l.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);i.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:a}=r;return a?this._returnResult({data:null,error:a}):await Ie(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:a,error:o}=r;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:u,error:f}=await Ie(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return f?this._returnResult({data:null,error:f}):(t.factorType==="totp"&&u.type==="totp"&&(!((i=u==null?void 0:u.totp)===null||i===void 0)&&i.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),this._returnResult({data:u,error:null}))})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:a}=r;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?b4(t.webauthn.credential_response):A4(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:u}=await Ie(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return u?this._returnResult({data:null,error:u}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:u}))})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:a}=r;if(a)return this._returnResult({data:null,error:a});const o=await Ie(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:T4(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:C4(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const a of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])i.all.push(a),a.status==="verified"&&i[a.factor_type].push(a);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Df(n.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const f=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:f},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?await Ie(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Hr})})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!i)return this._returnResult({data:null,error:new Hr});const o=await Ie(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&rr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(n){if(Le(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!i)return this._returnResult({data:null,error:new Hr});const o=await Ie(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&rr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(n){if(Le(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await Ie(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Hr})})}catch(t){if(Le(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?(await Ie(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Hr})})}catch(r){if(Le(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+NT>i)return n;const{data:a,error:o}=await Ie(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=i,n=a.keys.find(l=>l.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:v,error:x}=await this.getSession();if(x||!v.session)return this._returnResult({data:null,error:x});n=v.session.access_token}const{header:i,payload:a,signature:o,raw:{header:l,payload:u}}=Df(n);r!=null&&r.allowExpired||i4(a.exp);const f=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!f){const{error:v}=await this.getUser(n);if(v)throw v;return{data:{claims:a,header:i,signature:o},error:null}}const d=a4(i.alg),m=await crypto.subtle.importKey("jwk",f,d,!0,["verify"]);if(!await crypto.subtle.verify(d,m,o,VT(`${l}.${u}`)))throw new sd("Invalid JWT signature");return{data:{claims:a,header:i,signature:o},error:null}}catch(n){if(Le(n))return this._returnResult({data:null,error:n});throw n}}}Dl.nextInstanceID={};const M4=Dl,B4="2.90.1";let Wo="";typeof Deno<"u"?Wo="deno":typeof document<"u"?Wo="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Wo="react-native":Wo="node";const j4={"X-Client-Info":`supabase-js-${Wo}/${B4}`},U4={headers:j4},z4={schema:"public"},$4={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},W4={};function Ml(e){"@babel/helpers - typeof";return Ml=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ml(e)}function H4(e,t){if(Ml(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ml(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function V4(e){var t=H4(e,"string");return Ml(t)=="symbol"?t:t+""}function G4(e,t,r){return(t=V4(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pg(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function St(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pg(Object(r),!0).forEach(function(n){G4(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pg(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const Z4=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),K4=()=>Headers,q4=(e,t,r)=>{const n=Z4(r),i=K4();return async(a,o)=>{var l;const u=(l=await t())!==null&&l!==void 0?l:e;let f=new i(o==null?void 0:o.headers);return f.has("apikey")||f.set("apikey",e),f.has("Authorization")||f.set("Authorization",`Bearer ${u}`),n(a,St(St({},o),{},{headers:f}))}};function X4(e){return e.endsWith("/")?e:e+"/"}function Y4(e,t){var r,n;const{db:i,auth:a,realtime:o,global:l}=e,{db:u,auth:f,realtime:d,global:m}=t,p={db:St(St({},u),i),auth:St(St({},f),a),realtime:St(St({},d),o),storage:{},global:St(St(St({},m),l),{},{headers:St(St({},(r=m==null?void 0:m.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?p.accessToken=e.accessToken:delete p.accessToken,p}function J4(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(X4(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var Q4=class extends M4{constructor(e){super(e)}},e3=class{constructor(e,t,r){var n,i;this.supabaseUrl=e,this.supabaseKey=t;const a=J4(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const o=`sb-${a.hostname.split(".")[0]}-auth-token`,l={db:z4,realtime:W4,auth:St(St({},$4),{},{storageKey:o}),global:U4},u=Y4(r??{},l);if(this.storageKey=(n=u.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken)this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(d,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}});else{var f;this.auth=this._initSupabaseAuthClient((f=u.auth)!==null&&f!==void 0?f:{},this.headers,u.global.fetch)}this.fetch=q4(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(St({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.accessToken&&this.accessToken().then(d=>this.realtime.setAuth(d)).catch(d=>console.warn("Failed to set initial Realtime auth token:",d)),this.rest=new LS(new URL("rest/v1",a).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new OT(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new AS(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,storageKey:a,flowType:o,lock:l,debug:u,throwOnError:f},d,m){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Q4({url:this.authUrl.href,headers:St(St({},p),d),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,flowType:o,lock:l,debug:u,throwOnError:f,fetch:m,hasCustomAuthorizationHeader:Object.keys(this.headers).some(v=>v.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new XS(this.realtimeUrl.href,St(St({},e),{},{params:St(St({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const t3=(e,t,r)=>new e3(e,t,r);function r3(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}r3()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");var mg,st="colors",Sr="sizes",Re="space",n3={gap:Re,gridGap:Re,columnGap:Re,gridColumnGap:Re,rowGap:Re,gridRowGap:Re,inset:Re,insetBlock:Re,insetBlockEnd:Re,insetBlockStart:Re,insetInline:Re,insetInlineEnd:Re,insetInlineStart:Re,margin:Re,marginTop:Re,marginRight:Re,marginBottom:Re,marginLeft:Re,marginBlock:Re,marginBlockEnd:Re,marginBlockStart:Re,marginInline:Re,marginInlineEnd:Re,marginInlineStart:Re,padding:Re,paddingTop:Re,paddingRight:Re,paddingBottom:Re,paddingLeft:Re,paddingBlock:Re,paddingBlockEnd:Re,paddingBlockStart:Re,paddingInline:Re,paddingInlineEnd:Re,paddingInlineStart:Re,top:Re,right:Re,bottom:Re,left:Re,scrollMargin:Re,scrollMarginTop:Re,scrollMarginRight:Re,scrollMarginBottom:Re,scrollMarginLeft:Re,scrollMarginX:Re,scrollMarginY:Re,scrollMarginBlock:Re,scrollMarginBlockEnd:Re,scrollMarginBlockStart:Re,scrollMarginInline:Re,scrollMarginInlineEnd:Re,scrollMarginInlineStart:Re,scrollPadding:Re,scrollPaddingTop:Re,scrollPaddingRight:Re,scrollPaddingBottom:Re,scrollPaddingLeft:Re,scrollPaddingX:Re,scrollPaddingY:Re,scrollPaddingBlock:Re,scrollPaddingBlockEnd:Re,scrollPaddingBlockStart:Re,scrollPaddingInline:Re,scrollPaddingInlineEnd:Re,scrollPaddingInlineStart:Re,fontSize:"fontSizes",background:st,backgroundColor:st,backgroundImage:st,borderImage:st,border:st,borderBlock:st,borderBlockEnd:st,borderBlockStart:st,borderBottom:st,borderBottomColor:st,borderColor:st,borderInline:st,borderInlineEnd:st,borderInlineStart:st,borderLeft:st,borderLeftColor:st,borderRight:st,borderRightColor:st,borderTop:st,borderTopColor:st,caretColor:st,color:st,columnRuleColor:st,fill:st,outline:st,outlineColor:st,stroke:st,textDecorationColor:st,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:Sr,minBlockSize:Sr,maxBlockSize:Sr,inlineSize:Sr,minInlineSize:Sr,maxInlineSize:Sr,width:Sr,minWidth:Sr,maxWidth:Sr,height:Sr,minHeight:Sr,maxHeight:Sr,flexBasis:Sr,gridTemplateColumns:Sr,gridTemplateRows:Sr,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},i3=(e,t)=>typeof t=="function"?{"()":Function.prototype.toString.call(t)}:t,Ql=()=>{const e=Object.create(null);return(t,r,...n)=>{const i=(a=>JSON.stringify(a,i3))(t);return i in e?e[i]:e[i]=r(t,...n)}},gu=Symbol.for("sxs.internal"),wp=(e,t)=>Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)),gg=e=>{for(const t in e)return!0;return!1},{hasOwnProperty:a3}=Object.prototype,od=e=>e.includes("-")?e:e.replace(/[A-Z]/g,t=>"-"+t.toLowerCase()),s3=/\s+(?![^()]*\))/,xs=e=>t=>e(...typeof t=="string"?String(t).split(s3):[t]),vg={appearance:e=>({WebkitAppearance:e,appearance:e}),backfaceVisibility:e=>({WebkitBackfaceVisibility:e,backfaceVisibility:e}),backdropFilter:e=>({WebkitBackdropFilter:e,backdropFilter:e}),backgroundClip:e=>({WebkitBackgroundClip:e,backgroundClip:e}),boxDecorationBreak:e=>({WebkitBoxDecorationBreak:e,boxDecorationBreak:e}),clipPath:e=>({WebkitClipPath:e,clipPath:e}),content:e=>({content:e.includes('"')||e.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(e)?e:`"${e}"`}),hyphens:e=>({WebkitHyphens:e,hyphens:e}),maskImage:e=>({WebkitMaskImage:e,maskImage:e}),maskSize:e=>({WebkitMaskSize:e,maskSize:e}),tabSize:e=>({MozTabSize:e,tabSize:e}),textSizeAdjust:e=>({WebkitTextSizeAdjust:e,textSizeAdjust:e}),userSelect:e=>({WebkitUserSelect:e,userSelect:e}),marginBlock:xs((e,t)=>({marginBlockStart:e,marginBlockEnd:t||e})),marginInline:xs((e,t)=>({marginInlineStart:e,marginInlineEnd:t||e})),maxSize:xs((e,t)=>({maxBlockSize:e,maxInlineSize:t||e})),minSize:xs((e,t)=>({minBlockSize:e,minInlineSize:t||e})),paddingBlock:xs((e,t)=>({paddingBlockStart:e,paddingBlockEnd:t||e})),paddingInline:xs((e,t)=>({paddingInlineStart:e,paddingInlineEnd:t||e}))},jf=/([\d.]+)([^]*)/,o3=(e,t)=>e.length?e.reduce((r,n)=>(r.push(...t.map(i=>i.includes("&")?i.replace(/&/g,/[ +>|~]/.test(n)&&/&.*&/.test(i)?`:is(${n})`:n):n+" "+i)),r),[]):t,l3=(e,t)=>e in c3&&typeof t=="string"?t.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,(r,n,i,a)=>n+(i==="stretch"?`-moz-available${a};${od(e)}:${n}-webkit-fill-available`:`-moz-fit-content${a};${od(e)}:${n}fit-content`)+a):String(t),c3={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},Ti=e=>e?e+"-":"",ny=(e,t,r)=>e.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,(n,i,a,o,l)=>o=="$"==!!a?n:(i||o=="--"?"calc(":"")+"var(--"+(o==="$"?Ti(t)+(l.includes("$")?"":Ti(r))+l.replace(/\$/g,"-"):l)+")"+(i||o=="--"?"*"+(i||"")+(a||"1")+")":"")),u3=/\s*,\s*(?![^()]*\))/,f3=Object.prototype.toString,Bs=(e,t,r,n,i)=>{let a,o,l;const u=(f,d,m)=>{let p,v;const x=_=>{for(p in _){const k=p.charCodeAt(0)===64,y=k&&Array.isArray(_[p])?_[p]:[_[p]];for(v of y){const b=/[A-Z]/.test(w=p)?w:w.replace(/-[^]/g,R=>R[1].toUpperCase()),O=typeof v=="object"&&v&&v.toString===f3&&(!n.utils[b]||!d.length);if(b in n.utils&&!O){const R=n.utils[b];if(R!==o){o=R,x(R(v)),o=null;continue}}else if(b in vg){const R=vg[b];if(R!==l){l=R,x(R(v)),l=null;continue}}if(k&&(S=p.slice(1)in n.media?"@media "+n.media[p.slice(1)]:p,p=S.replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,(R,C,z,M,K,G)=>{const X=jf.test(C),Y=.0625*(X?-1:1),[de,he]=X?[M,C]:[C,M];return"("+(z[0]==="="?"":z[0]===">"===X?"max-":"min-")+de+":"+(z[0]!=="="&&z.length===1?he.replace(jf,(me,ge,J)=>Number(ge)+Y*(z===">"?1:-1)+J):he)+(K?") and ("+(K[0]===">"?"min-":"max-")+de+":"+(K.length===1?G.replace(jf,(me,ge,J)=>Number(ge)+Y*(K===">"?-1:1)+J):G):"")+")"})),O){const R=k?m.concat(p):[...m],C=k?[...d]:o3(d,p.split(u3));a!==void 0&&i(_g(...a)),a=void 0,u(v,C,R)}else a===void 0&&(a=[[],d,m]),p=k||p.charCodeAt(0)!==36?p:`--${Ti(n.prefix)}${p.slice(1).replace(/\$/g,"-")}`,v=O?v:typeof v=="number"?v&&b in h3?String(v)+"px":String(v):ny(l3(b,v??""),n.prefix,n.themeMap[b]),a[0].push(`${k?`${p} `:`${od(p)}:`}${v}`)}}var S,w};x(f),a!==void 0&&i(_g(...a)),a=void 0};u(e,t,r)},_g=(e,t,r)=>`${r.map(n=>`${n}{`).join("")}${t.length?`${t.join(",")}{`:""}${e.join(";")}${t.length?"}":""}${Array(r.length?r.length+1:0).join("}")}`,h3={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},xg=e=>String.fromCharCode(e+(e>25?39:97)),Da=e=>(t=>{let r,n="";for(r=Math.abs(t);r>52;r=r/52|0)n=xg(r%52)+n;return xg(r%52)+n})(((t,r)=>{let n=r.length;for(;n;)t=33*t^r.charCodeAt(--n);return t})(5381,JSON.stringify(e))>>>0),Ho=["themed","global","styled","onevar","resonevar","allvar","inline"],d3=e=>{if(e.href&&!e.href.startsWith(location.origin))return!1;try{return!!e.cssRules}catch{return!1}},p3=e=>{let t;const r=()=>{const{cssRules:i}=t.sheet;return[].map.call(i,(a,o)=>{const{cssText:l}=a;let u="";if(l.startsWith("--sxs"))return"";if(i[o-1]&&(u=i[o-1].cssText).startsWith("--sxs")){if(!a.cssRules.length)return"";for(const f in t.rules)if(t.rules[f].group===a)return`--sxs{--sxs:${[...t.rules[f].cache].join(" ")}}${l}`;return a.cssRules.length?`${u}${l}`:""}return l}).join("")},n=()=>{if(t){const{rules:l,sheet:u}=t;if(!u.deleteRule){for(;Object(Object(u.cssRules)[0]).type===3;)u.cssRules.splice(0,1);u.cssRules=[]}for(const f in l)delete l[f]}const i=Object(e).styleSheets||[];for(const l of i)if(d3(l)){for(let u=0,f=l.cssRules;f[u];++u){const d=Object(f[u]);if(d.type!==1)continue;const m=Object(f[u+1]);if(m.type!==4)continue;++u;const{cssText:p}=d;if(!p.startsWith("--sxs"))continue;const v=p.slice(14,-3).trim().split(/\s+/),x=Ho[v[0]];x&&(t||(t={sheet:l,reset:n,rules:{},toString:r}),t.rules[x]={group:m,index:u,cache:new Set(v)})}if(t)break}if(!t){const l=(u,f)=>({type:f,cssRules:[],insertRule(d,m){this.cssRules.splice(m,0,l(d,{import:3,undefined:1}[(d.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return u==="@media{}"?`@media{${[].map.call(this.cssRules,d=>d.cssText).join("")}}`:u}});t={sheet:e?(e.head||e).appendChild(document.createElement("style")).sheet:l("","text/css"),rules:{},reset:n,toString:r}}const{sheet:a,rules:o}=t;for(let l=Ho.length-1;l>=0;--l){const u=Ho[l];if(!o[u]){const f=Ho[l+1],d=o[f]?o[f].index:a.cssRules.length;a.insertRule("@media{}",d),a.insertRule(`--sxs{--sxs:${l}}`,d),o[u]={group:a.cssRules[d+1],index:d,cache:new Set([l])}}m3(o[u])}};return n(),t},m3=e=>{const t=e.group;let r=t.cssRules.length;e.apply=n=>{try{t.insertRule(n,r),++r}catch{}}},Do=Symbol(),g3=Ql(),v3=(e,t)=>g3(e,()=>(...r)=>{let n={type:null,composers:new Set};for(const i of r)if(i!=null)if(i[gu]){n.type==null&&(n.type=i[gu].type);for(const a of i[gu].composers)n.composers.add(a)}else i.constructor!==Object||i.$$typeof?n.type==null&&(n.type=i):n.composers.add(_3(i,e));return n.type==null&&(n.type="span"),n.composers.size||n.composers.add(["PJLV",{},[],[],{},[]]),x3(e,n,t)}),_3=({variants:e,compoundVariants:t,defaultVariants:r,...n},i)=>{const a=`${Ti(i.prefix)}c-${Da(n)}`,o=[],l=[],u=Object.create(null),f=[];for(const p in r)u[p]=String(r[p]);if(typeof e=="object"&&e)for(const p in e){d=u,m=p,a3.call(d,m)||(u[p]="undefined");const v=e[p];for(const x in v){const _={[p]:String(x)};String(x)==="undefined"&&f.push(p);const S=v[x],w=[_,S,!gg(S)];o.push(w)}}var d,m;if(typeof t=="object"&&t)for(const p of t){let{css:v,...x}=p;v=typeof v=="object"&&v||{};for(const S in x)x[S]=String(x[S]);const _=[x,v,!gg(v)];l.push(_)}return[a,n,o,l,u,f]},x3=(e,t,r)=>{const[n,i,a,o]=y3(t.composers),l=typeof t.type=="function"||t.type.$$typeof?(m=>{function p(){for(let v=0;v<p[Do].length;v++){const[x,_]=p[Do][v];m.rules[x].apply(_)}return p[Do]=[],null}return p[Do]=[],p.rules={},Ho.forEach(v=>p.rules[v]={apply:x=>p[Do].push([v,x])}),p})(r):null,u=(l||r).rules,f=`.${n}${i.length>1?`:where(.${i.slice(1).join(".")})`:""}`,d=m=>{m=typeof m=="object"&&m||w3;const{css:p,...v}=m,x={};for(const w in a)if(delete v[w],w in m){let k=m[w];typeof k=="object"&&k?x[w]={"@initial":a[w],...k}:(k=String(k),x[w]=k!=="undefined"||o.has(w)?k:a[w])}else x[w]=a[w];const _=new Set([...i]);for(const[w,k,y,b]of t.composers){r.rules.styled.cache.has(w)||(r.rules.styled.cache.add(w),Bs(k,[`.${w}`],[],e,C=>{u.styled.apply(C)}));const O=yg(y,x,e.media),R=yg(b,x,e.media,!0);for(const C of O)if(C!==void 0)for(const[z,M,K]of C){const G=`${w}-${Da(M)}-${z}`;_.add(G);const X=(K?r.rules.resonevar:r.rules.onevar).cache,Y=K?u.resonevar:u.onevar;X.has(G)||(X.add(G),Bs(M,[`.${G}`],[],e,de=>{Y.apply(de)}))}for(const C of R)if(C!==void 0)for(const[z,M]of C){const K=`${w}-${Da(M)}-${z}`;_.add(K),r.rules.allvar.cache.has(K)||(r.rules.allvar.cache.add(K),Bs(M,[`.${K}`],[],e,G=>{u.allvar.apply(G)}))}}if(typeof p=="object"&&p){const w=`${n}-i${Da(p)}-css`;_.add(w),r.rules.inline.cache.has(w)||(r.rules.inline.cache.add(w),Bs(p,[`.${w}`],[],e,k=>{u.inline.apply(k)}))}for(const w of String(m.className||"").trim().split(/\s+/))w&&_.add(w);const S=v.className=[..._].join(" ");return{type:t.type,className:S,selector:f,props:v,toString:()=>S,deferredInjector:l}};return wp(d,{className:n,selector:f,[gu]:t,toString:()=>(r.rules.styled.cache.has(n)||d(),n)})},y3=e=>{let t="";const r=[],n={},i=[];for(const[a,,,,o,l]of e){t===""&&(t=a),r.push(a),i.push(...l);for(const u in o){const f=o[u];(n[u]===void 0||f!=="undefined"||l.includes(f))&&(n[u]=f)}}return[t,r,n,new Set(i)]},yg=(e,t,r,n)=>{const i=[];e:for(let[a,o,l]of e){if(l)continue;let u,f=0,d=!1;for(u in a){const m=a[u];let p=t[u];if(p!==m){if(typeof p!="object"||!p)continue e;{let v,x,_=0;for(const S in p){if(m===String(p[S])){if(S!=="@initial"){const w=S.slice(1);(x=x||[]).push(w in r?r[w]:S.replace(/^@media ?/,"")),d=!0}f+=_,v=!0}++_}if(x&&x.length&&(o={["@media "+x.join(", ")]:o}),!v)continue e}}}(i[f]=i[f]||[]).push([n?"cv":`${u}-${a[u]}`,o,d])}return i},w3={},k3=Ql(),E3=(e,t)=>k3(e,()=>(...r)=>{const n=()=>{for(let i of r){i=typeof i=="object"&&i||{};let a=Da(i);if(!t.rules.global.cache.has(a)){if(t.rules.global.cache.add(a),"@import"in i){let o=[].indexOf.call(t.sheet.cssRules,t.rules.themed.group)-1;for(let l of[].concat(i["@import"]))l=l.includes('"')||l.includes("'")?l:`"${l}"`,t.sheet.insertRule(`@import ${l};`,o++);delete i["@import"]}Bs(i,[],[],e,o=>{t.rules.global.apply(o)})}}return""};return wp(n,{toString:n})}),S3=Ql(),T3=(e,t)=>S3(e,()=>r=>{const n=`${Ti(e.prefix)}k-${Da(r)}`,i=()=>{if(!t.rules.global.cache.has(n)){t.rules.global.cache.add(n);const a=[];Bs(r,[],[],e,l=>a.push(l));const o=`@keyframes ${n}{${a.join("")}}`;t.rules.global.apply(o)}return n};return wp(i,{get name(){return i()},toString:i})}),C3=class{constructor(t,r,n,i){this.token=t==null?"":String(t),this.value=r==null?"":String(r),this.scale=n==null?"":String(n),this.prefix=i==null?"":String(i)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+Ti(this.prefix)+Ti(this.scale)+this.token}toString(){return this.computedValue}},b3=Ql(),A3=(e,t)=>b3(e,()=>(r,n)=>{n=typeof r=="object"&&r||Object(n);const i=`.${r=(r=typeof r=="string"?r:"")||`${Ti(e.prefix)}t-${Da(n)}`}`,a={},o=[];for(const u in n){a[u]={};for(const f in n[u]){const d=`--${Ti(e.prefix)}${u}-${f}`,m=ny(String(n[u][f]),e.prefix,u);a[u][f]=new C3(f,m,u,e.prefix),o.push(`${d}:${m}`)}}const l=()=>{if(o.length&&!t.rules.themed.cache.has(r)){t.rules.themed.cache.add(r);const u=`${n===e.theme?":root,":""}.${r}{${o.join(";")}}`;t.rules.themed.apply(u)}return r};return{...a,get className(){return l()},selector:i,toString:l}}),P3=Ql(),iy=e=>{let t=!1;const r=P3(e,n=>{t=!0;const i="prefix"in(n=typeof n=="object"&&n||{})?String(n.prefix):"",a=typeof n.media=="object"&&n.media||{},o=typeof n.root=="object"?n.root||null:globalThis.document||null,l=typeof n.theme=="object"&&n.theme||{},u={prefix:i,media:a,theme:l,themeMap:typeof n.themeMap=="object"&&n.themeMap||{...n3},utils:typeof n.utils=="object"&&n.utils||{}},f=p3(o),d={css:v3(u,f),globalCss:E3(u,f),keyframes:T3(u,f),createTheme:A3(u,f),reset(){f.reset(),d.theme.toString()},theme:{},sheet:f,config:u,prefix:i,getCssText:f.toString,toString:f.toString};return String(d.theme=d.createTheme(l)),d});return t||r.reset(),r},ay=()=>mg||(mg=iy()),O3=(...e)=>ay().createTheme(...e),Pi=(...e)=>ay().css(...e),R3={default:{colors:{brand:"hsl(153 60.0% 53.0%)",brandAccent:"hsl(154 54.8% 45.1%)",brandButtonText:"white",defaultButtonBackground:"white",defaultButtonBackgroundHover:"#eaeaea",defaultButtonBorder:"lightgray",defaultButtonText:"gray",dividerBackground:"#eaeaea",inputBackground:"transparent",inputBorder:"lightgray",inputBorderHover:"gray",inputBorderFocus:"gray",inputText:"black",inputLabelText:"gray",inputPlaceholder:"darkgray",messageText:"#2b805a",messageBackground:"#e7fcf1",messageBorder:"#d0f3e1",messageTextDanger:"#ff6369",messageBackgroundDanger:"#fff8f8",messageBorderDanger:"#822025",anchorTextColor:"gray",anchorTextHoverColor:"darkgray"},space:{spaceSmall:"4px",spaceMedium:"8px",spaceLarge:"16px",labelBottomMargin:"8px",anchorBottomMargin:"4px",emailInputSpacing:"4px",socialAuthSpacing:"4px",buttonPadding:"10px 15px",inputPadding:"10px 15px"},fontSizes:{baseBodySize:"13px",baseInputSize:"14px",baseLabelSize:"14px",baseButtonSize:"14px"},fonts:{bodyFontFamily:"ui-sans-serif, sans-serif",buttonFontFamily:"ui-sans-serif, sans-serif",inputFontFamily:"ui-sans-serif, sans-serif",labelFontFamily:"ui-sans-serif, sans-serif"},borderWidths:{buttonBorderWidth:"1px",inputBorderWidth:"1px"},radii:{borderRadiusButton:"4px",buttonBorderRadius:"4px",inputBorderRadius:"4px"}},dark:{colors:{brandButtonText:"white",defaultButtonBackground:"#2e2e2e",defaultButtonBackgroundHover:"#3e3e3e",defaultButtonBorder:"#3e3e3e",defaultButtonText:"white",dividerBackground:"#2e2e2e",inputBackground:"#1e1e1e",inputBorder:"#3e3e3e",inputBorderHover:"gray",inputBorderFocus:"gray",inputText:"white",inputPlaceholder:"darkgray",messageText:"#85e0b7",messageBackground:"#072719",messageBorder:"#2b805a",messageBackgroundDanger:"#1f1315"}}},Ot={SIGN_IN:"sign_in",SIGN_UP:"sign_up",FORGOTTEN_PASSWORD:"forgotten_password",MAGIC_LINK:"magic_link",UPDATE_PASSWORD:"update_password",VERIFY_OTP:"verify_otp"},F3="supabase-auth-ui",L3={ROOT:"root",SIGN_IN:Ot.SIGN_IN,SIGN_UP:Ot.SIGN_UP,FORGOTTEN_PASSWORD:Ot.FORGOTTEN_PASSWORD,MAGIC_LINK:Ot.MAGIC_LINK,UPDATE_PASSWORD:Ot.UPDATE_PASSWORD,anchor:"ui-anchor",button:"ui-button",container:"ui-container",divider:"ui-divider",input:"ui-input",label:"ui-label",loader:"ui-loader",message:"ui-message"};function Xa(e,t,r){var n,i;const a=[],o=L3[e];return a.push(r!=null&&r.prependedClassName?(r==null?void 0:r.prependedClassName)+"_"+o:F3+"_"+o),(n=r==null?void 0:r.className)!=null&&n[e]&&a.push((i=r==null?void 0:r.className)==null?void 0:i[e]),((r==null?void 0:r.extend)===void 0||(r==null?void 0:r.extend)===!0)&&a.push(t),a}function ld(e,t){let r;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(Array.isArray(t))for(r=0;r<t.length;r++)e[r]=ld(e[r],t[r]);else for(r in t)e[r]=ld(e[r],t[r]);return e}return t}function Uf(e,...t){let r=t.length;for(let n=0;n<r;n++)e=ld(e,t[n]);return e}function I3(e,t){return e.replace(/{{(\w+)}}/g,(r,n)=>t.hasOwnProperty(n)?t[n]:r)}var N3={sign_up:{email_label:"Email address",password_label:"Create a Password",email_input_placeholder:"Your email address",password_input_placeholder:"Your password",button_label:"Sign up",loading_button_label:"Signing up ...",social_provider_text:"Sign in with {{provider}}",link_text:"Don't have an account? Sign up",confirmation_text:"Check your email for the confirmation link"},sign_in:{email_label:"Email address",password_label:"Your Password",email_input_placeholder:"Your email address",password_input_placeholder:"Your password",button_label:"Sign in",loading_button_label:"Signing in ...",social_provider_text:"Sign in with {{provider}}",link_text:"Already have an account? Sign in"},magic_link:{email_input_label:"Email address",email_input_placeholder:"Your email address",button_label:"Send Magic Link",loading_button_label:"Sending Magic Link ...",link_text:"Send a magic link email",confirmation_text:"Check your email for the magic link"},forgotten_password:{email_label:"Email address",password_label:"Your Password",email_input_placeholder:"Your email address",button_label:"Send reset password instructions",loading_button_label:"Sending reset instructions ...",link_text:"Forgot your password?",confirmation_text:"Check your email for the password reset link"},update_password:{password_label:"New password",password_input_placeholder:"Your new password",button_label:"Update password",loading_button_label:"Updating password ...",confirmation_text:"Your password has been updated"},verify_otp:{email_input_label:"Email address",email_input_placeholder:"Your email address",phone_input_label:"Phone number",phone_input_placeholder:"Your phone number",token_input_label:"Token",token_input_placeholder:"Your Otp token",button_label:"Verify token",loading_button_label:"Signing in ..."}};const D3=Pi({fontFamily:"$bodyFontFamily",fontSize:"$baseBodySize",marginBottom:"$anchorBottomMargin",color:"$anchorTextColor",display:"block",textAlign:"center",textDecoration:"underline","&:hover":{color:"$anchorTextHoverColor"}}),Fa=({children:e,appearance:t,...r})=>{var n;const i=Xa("anchor",D3(),t);return Q.createElement("a",{...r,style:(n=t==null?void 0:t.style)==null?void 0:n.anchor,className:i.join(" ")},e)},M3=Pi({fontFamily:"$buttonFontFamily",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",borderRadius:"$borderRadiusButton",fontSize:"$baseButtonSize",padding:"$buttonPadding",cursor:"pointer",borderWidth:"$buttonBorderWidth",borderStyle:"solid",width:"100%",transitionProperty:"background-color",transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",transitionDuration:"100ms","&:disabled":{opacity:.7,cursor:"unset"},variants:{color:{default:{backgroundColor:"$defaultButtonBackground",color:"$defaultButtonText",borderColor:"$defaultButtonBorder","&:hover:not(:disabled)":{backgroundColor:"$defaultButtonBackgroundHover"}},primary:{backgroundColor:"$brand",color:"$brandButtonText",borderColor:"$brandAccent","&:hover:not(:disabled)":{backgroundColor:"$brandAccent"}}}}}),lo=({children:e,color:t="default",appearance:r,icon:n,loading:i=!1,...a})=>{var o;const l=Xa("button",M3({color:t}),r);return Q.createElement("button",{...a,style:(o=r==null?void 0:r.style)==null?void 0:o.button,className:l.join(" "),disabled:i},n,e)},B3=Pi({display:"flex",gap:"4px",variants:{direction:{horizontal:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(48px, 1fr))"},vertical:{flexDirection:"column",margin:"8px 0"}},gap:{small:{gap:"4px"},medium:{gap:"8px"},large:{gap:"16px"}}}}),Jn=({children:e,appearance:t,...r})=>{var n;const i=Xa("container",B3({direction:r.direction,gap:r.gap}),t);return Q.createElement("div",{...r,style:(n=t==null?void 0:t.style)==null?void 0:n.container,className:i.join(" ")},e)},j3=Pi({background:"$dividerBackground",display:"block",margin:"16px 0",height:"1px",width:"100%"}),U3=({children:e,appearance:t,...r})=>{var n;const i=Xa("divider",j3(),t);return Q.createElement("div",{...r,style:(n=t==null?void 0:t.style)==null?void 0:n.divider,className:i.join(" ")})},z3=Pi({fontFamily:"$inputFontFamily",background:"$inputBackground",borderRadius:"$inputBorderRadius",padding:"$inputPadding",cursor:"text",borderWidth:"$inputBorderWidth",borderColor:"$inputBorder",borderStyle:"solid",fontSize:"$baseInputSize",width:"100%",color:"$inputText",boxSizing:"border-box","&:hover":{borderColor:"$inputBorderHover",outline:"none"},"&:focus":{borderColor:"$inputBorderFocus",outline:"none"},"&::placeholder":{color:"$inputPlaceholder",letterSpacing:"initial"},transitionProperty:"background-color, border",transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",transitionDuration:"100ms",variants:{type:{default:{letterSpacing:"0px"},password:{letterSpacing:"0px"}}}}),na=({children:e,appearance:t,...r})=>{var n;const i=Xa("input",z3({type:r.type==="password"?"password":"default"}),t);return Q.createElement("input",{...r,style:(n=t==null?void 0:t.style)==null?void 0:n.input,className:i.join(" ")},e)},$3=Pi({fontFamily:"$labelFontFamily",fontSize:"$baseLabelSize",marginBottom:"$labelBottomMargin",color:"$inputLabelText",display:"block"}),ia=({children:e,appearance:t,...r})=>{var n;const i=Xa("label",$3(),t);return Q.createElement("label",{...r,style:(n=t==null?void 0:t.style)==null?void 0:n.label,className:i.join(" ")},e)},W3=Pi({fontFamily:"$bodyFontFamily",fontSize:"$baseInputSize",marginBottom:"$labelBottomMargin",display:"block",textAlign:"center",borderRadius:"0.375rem",padding:"1.5rem 1rem",lineHeight:"1rem",color:"$messageText",backgroundColor:"$messageBackground",border:"1px solid $messageBorder",variants:{color:{danger:{color:"$messageTextDanger",backgroundColor:"$messageBackgroundDanger",border:"1px solid $messageBorderDanger"}}}}),Qn=({children:e,appearance:t,...r})=>{var n;const i=Xa("message",W3({color:r.color}),t);return Q.createElement("span",{...r,style:(n=t==null?void 0:t.style)==null?void 0:n.message,className:i.join(" ")},e)};function sy({setAuthView:e=()=>{},supabaseClient:t,redirectTo:r,i18n:n,appearance:i,showLinks:a=!1}){var o;const[l,u]=ie.useState(""),[f,d]=ie.useState(""),[m,p]=ie.useState(""),[v,x]=ie.useState(!1),_=async w=>{var k,y;if(w.preventDefault(),d(""),p(""),x(!0),l.length===0){d((k=n==null?void 0:n.magic_link)==null?void 0:k.empty_email_address),x(!1);return}const{error:b}=await t.auth.signInWithOtp({email:l,options:{emailRedirectTo:r}});b?d(b.message):p((y=n==null?void 0:n.magic_link)==null?void 0:y.confirmation_text),x(!1)},S=n==null?void 0:n.magic_link;return Q.createElement("form",{id:"auth-magic-link",onSubmit:_},Q.createElement(Jn,{gap:"large",direction:"vertical",appearance:i},Q.createElement("div",null,Q.createElement(ia,{htmlFor:"email",appearance:i},S==null?void 0:S.email_input_label),Q.createElement(na,{id:"email",name:"email",type:"email",autoFocus:!0,placeholder:S==null?void 0:S.email_input_placeholder,onChange:w=>{d&&d(""),u(w.target.value)},appearance:i})),Q.createElement(lo,{color:"primary",type:"submit",loading:v,appearance:i},v?S==null?void 0:S.loading_button_label:S==null?void 0:S.button_label),a&&Q.createElement(Fa,{href:"#auth-sign-in",onClick:w=>{w.preventDefault(),e(Ot.SIGN_IN)},appearance:i},(o=n==null?void 0:n.sign_in)==null?void 0:o.link_text),m&&Q.createElement(Qn,{appearance:i},m),f&&Q.createElement(Qn,{color:"danger",appearance:i},f)))}const cr=Pi({width:"21px",height:"21px"}),H3=({provider:e})=>e=="google"?V3():e=="facebook"?G3():e=="twitter"?Z3():e=="apple"?K3():e=="github"?q3():e=="gitlab"?X3():e=="bitbucket"?Y3():e=="discord"?J3():e=="azure"?Q3():e=="keycloak"?eC():e=="linkedin"?tC():e=="notion"?rC():e=="slack"?nC():e=="spotify"?iC():e=="twitch"?aC():e=="workos"?sC():e=="kakao"?oC():null,V3=()=>Q.createElement("svg",{className:cr(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},Q.createElement("path",{fill:"#FFC107",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),Q.createElement("path",{fill:"#FF3D00",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),Q.createElement("path",{fill:"#4CAF50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),Q.createElement("path",{fill:"#1976D2",d:"M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"})),G3=()=>Q.createElement("svg",{className:cr(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},Q.createElement("path",{fill:"#039be5",d:"M24 5A19 19 0 1 0 24 43A19 19 0 1 0 24 5Z"}),Q.createElement("path",{fill:"#fff",d:"M26.572,29.036h4.917l0.772-4.995h-5.69v-2.73c0-2.075,0.678-3.915,2.619-3.915h3.119v-4.359c-0.548-0.074-1.707-0.236-3.897-0.236c-4.573,0-7.254,2.415-7.254,7.917v3.323h-4.701v4.995h4.701v13.729C22.089,42.905,23.032,43,24,43c0.875,0,1.729-0.08,2.572-0.194V29.036z"})),Z3=()=>Q.createElement("svg",{className:cr(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},Q.createElement("path",{fill:"#03A9F4",d:"M42,12.429c-1.323,0.586-2.746,0.977-4.247,1.162c1.526-0.906,2.7-2.351,3.251-4.058c-1.428,0.837-3.01,1.452-4.693,1.776C34.967,9.884,33.05,9,30.926,9c-4.08,0-7.387,3.278-7.387,7.32c0,0.572,0.067,1.129,0.193,1.67c-6.138-0.308-11.582-3.226-15.224-7.654c-0.64,1.082-1,2.349-1,3.686c0,2.541,1.301,4.778,3.285,6.096c-1.211-0.037-2.351-0.374-3.349-0.914c0,0.022,0,0.055,0,0.086c0,3.551,2.547,6.508,5.923,7.181c-0.617,0.169-1.269,0.263-1.941,0.263c-0.477,0-0.942-0.054-1.392-0.135c0.94,2.902,3.667,5.023,6.898,5.086c-2.528,1.96-5.712,3.134-9.174,3.134c-0.598,0-1.183-0.034-1.761-0.104C9.268,36.786,13.152,38,17.321,38c13.585,0,21.017-11.156,21.017-20.834c0-0.317-0.01-0.633-0.025-0.945C39.763,15.197,41.013,13.905,42,12.429"})),K3=()=>Q.createElement("svg",{className:cr(),fill:"gray",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"21px",height:"21px"}," ",Q.createElement("path",{d:"M 15.904297 1.078125 C 15.843359 1.06875 15.774219 1.0746094 15.699219 1.0996094 C 14.699219 1.2996094 13.600391 1.8996094 12.900391 2.5996094 C 12.300391 3.1996094 11.800781 4.1996094 11.800781 5.0996094 C 11.800781 5.2996094 11.999219 5.5 12.199219 5.5 C 13.299219 5.4 14.399609 4.7996094 15.099609 4.0996094 C 15.699609 3.2996094 16.199219 2.4 16.199219 1.5 C 16.199219 1.275 16.087109 1.10625 15.904297 1.078125 z M 16.199219 5.4003906 C 14.399219 5.4003906 13.600391 6.5 12.400391 6.5 C 11.100391 6.5 9.9003906 5.5 8.4003906 5.5 C 6.3003906 5.5 3.0996094 7.4996094 3.0996094 12.099609 C 2.9996094 16.299609 6.8 21 9 21 C 10.3 21 10.600391 20.199219 12.400391 20.199219 C 14.200391 20.199219 14.600391 21 15.900391 21 C 17.400391 21 18.500391 19.399609 19.400391 18.099609 C 19.800391 17.399609 20.100391 17.000391 20.400391 16.400391 C 20.600391 16.000391 20.4 15.600391 20 15.400391 C 17.4 14.100391 16.900781 9.9003906 19.800781 8.4003906 C 20.300781 8.1003906 20.4 7.4992188 20 7.1992188 C 18.9 6.1992187 17.299219 5.4003906 16.199219 5.4003906 z"})),q3=()=>Q.createElement("svg",{className:cr(),fill:"gray",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 30 30",width:"21px",height:"21px"}," ",Q.createElement("path",{d:"M15,3C8.373,3,3,8.373,3,15c0,5.623,3.872,10.328,9.092,11.63C12.036,26.468,12,26.28,12,26.047v-2.051 c-0.487,0-1.303,0-1.508,0c-0.821,0-1.551-0.353-1.905-1.009c-0.393-0.729-0.461-1.844-1.435-2.526 c-0.289-0.227-0.069-0.486,0.264-0.451c0.615,0.174,1.125,0.596,1.605,1.222c0.478,0.627,0.703,0.769,1.596,0.769 c0.433,0,1.081-0.025,1.691-0.121c0.328-0.833,0.895-1.6,1.588-1.962c-3.996-0.411-5.903-2.399-5.903-5.098 c0-1.162,0.495-2.286,1.336-3.233C9.053,10.647,8.706,8.73,9.435,8c1.798,0,2.885,1.166,3.146,1.481C13.477,9.174,14.461,9,15.495,9 c1.036,0,2.024,0.174,2.922,0.483C18.675,9.17,19.763,8,21.565,8c0.732,0.731,0.381,2.656,0.102,3.594 c0.836,0.945,1.328,2.066,1.328,3.226c0,2.697-1.904,4.684-5.894,5.097C18.199,20.49,19,22.1,19,23.313v2.734 c0,0.104-0.023,0.179-0.035,0.268C23.641,24.676,27,20.236,27,15C27,8.373,21.627,3,15,3z"})),X3=()=>Q.createElement("svg",{className:cr(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},Q.createElement("path",{fill:"#e53935",d:"M24 43L16 20 32 20z"}),Q.createElement("path",{fill:"#ff7043",d:"M24 43L42 20 32 20z"}),Q.createElement("path",{fill:"#e53935",d:"M37 5L42 20 32 20z"}),Q.createElement("path",{fill:"#ffa726",d:"M24 43L42 20 45 28z"}),Q.createElement("path",{fill:"#ff7043",d:"M24 43L6 20 16 20z"}),Q.createElement("path",{fill:"#e53935",d:"M11 5L6 20 16 20z"}),Q.createElement("path",{fill:"#ffa726",d:"M24 43L6 20 3 28z"})),Y3=()=>Q.createElement("svg",{className:cr(),xmlns:"http://www.w3.org/2000/svg",width:"512",height:"512",viewBox:"0 0 62.42 62.42"},Q.createElement("defs",null,Q.createElement("linearGradient",{id:"New_Gradient_Swatch_1",x1:"64.01",y1:"30.27",x2:"32.99",y2:"54.48",gradientUnits:"userSpaceOnUse"},Q.createElement("stop",{offset:"0.18",stopColor:"#0052cc"}),Q.createElement("stop",{offset:"1",stopColor:"#2684ff"}))),Q.createElement("title",null,"Bitbucket-blue"),Q.createElement("g",{id:"Layer_2","data-name":"Layer 2"},Q.createElement("g",{id:"Blue",transform:"translate(0 -3.13)"},Q.createElement("path",{d:"M2,6.26A2,2,0,0,0,0,8.58L8.49,60.12a2.72,2.72,0,0,0,2.66,2.27H51.88a2,2,0,0,0,2-1.68L62.37,8.59a2,2,0,0,0-2-2.32ZM37.75,43.51h-13L21.23,25.12H40.9Z",fill:"#2684ff"}),Q.createElement("path",{d:"M59.67,25.12H40.9L37.75,43.51h-13L9.4,61.73a2.71,2.71,0,0,0,1.75.66H51.89a2,2,0,0,0,2-1.68Z",fill:"url(#New_Gradient_Swatch_1)"})))),J3=()=>Q.createElement("svg",{className:cr(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},Q.createElement("path",{fill:"#536dfe",d:"M39.248,10.177c-2.804-1.287-5.812-2.235-8.956-2.778c-0.057-0.01-0.114,0.016-0.144,0.068	c-0.387,0.688-0.815,1.585-1.115,2.291c-3.382-0.506-6.747-0.506-10.059,0c-0.3-0.721-0.744-1.603-1.133-2.291	c-0.03-0.051-0.087-0.077-0.144-0.068c-3.143,0.541-6.15,1.489-8.956,2.778c-0.024,0.01-0.045,0.028-0.059,0.051	c-5.704,8.522-7.267,16.835-6.5,25.044c0.003,0.04,0.026,0.079,0.057,0.103c3.763,2.764,7.409,4.442,10.987,5.554	c0.057,0.017,0.118-0.003,0.154-0.051c0.846-1.156,1.601-2.374,2.248-3.656c0.038-0.075,0.002-0.164-0.076-0.194	c-1.197-0.454-2.336-1.007-3.432-1.636c-0.087-0.051-0.094-0.175-0.014-0.234c0.231-0.173,0.461-0.353,0.682-0.534	c0.04-0.033,0.095-0.04,0.142-0.019c7.201,3.288,14.997,3.288,22.113,0c0.047-0.023,0.102-0.016,0.144,0.017	c0.22,0.182,0.451,0.363,0.683,0.536c0.08,0.059,0.075,0.183-0.012,0.234c-1.096,0.641-2.236,1.182-3.434,1.634	c-0.078,0.03-0.113,0.12-0.075,0.196c0.661,1.28,1.415,2.498,2.246,3.654c0.035,0.049,0.097,0.07,0.154,0.052	c3.595-1.112,7.241-2.79,11.004-5.554c0.033-0.024,0.054-0.061,0.057-0.101c0.917-9.491-1.537-17.735-6.505-25.044	C39.293,10.205,39.272,10.187,39.248,10.177z M16.703,30.273c-2.168,0-3.954-1.99-3.954-4.435s1.752-4.435,3.954-4.435	c2.22,0,3.989,2.008,3.954,4.435C20.658,28.282,18.906,30.273,16.703,30.273z M31.324,30.273c-2.168,0-3.954-1.99-3.954-4.435	s1.752-4.435,3.954-4.435c2.22,0,3.989,2.008,3.954,4.435C35.278,28.282,33.544,30.273,31.324,30.273z"})),Q3=()=>Q.createElement("svg",{className:cr(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},Q.createElement("linearGradient",{id:"k8yl7~hDat~FaoWq8WjN6a",x1:"-1254.397",x2:"-1261.911",y1:"877.268",y2:"899.466",gradientTransform:"translate(1981.75 -1362.063) scale(1.5625)",gradientUnits:"userSpaceOnUse"},Q.createElement("stop",{offset:"0",stopColor:"#114a8b"}),Q.createElement("stop",{offset:"1",stopColor:"#0669bc"})),Q.createElement("path",{fill:"url(#k8yl7~hDat~FaoWq8WjN6a)",d:"M17.634,6h11.305L17.203,40.773c-0.247,0.733-0.934,1.226-1.708,1.226H6.697 c-0.994,0-1.8-0.806-1.8-1.8c0-0.196,0.032-0.39,0.094-0.576L15.926,7.227C16.173,6.494,16.86,6,17.634,6L17.634,6z"}),Q.createElement("path",{fill:"#0078d4",d:"M34.062,29.324H16.135c-0.458-0.001-0.83,0.371-0.831,0.829c0,0.231,0.095,0.451,0.264,0.608 l11.52,10.752C27.423,41.826,27.865,42,28.324,42h10.151L34.062,29.324z"}),Q.createElement("linearGradient",{id:"k8yl7~hDat~FaoWq8WjN6b",x1:"-1252.05",x2:"-1253.788",y1:"887.612",y2:"888.2",gradientTransform:"translate(1981.75 -1362.063) scale(1.5625)",gradientUnits:"userSpaceOnUse"},Q.createElement("stop",{offset:"0",stopOpacity:".3"}),Q.createElement("stop",{offset:".071",stopOpacity:".2"}),Q.createElement("stop",{offset:".321",stopOpacity:".1"}),Q.createElement("stop",{offset:".623",stopOpacity:".05"}),Q.createElement("stop",{offset:"1",stopOpacity:"0"})),Q.createElement("path",{fill:"url(#k8yl7~hDat~FaoWq8WjN6b)",d:"M17.634,6c-0.783-0.003-1.476,0.504-1.712,1.25L5.005,39.595 c-0.335,0.934,0.151,1.964,1.085,2.299C6.286,41.964,6.493,42,6.702,42h9.026c0.684-0.122,1.25-0.603,1.481-1.259l2.177-6.416 l7.776,7.253c0.326,0.27,0.735,0.419,1.158,0.422h10.114l-4.436-12.676l-12.931,0.003L28.98,6H17.634z"}),Q.createElement("linearGradient",{id:"k8yl7~hDat~FaoWq8WjN6c",x1:"-1252.952",x2:"-1244.704",y1:"876.6",y2:"898.575",gradientTransform:"translate(1981.75 -1362.063) scale(1.5625)",gradientUnits:"userSpaceOnUse"},Q.createElement("stop",{offset:"0",stopColor:"#3ccbf4"}),Q.createElement("stop",{offset:"1",stopColor:"#2892df"})),Q.createElement("path",{fill:"url(#k8yl7~hDat~FaoWq8WjN6c)",d:"M32.074,7.225C31.827,6.493,31.141,6,30.368,6h-12.6c0.772,0,1.459,0.493,1.705,1.224 l10.935,32.399c0.318,0.942-0.188,1.963-1.13,2.281C29.093,41.968,28.899,42,28.703,42h12.6c0.994,0,1.8-0.806,1.8-1.801 c0-0.196-0.032-0.39-0.095-0.575L32.074,7.225z"})),eC=()=>Q.createElement("svg",{className:cr(),width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Q.createElement("path",{d:"M472.136 163.959H408.584C407.401 163.959 406.218 163.327 405.666 162.3L354.651 73.6591C354.02 72.632 352.916 72 351.654 72H143.492C142.309 72 141.126 72.632 140.574 73.6591L87.5084 165.618L36.414 254.259C35.862 255.286 35.862 256.55 36.414 257.656L87.5084 346.297L140.495 438.335C141.047 439.362 142.23 440.073 143.413 439.994H351.654C352.837 439.994 354.02 439.362 354.651 438.335L405.745 349.694C406.297 348.667 407.48 347.956 408.663 348.035H472.215C474.344 348.035 476 346.297 476 344.243V167.83C475.921 165.697 474.186 163.959 472.136 163.959ZM228.728 349.694L212.721 377.345C212.485 377.74 212.091 378.135 211.696 378.372C211.223 378.609 210.75 378.767 210.198 378.767H178.422C177.318 378.767 176.293 378.214 175.82 377.187L128.431 294.787L123.779 286.65L106.748 257.498C106.511 257.103 106.353 256.629 106.432 256.076C106.432 255.602 106.59 255.049 106.827 254.654L123.937 224.949L175.899 134.886C176.451 133.938 177.476 133.306 178.501 133.306H210.198C210.75 133.306 211.302 133.464 211.854 133.701C212.248 133.938 212.643 134.254 212.879 134.728L228.886 162.537C229.359 163.485 229.28 164.67 228.728 165.539L177.397 254.654C177.16 255.049 177.081 255.523 177.081 255.918C177.081 256.392 177.239 256.787 177.397 257.182L228.728 346.218C229.438 347.403 229.359 348.667 228.728 349.694V349.694ZM388.083 257.498L371.051 286.65L366.399 294.787L319.011 377.187C318.459 378.135 317.512 378.767 316.409 378.767H284.632C284.08 378.767 283.607 378.609 283.134 378.372C282.74 378.135 282.346 377.819 282.109 377.345L266.103 349.694C265.393 348.667 265.393 347.403 266.024 346.376L317.355 257.34C317.591 256.945 317.67 256.471 317.67 256.076C317.67 255.602 317.513 255.207 317.355 254.812L266.024 165.697C265.472 164.749 265.393 163.643 265.866 162.695L281.873 134.886C282.109 134.491 282.503 134.096 282.898 133.859C283.371 133.543 283.923 133.464 284.553 133.464H316.409C317.512 133.464 318.538 134.017 319.011 135.044L370.972 225.107L388.083 254.812C388.319 255.286 388.477 255.76 388.477 256.234C388.477 256.55 388.319 257.024 388.083 257.498V257.498Z",fill:"#008AAA"})),tC=()=>Q.createElement("svg",{className:cr(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},Q.createElement("path",{fill:"#0288D1",d:"M42,37c0,2.762-2.238,5-5,5H11c-2.761,0-5-2.238-5-5V11c0-2.762,2.239-5,5-5h26c2.762,0,5,2.238,5,5V37z"}),Q.createElement("path",{fill:"#FFF",d:"M12 19H17V36H12zM14.485 17h-.028C12.965 17 12 15.888 12 14.499 12 13.08 12.995 12 14.514 12c1.521 0 2.458 1.08 2.486 2.499C17 15.887 16.035 17 14.485 17zM36 36h-5v-9.099c0-2.198-1.225-3.698-3.192-3.698-1.501 0-2.313 1.012-2.707 1.99C24.957 25.543 25 26.511 25 27v9h-5V19h5v2.616C25.721 20.5 26.85 19 29.738 19c3.578 0 6.261 2.25 6.261 7.274L36 36 36 36z"})),rC=()=>Q.createElement("svg",{className:cr(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px",fillRule:"evenodd",clipRule:"evenodd"},Q.createElement("path",{fill:"#fff",fillRule:"evenodd",d:"M11.553,11.099c1.232,1.001,1.694,0.925,4.008,0.77 l21.812-1.31c0.463,0,0.078-0.461-0.076-0.538l-3.622-2.619c-0.694-0.539-1.619-1.156-3.391-1.002l-21.12,1.54 c-0.77,0.076-0.924,0.461-0.617,0.77L11.553,11.099z",clipRule:"evenodd"}),Q.createElement("path",{fill:"#fff",fillRule:"evenodd",d:"M12.862,16.182v22.95c0,1.233,0.616,1.695,2.004,1.619 l23.971-1.387c1.388-0.076,1.543-0.925,1.543-1.927V14.641c0-1-0.385-1.54-1.234-1.463l-25.05,1.463 C13.171,14.718,12.862,15.181,12.862,16.182L12.862,16.182z",clipRule:"evenodd"}),Q.createElement("path",{fill:"#424242",fillRule:"evenodd",d:"M11.553,11.099c1.232,1.001,1.694,0.925,4.008,0.77 l21.812-1.31c0.463,0,0.078-0.461-0.076-0.538l-3.622-2.619c-0.694-0.539-1.619-1.156-3.391-1.002l-21.12,1.54 c-0.77,0.076-0.924,0.461-0.617,0.77L11.553,11.099z M12.862,16.182v22.95c0,1.233,0.616,1.695,2.004,1.619l23.971-1.387 c1.388-0.076,1.543-0.925,1.543-1.927V14.641c0-1-0.385-1.54-1.234-1.463l-25.05,1.463C13.171,14.718,12.862,15.181,12.862,16.182 L12.862,16.182z M36.526,17.413c0.154,0.694,0,1.387-0.695,1.465l-1.155,0.23v16.943c-1.003,0.539-1.928,0.847-2.698,0.847 c-1.234,0-1.543-0.385-2.467-1.54l-7.555-11.86v11.475l2.391,0.539c0,0,0,1.386-1.929,1.386l-5.317,0.308 c-0.154-0.308,0-1.078,0.539-1.232l1.388-0.385V20.418l-1.927-0.154c-0.155-0.694,0.23-1.694,1.31-1.772l5.704-0.385l7.862,12.015 V19.493l-2.005-0.23c-0.154-0.848,0.462-1.464,1.233-1.54L36.526,17.413z M7.389,5.862l21.968-1.618 c2.698-0.231,3.392-0.076,5.087,1.155l7.013,4.929C42.614,11.176,43,11.407,43,12.33v27.032c0,1.694-0.617,2.696-2.775,2.849 l-25.512,1.541c-1.62,0.077-2.391-0.154-3.239-1.232l-5.164-6.7C5.385,34.587,5,33.664,5,32.585V8.556 C5,7.171,5.617,6.015,7.389,5.862z",clipRule:"evenodd"})),nC=()=>Q.createElement("svg",{className:cr(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},Q.createElement("path",{fill:"#33d375",d:"M33,8c0-2.209-1.791-4-4-4s-4,1.791-4,4c0,1.254,0,9.741,0,11c0,2.209,1.791,4,4,4s4-1.791,4-4	C33,17.741,33,9.254,33,8z"}),Q.createElement("path",{fill:"#33d375",d:"M43,19c0,2.209-1.791,4-4,4c-1.195,0-4,0-4,0s0-2.986,0-4c0-2.209,1.791-4,4-4S43,16.791,43,19z"}),Q.createElement("path",{fill:"#40c4ff",d:"M8,14c-2.209,0-4,1.791-4,4s1.791,4,4,4c1.254,0,9.741,0,11,0c2.209,0,4-1.791,4-4s-1.791-4-4-4	C17.741,14,9.254,14,8,14z"}),Q.createElement("path",{fill:"#40c4ff",d:"M19,4c2.209,0,4,1.791,4,4c0,1.195,0,4,0,4s-2.986,0-4,0c-2.209,0-4-1.791-4-4S16.791,4,19,4z"}),Q.createElement("path",{fill:"#e91e63",d:"M14,39.006C14,41.212,15.791,43,18,43s4-1.788,4-3.994c0-1.252,0-9.727,0-10.984	c0-2.206-1.791-3.994-4-3.994s-4,1.788-4,3.994C14,29.279,14,37.754,14,39.006z"}),Q.createElement("path",{fill:"#e91e63",d:"M4,28.022c0-2.206,1.791-3.994,4-3.994c1.195,0,4,0,4,0s0,2.981,0,3.994c0,2.206-1.791,3.994-4,3.994	S4,30.228,4,28.022z"}),Q.createElement("path",{fill:"#ffc107",d:"M39,33c2.209,0,4-1.791,4-4s-1.791-4-4-4c-1.254,0-9.741,0-11,0c-2.209,0-4,1.791-4,4s1.791,4,4,4	C29.258,33,37.746,33,39,33z"}),Q.createElement("path",{fill:"#ffc107",d:"M28,43c-2.209,0-4-1.791-4-4c0-1.195,0-4,0-4s2.986,0,4,0c2.209,0,4,1.791,4,4S30.209,43,28,43z"})),iC=()=>Q.createElement("svg",{className:cr(),width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Q.createElement("path",{d:"M255.498 31.0034C131.513 31.0034 31 131.515 31 255.502C31 379.492 131.513 480 255.498 480C379.497 480 480 379.495 480 255.502C480 131.522 379.497 31.0135 255.495 31.0135L255.498 31V31.0034ZM358.453 354.798C354.432 361.391 345.801 363.486 339.204 359.435C286.496 327.237 220.139 319.947 141.993 337.801C134.463 339.516 126.957 334.798 125.24 327.264C123.516 319.731 128.217 312.225 135.767 310.511C221.284 290.972 294.639 299.384 353.816 335.549C360.413 339.596 362.504 348.2 358.453 354.798ZM385.932 293.67C380.864 301.903 370.088 304.503 361.858 299.438C301.512 262.345 209.528 251.602 138.151 273.272C128.893 276.067 119.118 270.851 116.309 261.61C113.521 252.353 118.74 242.597 127.981 239.782C209.512 215.044 310.87 227.026 380.17 269.612C388.4 274.68 391 285.456 385.935 293.676V293.673L385.932 293.67ZM388.293 230.016C315.935 187.039 196.56 183.089 127.479 204.055C116.387 207.42 104.654 201.159 101.293 190.063C97.9326 178.964 104.189 167.241 115.289 163.87C194.59 139.796 326.418 144.446 409.723 193.902C419.722 199.826 422.995 212.71 417.068 222.675C411.168 232.653 398.247 235.943 388.303 230.016H388.293V230.016Z",fill:"#1ED760"})),aC=()=>Q.createElement("svg",{className:cr(),width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Q.createElement("path",{d:"M416 240L352 304H288L232 360V304H160V64H416V240Z",fill:"white"}),Q.createElement("path",{d:"M144 32L64 112V400H160V480L240 400H304L448 256V32H144ZM416 240L352 304H288L232 360V304H160V64H416V240Z",fill:"#9146FF"}),Q.createElement("path",{d:"M368 120H336V216H368V120Z",fill:"#9146FF"}),Q.createElement("path",{d:"M280 120H248V216H280V120Z",fill:"#9146FF"})),sC=()=>Q.createElement("svg",{className:cr(),width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Q.createElement("path",{d:"M33 256.043C33 264.556 35.3159 273.069 39.4845 280.202L117.993 415.493C126.098 429.298 138.373 440.572 153.657 445.634C183.764 455.528 214.797 442.873 229.618 417.333L248.609 384.661L173.806 256.043L252.777 119.831L271.768 87.1591C277.557 77.2654 284.968 69.4424 294 63H285.894H172.185C150.878 63 131.193 74.2742 120.54 92.6812L39.7161 231.884C35.3159 239.016 33 247.53 33 256.043Z",fill:"#6363F1"}),Q.createElement("path",{d:"M480 256.058C480 247.539 477.684 239.021 473.516 231.883L393.849 94.6596C379.028 69.3331 347.995 56.4396 317.888 66.34C302.603 71.4053 290.329 82.6871 282.224 96.5015L264.391 127.354L339.194 256.058L260.223 392.131L241.232 424.825C235.443 434.495 228.032 442.553 219 449H227.106H340.815C362.122 449 381.807 437.718 392.46 419.299L473.284 280.003C477.684 272.866 480 264.577 480 256.058Z",fill:"#6363F1"})),oC=()=>Q.createElement("svg",{className:cr(),xmlns:"http://www.w3.org/2000/svg",width:"2500",height:"2500",viewBox:"0 0 256 256"},Q.createElement("path",{fill:"#FFE812",d:"M256 236c0 11.046-8.954 20-20 20H20c-11.046 0-20-8.954-20-20V20C0 8.954 8.954 0 20 0h216c11.046 0 20 8.954 20 20v216z"}),Q.createElement("path",{d:"M128 36C70.562 36 24 72.713 24 118c0 29.279 19.466 54.97 48.748 69.477-1.593 5.494-10.237 35.344-10.581 37.689 0 0-.207 1.762.934 2.434s2.483.15 2.483.15c3.272-.457 37.943-24.811 43.944-29.04 5.995.849 12.168 1.29 18.472 1.29 57.438 0 104-36.712 104-82 0-45.287-46.562-82-104-82z"}),Q.createElement("path",{fill:"#FFE812",d:"M70.5 146.625c-3.309 0-6-2.57-6-5.73V105.25h-9.362c-3.247 0-5.888-2.636-5.888-5.875s2.642-5.875 5.888-5.875h30.724c3.247 0 5.888 2.636 5.888 5.875s-2.642 5.875-5.888 5.875H76.5v35.645c0 3.16-2.691 5.73-6 5.73zM123.112 146.547c-2.502 0-4.416-1.016-4.993-2.65l-2.971-7.778-18.296-.001-2.973 7.783c-.575 1.631-2.488 2.646-4.99 2.646a9.155 9.155 0 0 1-3.814-.828c-1.654-.763-3.244-2.861-1.422-8.52l14.352-37.776c1.011-2.873 4.082-5.833 7.99-5.922 3.919.088 6.99 3.049 8.003 5.928l14.346 37.759c1.826 5.672.236 7.771-1.418 8.532a9.176 9.176 0 0 1-3.814.827c-.001 0 0 0 0 0zm-11.119-21.056L106 108.466l-5.993 17.025h11.986zM138 145.75c-3.171 0-5.75-2.468-5.75-5.5V99.5c0-3.309 2.748-6 6.125-6s6.125 2.691 6.125 6v35.25h12.75c3.171 0 5.75 2.468 5.75 5.5s-2.579 5.5-5.75 5.5H138zM171.334 146.547c-3.309 0-6-2.691-6-6V99.5c0-3.309 2.691-6 6-6s6 2.691 6 6v12.896l16.74-16.74c.861-.861 2.044-1.335 3.328-1.335 1.498 0 3.002.646 4.129 1.772 1.051 1.05 1.678 2.401 1.764 3.804.087 1.415-.384 2.712-1.324 3.653l-13.673 13.671 14.769 19.566a5.951 5.951 0 0 1 1.152 4.445 5.956 5.956 0 0 1-2.328 3.957 5.94 5.94 0 0 1-3.609 1.211 5.953 5.953 0 0 1-4.793-2.385l-14.071-18.644-2.082 2.082v13.091a6.01 6.01 0 0 1-6.002 6.003z"}));function lC({supabaseClient:e,socialLayout:t="vertical",providers:r=["github","google","azure"],providerScopes:n,queryParams:i,redirectTo:a,onlyThirdPartyProviders:o=!0,view:l="sign_in",i18n:u,appearance:f}){const[d,m]=ie.useState(!1),[p,v]=ie.useState(""),x=t==="vertical",_=l==="magic_link"?"sign_in":l,S=async k=>{m(!0);const{error:y}=await e.auth.signInWithOAuth({provider:k,options:{redirectTo:a,scopes:n==null?void 0:n[k],queryParams:i}});y&&v(y.message),m(!1)};function w(k){const y=k.toLowerCase();return k.charAt(0).toUpperCase()+y.slice(1)}return Q.createElement(Q.Fragment,null,r&&r.length>0&&Q.createElement(Q.Fragment,null,Q.createElement(Jn,{gap:"large",direction:"vertical",appearance:f},Q.createElement(Jn,{direction:x?"vertical":"horizontal",gap:x?"small":"medium",appearance:f},r.map(k=>{var y;return Q.createElement(lo,{key:k,color:"default",loading:d,onClick:()=>S(k),appearance:f},Q.createElement(H3,{provider:k}),x&&I3((y=u==null?void 0:u[_])==null?void 0:y.social_provider_text,{provider:w(k)}))}))),!o&&Q.createElement(U3,{appearance:f})))}function wg({authView:e="sign_in",defaultEmail:t="",defaultPassword:r="",setAuthView:n=()=>{},setDefaultEmail:i=x=>{},setDefaultPassword:a=x=>{},supabaseClient:o,showLinks:l=!1,redirectTo:u,additionalData:f,magicLink:d,i18n:m,appearance:p,children:v}){var x,_,S,w;const k=ie.useRef(!0),[y,b]=ie.useState(t),[O,R]=ie.useState(r),[C,z]=ie.useState(""),[M,K]=ie.useState(!1),[G,X]=ie.useState("");ie.useEffect(()=>(k.current=!0,b(t),R(r),()=>{k.current=!1}),[e]);const Y=async me=>{var ge;switch(me.preventDefault(),z(""),K(!0),e){case"sign_in":const{error:J}=await o.auth.signInWithPassword({email:y,password:O});J&&z(J.message);break;case"sign_up":let q={emailRedirectTo:u};f&&(q.data=f);const{data:{user:ce,session:_e},error:N}=await o.auth.signUp({email:y,password:O,options:q});N?z(N.message):ce&&!_e&&X((ge=m==null?void 0:m.sign_up)==null?void 0:ge.confirmation_text);break}k.current&&K(!1)},de=me=>{i(y),a(O),n(me)},he=m==null?void 0:m[e];return Q.createElement("form",{id:e==="sign_in"?"auth-sign-in":"auth-sign-up",onSubmit:Y,autoComplete:"on",style:{width:"100%"}},Q.createElement(Jn,{direction:"vertical",gap:"large",appearance:p},Q.createElement(Jn,{direction:"vertical",gap:"large",appearance:p},Q.createElement("div",null,Q.createElement(ia,{htmlFor:"email",appearance:p},he==null?void 0:he.email_label),Q.createElement(na,{id:"email",type:"email",name:"email",placeholder:he==null?void 0:he.email_input_placeholder,defaultValue:y,onChange:me=>b(me.target.value),autoComplete:"email",appearance:p})),Q.createElement("div",null,Q.createElement(ia,{htmlFor:"password",appearance:p},he==null?void 0:he.password_label),Q.createElement(na,{id:"password",type:"password",name:"password",placeholder:he==null?void 0:he.password_input_placeholder,defaultValue:O,onChange:me=>R(me.target.value),autoComplete:e==="sign_in"?"current-password":"new-password",appearance:p})),v),Q.createElement(lo,{type:"submit",color:"primary",loading:M,appearance:p},M?he==null?void 0:he.loading_button_label:he==null?void 0:he.button_label),l&&Q.createElement(Jn,{direction:"vertical",gap:"small",appearance:p},e===Ot.SIGN_IN&&d&&Q.createElement(Fa,{href:"#auth-magic-link",onClick:me=>{me.preventDefault(),n(Ot.MAGIC_LINK)},appearance:p},(x=m==null?void 0:m.magic_link)==null?void 0:x.link_text),e===Ot.SIGN_IN&&Q.createElement(Fa,{href:"#auth-forgot-password",onClick:me=>{me.preventDefault(),n(Ot.FORGOTTEN_PASSWORD)},appearance:p},(_=m==null?void 0:m.forgotten_password)==null?void 0:_.link_text),e===Ot.SIGN_IN?Q.createElement(Fa,{href:"#auth-sign-up",onClick:me=>{me.preventDefault(),de(Ot.SIGN_UP)},appearance:p},(S=m==null?void 0:m.sign_up)==null?void 0:S.link_text):Q.createElement(Fa,{href:"#auth-sign-in",onClick:me=>{me.preventDefault(),de(Ot.SIGN_IN)},appearance:p},(w=m==null?void 0:m.sign_in)==null?void 0:w.link_text))),G&&Q.createElement(Qn,{appearance:p},G),C&&Q.createElement(Qn,{color:"danger",appearance:p},C))}function oy({setAuthView:e=()=>{},supabaseClient:t,redirectTo:r,i18n:n,appearance:i,showLinks:a=!1}){var o;const[l,u]=ie.useState(""),[f,d]=ie.useState(""),[m,p]=ie.useState(""),[v,x]=ie.useState(!1),_=async w=>{var k;w.preventDefault(),d(""),p(""),x(!0);const{error:y}=await t.auth.resetPasswordForEmail(l,{redirectTo:r});y?d(y.message):p((k=n==null?void 0:n.forgotten_password)==null?void 0:k.confirmation_text),x(!1)},S=n==null?void 0:n.forgotten_password;return Q.createElement("form",{id:"auth-forgot-password",onSubmit:_},Q.createElement(Jn,{direction:"vertical",gap:"large",appearance:i},Q.createElement(Jn,{gap:"large",direction:"vertical",appearance:i},Q.createElement("div",null,Q.createElement(ia,{htmlFor:"email",appearance:i},S==null?void 0:S.email_label),Q.createElement(na,{id:"email",name:"email",type:"email",autoFocus:!0,placeholder:S==null?void 0:S.email_input_placeholder,onChange:w=>u(w.target.value),appearance:i})),Q.createElement(lo,{type:"submit",color:"primary",loading:v,appearance:i},v?S==null?void 0:S.loading_button_label:S==null?void 0:S.button_label),a&&Q.createElement(Fa,{href:"#auth-sign-in",onClick:w=>{w.preventDefault(),e(Ot.SIGN_IN)},appearance:i},(o=n==null?void 0:n.sign_in)==null?void 0:o.link_text),m&&Q.createElement(Qn,{appearance:i},m),f&&Q.createElement(Qn,{color:"danger",appearance:i},f))))}function ly({supabaseClient:e,i18n:t,appearance:r}){const[n,i]=ie.useState(""),[a,o]=ie.useState(""),[l,u]=ie.useState(""),[f,d]=ie.useState(!1),m=async v=>{var x;v.preventDefault(),o(""),u(""),d(!0);const{error:_}=await e.auth.updateUser({password:n});_?o(_.message):u((x=t==null?void 0:t.update_password)==null?void 0:x.confirmation_text),d(!1)},p=t==null?void 0:t.update_password;return Q.createElement("form",{id:"auth-update-password",onSubmit:m},Q.createElement(Jn,{gap:"large",direction:"vertical",appearance:r},Q.createElement("div",null,Q.createElement(ia,{htmlFor:"password",appearance:r},p==null?void 0:p.password_label),Q.createElement(na,{id:"password",name:"password",placeholder:p==null?void 0:p.password_input_placeholder,type:"password",autoFocus:!0,onChange:v=>i(v.target.value),appearance:r})),Q.createElement(lo,{type:"submit",color:"primary",loading:f,appearance:r},f?p==null?void 0:p.loading_button_label:p==null?void 0:p.button_label),l&&Q.createElement(Qn,{appearance:r},l),a&&Q.createElement(Qn,{color:"danger",appearance:r},a)))}function cC({setAuthView:e=()=>{},supabaseClient:t,otpType:r="email",i18n:n,appearance:i,showLinks:a=!1}){var o;const[l,u]=ie.useState(""),[f,d]=ie.useState(""),[m,p]=ie.useState(""),[v,x]=ie.useState(""),[_,S]=ie.useState(""),[w,k]=ie.useState(!1),y=async O=>{O.preventDefault(),x(""),S(""),k(!0);let R={email:l,token:m,type:r};["sms","phone_change"].includes(r)&&(R={phone:f,token:m,type:r});const{error:C}=await t.auth.verifyOtp(R);C&&x(C.message),k(!1)},b=n==null?void 0:n.verify_otp;return Q.createElement("form",{id:"auth-magic-link",onSubmit:y},Q.createElement(Jn,{gap:"large",direction:"vertical",appearance:i},["sms","phone_change"].includes(r)?Q.createElement("div",null,Q.createElement(ia,{htmlFor:"phone",appearance:i},b==null?void 0:b.phone_input_label),Q.createElement(na,{id:"phone",name:"phone",type:"text",autoFocus:!0,placeholder:b==null?void 0:b.phone_input_placeholder,onChange:O=>d(O.target.value),appearance:i})):Q.createElement("div",null,Q.createElement(ia,{htmlFor:"email",appearance:i},b==null?void 0:b.email_input_label),Q.createElement(na,{id:"email",name:"email",type:"email",autoFocus:!0,placeholder:b==null?void 0:b.email_input_placeholder,onChange:O=>u(O.target.value),appearance:i})),Q.createElement("div",null,Q.createElement(ia,{htmlFor:"token",appearance:i},b==null?void 0:b.token_input_label),Q.createElement(na,{id:"token",name:"token",type:"text",placeholder:b==null?void 0:b.token_input_placeholder,onChange:O=>p(O.target.value),appearance:i})),Q.createElement(lo,{color:"primary",type:"submit",loading:w,appearance:i},w?b==null?void 0:b.loading_button_label:b==null?void 0:b.button_label),a&&Q.createElement(Fa,{href:"#auth-sign-in",onClick:O=>{O.preventDefault(),e(Ot.SIGN_IN)},appearance:i},(o=n==null?void 0:n.sign_in)==null?void 0:o.link_text),_&&Q.createElement(Qn,{appearance:i},_),v&&Q.createElement(Qn,{color:"danger",appearance:i},v)))}const cy=ie.createContext({user:null,session:null}),uC=e=>{const{supabaseClient:t}=e,[r,n]=ie.useState(null),[i,a]=ie.useState((r==null?void 0:r.user)??null);ie.useEffect(()=>{(async()=>{var u;const{data:f}=await t.auth.getSession();n(f.session),a(((u=f.session)==null?void 0:u.user)??null)})();const{data:l}=t.auth.onAuthStateChange(async(u,f)=>{n(f),a((f==null?void 0:f.user)??null)});return()=>{l==null||l.subscription.unsubscribe()}},[]);const o={session:r,user:i};return Q.createElement(cy.Provider,{value:o,...e})},fC=()=>{const e=ie.useContext(cy);if(e===void 0)throw new Error("useUser must be used within a UserContextProvider.");return e};function co({supabaseClient:e,socialLayout:t="vertical",providers:r,providerScopes:n,queryParams:i,view:a="sign_in",redirectTo:o,onlyThirdPartyProviders:l=!1,magicLink:u=!1,showLinks:f=!0,appearance:d,theme:m="default",localization:p={variables:{}},otpType:v="email",additionalData:x,children:_}){const S=Uf(N3,p.variables??{}),[w,k]=ie.useState(a),[y,b]=ie.useState(""),[O,R]=ie.useState(""),C=w==="sign_in"||w==="sign_up"||w==="magic_link";ie.useEffect(()=>{var K,G;iy({theme:Uf(((K=d==null?void 0:d.theme)==null?void 0:K.default)??{},((G=d==null?void 0:d.variables)==null?void 0:G.default)??{})})},[d]);const z=({children:K})=>{var G;return Q.createElement("div",{className:m!=="default"?O3(Uf(d==null?void 0:d.theme[m],((G=d==null?void 0:d.variables)==null?void 0:G[m])??{})):""},C&&Q.createElement(lC,{appearance:d,supabaseClient:e,providers:r,providerScopes:n,queryParams:i,socialLayout:t,redirectTo:o,onlyThirdPartyProviders:l,i18n:S,view:w}),!l&&K)};ie.useEffect(()=>{const{data:K}=e.auth.onAuthStateChange(G=>{G==="PASSWORD_RECOVERY"?k("update_password"):G==="USER_UPDATED"&&k("sign_in")});return k(a),()=>K.subscription.unsubscribe()},[a]);const M={supabaseClient:e,setAuthView:k,defaultEmail:y,defaultPassword:O,setDefaultEmail:b,setDefaultPassword:R,redirectTo:o,magicLink:u,showLinks:f,i18n:S,appearance:d};switch(w){case Ot.SIGN_IN:return Q.createElement(z,null,Q.createElement(wg,{...M,authView:"sign_in"}));case Ot.SIGN_UP:return Q.createElement(z,null,Q.createElement(wg,{appearance:d,supabaseClient:e,authView:"sign_up",setAuthView:k,defaultEmail:y,defaultPassword:O,setDefaultEmail:b,setDefaultPassword:R,redirectTo:o,magicLink:u,showLinks:f,i18n:S,additionalData:x,children:_}));case Ot.FORGOTTEN_PASSWORD:return Q.createElement(z,null,Q.createElement(oy,{appearance:d,supabaseClient:e,setAuthView:k,redirectTo:o,showLinks:f,i18n:S}));case Ot.MAGIC_LINK:return Q.createElement(z,null,Q.createElement(sy,{appearance:d,supabaseClient:e,setAuthView:k,redirectTo:o,showLinks:f,i18n:S}));case Ot.UPDATE_PASSWORD:return Q.createElement(ly,{appearance:d,supabaseClient:e,i18n:S});case Ot.VERIFY_OTP:return Q.createElement(cC,{appearance:d,supabaseClient:e,otpType:v,i18n:S});default:return null}}co.ForgottenPassword=oy;co.UpdatePassword=ly;co.MagicLink=sy;co.UserContextProvider=uC;co.useUser=fC;Pi({borderRadius:"12px",boxShadow:"rgba(100, 100, 111, 0.2) 0px 7px 29px 0px",width:"360px",padding:"28px 32px"});function hC(e,t){const r=ie.useRef(t);ie.useEffect(function(){t!==r.current&&e.attributionControl!=null&&(r.current!=null&&e.attributionControl.removeAttribution(r.current),t!=null&&e.attributionControl.addAttribution(t)),r.current=t},[e,t])}const dC=1;function pC(e){return Object.freeze({__version:dC,map:e})}function mC(e,t){return Object.freeze({...e,...t})}const uy=ie.createContext(null),fy=uy.Provider;function hy(){const e=ie.useContext(uy);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function gC(e){function t(r,n){const{instance:i,context:a}=e(r).current;return ie.useImperativeHandle(n,()=>i),r.children==null?null:Q.createElement(fy,{value:a},r.children)}return ie.forwardRef(t)}function vC(e){function t(r,n){const{instance:i}=e(r).current;return ie.useImperativeHandle(n,()=>i),null}return ie.forwardRef(t)}function dy(e,t){const r=ie.useRef();ie.useEffect(function(){return t!=null&&e.instance.on(t),r.current=t,function(){r.current!=null&&e.instance.off(r.current),r.current=null}},[e,t])}function kp(e,t){const r=e.pane??t.pane;return r?{...e,pane:r}:e}var cd={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(r,n){n(t)})(Yw,function(r){var n="1.9.4";function i(s){var c,h,g,E;for(h=1,g=arguments.length;h<g;h++){E=arguments[h];for(c in E)s[c]=E[c]}return s}var a=Object.create||function(){function s(){}return function(c){return s.prototype=c,new s}}();function o(s,c){var h=Array.prototype.slice;if(s.bind)return s.bind.apply(s,h.call(arguments,1));var g=h.call(arguments,2);return function(){return s.apply(c,g.length?g.concat(h.call(arguments)):arguments)}}var l=0;function u(s){return"_leaflet_id"in s||(s._leaflet_id=++l),s._leaflet_id}function f(s,c,h){var g,E,P,V;return V=function(){g=!1,E&&(P.apply(h,E),E=!1)},P=function(){g?E=arguments:(s.apply(h,arguments),setTimeout(V,c),g=!0)},P}function d(s,c,h){var g=c[1],E=c[0],P=g-E;return s===g&&h?s:((s-E)%P+P)%P+E}function m(){return!1}function p(s,c){if(c===!1)return s;var h=Math.pow(10,c===void 0?6:c);return Math.round(s*h)/h}function v(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function x(s){return v(s).split(/\s+/)}function _(s,c){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?a(s.options):{});for(var h in c)s.options[h]=c[h];return s.options}function S(s,c,h){var g=[];for(var E in s)g.push(encodeURIComponent(h?E.toUpperCase():E)+"="+encodeURIComponent(s[E]));return(!c||c.indexOf("?")===-1?"?":"&")+g.join("&")}var w=/\{ *([\w_ -]+) *\}/g;function k(s,c){return s.replace(w,function(h,g){var E=c[g];if(E===void 0)throw new Error("No value provided for variable "+h);return typeof E=="function"&&(E=E(c)),E})}var y=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function b(s,c){for(var h=0;h<s.length;h++)if(s[h]===c)return h;return-1}var O="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function R(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var C=0;function z(s){var c=+new Date,h=Math.max(0,16-(c-C));return C=c+h,window.setTimeout(s,h)}var M=window.requestAnimationFrame||R("RequestAnimationFrame")||z,K=window.cancelAnimationFrame||R("CancelAnimationFrame")||R("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function G(s,c,h){if(h&&M===z)s.call(c);else return M.call(window,o(s,c))}function X(s){s&&K.call(window,s)}var Y={__proto__:null,extend:i,create:a,bind:o,get lastId(){return l},stamp:u,throttle:f,wrapNum:d,falseFn:m,formatNum:p,trim:v,splitWords:x,setOptions:_,getParamString:S,template:k,isArray:y,indexOf:b,emptyImageUrl:O,requestFn:M,cancelFn:K,requestAnimFrame:G,cancelAnimFrame:X};function de(){}de.extend=function(s){var c=function(){_(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},h=c.__super__=this.prototype,g=a(h);g.constructor=c,c.prototype=g;for(var E in this)Object.prototype.hasOwnProperty.call(this,E)&&E!=="prototype"&&E!=="__super__"&&(c[E]=this[E]);return s.statics&&i(c,s.statics),s.includes&&(he(s.includes),i.apply(null,[g].concat(s.includes))),i(g,s),delete g.statics,delete g.includes,g.options&&(g.options=h.options?a(h.options):{},i(g.options,s.options)),g._initHooks=[],g.callInitHooks=function(){if(!this._initHooksCalled){h.callInitHooks&&h.callInitHooks.call(this),this._initHooksCalled=!0;for(var P=0,V=g._initHooks.length;P<V;P++)g._initHooks[P].call(this)}},c},de.include=function(s){var c=this.prototype.options;return i(this.prototype,s),s.options&&(this.prototype.options=c,this.mergeOptions(s.options)),this},de.mergeOptions=function(s){return i(this.prototype.options,s),this},de.addInitHook=function(s){var c=Array.prototype.slice.call(arguments,1),h=typeof s=="function"?s:function(){this[s].apply(this,c)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(h),this};function he(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=y(s)?s:[s];for(var c=0;c<s.length;c++)s[c]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var me={on:function(s,c,h){if(typeof s=="object")for(var g in s)this._on(g,s[g],c);else{s=x(s);for(var E=0,P=s.length;E<P;E++)this._on(s[E],c,h)}return this},off:function(s,c,h){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var g in s)this._off(g,s[g],c);else{s=x(s);for(var E=arguments.length===1,P=0,V=s.length;P<V;P++)E?this._off(s[P]):this._off(s[P],c,h)}return this},_on:function(s,c,h,g){if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}if(this._listens(s,c,h)===!1){h===this&&(h=void 0);var E={fn:c,ctx:h};g&&(E.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(E)}},_off:function(s,c,h){var g,E,P;if(this._events&&(g=this._events[s],!!g)){if(arguments.length===1){if(this._firingCount)for(E=0,P=g.length;E<P;E++)g[E].fn=m;delete this._events[s];return}if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}var V=this._listens(s,c,h);if(V!==!1){var re=g[V];this._firingCount&&(re.fn=m,this._events[s]=g=g.slice()),g.splice(V,1)}}},fire:function(s,c,h){if(!this.listens(s,h))return this;var g=i({},c,{type:s,target:this,sourceTarget:c&&c.sourceTarget||this});if(this._events){var E=this._events[s];if(E){this._firingCount=this._firingCount+1||1;for(var P=0,V=E.length;P<V;P++){var re=E[P],ue=re.fn;re.once&&this.off(s,ue,re.ctx),ue.call(re.ctx||this,g)}this._firingCount--}}return h&&this._propagateEvent(g),this},listens:function(s,c,h,g){typeof s!="string"&&console.warn('"string" type argument expected');var E=c;typeof c!="function"&&(g=!!c,E=void 0,h=void 0);var P=this._events&&this._events[s];if(P&&P.length&&this._listens(s,E,h)!==!1)return!0;if(g){for(var V in this._eventParents)if(this._eventParents[V].listens(s,c,h,g))return!0}return!1},_listens:function(s,c,h){if(!this._events)return!1;var g=this._events[s]||[];if(!c)return!!g.length;h===this&&(h=void 0);for(var E=0,P=g.length;E<P;E++)if(g[E].fn===c&&g[E].ctx===h)return E;return!1},once:function(s,c,h){if(typeof s=="object")for(var g in s)this._on(g,s[g],c,!0);else{s=x(s);for(var E=0,P=s.length;E<P;E++)this._on(s[E],c,h,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[u(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[u(s)],this},_propagateEvent:function(s){for(var c in this._eventParents)this._eventParents[c].fire(s.type,i({layer:s.target,propagatedFrom:s.target},s),!0)}};me.addEventListener=me.on,me.removeEventListener=me.clearAllEventListeners=me.off,me.addOneTimeEventListener=me.once,me.fireEvent=me.fire,me.hasEventListeners=me.listens;var ge=de.extend(me);function J(s,c,h){this.x=h?Math.round(s):s,this.y=h?Math.round(c):c}var q=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};J.prototype={clone:function(){return new J(this.x,this.y)},add:function(s){return this.clone()._add(ce(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(ce(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new J(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new J(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=q(this.x),this.y=q(this.y),this},distanceTo:function(s){s=ce(s);var c=s.x-this.x,h=s.y-this.y;return Math.sqrt(c*c+h*h)},equals:function(s){return s=ce(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=ce(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+p(this.x)+", "+p(this.y)+")"}};function ce(s,c,h){return s instanceof J?s:y(s)?new J(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new J(s.x,s.y):new J(s,c,h)}function _e(s,c){if(s)for(var h=c?[s,c]:s,g=0,E=h.length;g<E;g++)this.extend(h[g])}_e.prototype={extend:function(s){var c,h;if(!s)return this;if(s instanceof J||typeof s[0]=="number"||"x"in s)c=h=ce(s);else if(s=N(s),c=s.min,h=s.max,!c||!h)return this;return!this.min&&!this.max?(this.min=c.clone(),this.max=h.clone()):(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(h.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(h.y,this.max.y)),this},getCenter:function(s){return ce((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return ce(this.min.x,this.max.y)},getTopRight:function(){return ce(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var c,h;return typeof s[0]=="number"||s instanceof J?s=ce(s):s=N(s),s instanceof _e?(c=s.min,h=s.max):c=h=s,c.x>=this.min.x&&h.x<=this.max.x&&c.y>=this.min.y&&h.y<=this.max.y},intersects:function(s){s=N(s);var c=this.min,h=this.max,g=s.min,E=s.max,P=E.x>=c.x&&g.x<=h.x,V=E.y>=c.y&&g.y<=h.y;return P&&V},overlaps:function(s){s=N(s);var c=this.min,h=this.max,g=s.min,E=s.max,P=E.x>c.x&&g.x<h.x,V=E.y>c.y&&g.y<h.y;return P&&V},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var c=this.min,h=this.max,g=Math.abs(c.x-h.x)*s,E=Math.abs(c.y-h.y)*s;return N(ce(c.x-g,c.y-E),ce(h.x+g,h.y+E))},equals:function(s){return s?(s=N(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function N(s,c){return!s||s instanceof _e?s:new _e(s,c)}function Z(s,c){if(s)for(var h=c?[s,c]:s,g=0,E=h.length;g<E;g++)this.extend(h[g])}Z.prototype={extend:function(s){var c=this._southWest,h=this._northEast,g,E;if(s instanceof W)g=s,E=s;else if(s instanceof Z){if(g=s._southWest,E=s._northEast,!g||!E)return this}else return s?this.extend(te(s)||H(s)):this;return!c&&!h?(this._southWest=new W(g.lat,g.lng),this._northEast=new W(E.lat,E.lng)):(c.lat=Math.min(g.lat,c.lat),c.lng=Math.min(g.lng,c.lng),h.lat=Math.max(E.lat,h.lat),h.lng=Math.max(E.lng,h.lng)),this},pad:function(s){var c=this._southWest,h=this._northEast,g=Math.abs(c.lat-h.lat)*s,E=Math.abs(c.lng-h.lng)*s;return new Z(new W(c.lat-g,c.lng-E),new W(h.lat+g,h.lng+E))},getCenter:function(){return new W((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new W(this.getNorth(),this.getWest())},getSouthEast:function(){return new W(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof W||"lat"in s?s=te(s):s=H(s);var c=this._southWest,h=this._northEast,g,E;return s instanceof Z?(g=s.getSouthWest(),E=s.getNorthEast()):g=E=s,g.lat>=c.lat&&E.lat<=h.lat&&g.lng>=c.lng&&E.lng<=h.lng},intersects:function(s){s=H(s);var c=this._southWest,h=this._northEast,g=s.getSouthWest(),E=s.getNorthEast(),P=E.lat>=c.lat&&g.lat<=h.lat,V=E.lng>=c.lng&&g.lng<=h.lng;return P&&V},overlaps:function(s){s=H(s);var c=this._southWest,h=this._northEast,g=s.getSouthWest(),E=s.getNorthEast(),P=E.lat>c.lat&&g.lat<h.lat,V=E.lng>c.lng&&g.lng<h.lng;return P&&V},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,c){return s?(s=H(s),this._southWest.equals(s.getSouthWest(),c)&&this._northEast.equals(s.getNorthEast(),c)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function H(s,c){return s instanceof Z?s:new Z(s,c)}function W(s,c,h){if(isNaN(s)||isNaN(c))throw new Error("Invalid LatLng object: ("+s+", "+c+")");this.lat=+s,this.lng=+c,h!==void 0&&(this.alt=+h)}W.prototype={equals:function(s,c){if(!s)return!1;s=te(s);var h=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return h<=(c===void 0?1e-9:c)},toString:function(s){return"LatLng("+p(this.lat,s)+", "+p(this.lng,s)+")"},distanceTo:function(s){return Te.distance(this,te(s))},wrap:function(){return Te.wrapLatLng(this)},toBounds:function(s){var c=180*s/40075017,h=c/Math.cos(Math.PI/180*this.lat);return H([this.lat-c,this.lng-h],[this.lat+c,this.lng+h])},clone:function(){return new W(this.lat,this.lng,this.alt)}};function te(s,c,h){return s instanceof W?s:y(s)&&typeof s[0]!="object"?s.length===3?new W(s[0],s[1],s[2]):s.length===2?new W(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new W(s.lat,"lng"in s?s.lng:s.lon,s.alt):c===void 0?null:new W(s,c,h)}var xe={latLngToPoint:function(s,c){var h=this.projection.project(s),g=this.scale(c);return this.transformation._transform(h,g)},pointToLatLng:function(s,c){var h=this.scale(c),g=this.transformation.untransform(s,h);return this.projection.unproject(g)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var c=this.projection.bounds,h=this.scale(s),g=this.transformation.transform(c.min,h),E=this.transformation.transform(c.max,h);return new _e(g,E)},infinite:!1,wrapLatLng:function(s){var c=this.wrapLng?d(s.lng,this.wrapLng,!0):s.lng,h=this.wrapLat?d(s.lat,this.wrapLat,!0):s.lat,g=s.alt;return new W(h,c,g)},wrapLatLngBounds:function(s){var c=s.getCenter(),h=this.wrapLatLng(c),g=c.lat-h.lat,E=c.lng-h.lng;if(g===0&&E===0)return s;var P=s.getSouthWest(),V=s.getNorthEast(),re=new W(P.lat-g,P.lng-E),ue=new W(V.lat-g,V.lng-E);return new Z(re,ue)}},Te=i({},xe,{wrapLng:[-180,180],R:6371e3,distance:function(s,c){var h=Math.PI/180,g=s.lat*h,E=c.lat*h,P=Math.sin((c.lat-s.lat)*h/2),V=Math.sin((c.lng-s.lng)*h/2),re=P*P+Math.cos(g)*Math.cos(E)*V*V,ue=2*Math.atan2(Math.sqrt(re),Math.sqrt(1-re));return this.R*ue}}),ee=6378137,oe={R:ee,MAX_LATITUDE:85.0511287798,project:function(s){var c=Math.PI/180,h=this.MAX_LATITUDE,g=Math.max(Math.min(h,s.lat),-h),E=Math.sin(g*c);return new J(this.R*s.lng*c,this.R*Math.log((1+E)/(1-E))/2)},unproject:function(s){var c=180/Math.PI;return new W((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*c,s.x*c/this.R)},bounds:function(){var s=ee*Math.PI;return new _e([-s,-s],[s,s])}()};function Ae(s,c,h,g){if(y(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=c,this._c=h,this._d=g}Ae.prototype={transform:function(s,c){return this._transform(s.clone(),c)},_transform:function(s,c){return c=c||1,s.x=c*(this._a*s.x+this._b),s.y=c*(this._c*s.y+this._d),s},untransform:function(s,c){return c=c||1,new J((s.x/c-this._b)/this._a,(s.y/c-this._d)/this._c)}};function D(s,c,h,g){return new Ae(s,c,h,g)}var Ze=i({},Te,{code:"EPSG:3857",projection:oe,transformation:function(){var s=.5/(Math.PI*oe.R);return D(s,.5,-s,.5)}()}),qe=i({},Ze,{code:"EPSG:900913"});function nt(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function ze(s,c){var h="",g,E,P,V,re,ue;for(g=0,P=s.length;g<P;g++){for(re=s[g],E=0,V=re.length;E<V;E++)ue=re[E],h+=(E?"L":"M")+ue.x+" "+ue.y;h+=c?Fe.svg?"z":"x":""}return h||"M0 0"}var Ee=document.documentElement.style,it="ActiveXObject"in window,Qt=it&&!document.addEventListener,ur="msLaunchUri"in navigator&&!("documentMode"in document),fr=an("webkit"),yn=an("android"),Ir=an("android 2")||an("android 3"),Vt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Wr=yn&&an("Google")&&Vt<537&&!("AudioNode"in window),rn=!!window.opera,Ri=!ur&&an("chrome"),Gt=an("gecko")&&!fr&&!rn&&!it,nn=!Ri&&an("safari"),Ve=an("phantom"),mt="OTransition"in Ee,Nr=navigator.platform.indexOf("Win")===0,Et=it&&"transition"in Ee,wn="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ir,po="MozPerspective"in Ee,S0=!window.L_DISABLE_3D&&(Et||wn||po)&&!mt&&!Ve,pa=typeof orientation<"u"||an("mobile"),sc=pa&&fr,oc=pa&&wn,mo=!window.PointerEvent&&window.MSPointerEvent,lc=!!(window.PointerEvent||mo),cc="ontouchstart"in window||!!window.TouchEvent,ns=!window.L_NO_TOUCH&&(cc||lc),T0=pa&&rn,C0=pa&&Gt,b0=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,A0=function(){var s=!1;try{var c=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",m,c),window.removeEventListener("testPassiveEventSupport",m,c)}catch{}return s}(),P0=function(){return!!document.createElement("canvas").getContext}(),go=!!(document.createElementNS&&nt("svg").createSVGRect),O0=!!go&&function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),R0=!go&&function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var c=s.firstChild;return c.style.behavior="url(#default#VML)",c&&typeof c.adj=="object"}catch{return!1}}(),vo=navigator.platform.indexOf("Mac")===0,F0=navigator.platform.indexOf("Linux")===0;function an(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var Fe={ie:it,ielt9:Qt,edge:ur,webkit:fr,android:yn,android23:Ir,androidStock:Wr,opera:rn,chrome:Ri,gecko:Gt,safari:nn,phantom:Ve,opera12:mt,win:Nr,ie3d:Et,webkit3d:wn,gecko3d:po,any3d:S0,mobile:pa,mobileWebkit:sc,mobileWebkit3d:oc,msPointer:mo,pointer:lc,touch:ns,touchNative:cc,mobileOpera:T0,mobileGecko:C0,retina:b0,passiveEvents:A0,canvas:P0,svg:go,vml:R0,inlineSvg:O0,mac:vo,linux:F0},A=Fe.msPointer?"MSPointerDown":"pointerdown",B=Fe.msPointer?"MSPointerMove":"pointermove",F=Fe.msPointer?"MSPointerUp":"pointerup",I=Fe.msPointer?"MSPointerCancel":"pointercancel",j={touchstart:A,touchmove:B,touchend:F,touchcancel:I},U={touchstart:Ce,touchmove:ke,touchend:ke,touchcancel:ke},ne={},fe=!1;function ae(s,c,h){return c==="touchstart"&&Pe(),U[c]?(h=U[c].bind(this,h),s.addEventListener(j[c],h,!1),h):(console.warn("wrong event specified:",c),m)}function se(s,c,h){if(!j[c]){console.warn("wrong event specified:",c);return}s.removeEventListener(j[c],h,!1)}function le(s){ne[s.pointerId]=s}function ye(s){ne[s.pointerId]&&(ne[s.pointerId]=s)}function Se(s){delete ne[s.pointerId]}function Pe(){fe||(document.addEventListener(A,le,!0),document.addEventListener(B,ye,!0),document.addEventListener(F,Se,!0),document.addEventListener(I,Se,!0),fe=!0)}function ke(s,c){if(c.pointerType!==(c.MSPOINTER_TYPE_MOUSE||"mouse")){c.touches=[];for(var h in ne)c.touches.push(ne[h]);c.changedTouches=[c],s(c)}}function Ce(s,c){c.MSPOINTER_TYPE_TOUCH&&c.pointerType===c.MSPOINTER_TYPE_TOUCH&&er(c),ke(s,c)}function je(s){var c={},h,g;for(g in s)h=s[g],c[g]=h&&h.bind?h.bind(s):h;return s=c,c.type="dblclick",c.detail=2,c.isTrusted=!1,c._simulated=!0,c}var ft=200;function ht(s,c){s.addEventListener("dblclick",c);var h=0,g;function E(P){if(P.detail!==1){g=P.detail;return}if(!(P.pointerType==="mouse"||P.sourceCapabilities&&!P.sourceCapabilities.firesTouchEvents)){var V=Qp(P);if(!(V.some(function(ue){return ue instanceof HTMLLabelElement&&ue.attributes.for})&&!V.some(function(ue){return ue instanceof HTMLInputElement||ue instanceof HTMLSelectElement}))){var re=Date.now();re-h<=ft?(g++,g===2&&c(je(P))):g=1,h=re}}}return s.addEventListener("click",E),{dblclick:c,simDblclick:E}}function Zt(s,c){s.removeEventListener("dblclick",c.dblclick),s.removeEventListener("click",c.simDblclick)}var ii=hc(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),kn=hc(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Fi=kn==="webkitTransition"||kn==="OTransition"?kn+"End":"transitionend";function zn(s){return typeof s=="string"?document.getElementById(s):s}function ai(s,c){var h=s.style[c]||s.currentStyle&&s.currentStyle[c];if((!h||h==="auto")&&document.defaultView){var g=document.defaultView.getComputedStyle(s,null);h=g?g[c]:null}return h==="auto"?null:h}function $e(s,c,h){var g=document.createElement(s);return g.className=c||"",h&&h.appendChild(g),g}function _t(s){var c=s.parentNode;c&&c.removeChild(s)}function uc(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function is(s){var c=s.parentNode;c&&c.lastChild!==s&&c.appendChild(s)}function as(s){var c=s.parentNode;c&&c.firstChild!==s&&c.insertBefore(s,c.firstChild)}function L0(s,c){if(s.classList!==void 0)return s.classList.contains(c);var h=fc(s);return h.length>0&&new RegExp("(^|\\s)"+c+"(\\s|$)").test(h)}function Ge(s,c){if(s.classList!==void 0)for(var h=x(c),g=0,E=h.length;g<E;g++)s.classList.add(h[g]);else if(!L0(s,c)){var P=fc(s);I0(s,(P?P+" ":"")+c)}}function At(s,c){s.classList!==void 0?s.classList.remove(c):I0(s,v((" "+fc(s)+" ").replace(" "+c+" "," ")))}function I0(s,c){s.className.baseVal===void 0?s.className=c:s.className.baseVal=c}function fc(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function sn(s,c){"opacity"in s.style?s.style.opacity=c:"filter"in s.style&&rw(s,c)}function rw(s,c){var h=!1,g="DXImageTransform.Microsoft.Alpha";try{h=s.filters.item(g)}catch{if(c===1)return}c=Math.round(c*100),h?(h.Enabled=c!==100,h.Opacity=c):s.style.filter+=" progid:"+g+"(opacity="+c+")"}function hc(s){for(var c=document.documentElement.style,h=0;h<s.length;h++)if(s[h]in c)return s[h];return!1}function ma(s,c,h){var g=c||new J(0,0);s.style[ii]=(Fe.ie3d?"translate("+g.x+"px,"+g.y+"px)":"translate3d("+g.x+"px,"+g.y+"px,0)")+(h?" scale("+h+")":"")}function Ft(s,c){s._leaflet_pos=c,Fe.any3d?ma(s,c):(s.style.left=c.x+"px",s.style.top=c.y+"px")}function ga(s){return s._leaflet_pos||new J(0,0)}var _o,xo,N0;if("onselectstart"in document)_o=function(){We(window,"selectstart",er)},xo=function(){ot(window,"selectstart",er)};else{var yo=hc(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);_o=function(){if(yo){var s=document.documentElement.style;N0=s[yo],s[yo]="none"}},xo=function(){yo&&(document.documentElement.style[yo]=N0,N0=void 0)}}function D0(){We(window,"dragstart",er)}function M0(){ot(window,"dragstart",er)}var dc,B0;function j0(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(pc(),dc=s,B0=s.style.outlineStyle,s.style.outlineStyle="none",We(window,"keydown",pc))}function pc(){dc&&(dc.style.outlineStyle=B0,dc=void 0,B0=void 0,ot(window,"keydown",pc))}function Yp(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function U0(s){var c=s.getBoundingClientRect();return{x:c.width/s.offsetWidth||1,y:c.height/s.offsetHeight||1,boundingClientRect:c}}var nw={__proto__:null,TRANSFORM:ii,TRANSITION:kn,TRANSITION_END:Fi,get:zn,getStyle:ai,create:$e,remove:_t,empty:uc,toFront:is,toBack:as,hasClass:L0,addClass:Ge,removeClass:At,setClass:I0,getClass:fc,setOpacity:sn,testProp:hc,setTransform:ma,setPosition:Ft,getPosition:ga,get disableTextSelection(){return _o},get enableTextSelection(){return xo},disableImageDrag:D0,enableImageDrag:M0,preventOutline:j0,restoreOutline:pc,getSizedParentNode:Yp,getScale:U0};function We(s,c,h,g){if(c&&typeof c=="object")for(var E in c)$0(s,E,c[E],h);else{c=x(c);for(var P=0,V=c.length;P<V;P++)$0(s,c[P],h,g)}return this}var $n="_leaflet_events";function ot(s,c,h,g){if(arguments.length===1)Jp(s),delete s[$n];else if(c&&typeof c=="object")for(var E in c)W0(s,E,c[E],h);else if(c=x(c),arguments.length===2)Jp(s,function(re){return b(c,re)!==-1});else for(var P=0,V=c.length;P<V;P++)W0(s,c[P],h,g);return this}function Jp(s,c){for(var h in s[$n]){var g=h.split(/\d/)[0];(!c||c(g))&&W0(s,g,null,null,h)}}var z0={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function $0(s,c,h,g){var E=c+u(h)+(g?"_"+u(g):"");if(s[$n]&&s[$n][E])return this;var P=function(re){return h.call(g||s,re||window.event)},V=P;!Fe.touchNative&&Fe.pointer&&c.indexOf("touch")===0?P=ae(s,c,P):Fe.touch&&c==="dblclick"?P=ht(s,P):"addEventListener"in s?c==="touchstart"||c==="touchmove"||c==="wheel"||c==="mousewheel"?s.addEventListener(z0[c]||c,P,Fe.passiveEvents?{passive:!1}:!1):c==="mouseenter"||c==="mouseleave"?(P=function(re){re=re||window.event,V0(s,re)&&V(re)},s.addEventListener(z0[c],P,!1)):s.addEventListener(c,V,!1):s.attachEvent("on"+c,P),s[$n]=s[$n]||{},s[$n][E]=P}function W0(s,c,h,g,E){E=E||c+u(h)+(g?"_"+u(g):"");var P=s[$n]&&s[$n][E];if(!P)return this;!Fe.touchNative&&Fe.pointer&&c.indexOf("touch")===0?se(s,c,P):Fe.touch&&c==="dblclick"?Zt(s,P):"removeEventListener"in s?s.removeEventListener(z0[c]||c,P,!1):s.detachEvent("on"+c,P),s[$n][E]=null}function va(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function H0(s){return $0(s,"wheel",va),this}function wo(s){return We(s,"mousedown touchstart dblclick contextmenu",va),s._leaflet_disable_click=!0,this}function er(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function _a(s){return er(s),va(s),this}function Qp(s){if(s.composedPath)return s.composedPath();for(var c=[],h=s.target;h;)c.push(h),h=h.parentNode;return c}function em(s,c){if(!c)return new J(s.clientX,s.clientY);var h=U0(c),g=h.boundingClientRect;return new J((s.clientX-g.left)/h.x-c.clientLeft,(s.clientY-g.top)/h.y-c.clientTop)}var iw=Fe.linux&&Fe.chrome?window.devicePixelRatio:Fe.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function tm(s){return Fe.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/iw:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function V0(s,c){var h=c.relatedTarget;if(!h)return!0;try{for(;h&&h!==s;)h=h.parentNode}catch{return!1}return h!==s}var aw={__proto__:null,on:We,off:ot,stopPropagation:va,disableScrollPropagation:H0,disableClickPropagation:wo,preventDefault:er,stop:_a,getPropagationPath:Qp,getMousePosition:em,getWheelDelta:tm,isExternalTarget:V0,addListener:We,removeListener:ot},rm=ge.extend({run:function(s,c,h,g){this.stop(),this._el=s,this._inProgress=!0,this._duration=h||.25,this._easeOutPower=1/Math.max(g||.5,.2),this._startPos=ga(s),this._offset=c.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=G(this._animate,this),this._step()},_step:function(s){var c=+new Date-this._startTime,h=this._duration*1e3;c<h?this._runFrame(this._easeOut(c/h),s):(this._runFrame(1),this._complete())},_runFrame:function(s,c){var h=this._startPos.add(this._offset.multiplyBy(s));c&&h._round(),Ft(this._el,h),this.fire("step")},_complete:function(){X(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),Je=ge.extend({options:{crs:Ze,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,c){c=_(this,c),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),c.maxBounds&&this.setMaxBounds(c.maxBounds),c.zoom!==void 0&&(this._zoom=this._limitZoom(c.zoom)),c.center&&c.zoom!==void 0&&this.setView(te(c.center),c.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=kn&&Fe.any3d&&!Fe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),We(this._proxy,Fi,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,c,h){if(c=c===void 0?this._zoom:this._limitZoom(c),s=this._limitCenter(te(s),c,this.options.maxBounds),h=h||{},this._stop(),this._loaded&&!h.reset&&h!==!0){h.animate!==void 0&&(h.zoom=i({animate:h.animate},h.zoom),h.pan=i({animate:h.animate,duration:h.duration},h.pan));var g=this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,c,h.zoom):this._tryAnimatedPan(s,h.pan);if(g)return clearTimeout(this._sizeTimer),this}return this._resetView(s,c,h.pan&&h.pan.noMoveStart),this},setZoom:function(s,c){return this._loaded?this.setView(this.getCenter(),s,{zoom:c}):(this._zoom=s,this)},zoomIn:function(s,c){return s=s||(Fe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,c)},zoomOut:function(s,c){return s=s||(Fe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,c)},setZoomAround:function(s,c,h){var g=this.getZoomScale(c),E=this.getSize().divideBy(2),P=s instanceof J?s:this.latLngToContainerPoint(s),V=P.subtract(E).multiplyBy(1-1/g),re=this.containerPointToLatLng(E.add(V));return this.setView(re,c,{zoom:h})},_getBoundsCenterZoom:function(s,c){c=c||{},s=s.getBounds?s.getBounds():H(s);var h=ce(c.paddingTopLeft||c.padding||[0,0]),g=ce(c.paddingBottomRight||c.padding||[0,0]),E=this.getBoundsZoom(s,!1,h.add(g));if(E=typeof c.maxZoom=="number"?Math.min(c.maxZoom,E):E,E===1/0)return{center:s.getCenter(),zoom:E};var P=g.subtract(h).divideBy(2),V=this.project(s.getSouthWest(),E),re=this.project(s.getNorthEast(),E),ue=this.unproject(V.add(re).divideBy(2).add(P),E);return{center:ue,zoom:E}},fitBounds:function(s,c){if(s=H(s),!s.isValid())throw new Error("Bounds are not valid.");var h=this._getBoundsCenterZoom(s,c);return this.setView(h.center,h.zoom,c)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,c){return this.setView(s,this._zoom,{pan:c})},panBy:function(s,c){if(s=ce(s).round(),c=c||{},!s.x&&!s.y)return this.fire("moveend");if(c.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new rm,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),c.noMoveStart||this.fire("movestart"),c.animate!==!1){Ge(this._mapPane,"leaflet-pan-anim");var h=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,h,c.duration||.25,c.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,c,h){if(h=h||{},h.animate===!1||!Fe.any3d)return this.setView(s,c,h);this._stop();var g=this.project(this.getCenter()),E=this.project(s),P=this.getSize(),V=this._zoom;s=te(s),c=c===void 0?V:c;var re=Math.max(P.x,P.y),ue=re*this.getZoomScale(V,c),ve=E.distanceTo(g)||1,be=1.42,Me=be*be;function Ke(Lt){var Cc=Lt?-1:1,Zw=Lt?ue:re,Kw=ue*ue-re*re+Cc*Me*Me*ve*ve,qw=2*Zw*Me*ve,rf=Kw/qw,Dm=Math.sqrt(rf*rf+1)-rf,Xw=Dm<1e-9?-18:Math.log(Dm);return Xw}function Er(Lt){return(Math.exp(Lt)-Math.exp(-Lt))/2}function Kt(Lt){return(Math.exp(Lt)+Math.exp(-Lt))/2}function ln(Lt){return Er(Lt)/Kt(Lt)}var Dr=Ke(0);function fs(Lt){return re*(Kt(Dr)/Kt(Dr+be*Lt))}function Ww(Lt){return re*(Kt(Dr)*ln(Dr+be*Lt)-Er(Dr))/Me}function Hw(Lt){return 1-Math.pow(1-Lt,1.5)}var Vw=Date.now(),Im=(Ke(1)-Dr)/be,Gw=h.duration?1e3*h.duration:1e3*Im*.8;function Nm(){var Lt=(Date.now()-Vw)/Gw,Cc=Hw(Lt)*Im;Lt<=1?(this._flyToFrame=G(Nm,this),this._move(this.unproject(g.add(E.subtract(g).multiplyBy(Ww(Cc)/ve)),V),this.getScaleZoom(re/fs(Cc),V),{flyTo:!0})):this._move(s,c)._moveEnd(!0)}return this._moveStart(!0,h.noMoveStart),Nm.call(this),this},flyToBounds:function(s,c){var h=this._getBoundsCenterZoom(s,c);return this.flyTo(h.center,h.zoom,c)},setMaxBounds:function(s){return s=H(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var c=this.options.minZoom;return this.options.minZoom=s,this._loaded&&c!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var c=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&c!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,c){this._enforcingBounds=!0;var h=this.getCenter(),g=this._limitCenter(h,this._zoom,H(s));return h.equals(g)||this.panTo(g,c),this._enforcingBounds=!1,this},panInside:function(s,c){c=c||{};var h=ce(c.paddingTopLeft||c.padding||[0,0]),g=ce(c.paddingBottomRight||c.padding||[0,0]),E=this.project(this.getCenter()),P=this.project(s),V=this.getPixelBounds(),re=N([V.min.add(h),V.max.subtract(g)]),ue=re.getSize();if(!re.contains(P)){this._enforcingBounds=!0;var ve=P.subtract(re.getCenter()),be=re.extend(P).getSize().subtract(ue);E.x+=ve.x<0?-be.x:be.x,E.y+=ve.y<0?-be.y:be.y,this.panTo(this.unproject(E),c),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=i({animate:!1,pan:!0},s===!0?{animate:!0}:s);var c=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var h=this.getSize(),g=c.divideBy(2).round(),E=h.divideBy(2).round(),P=g.subtract(E);return!P.x&&!P.y?this:(s.animate&&s.pan?this.panBy(P):(s.pan&&this._rawPanBy(P),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:c,newSize:h}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=i({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=o(this._handleGeolocationResponse,this),h=o(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,h,s):navigator.geolocation.getCurrentPosition(c,h,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var c=s.code,h=s.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+h+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var c=s.coords.latitude,h=s.coords.longitude,g=new W(c,h),E=g.toBounds(s.coords.accuracy*2),P=this._locateOptions;if(P.setView){var V=this.getBoundsZoom(E);this.setView(g,P.maxZoom?Math.min(V,P.maxZoom):V)}var re={latlng:g,bounds:E,timestamp:s.timestamp};for(var ue in s.coords)typeof s.coords[ue]=="number"&&(re[ue]=s.coords[ue]);this.fire("locationfound",re)}},addHandler:function(s,c){if(!c)return this;var h=this[s]=new c(this);return this._handlers.push(h),this.options[s]&&h.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),_t(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(X(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)_t(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,c){var h="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),g=$e("div",h,c||this._mapPane);return s&&(this._panes[s]=g),g},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),c=this.unproject(s.getBottomLeft()),h=this.unproject(s.getTopRight());return new Z(c,h)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,c,h){s=H(s),h=ce(h||[0,0]);var g=this.getZoom()||0,E=this.getMinZoom(),P=this.getMaxZoom(),V=s.getNorthWest(),re=s.getSouthEast(),ue=this.getSize().subtract(h),ve=N(this.project(re,g),this.project(V,g)).getSize(),be=Fe.any3d?this.options.zoomSnap:1,Me=ue.x/ve.x,Ke=ue.y/ve.y,Er=c?Math.max(Me,Ke):Math.min(Me,Ke);return g=this.getScaleZoom(Er,g),be&&(g=Math.round(g/(be/100))*(be/100),g=c?Math.ceil(g/be)*be:Math.floor(g/be)*be),Math.max(E,Math.min(P,g))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new J(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,c){var h=this._getTopLeftPoint(s,c);return new _e(h,h.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,c){var h=this.options.crs;return c=c===void 0?this._zoom:c,h.scale(s)/h.scale(c)},getScaleZoom:function(s,c){var h=this.options.crs;c=c===void 0?this._zoom:c;var g=h.zoom(s*h.scale(c));return isNaN(g)?1/0:g},project:function(s,c){return c=c===void 0?this._zoom:c,this.options.crs.latLngToPoint(te(s),c)},unproject:function(s,c){return c=c===void 0?this._zoom:c,this.options.crs.pointToLatLng(ce(s),c)},layerPointToLatLng:function(s){var c=ce(s).add(this.getPixelOrigin());return this.unproject(c)},latLngToLayerPoint:function(s){var c=this.project(te(s))._round();return c._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(te(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(H(s))},distance:function(s,c){return this.options.crs.distance(te(s),te(c))},containerPointToLayerPoint:function(s){return ce(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return ce(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var c=this.containerPointToLayerPoint(ce(s));return this.layerPointToLatLng(c)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(te(s)))},mouseEventToContainerPoint:function(s){return em(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var c=this._container=zn(s);if(c){if(c._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");We(c,"scroll",this._onScroll,this),this._containerId=u(c)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&Fe.any3d,Ge(s,"leaflet-container"+(Fe.touch?" leaflet-touch":"")+(Fe.retina?" leaflet-retina":"")+(Fe.ielt9?" leaflet-oldie":"")+(Fe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var c=ai(s,"position");c!=="absolute"&&c!=="relative"&&c!=="fixed"&&c!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Ft(this._mapPane,new J(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ge(s.markerPane,"leaflet-zoom-hide"),Ge(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,c,h){Ft(this._mapPane,new J(0,0));var g=!this._loaded;this._loaded=!0,c=this._limitZoom(c),this.fire("viewprereset");var E=this._zoom!==c;this._moveStart(E,h)._move(s,c)._moveEnd(E),this.fire("viewreset"),g&&this.fire("load")},_moveStart:function(s,c){return s&&this.fire("zoomstart"),c||this.fire("movestart"),this},_move:function(s,c,h,g){c===void 0&&(c=this._zoom);var E=this._zoom!==c;return this._zoom=c,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),g?h&&h.pinch&&this.fire("zoom",h):((E||h&&h.pinch)&&this.fire("zoom",h),this.fire("move",h)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return X(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){Ft(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[u(this._container)]=this;var c=s?ot:We;c(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&c(window,"resize",this._onResize,this),Fe.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){X(this._resizeRequest),this._resizeRequest=G(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,c){for(var h=[],g,E=c==="mouseout"||c==="mouseover",P=s.target||s.srcElement,V=!1;P;){if(g=this._targets[u(P)],g&&(c==="click"||c==="preclick")&&this._draggableMoved(g)){V=!0;break}if(g&&g.listens(c,!0)&&(E&&!V0(P,s)||(h.push(g),E))||P===this._container)break;P=P.parentNode}return!h.length&&!V&&!E&&this.listens(c,!0)&&(h=[this]),h},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var c=s.target||s.srcElement;if(!(!this._loaded||c._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(c))){var h=s.type;h==="mousedown"&&j0(c),this._fireDOMEvent(s,h)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,c,h){if(s.type==="click"){var g=i({},s);g.type="preclick",this._fireDOMEvent(g,g.type,h)}var E=this._findEventTargets(s,c);if(h){for(var P=[],V=0;V<h.length;V++)h[V].listens(c,!0)&&P.push(h[V]);E=P.concat(E)}if(E.length){c==="contextmenu"&&er(s);var re=E[0],ue={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var ve=re.getLatLng&&(!re._radius||re._radius<=10);ue.containerPoint=ve?this.latLngToContainerPoint(re.getLatLng()):this.mouseEventToContainerPoint(s),ue.layerPoint=this.containerPointToLayerPoint(ue.containerPoint),ue.latlng=ve?re.getLatLng():this.layerPointToLatLng(ue.layerPoint)}for(V=0;V<E.length;V++)if(E[V].fire(c,ue,!0),ue.originalEvent._stopped||E[V].options.bubblingMouseEvents===!1&&b(this._mouseEvents,c)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,c=this._handlers.length;s<c;s++)this._handlers[s].disable()},whenReady:function(s,c){return this._loaded?s.call(c||this,{target:this}):this.on("load",s,c),this},_getMapPanePos:function(){return ga(this._mapPane)||new J(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,c){var h=s&&c!==void 0?this._getNewPixelOrigin(s,c):this.getPixelOrigin();return h.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,c){var h=this.getSize()._divideBy(2);return this.project(s,c)._subtract(h)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,c,h){var g=this._getNewPixelOrigin(h,c);return this.project(s,c)._subtract(g)},_latLngBoundsToNewLayerBounds:function(s,c,h){var g=this._getNewPixelOrigin(h,c);return N([this.project(s.getSouthWest(),c)._subtract(g),this.project(s.getNorthWest(),c)._subtract(g),this.project(s.getSouthEast(),c)._subtract(g),this.project(s.getNorthEast(),c)._subtract(g)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,c,h){if(!h)return s;var g=this.project(s,c),E=this.getSize().divideBy(2),P=new _e(g.subtract(E),g.add(E)),V=this._getBoundsOffset(P,h,c);return Math.abs(V.x)<=1&&Math.abs(V.y)<=1?s:this.unproject(g.add(V),c)},_limitOffset:function(s,c){if(!c)return s;var h=this.getPixelBounds(),g=new _e(h.min.add(s),h.max.add(s));return s.add(this._getBoundsOffset(g,c))},_getBoundsOffset:function(s,c,h){var g=N(this.project(c.getNorthEast(),h),this.project(c.getSouthWest(),h)),E=g.min.subtract(s.min),P=g.max.subtract(s.max),V=this._rebound(E.x,-P.x),re=this._rebound(E.y,-P.y);return new J(V,re)},_rebound:function(s,c){return s+c>0?Math.round(s-c)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(c))},_limitZoom:function(s){var c=this.getMinZoom(),h=this.getMaxZoom(),g=Fe.any3d?this.options.zoomSnap:1;return g&&(s=Math.round(s/g)*g),Math.max(c,Math.min(h,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){At(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,c){var h=this._getCenterOffset(s)._trunc();return(c&&c.animate)!==!0&&!this.getSize().contains(h)?!1:(this.panBy(h,c),!0)},_createAnimProxy:function(){var s=this._proxy=$e("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(c){var h=ii,g=this._proxy.style[h];ma(this._proxy,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1)),g===this._proxy.style[h]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){_t(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),c=this.getZoom();ma(this._proxy,this.project(s,c),this.getZoomScale(c,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,c,h){if(this._animatingZoom)return!0;if(h=h||{},!this._zoomAnimated||h.animate===!1||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var g=this.getZoomScale(c),E=this._getCenterOffset(s)._divideBy(1-1/g);return h.animate!==!0&&!this.getSize().contains(E)?!1:(G(function(){this._moveStart(!0,h.noMoveStart||!1)._animateZoom(s,c,!0)},this),!0)},_animateZoom:function(s,c,h,g){this._mapPane&&(h&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=c,Ge(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:c,noUpdate:g}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&At(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function sw(s,c){return new Je(s,c)}var En=de.extend({options:{position:"topright"},initialize:function(s){_(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var c=this._map;return c&&c.removeControl(this),this.options.position=s,c&&c.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var c=this._container=this.onAdd(s),h=this.getPosition(),g=s._controlCorners[h];return Ge(c,"leaflet-control"),h.indexOf("bottom")!==-1?g.insertBefore(c,g.firstChild):g.appendChild(c),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(_t(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),ko=function(s){return new En(s)};Je.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},c="leaflet-",h=this._controlContainer=$e("div",c+"control-container",this._container);function g(E,P){var V=c+E+" "+c+P;s[E+P]=$e("div",V,h)}g("top","left"),g("top","right"),g("bottom","left"),g("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)_t(this._controlCorners[s]);_t(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var nm=En.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,c,h,g){return h<g?-1:g<h?1:0}},initialize:function(s,c,h){_(this,h),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var g in s)this._addLayer(s[g],g);for(g in c)this._addLayer(c[g],g,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return En.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,c){return this._addLayer(s,c),this._map?this._update():this},addOverlay:function(s,c){return this._addLayer(s,c,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var c=this._getLayer(u(s));return c&&this._layers.splice(this._layers.indexOf(c),1),this._map?this._update():this},expand:function(){Ge(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(Ge(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):At(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return At(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",c=this._container=$e("div",s),h=this.options.collapsed;c.setAttribute("aria-haspopup",!0),wo(c),H0(c);var g=this._section=$e("section",s+"-list");h&&(this._map.on("click",this.collapse,this),We(c,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var E=this._layersLink=$e("a",s+"-toggle",c);E.href="#",E.title="Layers",E.setAttribute("role","button"),We(E,{keydown:function(P){P.keyCode===13&&this._expandSafely()},click:function(P){er(P),this._expandSafely()}},this),h||this.expand(),this._baseLayersList=$e("div",s+"-base",g),this._separator=$e("div",s+"-separator",g),this._overlaysList=$e("div",s+"-overlays",g),c.appendChild(g)},_getLayer:function(s){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&u(this._layers[c].layer)===s)return this._layers[c]},_addLayer:function(s,c,h){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:c,overlay:h}),this.options.sortLayers&&this._layers.sort(o(function(g,E){return this.options.sortFunction(g.layer,E.layer,g.name,E.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;uc(this._baseLayersList),uc(this._overlaysList),this._layerControlInputs=[];var s,c,h,g,E=0;for(h=0;h<this._layers.length;h++)g=this._layers[h],this._addItem(g),c=c||g.overlay,s=s||!g.overlay,E+=g.overlay?0:1;return this.options.hideSingleBase&&(s=s&&E>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=c&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var c=this._getLayer(u(s.target)),h=c.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;h&&this._map.fire(h,c)},_createRadioElement:function(s,c){var h='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(c?' checked="checked"':"")+"/>",g=document.createElement("div");return g.innerHTML=h,g.firstChild},_addItem:function(s){var c=document.createElement("label"),h=this._map.hasLayer(s.layer),g;s.overlay?(g=document.createElement("input"),g.type="checkbox",g.className="leaflet-control-layers-selector",g.defaultChecked=h):g=this._createRadioElement("leaflet-base-layers_"+u(this),h),this._layerControlInputs.push(g),g.layerId=u(s.layer),We(g,"click",this._onInputClick,this);var E=document.createElement("span");E.innerHTML=" "+s.name;var P=document.createElement("span");c.appendChild(P),P.appendChild(g),P.appendChild(E);var V=s.overlay?this._overlaysList:this._baseLayersList;return V.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,c,h,g=[],E=[];this._handlingClick=!0;for(var P=s.length-1;P>=0;P--)c=s[P],h=this._getLayer(c.layerId).layer,c.checked?g.push(h):c.checked||E.push(h);for(P=0;P<E.length;P++)this._map.hasLayer(E[P])&&this._map.removeLayer(E[P]);for(P=0;P<g.length;P++)this._map.hasLayer(g[P])||this._map.addLayer(g[P]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,c,h,g=this._map.getZoom(),E=s.length-1;E>=0;E--)c=s[E],h=this._getLayer(c.layerId).layer,c.disabled=h.options.minZoom!==void 0&&g<h.options.minZoom||h.options.maxZoom!==void 0&&g>h.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,We(s,"click",er),this.expand();var c=this;setTimeout(function(){ot(s,"click",er),c._preventClick=!1})}}),ow=function(s,c,h){return new nm(s,c,h)},G0=En.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var c="leaflet-control-zoom",h=$e("div",c+" leaflet-bar"),g=this.options;return this._zoomInButton=this._createButton(g.zoomInText,g.zoomInTitle,c+"-in",h,this._zoomIn),this._zoomOutButton=this._createButton(g.zoomOutText,g.zoomOutTitle,c+"-out",h,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),h},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,c,h,g,E){var P=$e("a",h,g);return P.innerHTML=s,P.href="#",P.title=c,P.setAttribute("role","button"),P.setAttribute("aria-label",c),wo(P),We(P,"click",_a),We(P,"click",E,this),We(P,"click",this._refocusOnMap,this),P},_updateDisabled:function(){var s=this._map,c="leaflet-disabled";At(this._zoomInButton,c),At(this._zoomOutButton,c),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(Ge(this._zoomOutButton,c),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(Ge(this._zoomInButton,c),this._zoomInButton.setAttribute("aria-disabled","true"))}});Je.mergeOptions({zoomControl:!0}),Je.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new G0,this.addControl(this.zoomControl))});var lw=function(s){return new G0(s)},im=En.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var c="leaflet-control-scale",h=$e("div",c),g=this.options;return this._addScales(g,c+"-line",h),s.on(g.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),h},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,c,h){s.metric&&(this._mScale=$e("div",c,h)),s.imperial&&(this._iScale=$e("div",c,h))},_update:function(){var s=this._map,c=s.getSize().y/2,h=s.distance(s.containerPointToLatLng([0,c]),s.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(h)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var c=this._getRoundNum(s),h=c<1e3?c+" m":c/1e3+" km";this._updateScale(this._mScale,h,c/s)},_updateImperial:function(s){var c=s*3.2808399,h,g,E;c>5280?(h=c/5280,g=this._getRoundNum(h),this._updateScale(this._iScale,g+" mi",g/h)):(E=this._getRoundNum(c),this._updateScale(this._iScale,E+" ft",E/c))},_updateScale:function(s,c,h){s.style.width=Math.round(this.options.maxWidth*h)+"px",s.innerHTML=c},_getRoundNum:function(s){var c=Math.pow(10,(Math.floor(s)+"").length-1),h=s/c;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:1,c*h}}),cw=function(s){return new im(s)},uw='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Z0=En.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Fe.inlineSvg?uw+" ":"")+"Leaflet</a>"},initialize:function(s){_(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=$e("div","leaflet-control-attribution"),wo(this._container);for(var c in s._layers)s._layers[c].getAttribution&&this.addAttribution(s._layers[c].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var c in this._attributions)this._attributions[c]&&s.push(c);var h=[];this.options.prefix&&h.push(this.options.prefix),s.length&&h.push(s.join(", ")),this._container.innerHTML=h.join(' <span aria-hidden="true">|</span> ')}}});Je.mergeOptions({attributionControl:!0}),Je.addInitHook(function(){this.options.attributionControl&&new Z0().addTo(this)});var fw=function(s){return new Z0(s)};En.Layers=nm,En.Zoom=G0,En.Scale=im,En.Attribution=Z0,ko.layers=ow,ko.zoom=lw,ko.scale=cw,ko.attribution=fw;var Wn=de.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Wn.addTo=function(s,c){return s.addHandler(c,this),this};var hw={Events:me},am=Fe.touch?"touchstart mousedown":"mousedown",Li=ge.extend({options:{clickTolerance:3},initialize:function(s,c,h,g){_(this,g),this._element=s,this._dragStartTarget=c||s,this._preventOutline=h},enable:function(){this._enabled||(We(this._dragStartTarget,am,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Li._dragging===this&&this.finishDrag(!0),ot(this._dragStartTarget,am,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!L0(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){Li._dragging===this&&this.finishDrag();return}if(!(Li._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(Li._dragging=this,this._preventOutline&&j0(this._element),D0(),_o(),!this._moving)){this.fire("down");var c=s.touches?s.touches[0]:s,h=Yp(this._element);this._startPoint=new J(c.clientX,c.clientY),this._startPos=ga(this._element),this._parentScale=U0(h);var g=s.type==="mousedown";We(document,g?"mousemove":"touchmove",this._onMove,this),We(document,g?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var c=s.touches&&s.touches.length===1?s.touches[0]:s,h=new J(c.clientX,c.clientY)._subtract(this._startPoint);!h.x&&!h.y||Math.abs(h.x)+Math.abs(h.y)<this.options.clickTolerance||(h.x/=this._parentScale.x,h.y/=this._parentScale.y,er(s),this._moved||(this.fire("dragstart"),this._moved=!0,Ge(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ge(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(h),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),Ft(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){At(document.body,"leaflet-dragging"),this._lastTarget&&(At(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),ot(document,"mousemove touchmove",this._onMove,this),ot(document,"mouseup touchend touchcancel",this._onUp,this),M0(),xo();var c=this._moved&&this._moving;this._moving=!1,Li._dragging=!1,c&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function sm(s,c,h){var g,E=[1,4,2,8],P,V,re,ue,ve,be,Me,Ke;for(P=0,be=s.length;P<be;P++)s[P]._code=xa(s[P],c);for(re=0;re<4;re++){for(Me=E[re],g=[],P=0,be=s.length,V=be-1;P<be;V=P++)ue=s[P],ve=s[V],ue._code&Me?ve._code&Me||(Ke=mc(ve,ue,Me,c,h),Ke._code=xa(Ke,c),g.push(Ke)):(ve._code&Me&&(Ke=mc(ve,ue,Me,c,h),Ke._code=xa(Ke,c),g.push(Ke)),g.push(ue));s=g}return s}function om(s,c){var h,g,E,P,V,re,ue,ve,be;if(!s||s.length===0)throw new Error("latlngs not passed");on(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var Me=te([0,0]),Ke=H(s),Er=Ke.getNorthWest().distanceTo(Ke.getSouthWest())*Ke.getNorthEast().distanceTo(Ke.getNorthWest());Er<1700&&(Me=K0(s));var Kt=s.length,ln=[];for(h=0;h<Kt;h++){var Dr=te(s[h]);ln.push(c.project(te([Dr.lat-Me.lat,Dr.lng-Me.lng])))}for(re=ue=ve=0,h=0,g=Kt-1;h<Kt;g=h++)E=ln[h],P=ln[g],V=E.y*P.x-P.y*E.x,ue+=(E.x+P.x)*V,ve+=(E.y+P.y)*V,re+=V*3;re===0?be=ln[0]:be=[ue/re,ve/re];var fs=c.unproject(ce(be));return te([fs.lat+Me.lat,fs.lng+Me.lng])}function K0(s){for(var c=0,h=0,g=0,E=0;E<s.length;E++){var P=te(s[E]);c+=P.lat,h+=P.lng,g++}return te([c/g,h/g])}var dw={__proto__:null,clipPolygon:sm,polygonCenter:om,centroid:K0};function lm(s,c){if(!c||!s.length)return s.slice();var h=c*c;return s=gw(s,h),s=mw(s,h),s}function cm(s,c,h){return Math.sqrt(Eo(s,c,h,!0))}function pw(s,c,h){return Eo(s,c,h)}function mw(s,c){var h=s.length,g=typeof Uint8Array<"u"?Uint8Array:Array,E=new g(h);E[0]=E[h-1]=1,q0(s,E,c,0,h-1);var P,V=[];for(P=0;P<h;P++)E[P]&&V.push(s[P]);return V}function q0(s,c,h,g,E){var P=0,V,re,ue;for(re=g+1;re<=E-1;re++)ue=Eo(s[re],s[g],s[E],!0),ue>P&&(V=re,P=ue);P>h&&(c[V]=1,q0(s,c,h,g,V),q0(s,c,h,V,E))}function gw(s,c){for(var h=[s[0]],g=1,E=0,P=s.length;g<P;g++)vw(s[g],s[E])>c&&(h.push(s[g]),E=g);return E<P-1&&h.push(s[P-1]),h}var um;function fm(s,c,h,g,E){var P=g?um:xa(s,h),V=xa(c,h),re,ue,ve;for(um=V;;){if(!(P|V))return[s,c];if(P&V)return!1;re=P||V,ue=mc(s,c,re,h,E),ve=xa(ue,h),re===P?(s=ue,P=ve):(c=ue,V=ve)}}function mc(s,c,h,g,E){var P=c.x-s.x,V=c.y-s.y,re=g.min,ue=g.max,ve,be;return h&8?(ve=s.x+P*(ue.y-s.y)/V,be=ue.y):h&4?(ve=s.x+P*(re.y-s.y)/V,be=re.y):h&2?(ve=ue.x,be=s.y+V*(ue.x-s.x)/P):h&1&&(ve=re.x,be=s.y+V*(re.x-s.x)/P),new J(ve,be,E)}function xa(s,c){var h=0;return s.x<c.min.x?h|=1:s.x>c.max.x&&(h|=2),s.y<c.min.y?h|=4:s.y>c.max.y&&(h|=8),h}function vw(s,c){var h=c.x-s.x,g=c.y-s.y;return h*h+g*g}function Eo(s,c,h,g){var E=c.x,P=c.y,V=h.x-E,re=h.y-P,ue=V*V+re*re,ve;return ue>0&&(ve=((s.x-E)*V+(s.y-P)*re)/ue,ve>1?(E=h.x,P=h.y):ve>0&&(E+=V*ve,P+=re*ve)),V=s.x-E,re=s.y-P,g?V*V+re*re:new J(E,P)}function on(s){return!y(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function hm(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),on(s)}function dm(s,c){var h,g,E,P,V,re,ue,ve;if(!s||s.length===0)throw new Error("latlngs not passed");on(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var be=te([0,0]),Me=H(s),Ke=Me.getNorthWest().distanceTo(Me.getSouthWest())*Me.getNorthEast().distanceTo(Me.getNorthWest());Ke<1700&&(be=K0(s));var Er=s.length,Kt=[];for(h=0;h<Er;h++){var ln=te(s[h]);Kt.push(c.project(te([ln.lat-be.lat,ln.lng-be.lng])))}for(h=0,g=0;h<Er-1;h++)g+=Kt[h].distanceTo(Kt[h+1])/2;if(g===0)ve=Kt[0];else for(h=0,P=0;h<Er-1;h++)if(V=Kt[h],re=Kt[h+1],E=V.distanceTo(re),P+=E,P>g){ue=(P-g)/E,ve=[re.x-ue*(re.x-V.x),re.y-ue*(re.y-V.y)];break}var Dr=c.unproject(ce(ve));return te([Dr.lat+be.lat,Dr.lng+be.lng])}var _w={__proto__:null,simplify:lm,pointToSegmentDistance:cm,closestPointOnSegment:pw,clipSegment:fm,_getEdgeIntersection:mc,_getBitCode:xa,_sqClosestPointOnSegment:Eo,isFlat:on,_flat:hm,polylineCenter:dm},X0={project:function(s){return new J(s.lng,s.lat)},unproject:function(s){return new W(s.y,s.x)},bounds:new _e([-180,-90],[180,90])},Y0={R:6378137,R_MINOR:6356752314245179e-9,bounds:new _e([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var c=Math.PI/180,h=this.R,g=s.lat*c,E=this.R_MINOR/h,P=Math.sqrt(1-E*E),V=P*Math.sin(g),re=Math.tan(Math.PI/4-g/2)/Math.pow((1-V)/(1+V),P/2);return g=-h*Math.log(Math.max(re,1e-10)),new J(s.lng*c*h,g)},unproject:function(s){for(var c=180/Math.PI,h=this.R,g=this.R_MINOR/h,E=Math.sqrt(1-g*g),P=Math.exp(-s.y/h),V=Math.PI/2-2*Math.atan(P),re=0,ue=.1,ve;re<15&&Math.abs(ue)>1e-7;re++)ve=E*Math.sin(V),ve=Math.pow((1-ve)/(1+ve),E/2),ue=Math.PI/2-2*Math.atan(P*ve)-V,V+=ue;return new W(V*c,s.x*c/h)}},xw={__proto__:null,LonLat:X0,Mercator:Y0,SphericalMercator:oe},yw=i({},Te,{code:"EPSG:3395",projection:Y0,transformation:function(){var s=.5/(Math.PI*Y0.R);return D(s,.5,-s,.5)}()}),pm=i({},Te,{code:"EPSG:4326",projection:X0,transformation:D(1/180,1,-1/180,.5)}),ww=i({},xe,{projection:X0,transformation:D(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,c){var h=c.lng-s.lng,g=c.lat-s.lat;return Math.sqrt(h*h+g*g)},infinite:!0});xe.Earth=Te,xe.EPSG3395=yw,xe.EPSG3857=Ze,xe.EPSG900913=qe,xe.EPSG4326=pm,xe.Simple=ww;var Sn=ge.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[u(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[u(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var c=s.target;if(c.hasLayer(this)){if(this._map=c,this._zoomAnimated=c._zoomAnimated,this.getEvents){var h=this.getEvents();c.on(h,this),this.once("remove",function(){c.off(h,this)},this)}this.onAdd(c),this.fire("add"),c.fire("layeradd",{layer:this})}}});Je.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var c=u(s);return this._layers[c]?this:(this._layers[c]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var c=u(s);return this._layers[c]?(this._loaded&&s.onRemove(this),delete this._layers[c],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return u(s)in this._layers},eachLayer:function(s,c){for(var h in this._layers)s.call(c,this._layers[h]);return this},_addLayers:function(s){s=s?y(s)?s:[s]:[];for(var c=0,h=s.length;c<h;c++)this.addLayer(s[c])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[u(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var c=u(s);this._zoomBoundLayers[c]&&(delete this._zoomBoundLayers[c],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,c=-1/0,h=this._getZoomSpan();for(var g in this._zoomBoundLayers){var E=this._zoomBoundLayers[g].options;s=E.minZoom===void 0?s:Math.min(s,E.minZoom),c=E.maxZoom===void 0?c:Math.max(c,E.maxZoom)}this._layersMaxZoom=c===-1/0?void 0:c,this._layersMinZoom=s===1/0?void 0:s,h!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ss=Sn.extend({initialize:function(s,c){_(this,c),this._layers={};var h,g;if(s)for(h=0,g=s.length;h<g;h++)this.addLayer(s[h])},addLayer:function(s){var c=this.getLayerId(s);return this._layers[c]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var c=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[c]&&this._map.removeLayer(this._layers[c]),delete this._layers[c],this},hasLayer:function(s){var c=typeof s=="number"?s:this.getLayerId(s);return c in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var c=Array.prototype.slice.call(arguments,1),h,g;for(h in this._layers)g=this._layers[h],g[s]&&g[s].apply(g,c);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,c){for(var h in this._layers)s.call(c,this._layers[h]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return u(s)}}),kw=function(s,c){return new ss(s,c)},si=ss.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),ss.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),ss.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new Z;for(var c in this._layers){var h=this._layers[c];s.extend(h.getBounds?h.getBounds():h.getLatLng())}return s}}),Ew=function(s,c){return new si(s,c)},os=de.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){_(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,c){var h=this._getIconUrl(s);if(!h){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var g=this._createImg(h,c&&c.tagName==="IMG"?c:null);return this._setIconStyles(g,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(g.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),g},_setIconStyles:function(s,c){var h=this.options,g=h[c+"Size"];typeof g=="number"&&(g=[g,g]);var E=ce(g),P=ce(c==="shadow"&&h.shadowAnchor||h.iconAnchor||E&&E.divideBy(2,!0));s.className="leaflet-marker-"+c+" "+(h.className||""),P&&(s.style.marginLeft=-P.x+"px",s.style.marginTop=-P.y+"px"),E&&(s.style.width=E.x+"px",s.style.height=E.y+"px")},_createImg:function(s,c){return c=c||document.createElement("img"),c.src=s,c},_getIconUrl:function(s){return Fe.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function Sw(s){return new os(s)}var So=os.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof So.imagePath!="string"&&(So.imagePath=this._detectIconPath()),(this.options.imagePath||So.imagePath)+os.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var c=function(h,g,E){var P=g.exec(h);return P&&P[E]};return s=c(s,/^url\((['"])?(.+)\1\)$/,2),s&&c(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=$e("div","leaflet-default-icon-path",document.body),c=ai(s,"background-image")||ai(s,"backgroundImage");if(document.body.removeChild(s),c=this._stripUrl(c),c)return c;var h=document.querySelector('link[href$="leaflet.css"]');return h?h.href.substring(0,h.href.length-11-1):""}}),mm=Wn.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new Li(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ge(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&At(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var c=this._marker,h=c._map,g=this._marker.options.autoPanSpeed,E=this._marker.options.autoPanPadding,P=ga(c._icon),V=h.getPixelBounds(),re=h.getPixelOrigin(),ue=N(V.min._subtract(re).add(E),V.max._subtract(re).subtract(E));if(!ue.contains(P)){var ve=ce((Math.max(ue.max.x,P.x)-ue.max.x)/(V.max.x-ue.max.x)-(Math.min(ue.min.x,P.x)-ue.min.x)/(V.min.x-ue.min.x),(Math.max(ue.max.y,P.y)-ue.max.y)/(V.max.y-ue.max.y)-(Math.min(ue.min.y,P.y)-ue.min.y)/(V.min.y-ue.min.y)).multiplyBy(g);h.panBy(ve,{animate:!1}),this._draggable._newPos._add(ve),this._draggable._startPos._add(ve),Ft(c._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=G(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(X(this._panRequest),this._panRequest=G(this._adjustPan.bind(this,s)))},_onDrag:function(s){var c=this._marker,h=c._shadow,g=ga(c._icon),E=c._map.layerPointToLatLng(g);h&&Ft(h,g),c._latlng=E,s.latlng=E,s.oldLatLng=this._oldLatLng,c.fire("move",s).fire("drag",s)},_onDragEnd:function(s){X(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),gc=Sn.extend({options:{icon:new So,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,c){_(this,c),this._latlng=te(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var c=this._latlng;return this._latlng=te(s),this.update(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),h=s.icon.createIcon(this._icon),g=!1;h!==this._icon&&(this._icon&&this._removeIcon(),g=!0,s.title&&(h.title=s.title),h.tagName==="IMG"&&(h.alt=s.alt||"")),Ge(h,c),s.keyboard&&(h.tabIndex="0",h.setAttribute("role","button")),this._icon=h,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&We(h,"focus",this._panOnFocus,this);var E=s.icon.createShadow(this._shadow),P=!1;E!==this._shadow&&(this._removeShadow(),P=!0),E&&(Ge(E,c),E.alt=""),this._shadow=E,s.opacity<1&&this._updateOpacity(),g&&this.getPane().appendChild(this._icon),this._initInteraction(),E&&P&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ot(this._icon,"focus",this._panOnFocus,this),_t(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&_t(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&Ft(this._icon,s),this._shadow&&Ft(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(c)},_initInteraction:function(){if(this.options.interactive&&(Ge(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),mm)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new mm(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&sn(this._icon,s),this._shadow&&sn(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var c=this.options.icon.options,h=c.iconSize?ce(c.iconSize):ce(0,0),g=c.iconAnchor?ce(c.iconAnchor):ce(0,0);s.panInside(this._latlng,{paddingTopLeft:g,paddingBottomRight:h.subtract(g)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Tw(s,c){return new gc(s,c)}var Ii=Sn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return _(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),vc=Ii.extend({options:{fill:!0,radius:10},initialize:function(s,c){_(this,c),this._latlng=te(s),this._radius=this.options.radius},setLatLng:function(s){var c=this._latlng;return this._latlng=te(s),this.redraw(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var c=s&&s.radius||this._radius;return Ii.prototype.setStyle.call(this,s),this.setRadius(c),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,c=this._radiusY||s,h=this._clickTolerance(),g=[s+h,c+h];this._pxBounds=new _e(this._point.subtract(g),this._point.add(g))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Cw(s,c){return new vc(s,c)}var J0=vc.extend({initialize:function(s,c,h){if(typeof c=="number"&&(c=i({},h,{radius:c})),_(this,c),this._latlng=te(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new Z(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:Ii.prototype.setStyle,_project:function(){var s=this._latlng.lng,c=this._latlng.lat,h=this._map,g=h.options.crs;if(g.distance===Te.distance){var E=Math.PI/180,P=this._mRadius/Te.R/E,V=h.project([c+P,s]),re=h.project([c-P,s]),ue=V.add(re).divideBy(2),ve=h.unproject(ue).lat,be=Math.acos((Math.cos(P*E)-Math.sin(c*E)*Math.sin(ve*E))/(Math.cos(c*E)*Math.cos(ve*E)))/E;(isNaN(be)||be===0)&&(be=P/Math.cos(Math.PI/180*c)),this._point=ue.subtract(h.getPixelOrigin()),this._radius=isNaN(be)?0:ue.x-h.project([ve,s-be]).x,this._radiusY=ue.y-V.y}else{var Me=g.unproject(g.project(this._latlng).subtract([this._mRadius,0]));this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(Me).x}this._updateBounds()}});function bw(s,c,h){return new J0(s,c,h)}var oi=Ii.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,c){_(this,c),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var c=1/0,h=null,g=Eo,E,P,V=0,re=this._parts.length;V<re;V++)for(var ue=this._parts[V],ve=1,be=ue.length;ve<be;ve++){E=ue[ve-1],P=ue[ve];var Me=g(s,E,P,!0);Me<c&&(c=Me,h=g(s,E,P))}return h&&(h.distance=Math.sqrt(c)),h},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return dm(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,c){return c=c||this._defaultShape(),s=te(s),c.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new Z,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return on(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var c=[],h=on(s),g=0,E=s.length;g<E;g++)h?(c[g]=te(s[g]),this._bounds.extend(c[g])):c[g]=this._convertLatLngs(s[g]);return c},_project:function(){var s=new _e;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),c=new J(s,s);this._rawPxBounds&&(this._pxBounds=new _e([this._rawPxBounds.min.subtract(c),this._rawPxBounds.max.add(c)]))},_projectLatlngs:function(s,c,h){var g=s[0]instanceof W,E=s.length,P,V;if(g){for(V=[],P=0;P<E;P++)V[P]=this._map.latLngToLayerPoint(s[P]),h.extend(V[P]);c.push(V)}else for(P=0;P<E;P++)this._projectLatlngs(s[P],c,h)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var c=this._parts,h,g,E,P,V,re,ue;for(h=0,E=0,P=this._rings.length;h<P;h++)for(ue=this._rings[h],g=0,V=ue.length;g<V-1;g++)re=fm(ue[g],ue[g+1],s,g,!0),re&&(c[E]=c[E]||[],c[E].push(re[0]),(re[1]!==ue[g+1]||g===V-2)&&(c[E].push(re[1]),E++))}},_simplifyPoints:function(){for(var s=this._parts,c=this.options.smoothFactor,h=0,g=s.length;h<g;h++)s[h]=lm(s[h],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,c){var h,g,E,P,V,re,ue=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(h=0,P=this._parts.length;h<P;h++)for(re=this._parts[h],g=0,V=re.length,E=V-1;g<V;E=g++)if(!(!c&&g===0)&&cm(s,re[E],re[g])<=ue)return!0;return!1}});function Aw(s,c){return new oi(s,c)}oi._flat=hm;var ls=oi.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return om(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var c=oi.prototype._convertLatLngs.call(this,s),h=c.length;return h>=2&&c[0]instanceof W&&c[0].equals(c[h-1])&&c.pop(),c},_setLatLngs:function(s){oi.prototype._setLatLngs.call(this,s),on(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return on(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,c=this.options.weight,h=new J(c,c);if(s=new _e(s.min.subtract(h),s.max.add(h)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var g=0,E=this._rings.length,P;g<E;g++)P=sm(this._rings[g],s,!0),P.length&&this._parts.push(P)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var c=!1,h,g,E,P,V,re,ue,ve;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(P=0,ue=this._parts.length;P<ue;P++)for(h=this._parts[P],V=0,ve=h.length,re=ve-1;V<ve;re=V++)g=h[V],E=h[re],g.y>s.y!=E.y>s.y&&s.x<(E.x-g.x)*(s.y-g.y)/(E.y-g.y)+g.x&&(c=!c);return c||oi.prototype._containsPoint.call(this,s,!0)}});function Pw(s,c){return new ls(s,c)}var li=si.extend({initialize:function(s,c){_(this,c),this._layers={},s&&this.addData(s)},addData:function(s){var c=y(s)?s:s.features,h,g,E;if(c){for(h=0,g=c.length;h<g;h++)E=c[h],(E.geometries||E.geometry||E.features||E.coordinates)&&this.addData(E);return this}var P=this.options;if(P.filter&&!P.filter(s))return this;var V=_c(s,P);return V?(V.feature=wc(s),V.defaultOptions=V.options,this.resetStyle(V),P.onEachFeature&&P.onEachFeature(s,V),this.addLayer(V)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=i({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(c){this._setLayerStyle(c,s)},this)},_setLayerStyle:function(s,c){s.setStyle&&(typeof c=="function"&&(c=c(s.feature)),s.setStyle(c))}});function _c(s,c){var h=s.type==="Feature"?s.geometry:s,g=h?h.coordinates:null,E=[],P=c&&c.pointToLayer,V=c&&c.coordsToLatLng||Q0,re,ue,ve,be;if(!g&&!h)return null;switch(h.type){case"Point":return re=V(g),gm(P,s,re,c);case"MultiPoint":for(ve=0,be=g.length;ve<be;ve++)re=V(g[ve]),E.push(gm(P,s,re,c));return new si(E);case"LineString":case"MultiLineString":return ue=xc(g,h.type==="LineString"?0:1,V),new oi(ue,c);case"Polygon":case"MultiPolygon":return ue=xc(g,h.type==="Polygon"?1:2,V),new ls(ue,c);case"GeometryCollection":for(ve=0,be=h.geometries.length;ve<be;ve++){var Me=_c({geometry:h.geometries[ve],type:"Feature",properties:s.properties},c);Me&&E.push(Me)}return new si(E);case"FeatureCollection":for(ve=0,be=h.features.length;ve<be;ve++){var Ke=_c(h.features[ve],c);Ke&&E.push(Ke)}return new si(E);default:throw new Error("Invalid GeoJSON object.")}}function gm(s,c,h,g){return s?s(c,h):new gc(h,g&&g.markersInheritOptions&&g)}function Q0(s){return new W(s[1],s[0],s[2])}function xc(s,c,h){for(var g=[],E=0,P=s.length,V;E<P;E++)V=c?xc(s[E],c-1,h):(h||Q0)(s[E]),g.push(V);return g}function ef(s,c){return s=te(s),s.alt!==void 0?[p(s.lng,c),p(s.lat,c),p(s.alt,c)]:[p(s.lng,c),p(s.lat,c)]}function yc(s,c,h,g){for(var E=[],P=0,V=s.length;P<V;P++)E.push(c?yc(s[P],on(s[P])?0:c-1,h,g):ef(s[P],g));return!c&&h&&E.length>0&&E.push(E[0].slice()),E}function cs(s,c){return s.feature?i({},s.feature,{geometry:c}):wc(c)}function wc(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var tf={toGeoJSON:function(s){return cs(this,{type:"Point",coordinates:ef(this.getLatLng(),s)})}};gc.include(tf),J0.include(tf),vc.include(tf),oi.include({toGeoJSON:function(s){var c=!on(this._latlngs),h=yc(this._latlngs,c?1:0,!1,s);return cs(this,{type:(c?"Multi":"")+"LineString",coordinates:h})}}),ls.include({toGeoJSON:function(s){var c=!on(this._latlngs),h=c&&!on(this._latlngs[0]),g=yc(this._latlngs,h?2:c?1:0,!0,s);return c||(g=[g]),cs(this,{type:(h?"Multi":"")+"Polygon",coordinates:g})}}),ss.include({toMultiPoint:function(s){var c=[];return this.eachLayer(function(h){c.push(h.toGeoJSON(s).geometry.coordinates)}),cs(this,{type:"MultiPoint",coordinates:c})},toGeoJSON:function(s){var c=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(c==="MultiPoint")return this.toMultiPoint(s);var h=c==="GeometryCollection",g=[];return this.eachLayer(function(E){if(E.toGeoJSON){var P=E.toGeoJSON(s);if(h)g.push(P.geometry);else{var V=wc(P);V.type==="FeatureCollection"?g.push.apply(g,V.features):g.push(V)}}}),h?cs(this,{geometries:g,type:"GeometryCollection"}):{type:"FeatureCollection",features:g}}});function vm(s,c){return new li(s,c)}var Ow=vm,kc=Sn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,c,h){this._url=s,this._bounds=H(c),_(this,h)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ge(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){_t(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&is(this._image),this},bringToBack:function(){return this._map&&as(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=H(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",c=this._image=s?this._url:$e("img");if(Ge(c,"leaflet-image-layer"),this._zoomAnimated&&Ge(c,"leaflet-zoom-animated"),this.options.className&&Ge(c,this.options.className),c.onselectstart=m,c.onmousemove=m,c.onload=o(this.fire,this,"load"),c.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=c.src;return}c.src=this._url,c.alt=this.options.alt},_animateZoom:function(s){var c=this._map.getZoomScale(s.zoom),h=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;ma(this._image,h,c)},_reset:function(){var s=this._image,c=new _e(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),h=c.getSize();Ft(s,c.min),s.style.width=h.x+"px",s.style.height=h.y+"px"},_updateOpacity:function(){sn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),Rw=function(s,c,h){return new kc(s,c,h)},_m=kc.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",c=this._image=s?this._url:$e("video");if(Ge(c,"leaflet-image-layer"),this._zoomAnimated&&Ge(c,"leaflet-zoom-animated"),this.options.className&&Ge(c,this.options.className),c.onselectstart=m,c.onmousemove=m,c.onloadeddata=o(this.fire,this,"load"),s){for(var h=c.getElementsByTagName("source"),g=[],E=0;E<h.length;E++)g.push(h[E].src);this._url=h.length>0?g:[c.src];return}y(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(c.style,"objectFit")&&(c.style.objectFit="fill"),c.autoplay=!!this.options.autoplay,c.loop=!!this.options.loop,c.muted=!!this.options.muted,c.playsInline=!!this.options.playsInline;for(var P=0;P<this._url.length;P++){var V=$e("source");V.src=this._url[P],c.appendChild(V)}}});function Fw(s,c,h){return new _m(s,c,h)}var xm=kc.extend({_initImage:function(){var s=this._image=this._url;Ge(s,"leaflet-image-layer"),this._zoomAnimated&&Ge(s,"leaflet-zoom-animated"),this.options.className&&Ge(s,this.options.className),s.onselectstart=m,s.onmousemove=m}});function Lw(s,c,h){return new xm(s,c,h)}var Hn=Sn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,c){s&&(s instanceof W||y(s))?(this._latlng=te(s),_(this,c)):(_(this,s),this._source=c),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&sn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&sn(this._container,1),this.bringToFront(),this.options.interactive&&(Ge(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(sn(this._container,0),this._removeTimeout=setTimeout(o(_t,void 0,this._container),200)):_t(this._container),this.options.interactive&&(At(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=te(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&is(this._container),this},bringToBack:function(){return this._map&&as(this._container),this},_prepareOpen:function(s){var c=this._source;if(!c._map)return!1;if(c instanceof si){c=null;var h=this._source._layers;for(var g in h)if(h[g]._map){c=h[g];break}if(!c)return!1;this._source=c}if(!s)if(c.getCenter)s=c.getCenter();else if(c.getLatLng)s=c.getLatLng();else if(c.getBounds)s=c.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,c=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof c=="string")s.innerHTML=c;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),c=ce(this.options.offset),h=this._getAnchor();this._zoomAnimated?Ft(this._container,s.add(h)):c=c.add(s).add(h);var g=this._containerBottom=-c.y,E=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=g+"px",this._container.style.left=E+"px"}},_getAnchor:function(){return[0,0]}});Je.include({_initOverlay:function(s,c,h,g){var E=c;return E instanceof s||(E=new s(g).setContent(c)),h&&E.setLatLng(h),E}}),Sn.include({_initOverlay:function(s,c,h,g){var E=h;return E instanceof s?(_(E,g),E._source=this):(E=c&&!g?c:new s(g,this),E.setContent(h)),E}});var Ec=Hn.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,Hn.prototype.openOn.call(this,s)},onAdd:function(s){Hn.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ii||this._source.on("preclick",va))},onRemove:function(s){Hn.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ii||this._source.off("preclick",va))},getEvents:function(){var s=Hn.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",c=this._container=$e("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),h=this._wrapper=$e("div",s+"-content-wrapper",c);if(this._contentNode=$e("div",s+"-content",h),wo(c),H0(this._contentNode),We(c,"contextmenu",va),this._tipContainer=$e("div",s+"-tip-container",c),this._tip=$e("div",s+"-tip",this._tipContainer),this.options.closeButton){var g=this._closeButton=$e("a",s+"-close-button",c);g.setAttribute("role","button"),g.setAttribute("aria-label","Close popup"),g.href="#close",g.innerHTML='<span aria-hidden="true">&#215;</span>',We(g,"click",function(E){er(E),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,c=s.style;c.width="",c.whiteSpace="nowrap";var h=s.offsetWidth;h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth),c.width=h+1+"px",c.whiteSpace="",c.height="";var g=s.offsetHeight,E=this.options.maxHeight,P="leaflet-popup-scrolled";E&&g>E?(c.height=E+"px",Ge(s,P)):At(s,P),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),h=this._getAnchor();Ft(this._container,c.add(h))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,c=parseInt(ai(this._container,"marginBottom"),10)||0,h=this._container.offsetHeight+c,g=this._containerWidth,E=new J(this._containerLeft,-h-this._containerBottom);E._add(ga(this._container));var P=s.layerPointToContainerPoint(E),V=ce(this.options.autoPanPadding),re=ce(this.options.autoPanPaddingTopLeft||V),ue=ce(this.options.autoPanPaddingBottomRight||V),ve=s.getSize(),be=0,Me=0;P.x+g+ue.x>ve.x&&(be=P.x+g-ve.x+ue.x),P.x-be-re.x<0&&(be=P.x-re.x),P.y+h+ue.y>ve.y&&(Me=P.y+h-ve.y+ue.y),P.y-Me-re.y<0&&(Me=P.y-re.y),(be||Me)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([be,Me]))}},_getAnchor:function(){return ce(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Iw=function(s,c){return new Ec(s,c)};Je.mergeOptions({closePopupOnClick:!0}),Je.include({openPopup:function(s,c,h){return this._initOverlay(Ec,s,c,h).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),Sn.include({bindPopup:function(s,c){return this._popup=this._initOverlay(Ec,this._popup,s,c),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof si||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){_a(s);var c=s.layer||s.target;if(this._popup._source===c&&!(c instanceof Ii)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=c,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var Sc=Hn.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){Hn.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){Hn.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=Hn.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",c=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=$e("div",c),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+u(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var c,h,g=this._map,E=this._container,P=g.latLngToContainerPoint(g.getCenter()),V=g.layerPointToContainerPoint(s),re=this.options.direction,ue=E.offsetWidth,ve=E.offsetHeight,be=ce(this.options.offset),Me=this._getAnchor();re==="top"?(c=ue/2,h=ve):re==="bottom"?(c=ue/2,h=0):re==="center"?(c=ue/2,h=ve/2):re==="right"?(c=0,h=ve/2):re==="left"?(c=ue,h=ve/2):V.x<P.x?(re="right",c=0,h=ve/2):(re="left",c=ue+(be.x+Me.x)*2,h=ve/2),s=s.subtract(ce(c,h,!0)).add(be).add(Me),At(E,"leaflet-tooltip-right"),At(E,"leaflet-tooltip-left"),At(E,"leaflet-tooltip-top"),At(E,"leaflet-tooltip-bottom"),Ge(E,"leaflet-tooltip-"+re),Ft(E,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&sn(this._container,s)},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(c)},_getAnchor:function(){return ce(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Nw=function(s,c){return new Sc(s,c)};Je.include({openTooltip:function(s,c,h){return this._initOverlay(Sc,s,c,h).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),Sn.include({bindTooltip:function(s,c){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Sc,this._tooltip,s,c),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var c=s?"off":"on",h={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?h.add=this._openTooltip:(h.mouseover=this._openTooltip,h.mouseout=this.closeTooltip,h.click=this._openTooltip,this._map?this._addFocusListeners():h.add=this._addFocusListeners),this._tooltip.options.sticky&&(h.mousemove=this._moveTooltip),this[c](h),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof si||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var c=typeof s.getElement=="function"&&s.getElement();c&&(We(c,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),We(c,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var c=typeof s.getElement=="function"&&s.getElement();c&&c.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var c=this;this._map.once("moveend",function(){c._openOnceFlag=!1,c._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var c=s.latlng,h,g;this._tooltip.options.sticky&&s.originalEvent&&(h=this._map.mouseEventToContainerPoint(s.originalEvent),g=this._map.containerPointToLayerPoint(h),c=this._map.layerPointToLatLng(g)),this._tooltip.setLatLng(c)}});var ym=os.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var c=s&&s.tagName==="DIV"?s:document.createElement("div"),h=this.options;if(h.html instanceof Element?(uc(c),c.appendChild(h.html)):c.innerHTML=h.html!==!1?h.html:"",h.bgPos){var g=ce(h.bgPos);c.style.backgroundPosition=-g.x+"px "+-g.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}});function Dw(s){return new ym(s)}os.Default=So;var To=Sn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Fe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){_(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),_t(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(is(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(as(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof J?s:new J(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var c=this.getPane().children,h=-s(-1/0,1/0),g=0,E=c.length,P;g<E;g++)P=c[g].style.zIndex,c[g]!==this._container&&P&&(h=s(h,+P));isFinite(h)&&(this.options.zIndex=h+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Fe.ielt9){sn(this._container,this.options.opacity);var s=+new Date,c=!1,h=!1;for(var g in this._tiles){var E=this._tiles[g];if(!(!E.current||!E.loaded)){var P=Math.min(1,(s-E.loaded)/200);sn(E.el,P),P<1?c=!0:(E.active?h=!0:this._onOpaqueTile(E),E.active=!0)}}h&&!this._noPrune&&this._pruneTiles(),c&&(X(this._fadeFrame),this._fadeFrame=G(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=$e("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,c=this.options.maxZoom;if(s!==void 0){for(var h in this._levels)h=Number(h),this._levels[h].el.children.length||h===s?(this._levels[h].el.style.zIndex=c-Math.abs(s-h),this._onUpdateLevel(h)):(_t(this._levels[h].el),this._removeTilesAtZoom(h),this._onRemoveLevel(h),delete this._levels[h]);var g=this._levels[s],E=this._map;return g||(g=this._levels[s]={},g.el=$e("div","leaflet-tile-container leaflet-zoom-animated",this._container),g.el.style.zIndex=c,g.origin=E.project(E.unproject(E.getPixelOrigin()),s).round(),g.zoom=s,this._setZoomTransform(g,E.getCenter(),E.getZoom()),m(g.el.offsetWidth),this._onCreateLevel(g)),this._level=g,g}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(this._map){var s,c,h=this._map.getZoom();if(h>this.options.maxZoom||h<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)c=this._tiles[s],c.retain=c.current;for(s in this._tiles)if(c=this._tiles[s],c.current&&!c.active){var g=c.coords;this._retainParent(g.x,g.y,g.z,g.z-5)||this._retainChildren(g.x,g.y,g.z,g.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var c in this._tiles)this._tiles[c].coords.z===s&&this._removeTile(c)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)_t(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,c,h,g){var E=Math.floor(s/2),P=Math.floor(c/2),V=h-1,re=new J(+E,+P);re.z=+V;var ue=this._tileCoordsToKey(re),ve=this._tiles[ue];return ve&&ve.active?(ve.retain=!0,!0):(ve&&ve.loaded&&(ve.retain=!0),V>g?this._retainParent(E,P,V,g):!1)},_retainChildren:function(s,c,h,g){for(var E=2*s;E<2*s+2;E++)for(var P=2*c;P<2*c+2;P++){var V=new J(E,P);V.z=h+1;var re=this._tileCoordsToKey(V),ue=this._tiles[re];if(ue&&ue.active){ue.retain=!0;continue}else ue&&ue.loaded&&(ue.retain=!0);h+1<g&&this._retainChildren(E,P,h+1,g)}},_resetView:function(s){var c=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),c,c)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var c=this.options;return c.minNativeZoom!==void 0&&s<c.minNativeZoom?c.minNativeZoom:c.maxNativeZoom!==void 0&&c.maxNativeZoom<s?c.maxNativeZoom:s},_setView:function(s,c,h,g){var E=Math.round(c);this.options.maxZoom!==void 0&&E>this.options.maxZoom||this.options.minZoom!==void 0&&E<this.options.minZoom?E=void 0:E=this._clampZoom(E);var P=this.options.updateWhenZooming&&E!==this._tileZoom;(!g||P)&&(this._tileZoom=E,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),E!==void 0&&this._update(s),h||this._pruneTiles(),this._noPrune=!!h),this._setZoomTransforms(s,c)},_setZoomTransforms:function(s,c){for(var h in this._levels)this._setZoomTransform(this._levels[h],s,c)},_setZoomTransform:function(s,c,h){var g=this._map.getZoomScale(h,s.zoom),E=s.origin.multiplyBy(g).subtract(this._map._getNewPixelOrigin(c,h)).round();Fe.any3d?ma(s.el,E,g):Ft(s.el,E)},_resetGrid:function(){var s=this._map,c=s.options.crs,h=this._tileSize=this.getTileSize(),g=this._tileZoom,E=this._map.getPixelWorldBounds(this._tileZoom);E&&(this._globalTileRange=this._pxBoundsToTileRange(E)),this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,c.wrapLng[0]],g).x/h.x),Math.ceil(s.project([0,c.wrapLng[1]],g).x/h.y)],this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([c.wrapLat[0],0],g).y/h.x),Math.ceil(s.project([c.wrapLat[1],0],g).y/h.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var c=this._map,h=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),g=c.getZoomScale(h,this._tileZoom),E=c.project(s,this._tileZoom).floor(),P=c.getSize().divideBy(g*2);return new _e(E.subtract(P),E.add(P))},_update:function(s){var c=this._map;if(c){var h=this._clampZoom(c.getZoom());if(s===void 0&&(s=c.getCenter()),this._tileZoom!==void 0){var g=this._getTiledPixelBounds(s),E=this._pxBoundsToTileRange(g),P=E.getCenter(),V=[],re=this.options.keepBuffer,ue=new _e(E.getBottomLeft().subtract([re,-re]),E.getTopRight().add([re,-re]));if(!(isFinite(E.min.x)&&isFinite(E.min.y)&&isFinite(E.max.x)&&isFinite(E.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ve in this._tiles){var be=this._tiles[ve].coords;(be.z!==this._tileZoom||!ue.contains(new J(be.x,be.y)))&&(this._tiles[ve].current=!1)}if(Math.abs(h-this._tileZoom)>1){this._setView(s,h);return}for(var Me=E.min.y;Me<=E.max.y;Me++)for(var Ke=E.min.x;Ke<=E.max.x;Ke++){var Er=new J(Ke,Me);if(Er.z=this._tileZoom,!!this._isValidTile(Er)){var Kt=this._tiles[this._tileCoordsToKey(Er)];Kt?Kt.current=!0:V.push(Er)}}if(V.sort(function(Dr,fs){return Dr.distanceTo(P)-fs.distanceTo(P)}),V.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var ln=document.createDocumentFragment();for(Ke=0;Ke<V.length;Ke++)this._addTile(V[Ke],ln);this._level.el.appendChild(ln)}}}},_isValidTile:function(s){var c=this._map.options.crs;if(!c.infinite){var h=this._globalTileRange;if(!c.wrapLng&&(s.x<h.min.x||s.x>h.max.x)||!c.wrapLat&&(s.y<h.min.y||s.y>h.max.y))return!1}if(!this.options.bounds)return!0;var g=this._tileCoordsToBounds(s);return H(this.options.bounds).overlaps(g)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var c=this._map,h=this.getTileSize(),g=s.scaleBy(h),E=g.add(h),P=c.unproject(g,s.z),V=c.unproject(E,s.z);return[P,V]},_tileCoordsToBounds:function(s){var c=this._tileCoordsToNwSe(s),h=new Z(c[0],c[1]);return this.options.noWrap||(h=this._map.wrapLatLngBounds(h)),h},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var c=s.split(":"),h=new J(+c[0],+c[1]);return h.z=+c[2],h},_removeTile:function(s){var c=this._tiles[s];c&&(_t(c.el),delete this._tiles[s],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){Ge(s,"leaflet-tile");var c=this.getTileSize();s.style.width=c.x+"px",s.style.height=c.y+"px",s.onselectstart=m,s.onmousemove=m,Fe.ielt9&&this.options.opacity<1&&sn(s,this.options.opacity)},_addTile:function(s,c){var h=this._getTilePos(s),g=this._tileCoordsToKey(s),E=this.createTile(this._wrapCoords(s),o(this._tileReady,this,s));this._initTile(E),this.createTile.length<2&&G(o(this._tileReady,this,s,null,E)),Ft(E,h),this._tiles[g]={el:E,coords:s,current:!0},c.appendChild(E),this.fire("tileloadstart",{tile:E,coords:s})},_tileReady:function(s,c,h){c&&this.fire("tileerror",{error:c,tile:h,coords:s});var g=this._tileCoordsToKey(s);h=this._tiles[g],h&&(h.loaded=+new Date,this._map._fadeAnimated?(sn(h.el,0),X(this._fadeFrame),this._fadeFrame=G(this._updateOpacity,this)):(h.active=!0,this._pruneTiles()),c||(Ge(h.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:h.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Fe.ielt9||!this._map._fadeAnimated?G(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var c=new J(this._wrapX?d(s.x,this._wrapX):s.x,this._wrapY?d(s.y,this._wrapY):s.y);return c.z=s.z,c},_pxBoundsToTileRange:function(s){var c=this.getTileSize();return new _e(s.min.unscaleBy(c).floor(),s.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function Mw(s){return new To(s)}var us=To.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,c){this._url=s,c=_(this,c),c.detectRetina&&Fe.retina&&c.maxZoom>0?(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom=Math.min(c.maxZoom,c.minZoom+1)):(c.zoomOffset++,c.maxZoom=Math.max(c.minZoom,c.maxZoom-1)),c.minZoom=Math.max(0,c.minZoom)):c.zoomReverse?c.minZoom=Math.min(c.maxZoom,c.minZoom):c.maxZoom=Math.max(c.minZoom,c.maxZoom),typeof c.subdomains=="string"&&(c.subdomains=c.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,c){return this._url===s&&c===void 0&&(c=!0),this._url=s,c||this.redraw(),this},createTile:function(s,c){var h=document.createElement("img");return We(h,"load",o(this._tileOnLoad,this,c,h)),We(h,"error",o(this._tileOnError,this,c,h)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(h.referrerPolicy=this.options.referrerPolicy),h.alt="",h.src=this.getTileUrl(s),h},getTileUrl:function(s){var c={r:Fe.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var h=this._globalTileRange.max.y-s.y;this.options.tms&&(c.y=h),c["-y"]=h}return k(this._url,i(c,this.options))},_tileOnLoad:function(s,c){Fe.ielt9?setTimeout(o(s,this,null,c),0):s(null,c)},_tileOnError:function(s,c,h){var g=this.options.errorTileUrl;g&&c.getAttribute("src")!==g&&(c.src=g),s(h,c)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,c=this.options.maxZoom,h=this.options.zoomReverse,g=this.options.zoomOffset;return h&&(s=c-s),s+g},_getSubdomain:function(s){var c=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[c]},_abortLoading:function(){var s,c;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(c=this._tiles[s].el,c.onload=m,c.onerror=m,!c.complete)){c.src=O;var h=this._tiles[s].coords;_t(c),delete this._tiles[s],this.fire("tileabort",{tile:c,coords:h})}},_removeTile:function(s){var c=this._tiles[s];if(c)return c.el.setAttribute("src",O),To.prototype._removeTile.call(this,s)},_tileReady:function(s,c,h){if(!(!this._map||h&&h.getAttribute("src")===O))return To.prototype._tileReady.call(this,s,c,h)}});function wm(s,c){return new us(s,c)}var km=us.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,c){this._url=s;var h=i({},this.defaultWmsParams);for(var g in c)g in this.options||(h[g]=c[g]);c=_(this,c);var E=c.detectRetina&&Fe.retina?2:1,P=this.getTileSize();h.width=P.x*E,h.height=P.y*E,this.wmsParams=h},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var c=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[c]=this._crs.code,us.prototype.onAdd.call(this,s)},getTileUrl:function(s){var c=this._tileCoordsToNwSe(s),h=this._crs,g=N(h.project(c[0]),h.project(c[1])),E=g.min,P=g.max,V=(this._wmsVersion>=1.3&&this._crs===pm?[E.y,E.x,P.y,P.x]:[E.x,E.y,P.x,P.y]).join(","),re=us.prototype.getTileUrl.call(this,s);return re+S(this.wmsParams,re,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+V},setParams:function(s,c){return i(this.wmsParams,s),c||this.redraw(),this}});function Bw(s,c){return new km(s,c)}us.WMS=km,wm.wms=Bw;var ci=Sn.extend({options:{padding:.1},initialize:function(s){_(this,s),u(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Ge(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,c){var h=this._map.getZoomScale(c,this._zoom),g=this._map.getSize().multiplyBy(.5+this.options.padding),E=this._map.project(this._center,c),P=g.multiplyBy(-h).add(E).subtract(this._map._getNewPixelOrigin(s,c));Fe.any3d?ma(this._container,P,h):Ft(this._container,P)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,c=this._map.getSize(),h=this._map.containerPointToLayerPoint(c.multiplyBy(-s)).round();this._bounds=new _e(h,h.add(c.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Em=ci.extend({options:{tolerance:0},getEvents:function(){var s=ci.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ci.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");We(s,"mousemove",this._onMouseMove,this),We(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),We(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){X(this._redrawRequest),delete this._ctx,_t(this._container),ot(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var c in this._layers)s=this._layers[c],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ci.prototype._update.call(this);var s=this._bounds,c=this._container,h=s.getSize(),g=Fe.retina?2:1;Ft(c,s.min),c.width=g*h.x,c.height=g*h.y,c.style.width=h.x+"px",c.style.height=h.y+"px",Fe.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){ci.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[u(s)]=s;var c=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=c),this._drawLast=c,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var c=s._order,h=c.next,g=c.prev;h?h.prev=g:this._drawLast=g,g?g.next=h:this._drawFirst=h,delete s._order,delete this._layers[u(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var c=s.options.dashArray.split(/[, ]+/),h=[],g,E;for(E=0;E<c.length;E++){if(g=Number(c[E]),isNaN(g))return;h.push(g)}s.options._dashArray=h}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||G(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var c=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new _e,this._redrawBounds.extend(s._pxBounds.min.subtract([c,c])),this._redrawBounds.extend(s._pxBounds.max.add([c,c]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var c=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,c.x,c.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,c=this._redrawBounds;if(this._ctx.save(),c){var h=c.getSize();this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,h.x,h.y),this._ctx.clip()}this._drawing=!0;for(var g=this._drawFirst;g;g=g.next)s=g.layer,(!c||s._pxBounds&&s._pxBounds.intersects(c))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,c){if(this._drawing){var h,g,E,P,V=s._parts,re=V.length,ue=this._ctx;if(re){for(ue.beginPath(),h=0;h<re;h++){for(g=0,E=V[h].length;g<E;g++)P=V[h][g],ue[g?"lineTo":"moveTo"](P.x,P.y);c&&ue.closePath()}this._fillStroke(ue,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var c=s._point,h=this._ctx,g=Math.max(Math.round(s._radius),1),E=(Math.max(Math.round(s._radiusY),1)||g)/g;E!==1&&(h.save(),h.scale(1,E)),h.beginPath(),h.arc(c.x,c.y/E,g,0,Math.PI*2,!1),E!==1&&h.restore(),this._fillStroke(h,s)}},_fillStroke:function(s,c){var h=c.options;h.fill&&(s.globalAlpha=h.fillOpacity,s.fillStyle=h.fillColor||h.color,s.fill(h.fillRule||"evenodd")),h.stroke&&h.weight!==0&&(s.setLineDash&&s.setLineDash(c.options&&c.options._dashArray||[]),s.globalAlpha=h.opacity,s.lineWidth=h.weight,s.strokeStyle=h.color,s.lineCap=h.lineCap,s.lineJoin=h.lineJoin,s.stroke())},_onClick:function(s){for(var c=this._map.mouseEventToLayerPoint(s),h,g,E=this._drawFirst;E;E=E.next)h=E.layer,h.options.interactive&&h._containsPoint(c)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(h))&&(g=h);this._fireEvent(g?[g]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var c=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,c)}},_handleMouseOut:function(s){var c=this._hoveredLayer;c&&(At(this._container,"leaflet-interactive"),this._fireEvent([c],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,c){if(!this._mouseHoverThrottled){for(var h,g,E=this._drawFirst;E;E=E.next)h=E.layer,h.options.interactive&&h._containsPoint(c)&&(g=h);g!==this._hoveredLayer&&(this._handleMouseOut(s),g&&(Ge(this._container,"leaflet-interactive"),this._fireEvent([g],s,"mouseover"),this._hoveredLayer=g)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,c,h){this._map._fireDOMEvent(c,h||c.type,s)},_bringToFront:function(s){var c=s._order;if(c){var h=c.next,g=c.prev;if(h)h.prev=g;else return;g?g.next=h:h&&(this._drawFirst=h),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(s)}},_bringToBack:function(s){var c=s._order;if(c){var h=c.next,g=c.prev;if(g)g.next=h;else return;h?h.prev=g:g&&(this._drawLast=g),c.prev=null,c.next=this._drawFirst,this._drawFirst.prev=c,this._drawFirst=c,this._requestRedraw(s)}}});function Sm(s){return Fe.canvas?new Em(s):null}var Co=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),jw={_initContainer:function(){this._container=$e("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ci.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var c=s._container=Co("shape");Ge(c,"leaflet-vml-shape "+(this.options.className||"")),c.coordsize="1 1",s._path=Co("path"),c.appendChild(s._path),this._updateStyle(s),this._layers[u(s)]=s},_addPath:function(s){var c=s._container;this._container.appendChild(c),s.options.interactive&&s.addInteractiveTarget(c)},_removePath:function(s){var c=s._container;_t(c),s.removeInteractiveTarget(c),delete this._layers[u(s)]},_updateStyle:function(s){var c=s._stroke,h=s._fill,g=s.options,E=s._container;E.stroked=!!g.stroke,E.filled=!!g.fill,g.stroke?(c||(c=s._stroke=Co("stroke")),E.appendChild(c),c.weight=g.weight+"px",c.color=g.color,c.opacity=g.opacity,g.dashArray?c.dashStyle=y(g.dashArray)?g.dashArray.join(" "):g.dashArray.replace(/( *, *)/g," "):c.dashStyle="",c.endcap=g.lineCap.replace("butt","flat"),c.joinstyle=g.lineJoin):c&&(E.removeChild(c),s._stroke=null),g.fill?(h||(h=s._fill=Co("fill")),E.appendChild(h),h.color=g.fillColor||g.color,h.opacity=g.fillOpacity):h&&(E.removeChild(h),s._fill=null)},_updateCircle:function(s){var c=s._point.round(),h=Math.round(s._radius),g=Math.round(s._radiusY||h);this._setPath(s,s._empty()?"M0 0":"AL "+c.x+","+c.y+" "+h+","+g+" 0,"+65535*360)},_setPath:function(s,c){s._path.v=c},_bringToFront:function(s){is(s._container)},_bringToBack:function(s){as(s._container)}},Tc=Fe.vml?Co:nt,bo=ci.extend({_initContainer:function(){this._container=Tc("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Tc("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){_t(this._container),ot(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ci.prototype._update.call(this);var s=this._bounds,c=s.getSize(),h=this._container;(!this._svgSize||!this._svgSize.equals(c))&&(this._svgSize=c,h.setAttribute("width",c.x),h.setAttribute("height",c.y)),Ft(h,s.min),h.setAttribute("viewBox",[s.min.x,s.min.y,c.x,c.y].join(" ")),this.fire("update")}},_initPath:function(s){var c=s._path=Tc("path");s.options.className&&Ge(c,s.options.className),s.options.interactive&&Ge(c,"leaflet-interactive"),this._updateStyle(s),this._layers[u(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){_t(s._path),s.removeInteractiveTarget(s._path),delete this._layers[u(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var c=s._path,h=s.options;c&&(h.stroke?(c.setAttribute("stroke",h.color),c.setAttribute("stroke-opacity",h.opacity),c.setAttribute("stroke-width",h.weight),c.setAttribute("stroke-linecap",h.lineCap),c.setAttribute("stroke-linejoin",h.lineJoin),h.dashArray?c.setAttribute("stroke-dasharray",h.dashArray):c.removeAttribute("stroke-dasharray"),h.dashOffset?c.setAttribute("stroke-dashoffset",h.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),h.fill?(c.setAttribute("fill",h.fillColor||h.color),c.setAttribute("fill-opacity",h.fillOpacity),c.setAttribute("fill-rule",h.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(s,c){this._setPath(s,ze(s._parts,c))},_updateCircle:function(s){var c=s._point,h=Math.max(Math.round(s._radius),1),g=Math.max(Math.round(s._radiusY),1)||h,E="a"+h+","+g+" 0 1,0 ",P=s._empty()?"M0 0":"M"+(c.x-h)+","+c.y+E+h*2+",0 "+E+-h*2+",0 ";this._setPath(s,P)},_setPath:function(s,c){s._path.setAttribute("d",c)},_bringToFront:function(s){is(s._path)},_bringToBack:function(s){as(s._path)}});Fe.vml&&bo.include(jw);function Tm(s){return Fe.svg||Fe.vml?new bo(s):null}Je.include({getRenderer:function(s){var c=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return c||(c=this._renderer=this._createRenderer()),this.hasLayer(c)||this.addLayer(c),c},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var c=this._paneRenderers[s];return c===void 0&&(c=this._createRenderer({pane:s}),this._paneRenderers[s]=c),c},_createRenderer:function(s){return this.options.preferCanvas&&Sm(s)||Tm(s)}});var Cm=ls.extend({initialize:function(s,c){ls.prototype.initialize.call(this,this._boundsToLatLngs(s),c)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=H(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function Uw(s,c){return new Cm(s,c)}bo.create=Tc,bo.pointsToPath=ze,li.geometryToLayer=_c,li.coordsToLatLng=Q0,li.coordsToLatLngs=xc,li.latLngToCoords=ef,li.latLngsToCoords=yc,li.getFeature=cs,li.asFeature=wc,Je.mergeOptions({boxZoom:!0});var bm=Wn.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){We(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){ot(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){_t(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),_o(),D0(),this._startPoint=this._map.mouseEventToContainerPoint(s),We(document,{contextmenu:_a,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=$e("div","leaflet-zoom-box",this._container),Ge(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var c=new _e(this._point,this._startPoint),h=c.getSize();Ft(this._box,c.min),this._box.style.width=h.x+"px",this._box.style.height=h.y+"px"},_finish:function(){this._moved&&(_t(this._box),At(this._container,"leaflet-crosshair")),xo(),M0(),ot(document,{contextmenu:_a,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var c=new Z(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(c).fire("boxzoomend",{boxZoomBounds:c})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Je.addInitHook("addHandler","boxZoom",bm),Je.mergeOptions({doubleClickZoom:!0});var Am=Wn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var c=this._map,h=c.getZoom(),g=c.options.zoomDelta,E=s.originalEvent.shiftKey?h-g:h+g;c.options.doubleClickZoom==="center"?c.setZoom(E):c.setZoomAround(s.containerPoint,E)}});Je.addInitHook("addHandler","doubleClickZoom",Am),Je.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Pm=Wn.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new Li(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}Ge(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){At(this._map._container,"leaflet-grab"),At(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=H(this._map.options.maxBounds);this._offsetLimit=N(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var c=this._lastTime=+new Date,h=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(h),this._times.push(c),this._prunePositions(c)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),c=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=c.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,c){return s-(s-c)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;s.x<c.min.x&&(s.x=this._viscousLimit(s.x,c.min.x)),s.y<c.min.y&&(s.y=this._viscousLimit(s.y,c.min.y)),s.x>c.max.x&&(s.x=this._viscousLimit(s.x,c.max.x)),s.y>c.max.y&&(s.y=this._viscousLimit(s.y,c.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,c=Math.round(s/2),h=this._initialWorldOffset,g=this._draggable._newPos.x,E=(g-c+h)%s+c-h,P=(g+c+h)%s-c-h,V=Math.abs(E+h)<Math.abs(P+h)?E:P;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=V},_onDragEnd:function(s){var c=this._map,h=c.options,g=!h.inertia||s.noInertia||this._times.length<2;if(c.fire("dragend",s),g)c.fire("moveend");else{this._prunePositions(+new Date);var E=this._lastPos.subtract(this._positions[0]),P=(this._lastTime-this._times[0])/1e3,V=h.easeLinearity,re=E.multiplyBy(V/P),ue=re.distanceTo([0,0]),ve=Math.min(h.inertiaMaxSpeed,ue),be=re.multiplyBy(ve/ue),Me=ve/(h.inertiaDeceleration*V),Ke=be.multiplyBy(-Me/2).round();!Ke.x&&!Ke.y?c.fire("moveend"):(Ke=c._limitOffset(Ke,c.options.maxBounds),G(function(){c.panBy(Ke,{duration:Me,easeLinearity:V,noMoveStart:!0,animate:!0})}))}}});Je.addInitHook("addHandler","dragging",Pm),Je.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Om=Wn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),We(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),ot(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,c=document.documentElement,h=s.scrollTop||c.scrollTop,g=s.scrollLeft||c.scrollLeft;this._map._container.focus(),window.scrollTo(g,h)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var c=this._panKeys={},h=this.keyCodes,g,E;for(g=0,E=h.left.length;g<E;g++)c[h.left[g]]=[-1*s,0];for(g=0,E=h.right.length;g<E;g++)c[h.right[g]]=[s,0];for(g=0,E=h.down.length;g<E;g++)c[h.down[g]]=[0,s];for(g=0,E=h.up.length;g<E;g++)c[h.up[g]]=[0,-1*s]},_setZoomDelta:function(s){var c=this._zoomKeys={},h=this.keyCodes,g,E;for(g=0,E=h.zoomIn.length;g<E;g++)c[h.zoomIn[g]]=s;for(g=0,E=h.zoomOut.length;g<E;g++)c[h.zoomOut[g]]=-s},_addHooks:function(){We(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){ot(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var c=s.keyCode,h=this._map,g;if(c in this._panKeys){if(!h._panAnim||!h._panAnim._inProgress)if(g=this._panKeys[c],s.shiftKey&&(g=ce(g).multiplyBy(3)),h.options.maxBounds&&(g=h._limitOffset(ce(g),h.options.maxBounds)),h.options.worldCopyJump){var E=h.wrapLatLng(h.unproject(h.project(h.getCenter()).add(g)));h.panTo(E)}else h.panBy(g)}else if(c in this._zoomKeys)h.setZoom(h.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[c]);else if(c===27&&h._popup&&h._popup.options.closeOnEscapeKey)h.closePopup();else return;_a(s)}}});Je.addInitHook("addHandler","keyboard",Om),Je.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Rm=Wn.extend({addHooks:function(){We(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){ot(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var c=tm(s),h=this._map.options.wheelDebounceTime;this._delta+=c,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var g=Math.max(h-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),g),_a(s)},_performZoom:function(){var s=this._map,c=s.getZoom(),h=this._map.options.zoomSnap||0;s._stop();var g=this._delta/(this._map.options.wheelPxPerZoomLevel*4),E=4*Math.log(2/(1+Math.exp(-Math.abs(g))))/Math.LN2,P=h?Math.ceil(E/h)*h:E,V=s._limitZoom(c+(this._delta>0?P:-P))-c;this._delta=0,this._startTime=null,V&&(s.options.scrollWheelZoom==="center"?s.setZoom(c+V):s.setZoomAround(this._lastMousePos,c+V))}});Je.addInitHook("addHandler","scrollWheelZoom",Rm);var zw=600;Je.mergeOptions({tapHold:Fe.touchNative&&Fe.safari&&Fe.mobile,tapTolerance:15});var Fm=Wn.extend({addHooks:function(){We(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){ot(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var c=s.touches[0];this._startPos=this._newPos=new J(c.clientX,c.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(We(document,"touchend",er),We(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",c))},this),zw),We(document,"touchend touchcancel contextmenu",this._cancel,this),We(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){ot(document,"touchend",er),ot(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),ot(document,"touchend touchcancel contextmenu",this._cancel,this),ot(document,"touchmove",this._onMove,this)},_onMove:function(s){var c=s.touches[0];this._newPos=new J(c.clientX,c.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,c){var h=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY});h._simulated=!0,c.target.dispatchEvent(h)}});Je.addInitHook("addHandler","tapHold",Fm),Je.mergeOptions({touchZoom:Fe.touch,bounceAtZoomLimits:!0});var Lm=Wn.extend({addHooks:function(){Ge(this._map._container,"leaflet-touch-zoom"),We(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){At(this._map._container,"leaflet-touch-zoom"),ot(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var c=this._map;if(!(!s.touches||s.touches.length!==2||c._animatingZoom||this._zooming)){var h=c.mouseEventToContainerPoint(s.touches[0]),g=c.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),c.options.touchZoom!=="center"&&(this._pinchStartLatLng=c.containerPointToLatLng(h.add(g)._divideBy(2))),this._startDist=h.distanceTo(g),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),We(document,"touchmove",this._onTouchMove,this),We(document,"touchend touchcancel",this._onTouchEnd,this),er(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var c=this._map,h=c.mouseEventToContainerPoint(s.touches[0]),g=c.mouseEventToContainerPoint(s.touches[1]),E=h.distanceTo(g)/this._startDist;if(this._zoom=c.getScaleZoom(E,this._startZoom),!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&E<1||this._zoom>c.getMaxZoom()&&E>1)&&(this._zoom=c._limitZoom(this._zoom)),c.options.touchZoom==="center"){if(this._center=this._startLatLng,E===1)return}else{var P=h._add(g)._divideBy(2)._subtract(this._centerPoint);if(E===1&&P.x===0&&P.y===0)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(P),this._zoom)}this._moved||(c._moveStart(!0,!1),this._moved=!0),X(this._animRequest);var V=o(c._move,c,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=G(V,this,!0),er(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,X(this._animRequest),ot(document,"touchmove",this._onTouchMove,this),ot(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Je.addInitHook("addHandler","touchZoom",Lm),Je.BoxZoom=bm,Je.DoubleClickZoom=Am,Je.Drag=Pm,Je.Keyboard=Om,Je.ScrollWheelZoom=Rm,Je.TapHold=Fm,Je.TouchZoom=Lm,r.Bounds=_e,r.Browser=Fe,r.CRS=xe,r.Canvas=Em,r.Circle=J0,r.CircleMarker=vc,r.Class=de,r.Control=En,r.DivIcon=ym,r.DivOverlay=Hn,r.DomEvent=aw,r.DomUtil=nw,r.Draggable=Li,r.Evented=ge,r.FeatureGroup=si,r.GeoJSON=li,r.GridLayer=To,r.Handler=Wn,r.Icon=os,r.ImageOverlay=kc,r.LatLng=W,r.LatLngBounds=Z,r.Layer=Sn,r.LayerGroup=ss,r.LineUtil=_w,r.Map=Je,r.Marker=gc,r.Mixin=hw,r.Path=Ii,r.Point=J,r.PolyUtil=dw,r.Polygon=ls,r.Polyline=oi,r.Popup=Ec,r.PosAnimation=rm,r.Projection=xw,r.Rectangle=Cm,r.Renderer=ci,r.SVG=bo,r.SVGOverlay=xm,r.TileLayer=us,r.Tooltip=Sc,r.Transformation=Ae,r.Util=Y,r.VideoOverlay=_m,r.bind=o,r.bounds=N,r.canvas=Sm,r.circle=bw,r.circleMarker=Cw,r.control=ko,r.divIcon=Dw,r.extend=i,r.featureGroup=Ew,r.geoJSON=vm,r.geoJson=Ow,r.gridLayer=Mw,r.icon=Sw,r.imageOverlay=Rw,r.latLng=te,r.latLngBounds=H,r.layerGroup=kw,r.map=sw,r.marker=Tw,r.point=ce,r.polygon=Pw,r.polyline=Aw,r.popup=Iw,r.rectangle=Uw,r.setOptions=_,r.stamp=u,r.svg=Tm,r.svgOverlay=Lw,r.tileLayer=wm,r.tooltip=Nw,r.transformation=D,r.version=n,r.videoOverlay=Fw;var $w=window.L;r.noConflict=function(){return window.L=$w,this},window.L=r})})(cd,cd.exports);var Ep=cd.exports;function py(e,t,r){return Object.freeze({instance:e,context:t,container:r})}function my(e,t){return t==null?function(n,i){const a=ie.useRef();return a.current||(a.current=e(n,i)),a}:function(n,i){const a=ie.useRef();a.current||(a.current=e(n,i));const o=ie.useRef(n),{instance:l}=a.current;return ie.useEffect(function(){o.current!==n&&(t(l,n,o.current),o.current=n)},[l,n,i]),a}}function gy(e,t){ie.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){var a;(a=t.layerContainer)==null||a.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function _C(e){return function(r){const n=hy(),i=e(kp(r,n),n);return hC(n.map,r.attribution),dy(i.current,r.eventHandlers),gy(i.current,n),i}}function xC(e,t){const r=ie.useRef();ie.useEffect(function(){if(t.pathOptions!==r.current){const i=t.pathOptions??{};e.instance.setStyle(i),r.current=i}},[e,t])}function yC(e){return function(r){const n=hy(),i=e(kp(r,n),n);return dy(i.current,r.eventHandlers),gy(i.current,n),xC(i.current,r),i}}function wC(e,t){const r=my(e,t),n=yC(r);return gC(n)}function kC(e,t){const r=my(e,t),n=_C(r);return vC(n)}function EC(e,t,r){const{opacity:n,zIndex:i}=t;n!=null&&n!==r.opacity&&e.setOpacity(n),i!=null&&i!==r.zIndex&&e.setZIndex(i)}const SC=wC(function({data:t,...r},n){const i=new Ep.GeoJSON(t,r);return py(i,mC(n,{overlayContainer:i}))},function(t,r,n){r.style!==n.style&&(r.style==null?t.resetStyle():t.setStyle(r.style))});function ud(){return ud=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ud.apply(this,arguments)}function TC({bounds:e,boundsOptions:t,center:r,children:n,className:i,id:a,placeholder:o,style:l,whenReady:u,zoom:f,...d},m){const[p]=ie.useState({className:i,id:a,style:l}),[v,x]=ie.useState(null);ie.useImperativeHandle(m,()=>(v==null?void 0:v.map)??null,[v]);const _=ie.useCallback(w=>{if(w!==null&&v===null){const k=new Ep.Map(w,d);r!=null&&f!=null?k.setView(r,f):e!=null&&k.fitBounds(e,t),u!=null&&k.whenReady(u),x(pC(k))}},[]);ie.useEffect(()=>()=>{v==null||v.map.remove()},[v]);const S=v?Q.createElement(fy,{value:v},n):o??null;return Q.createElement("div",ud({},p,{ref:_}),S)}const CC=ie.forwardRef(TC),bC=kC(function({url:t,...r},n){const i=new Ep.TileLayer(t,kp(r,n));return py(i,n)},function(t,r,n){EC(t,r,n);const{url:i}=r;i!=null&&i!==n.url&&t.setUrl(i)}),AC=CC;function PC({geojson:e}){return e?T.jsx("div",{className:"h-64 w-full border rounded overflow-hidden",children:T.jsxs(AC,{style:{height:"100%",width:"100%"},center:[20,0],zoom:2,scrollWheelZoom:!1,children:[T.jsx(bC,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),T.jsx(SC,{data:e})]})}):null}const Di="https://gnobnyzezkuyptuakztf.supabase.co/functions/v1/clever-function",vy={critical:{emoji:"",label:"CRITICAL",color:"bg-red-600"},warning:{emoji:"",label:"WARNING",color:"bg-orange-500"},caution:{emoji:"",label:"CAUTION",color:"bg-yellow-500"},informative:{emoji:"",label:"INFO",color:"bg-blue-500"}};function OC(e){const t=e.event_start_date||"",r=e.event_end_date||"";return t&&r?`${t}  ${r}`:t&&!r?`${t} (ongoing)`:!t&&r?`until ${r}`:"Ongoing"}function RC(e){const t=vy[e.severity],r=(e.event_type||"General").trim(),n=e.article_url||e.source_url||"";return`
${e.country}
${e.location}
${OC(e)}

${t.emoji} ${r}

${e.summary}

${e.recommendations?`Recommendations:
${e.recommendations}`:""}

${n?`Sources:
${n}`:""}
`.trim()}function FC({permissions:e}){const[t,r]=ie.useState([]),[n,i]=ie.useState({}),[a,o]=ie.useState({}),[l,u]=ie.useState({}),[f,d]=ie.useState(new Set),[m,p]=ie.useState(!0),[v,x]=ie.useState(null);ie.useEffect(()=>{e.canReview&&_()},[e.canReview]);async function _(){try{p(!0),x(null);const O=await fetch(`${Di}/alerts/review`);if(!O.ok)throw new Error(`Failed to load alerts (${O.status})`);const R=await O.json();r(Array.isArray(R.alerts)?R.alerts:[])}catch(O){x((O==null?void 0:O.message)||"Failed to load alerts")}finally{p(!1)}}async function S(O){await fetch(`${Di}/alerts/${O}/approve`,{method:"POST"}),r(R=>R.filter(C=>C.id!==O))}async function w(O){await fetch(`${Di}/alerts/${O}/dismiss`,{method:"POST"}),r(R=>R.filter(C=>C.id!==O))}async function k(O){window.confirm("Delete alert permanently?")&&(await fetch(`${Di}/alerts/${O}`,{method:"DELETE"}),r(R=>R.filter(C=>C.id!==O)))}async function y(){f.size&&window.confirm(`Dismiss ${f.size} alerts?`)&&(await Promise.all([...f].map(O=>fetch(`${Di}/alerts/${O}/dismiss`,{method:"POST"}))),r(O=>O.filter(R=>!f.has(R.id))),d(new Set))}async function b(){f.size&&window.confirm(`DELETE ${f.size} alerts?`)&&(await Promise.all([...f].map(O=>fetch(`${Di}/alerts/${O}`,{method:"DELETE"}))),r(O=>O.filter(R=>!f.has(R.id))),d(new Set))}return e.canReview?m?T.jsx("div",{className:"p-6",children:"Loading alerts"}):v?T.jsxs("div",{className:"p-4 border border-red-300 bg-red-50 rounded",children:[T.jsx("div",{className:"text-red-700 mb-2",children:v}),T.jsx("button",{className:"px-3 py-1 bg-red-600 text-white rounded",onClick:()=>void _(),children:"Retry"})]}):T.jsxs("div",{className:"space-y-4",children:[e.canScour&&T.jsx("div",{className:"flex justify-end",children:T.jsx("button",{className:"px-4 py-2 bg-indigo-600 text-white rounded",onClick:()=>fetch(`${Di}/scour-sources`,{method:"POST"}),children:"Run Scour"})}),e.canScour&&T.jsx("div",{className:"flex justify-end mb-3",children:T.jsx("button",{onClick:async()=>{await fetch(`${Di}/scour-sources`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}),window.alert("Scour started")},className:"px-4 py-2 bg-indigo-600 text-white rounded",children:"Run Scour"})}),f.size>0&&T.jsxs("div",{className:"sticky top-0 z-10 p-3 bg-gray-50 border rounded flex gap-3",children:[T.jsxs("strong",{children:[f.size," selected"]}),T.jsx("button",{onClick:y,className:"bg-yellow-600 text-white px-3 py-1 rounded",children:"Batch Dismiss"}),T.jsx("button",{onClick:b,className:"bg-red-600 text-white px-3 py-1 rounded",children:"Batch Delete"})]}),t.map(O=>{const R=vy[O.severity],C=!!n[O.id];return a[O.id],l[O.id],T.jsxs("div",{className:"border rounded bg-white shadow-sm",children:[T.jsxs("div",{className:"flex items-center gap-3 p-4",children:[T.jsx("input",{type:"checkbox",checked:f.has(O.id),onChange:()=>d(z=>{const M=new Set(z);return M.has(O.id)?M.delete(O.id):M.add(O.id),M})}),T.jsx("button",{className:"text-xs underline",onClick:()=>i(z=>({...z,[O.id]:!C})),children:C?"Collapse":"Expand"}),T.jsx("div",{className:"flex-1 font-semibold",children:O.title}),T.jsxs("span",{className:`text-xs text-white px-2 py-1 rounded ${R.color}`,children:[R.emoji," ",R.label]})]}),C&&T.jsxs("div",{className:"px-6 pb-4 space-y-4 text-sm",children:[T.jsx("div",{children:O.summary}),O.geojson&&T.jsx(PC,{geojson:O.geojson}),T.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.canApproveAndPost&&T.jsx("button",{onClick:()=>S(O.id),className:"bg-green-600 text-white px-3 py-1 rounded",children:"Approve & Post"}),e.canDismiss&&T.jsx("button",{onClick:()=>w(O.id),className:"bg-yellow-600 text-white px-3 py-1 rounded",children:"Dismiss"}),T.jsx("button",{onClick:()=>{navigator.clipboard.writeText(RC(O)),window.alert("Copied WhatsApp alert")},className:"px-3 py-1 border rounded",children:"Copy WhatsApp"}),e.canDelete&&T.jsx("button",{onClick:()=>k(O.id),className:"bg-red-600 text-white px-3 py-1 rounded",children:"Delete"})]})]})]},O.id)})]}):T.jsx("div",{className:"p-4 text-gray-500",children:"No review permissions"})}const LC="gnobnyzezkuyptuakztf",IC="clever-function";function NC(e){const t=e.startsWith("/")?e:`/${e}`;return`https://${LC}.supabase.co/functions/v1/${IC}${t}`}const DC="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imdub2JueXplemt1eXB0dWFrenRmIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2ODM4MTA5MywiZXhwIjoyMDgzOTU3MDkzfQ.tX4M3i08_d8P1gCTL37XogysPgAac-7Et09godBSdNA";async function ei(e,t,r={}){const n=NC(e),i={"Content-Type":"application/json",Authorization:`Bearer ${DC}`,...r.headers||{}},a=await fetch(n,{...r,headers:i});if(!a.ok){const o=await a.text();throw new Error(`API error ${a.status}: ${o}`)}return a.json()}async function Ha(e,t,r){return ei(e,r,{method:"POST",body:JSON.stringify(t)})}async function _y(e,t,r){return ei(e,r,{method:"PATCH",body:JSON.stringify(t)})}async function MC(e,t){return Ha("/sources/bulk",{sources:e},t)}const pe={magnusDarkGreen:"#1A4234",magnusAccentGreen:"#065831",magnusOrange:"#E67E22",magnusLightBg:"#F8FAF9",magnusDarkText:"#1A2622",success:"#38A169",warning:"#ED8936",danger:"#E53E3E",white:"#FFFFFF",gray50:"#F9FAFB",gray100:"#F3F4F6",gray200:"#E5E7EB",gray300:"#D1D5DB",gray500:"#6B7280",gray600:"#4B5563",gray700:"#374151",gray800:"#1F2937",blue50:"#eff6ff",blue100:"#dbeafe",blue600:"#2563eb",blue700:"#1d4ed8",blue800:"#1e40af",orange600:"#ea580c",orange700:"#c2410c",red50:"#fef2f2",red100:"#fee2e2",red200:"#fecaca",red500:"#ef4444",red600:"#dc2626",red700:"#b91c1c",purple100:"#f3e8ff",purple700:"#7e22ce"},xy={base:{backgroundColor:pe.white,border:`1px solid ${pe.gray200}`,borderRadius:"12px",padding:"1.5rem",boxShadow:"0 2px 4px rgba(26, 38, 34, 0.1)"}},pi={primary:{background:`linear-gradient(135deg, ${pe.magnusDarkGreen} 0%, ${pe.magnusAccentGreen} 100%)`,color:pe.magnusLightBg,border:"none",borderRadius:"8px",padding:"0.625rem 1.25rem",fontSize:"0.875rem",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.05em",cursor:"pointer",transition:"all 0.2s",boxShadow:"0 4px 6px -1px rgba(26, 66, 52, 0.3)",display:"inline-flex",alignItems:"center",gap:"0.5rem"},secondary:{backgroundColor:pe.white,color:pe.magnusOrange,border:`2px solid ${pe.magnusOrange}`,borderRadius:"8px",padding:"0.625rem 1.25rem",fontSize:"0.875rem",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.05em",cursor:"pointer",transition:"all 0.2s",display:"inline-flex",alignItems:"center",gap:"0.5rem"}},zf=[{value:"critical",label:"Critical",description:"Mass-casualty events, major terrorist attacks, armed conflict escalation, imminent life-threatening hazards",color:pe.red600},{value:"warning",label:"Warning",description:"Significant disruption, violence, unrest, major infrastructure impact",color:pe.orange600},{value:"caution",label:"Caution",description:"Localized incidents, moderate disruption, travelers should take extra care",color:pe.warning},{value:"informative",label:"Informative",description:"Routine advisories, low-impact updates, general reminders",color:pe.blue600}],BC=["Armed Conflict","Terrorism","Civil Unrest","Political Instability","Natural Disaster","Health Emergency","Infrastructure Disruption","Crime / Safety","Transportation Disruption","Environmental Hazard","Other"],jC=["city","region","country","multi-country"],UC=["Afghanistan","Albania","Algeria","Argentina","Armenia","Australia","Austria","Azerbaijan","Bahrain","Bangladesh","Belarus","Belgium","Bolivia","Bosnia and Herzegovina","Brazil","Bulgaria","Cambodia","Cameroon","Canada","Chile","China","Colombia","Costa Rica","Croatia","Cuba","Cyprus","Czech Republic","Democratic Republic of Congo","Denmark","Dominican Republic","Ecuador","Egypt","El Salvador","Estonia","Ethiopia","Finland","France","Georgia","Germany","Ghana","Greece","Guatemala","Haiti","Honduras","Hong Kong","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Ivory Coast","Jamaica","Japan","Jordan","Kazakhstan","Kenya","Kosovo","Kuwait","Kyrgyzstan","Laos","Latvia","Lebanon","Libya","Lithuania","Luxembourg","Malaysia","Mali","Malta","Mexico","Moldova","Mongolia","Montenegro","Morocco","Mozambique","Myanmar","Nepal","Netherlands","New Zealand","Nicaragua","Niger","Nigeria","North Korea","North Macedonia","Norway","Oman","Pakistan","Palestine","Panama","Paraguay","Peru","Philippines","Poland","Portugal","Qatar","Romania","Russia","Rwanda","Saudi Arabia","Senegal","Serbia","Singapore","Slovakia","Slovenia","Somalia","South Africa","South Korea","South Sudan","Spain","Sri Lanka","Sudan","Sweden","Switzerland","Syria","Taiwan","Tajikistan","Tanzania","Thailand","Tunisia","Turkey","Turkmenistan","Uganda","Ukraine","United Arab Emirates","United Kingdom","United States","Uruguay","Uzbekistan","Venezuela","Vietnam","Yemen","Zambia","Zimbabwe"],kg={title:"",country:"",region:"",location:"",summary:"",recommendations:["","","",""],sources:[{url:"",title:""}],severity:"informative",event_type:"",geo_scope:"city",latitude:"",longitude:"",radius_km:"25",event_start_at:"",event_end_at:""};function zC({accessToken:e,permissions:t,onAlertCreated:r}){var xe,Te;const[n,i]=ie.useState(kg),[a,o]=ie.useState(!1),[l,u]=ie.useState(null),[f,d]=ie.useState(null),[m,p]=ie.useState(!1);if(t&&!t.canCreate)return T.jsx("div",{style:{padding:"2rem",textAlign:"center",color:pe.gray500},children:"You don't have permission to create alerts."});const v=ie.useMemo(()=>{const ee=[];n.title.trim()||ee.push("Title is required"),n.title.length<10&&ee.push("Title should be at least 10 characters"),n.country||ee.push("Country is required"),n.location.trim()||ee.push("Location is required"),n.summary.trim()||ee.push("Summary is required"),n.summary.length<50&&ee.push("Summary should be at least 50 characters"),n.recommendations.filter(D=>D.trim()).length<2&&ee.push("At least 2 recommendations items are required");const Ae=n.sources.filter(D=>D.url.trim());Ae.length===0&&ee.push("At least 1 source URL is recommended for WP export");for(const D of Ae)try{new URL(D.url)}catch{ee.push(`Invalid URL: ${D.url}`)}if(n.latitude&&n.longitude){const D=parseFloat(n.latitude),Ze=parseFloat(n.longitude);(isNaN(D)||D<-90||D>90)&&ee.push("Latitude must be between -90 and 90"),(isNaN(Ze)||Ze<-180||Ze>180)&&ee.push("Longitude must be between -180 and 180")}return{isValid:ee.length===0,errors:ee,warnings:Ae.length===0?["No sources provided - WordPress export may be incomplete"]:[]}},[n]),x=ie.useCallback((ee,oe)=>{i(Ae=>({...Ae,[ee]:oe})),u(null),d(null)},[]),_=ie.useCallback((ee,oe)=>{i(Ae=>{const D=[...Ae.recommendations];return D[ee]=oe,{...Ae,recommendations:D}})},[]),S=ie.useCallback(()=>{i(ee=>({...ee,recommendations:[...ee.recommendations,""]}))},[]),w=ie.useCallback(ee=>{i(oe=>({...oe,recommendations:oe.recommendations.filter((Ae,D)=>D!==ee)}))},[]),k=ie.useCallback((ee,oe,Ae)=>{i(D=>{const Ze=[...D.sources];return Ze[ee]={...Ze[ee],[oe]:Ae},{...D,sources:Ze}})},[]),y=ie.useCallback(()=>{i(ee=>({...ee,sources:[...ee.sources,{url:"",title:""}]}))},[]),b=ie.useCallback(ee=>{i(oe=>({...oe,sources:oe.sources.filter((Ae,D)=>D!==ee)}))},[]),O=ie.useCallback(()=>{i(kg),u(null),d(null),p(!1)},[]),R=ie.useCallback(async ee=>{if(ee.preventDefault(),!v.isValid){u(v.errors.join(". "));return}o(!0),u(null),d(null);try{const oe={status:"draft",title:n.title.trim(),country:n.country,region:n.region.trim()||null,location:n.location.trim(),summary:n.summary.trim(),recommendations:n.recommendations.filter(D=>D.trim()).map(D=>D.trim()),sources:n.sources.filter(D=>D.url.trim()).map(D=>{var Ze;return{url:D.url.trim(),title:((Ze=D.title)==null?void 0:Ze.trim())||void 0}}),severity:n.severity,event_type:n.event_type||null,geo_scope:n.geo_scope||null};n.latitude&&n.longitude&&(oe.latitude=parseFloat(n.latitude),oe.longitude=parseFloat(n.longitude),oe.radius_km=parseFloat(n.radius_km)||25,oe.geojson=C(oe.latitude,oe.longitude,oe.radius_km)),n.event_start_at&&(oe.event_start_at=new Date(n.event_start_at).toISOString()),n.event_end_at&&(oe.event_end_at=new Date(n.event_end_at).toISOString());const Ae=await Ha("/alerts",oe,e);if(Ae.ok&&Ae.alert)d(`Alert created successfully! ID: ${Ae.alert.id}`),r==null||r(Ae.alert),O();else throw new Error(Ae.error||"Failed to create alert")}catch(oe){const Ae=oe instanceof Error?oe.message:"Failed to create alert";u(Ae)}finally{o(!1)}},[n,v,e,r,O]);function C(ee,oe,Ae){const Ze=Ae/6371,qe=ee*Math.PI/180,nt=oe*Math.PI/180,ze=28,Ee=[];for(let it=0;it<=ze;it++){const Qt=2*Math.PI*it/ze,ur=Math.sin(qe),fr=Math.cos(qe),yn=Math.sin(Ze),Ir=Math.cos(Ze),Vt=Math.asin(ur*Ir+fr*yn*Math.cos(Qt)),Wr=nt+Math.atan2(Math.sin(Qt)*yn*fr,Ir-ur*Math.sin(Vt));Ee.push([Number((Wr*180/Math.PI).toFixed(6)),Number((Vt*180/Math.PI).toFixed(6))])}return{type:"Feature",properties:{shape:"circle",radiusKm:Ae},geometry:{type:"Polygon",coordinates:[Ee]}}}const z={padding:"1rem",maxWidth:"900px",margin:"0 auto"},M={marginBottom:"1.5rem"},K={fontSize:"1.5rem",fontWeight:600,color:pe.magnusDarkGreen,margin:0},G={fontSize:"0.875rem",color:pe.gray600,marginTop:"0.5rem"},X={...xy.base,padding:"1.5rem",marginBottom:"1.5rem"},Y={fontSize:"1.125rem",fontWeight:600,color:pe.magnusDarkText,marginBottom:"1rem",paddingBottom:"0.5rem",borderBottom:`1px solid ${pe.gray200}`},de={marginBottom:"1rem"},he={display:"block",marginBottom:"0.375rem",fontSize:"0.875rem",fontWeight:500,color:pe.gray700},me={color:pe.red500,marginLeft:"2px"},ge={width:"100%",padding:"0.75rem",border:`1px solid ${pe.gray300}`,borderRadius:"8px",fontSize:"1rem",transition:"border-color 0.2s"},J={...ge,minHeight:"100px",resize:"vertical"},q={...ge,backgroundColor:"white"},ce={display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},_e={padding:"1rem",backgroundColor:pe.red50,border:`1px solid ${pe.red200}`,borderRadius:"8px",color:pe.red700,marginBottom:"1rem"},N={padding:"1rem",backgroundColor:pe.success+"15",border:`1px solid ${pe.success}`,borderRadius:"8px",color:pe.magnusDarkGreen,marginBottom:"1rem"},Z={padding:"0.75rem",backgroundColor:pe.warning+"15",border:`1px solid ${pe.warning}`,borderRadius:"8px",color:pe.orange700,marginBottom:"1rem",fontSize:"0.875rem"},H={display:"flex",gap:"1rem",justifyContent:"flex-end",flexWrap:"wrap"},W={fontSize:"0.75rem",color:pe.gray500,marginTop:"0.25rem"};function te(){const ee=`
      <p><strong>Country:</strong> ${n.country||"(not set)"}</p>
      ${n.location?`<p><strong>Location:</strong> ${n.location}</p>`:""}
      ${n.summary?`<p>${n.summary}</p>`:""}
      ${n.recommendations.filter(oe=>oe.trim()).length>0?`<h3>recommendations</h3><ul>${n.recommendations.filter(oe=>oe.trim()).map(oe=>`<li>${oe}</li>`).join("")}</ul>`:""}
    `;return T.jsxs("div",{style:X,children:[T.jsx("h3",{style:Y,children:" WordPress Export Preview"}),T.jsxs("div",{style:{padding:"1rem",backgroundColor:pe.gray50,borderRadius:"8px",border:`1px solid ${pe.gray200}`},children:[T.jsx("h4",{style:{margin:"0 0 1rem",color:pe.magnusDarkGreen},children:n.title||"(No title)"}),T.jsx("div",{dangerouslySetInnerHTML:{__html:ee}}),n.sources.filter(oe=>oe.url.trim()).length>0&&T.jsxs("div",{style:{marginTop:"1rem",fontSize:"0.875rem"},children:[T.jsx("strong",{children:"Sources:"}),T.jsx("ul",{style:{margin:"0.5rem 0 0",paddingLeft:"1.5rem"},children:n.sources.filter(oe=>oe.url.trim()).map((oe,Ae)=>T.jsx("li",{children:T.jsx("a",{href:oe.url,target:"_blank",rel:"noopener noreferrer",children:oe.title||oe.url})},Ae))})]})]})]})}return T.jsxs("div",{style:z,children:[T.jsxs("div",{style:M,children:[T.jsx("h2",{style:K,children:"Create Alert"}),T.jsx("p",{style:G,children:"Create a travel safety alert for WordPress export. All required fields must be completed for a healthy export."})]}),l&&T.jsxs("div",{style:_e,children:[T.jsx("strong",{children:"Error:"})," ",l]}),f&&T.jsxs("div",{style:N,children:[T.jsx("strong",{})," ",f]}),v.warnings.length>0&&T.jsxs("div",{style:Z,children:[T.jsx("strong",{children:" Warning:"})," ",v.warnings.join(". ")]}),T.jsxs("form",{onSubmit:R,children:[T.jsxs("div",{style:X,children:[T.jsx("h3",{style:Y,children:" Basic Information"}),T.jsxs("div",{style:de,children:[T.jsxs("label",{style:he,children:["Title ",T.jsx("span",{style:me,children:"*"})]}),T.jsx("input",{type:"text",value:n.title,onChange:ee=>x("title",ee.target.value),style:ge,placeholder:"Specific incident title (e.g., 'Armed Clashes in Northern Region')",maxLength:200}),T.jsx("div",{style:W,children:'Be specific about the incident. Avoid generic titles like "Travel Advisory".'})]}),T.jsxs("div",{style:ce,children:[T.jsxs("div",{style:de,children:[T.jsxs("label",{style:he,children:["Country ",T.jsx("span",{style:me,children:"*"})]}),T.jsxs("select",{value:n.country,onChange:ee=>x("country",ee.target.value),style:q,children:[T.jsx("option",{value:"",children:"Select country..."}),UC.map(ee=>T.jsx("option",{value:ee,children:ee},ee))]})]}),T.jsxs("div",{style:de,children:[T.jsx("label",{style:he,children:"Region"}),T.jsx("input",{type:"text",value:n.region,onChange:ee=>x("region",ee.target.value),style:ge,placeholder:"e.g., Northern Province"})]})]}),T.jsxs("div",{style:de,children:[T.jsxs("label",{style:he,children:["Location ",T.jsx("span",{style:me,children:"*"})]}),T.jsx("input",{type:"text",value:n.location,onChange:ee=>x("location",ee.target.value),style:ge,placeholder:"Specific location (e.g., 'Central District, Capital City')"})]}),T.jsxs("div",{style:ce,children:[T.jsxs("div",{style:de,children:[T.jsxs("label",{style:he,children:["Severity ",T.jsx("span",{style:me,children:"*"})]}),T.jsx("select",{value:n.severity,onChange:ee=>x("severity",ee.target.value),style:{...q,borderLeftWidth:"4px",borderLeftColor:(xe=zf.find(ee=>ee.value===n.severity))==null?void 0:xe.color},children:zf.map(ee=>T.jsx("option",{value:ee.value,children:ee.label},ee.value))}),T.jsx("div",{style:W,children:(Te=zf.find(ee=>ee.value===n.severity))==null?void 0:Te.description})]}),T.jsxs("div",{style:de,children:[T.jsx("label",{style:he,children:"Event Type"}),T.jsxs("select",{value:n.event_type,onChange:ee=>x("event_type",ee.target.value),style:q,children:[T.jsx("option",{value:"",children:"Select type..."}),BC.map(ee=>T.jsx("option",{value:ee,children:ee},ee))]})]})]})]}),T.jsxs("div",{style:X,children:[T.jsx("h3",{style:Y,children:" Content"}),T.jsxs("div",{style:de,children:[T.jsxs("label",{style:he,children:["Summary ",T.jsx("span",{style:me,children:"*"})]}),T.jsx("textarea",{value:n.summary,onChange:ee=>x("summary",ee.target.value),style:J,placeholder:"2-3 sentences describing the incident. Be concrete about what happened and where. Keep under 150 words.",maxLength:800}),T.jsxs("div",{style:W,children:[n.summary.length,"/800 characters. Aim for 50-150 words."]})]}),T.jsxs("div",{style:de,children:[T.jsxs("label",{style:he,children:["recommendations ",T.jsx("span",{style:me,children:"*"})," (minimum 2 items)"]}),n.recommendations.map((ee,oe)=>T.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem"},children:[T.jsx("input",{type:"text",value:ee,onChange:Ae=>_(oe,Ae.target.value),style:{...ge,flex:1},placeholder:`recommendations item ${oe+1} (e.g., "Avoid the affected area")`}),n.recommendations.length>2&&T.jsx("button",{type:"button",onClick:()=>w(oe),style:{padding:"0.5rem 0.75rem",backgroundColor:pe.red100,color:pe.red600,border:"none",borderRadius:"6px",cursor:"pointer"}})]},oe)),n.recommendations.length<8&&T.jsx("button",{type:"button",onClick:S,style:{...pi.secondary,marginTop:"0.5rem"},children:"+ Add recommendations"}),T.jsx("div",{style:W,children:"4-6 practical bullet points recommended for WordPress export."})]})]}),T.jsxs("div",{style:X,children:[T.jsx("h3",{style:Y,children:" Sources"}),n.sources.map((ee,oe)=>T.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr auto",gap:"0.5rem",marginBottom:"0.5rem",alignItems:"start"},children:[T.jsx("div",{children:T.jsx("input",{type:"url",value:ee.url,onChange:Ae=>k(oe,"url",Ae.target.value),style:ge,placeholder:"https://..."})}),T.jsx("div",{children:T.jsx("input",{type:"text",value:ee.title||"",onChange:Ae=>k(oe,"title",Ae.target.value),style:ge,placeholder:"Source title (optional)"})}),n.sources.length>1&&T.jsx("button",{type:"button",onClick:()=>b(oe),style:{padding:"0.75rem",backgroundColor:pe.red100,color:pe.red600,border:"none",borderRadius:"6px",cursor:"pointer"}})]},oe)),n.sources.length<3&&T.jsx("button",{type:"button",onClick:y,style:{...pi.secondary,marginTop:"0.5rem"},children:"+ Add Source"}),T.jsx("div",{style:W,children:"1-3 source URLs recommended. These will be included in the WordPress export."})]}),T.jsxs("div",{style:X,children:[T.jsx("h3",{style:Y,children:" Geographic Data (Optional)"}),T.jsxs("div",{style:ce,children:[T.jsxs("div",{style:de,children:[T.jsx("label",{style:he,children:"Geo Scope"}),T.jsx("select",{value:n.geo_scope,onChange:ee=>x("geo_scope",ee.target.value),style:q,children:jC.map(ee=>T.jsx("option",{value:ee,children:ee},ee))})]}),T.jsxs("div",{style:de,children:[T.jsx("label",{style:he,children:"Latitude"}),T.jsx("input",{type:"number",step:"any",value:n.latitude,onChange:ee=>x("latitude",ee.target.value),style:ge,placeholder:"e.g., 31.7683",min:"-90",max:"90"})]}),T.jsxs("div",{style:de,children:[T.jsx("label",{style:he,children:"Longitude"}),T.jsx("input",{type:"number",step:"any",value:n.longitude,onChange:ee=>x("longitude",ee.target.value),style:ge,placeholder:"e.g., 35.2137",min:"-180",max:"180"})]}),T.jsxs("div",{style:de,children:[T.jsx("label",{style:he,children:"Radius (km)"}),T.jsx("input",{type:"number",value:n.radius_km,onChange:ee=>x("radius_km",ee.target.value),style:ge,placeholder:"25",min:"1",max:"1000"})]})]})]}),T.jsxs("div",{style:X,children:[T.jsx("h3",{style:Y,children:" Event Dates (Optional)"}),T.jsxs("div",{style:ce,children:[T.jsxs("div",{style:de,children:[T.jsx("label",{style:he,children:"Event Start"}),T.jsx("input",{type:"datetime-local",value:n.event_start_at,onChange:ee=>x("event_start_at",ee.target.value),style:ge})]}),T.jsxs("div",{style:de,children:[T.jsx("label",{style:he,children:"Event End"}),T.jsx("input",{type:"datetime-local",value:n.event_end_at,onChange:ee=>x("event_end_at",ee.target.value),style:ge})]})]})]}),m&&te(),T.jsxs("div",{style:H,children:[T.jsx("button",{type:"button",onClick:()=>p(!m),style:pi.secondary,children:m?"Hide Preview":"Show WP Preview"}),T.jsx("button",{type:"button",onClick:O,style:pi.secondary,children:"Reset Form"}),T.jsx("button",{type:"submit",disabled:a||!v.isValid,style:{...pi.primary,opacity:a||!v.isValid?.6:1,cursor:a||!v.isValid?"not-allowed":"pointer"},children:a?"Creating...":"Create Alert (Draft)"})]}),!v.isValid&&T.jsxs("div",{style:{marginTop:"1rem",fontSize:"0.875rem",color:pe.red600},children:[T.jsx("strong",{children:"Please fix:"}),T.jsx("ul",{style:{margin:"0.5rem 0 0",paddingLeft:"1.5rem"},children:v.errors.map((ee,oe)=>T.jsx("li",{children:ee},oe))})]})]})]})}const yy=ie.createContext(void 0),$C=()=>{const e=ie.useContext(yy);if(!e)throw new Error("useScour must be used within a ScourProvider");return e},WC=({children:e,accessToken:t})=>{const[r,n]=ie.useState(!1),[i,a]=ie.useState(null),[o,l]=ie.useState(null),[u,f]=ie.useState(null),[d,m]=ie.useState(null),[p,v]=ie.useState(null),[x,_]=ie.useState(null),S=ie.useRef(null),w=ie.useCallback(()=>{S.current&&(clearInterval(S.current),S.current=null)},[]),k=ie.useCallback(async(R,C)=>{var z,M;try{const K=await ei(`/scour/status?jobId=${encodeURIComponent(R)}`,C);if(K.ok&&K.job){const G=K.job;a(G),(G.status==="done"||G.status==="error")&&(n(!1),_(new Date().toISOString()),G.status==="done"?(f({processed:G.processed||0,created:G.created||0,duplicatesSkipped:G.duplicatesSkipped||0,lowConfidenceSkipped:G.lowConfidenceSkipped||0,errorCount:G.errorCount||0}),m(null)):m(((M=(z=G.errors)==null?void 0:z[0])==null?void 0:M.reason)||"Scour failed"),w())}}catch(K){console.error("Poll error:",K),m(K.message||"Polling failed"),n(!1),w()}},[w]),y=ie.useCallback(async(R,C)=>{const z=R||t;try{n(!0),m(null),v(new Date().toISOString());let M=(C==null?void 0:C.sourceIds)||[];if(M.length===0){console.log("  No sourceIds provided - fetching enabled sources...");try{const G=await ei("/sources",z);if(G.ok&&Array.isArray(G.sources))M=G.sources.filter(X=>X.enabled).map(X=>X.id),console.log(` Fetched ${M.length} enabled sources`);else throw new Error("Failed to fetch sources")}catch(G){throw console.error("Failed to fetch sources:",G),new Error(`Cannot start scour: ${G.message}`)}}if(M.length===0)throw new Error("No enabled sources available to scour");console.log(` Starting scour with ${M.length} sources`);const K=await Ha("/scour-sources",{sourceIds:M,daysBack:(C==null?void 0:C.daysBack)||14},z);if(K.ok&&K.jobId){const G=K.jobId;l(G),a({id:G,status:"running",total:K.total||M.length,processed:0,created:0,duplicatesSkipped:0,lowConfidenceSkipped:0,errorCount:0}),w(),S.current=setInterval(()=>{k(G,z)},3e3),setTimeout(()=>k(G,z),1e3)}else throw new Error("Failed to start scour job")}catch(M){console.error("Start scour error:",M),m(M.message||"Failed to start scour"),n(!1),w()}},[t,w,k]),b=ie.useCallback(()=>{n(!1),w()},[w]),O={isScouring:r,scourJob:i,jobId:o,lastResult:u,lastError:d,lastStartedAt:p,lastFinishedAt:x,startScour:y,runScour:y,stopScour:b,scourJobId:o};return T.jsx(yy.Provider,{value:O,children:e})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var wy=1252,HC=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Sp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Tp=function(e){HC.indexOf(e)!=-1&&(wy=Sp[0]=e)};function VC(){Tp(1252)}var Nn=function(e){Tp(e)};function ky(){Nn(1200),VC()}function Eg(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function GC(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Ey(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Vo=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?GC(e.slice(2)):t==254&&r==255?Ey(e.slice(2)):t==65279?e.slice(1):e},Kc=function(t){return String.fromCharCode(t)},Sg=function(t){return String.fromCharCode(t)},Bl,Zi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Tg(e){for(var t="",r=0,n=0,i=0,a=0,o=0,l=0,u=0,f=0;f<e.length;)r=e.charCodeAt(f++),a=r>>2,n=e.charCodeAt(f++),o=(r&3)<<4|n>>4,i=e.charCodeAt(f++),l=(n&15)<<2|i>>6,u=i&63,isNaN(n)?l=u=64:isNaN(i)&&(u=64),t+=Zi.charAt(a)+Zi.charAt(o)+Zi.charAt(l)+Zi.charAt(u);return t}function Qr(e){var t="",r=0,n=0,i=0,a=0,o=0,l=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)a=Zi.indexOf(e.charAt(f++)),o=Zi.indexOf(e.charAt(f++)),r=a<<2|o>>4,t+=String.fromCharCode(r),l=Zi.indexOf(e.charAt(f++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),u=Zi.indexOf(e.charAt(f++)),i=(l&3)<<6|u,u!==64&&(t+=String.fromCharCode(i));return t}var Ye=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ya=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function la(e){return Ye?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Cg(e){return Ye?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var In=function(t){return Ye?Ya(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Ja(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Cp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Cp(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Hi=Ye?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ya(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function ZC(e){for(var t=[],r=0,n=e.length+250,i=la(e.length+255),a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++a)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|l>>6&15|(o&3)<<4,i[r++]=128|l&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(t.push(i.slice(0,r)),r=0,i=la(65535),n=65530)}return t.push(i.slice(0,r)),Hi(t)}var Or=/\u0000/g,Go=/[\u0001-\u0006]/g;function Zs(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Dn(e,t){var r=""+e;return r.length>=t?r:Ct("0",t-r.length)+r}function bp(e,t){var r=""+e;return r.length>=t?r:Ct(" ",t-r.length)+r}function Hu(e,t){var r=""+e;return r.length>=t?r:r+Ct(" ",t-r.length)}function KC(e,t){var r=""+Math.round(e);return r.length>=t?r:Ct("0",t-r.length)+r}function qC(e,t){var r=""+e;return r.length>=t?r:Ct("0",t-r.length)+r}var bg=Math.pow(2,32);function ys(e,t){if(e>bg||e<-bg)return KC(e,t);var r=Math.round(e);return qC(r,t)}function Vu(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Ag=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],$f=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function XC(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var He={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Pg={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},YC={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Gu(e,t,r){for(var n=e<0?-1:1,i=e*n,a=0,o=1,l=0,u=1,f=0,d=0,m=Math.floor(i);f<t&&(m=Math.floor(i),l=m*o+a,d=m*f+u,!(i-m<5e-8));)i=1/(i-m),a=o,o=l,u=f,f=d;if(d>t&&(f>t?(d=u,l=a):(d=f,l=o)),!r)return[0,n*l,d];var p=Math.floor(n*l/d);return[p,n*l-p*d,d]}function La(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),a=0,o=[],l={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++i==86400&&(l.T=i=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],a=u.getDay(),n<60&&(a=(a+6)%7),r&&(a=nb(u,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=a,l}var Sy=new Date(1899,11,31,0,0,0),JC=Sy.getTime(),QC=new Date(1900,2,1,0,0,0);function Ty(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=QC&&(r+=24*60*60*1e3),(r-(JC+(e.getTimezoneOffset()-Sy.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ap(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function eb(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function tb(e){var t=e<0?12:11,r=Ap(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function rb(e){var t=Ap(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function jl(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=tb(e):t===10?r=e.toFixed(10).substr(0,12):r=rb(e),Ap(eb(r.toUpperCase()))}function Va(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):jl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return _n(14,Ty(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function nb(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function ib(e,t,r,n){var i="",a=0,o=0,l=r.y,u,f=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:u=l%100,f=2;break;default:u=l%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:u=r.m,f=t.length;break;case 3:return $f[r.m-1][1];case 5:return $f[r.m-1][0];default:return $f[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=r.d,f=t.length;break;case 3:return Ag[r.q][0];default:return Ag[r.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Dn(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,a=Math.round(o*(r.S+r.u)),a>=60*o&&(a=0),t==="s"?a===0?"0":""+a/o:(i=Dn(a,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:u=l,f=1;break}var d=f>0?Dn(u,f):"";return d}function Ki(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Cy=/%/g;function ab(e,t,r){var n=t.replace(Cy,""),i=t.length-n.length;return xi(e,n,r*Math.pow(10,2*i))+Ct("%",i)}function sb(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return xi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function by(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+by(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,f,d){return u+f+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Ay=/# (\?+)( ?)\/( ?)(\d+)/;function ob(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),a=Math.floor(i/n),o=i-a*n,l=n;return r+(a===0?"":""+a)+" "+(o===0?Ct(" ",e[1].length+1+e[4].length):bp(o,e[1].length)+e[2]+"/"+e[3]+Dn(l,e[4].length))}function lb(e,t,r){return r+(t===0?"":""+t)+Ct(" ",e[1].length+2+e[4].length)}var Py=/^#*0*\.([0#]+)/,Oy=/\).*[0#]/,Ry=/\(###\) ###\\?-####/;function Cr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Og(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Rg(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function cb(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function ub(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function un(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Oy)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?un("n",n,r):"("+un("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return sb(e,t,r);if(t.indexOf("%")!==-1)return ab(e,t,r);if(t.indexOf("E")!==-1)return by(t,r);if(t.charCodeAt(0)===36)return"$"+un(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,o,l,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+ys(u,t.length);if(t.match(/^[#?]+$/))return i=ys(r,0),i==="0"&&(i=""),i.length>t.length?i:Cr(t.substr(0,t.length-i.length))+i;if(a=t.match(Ay))return ob(a,u,f);if(t.match(/^#+0+$/))return f+ys(u,t.length-t.indexOf("0"));if(a=t.match(Py))return i=Og(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Cr(a[1])).replace(/\.$/,"."+Cr(a[1])).replace(/\.(\d*)$/,function(x,_){return"."+_+Ct("0",Cr(a[1]).length-_.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return f+Og(u,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return f+Ki(ys(u,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+un(e,t,-r):Ki(""+(Math.floor(r)+cb(r,a[1].length)))+"."+Dn(Rg(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return un(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Zs(un(e,t.replace(/[\\-]/g,""),r)),o=0,Zs(Zs(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<i.length?i.charAt(o++):x==="0"?"0":""}));if(t.match(Ry))return i=un(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=Gu(u,Math.pow(10,o)-1,!1),i=""+f,d=xi("n",a[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=Hu(l[2],o),d.length<a[4].length&&(d=Cr(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=Gu(u,Math.pow(10,o)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?bp(l[1],o)+a[2]+"/"+a[3]+Hu(l[2],o):Ct(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=ys(r,0),t.length<=i.length?i:Cr(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var m=t.indexOf(".")-o,p=t.length-i.length-m;return Cr(t.substr(0,m)+i+t.substr(t.length-p))}if(a=t.match(/^00,000\.([#0]*0)$/))return o=Rg(r,a[1].length),r<0?"-"+un(e,t,-r):Ki(ub(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Dn(0,3-x.length):"")+x})+"."+Dn(o,a[1].length);switch(t){case"###,##0.00":return un(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var v=Ki(ys(u,0));return v!=="0"?f+v:"";case"###,###.00":return un(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return un(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function fb(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return xi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function hb(e,t,r){var n=t.replace(Cy,""),i=t.length-n.length;return xi(e,n,r*Math.pow(10,2*i))+Ct("%",i)}function Fy(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Fy(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,f,d){return u+f+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Zn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Oy)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Zn("n",n,r):"("+Zn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return fb(e,t,r);if(t.indexOf("%")!==-1)return hb(e,t,r);if(t.indexOf("E")!==-1)return Fy(t,r);if(t.charCodeAt(0)===36)return"$"+Zn(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,o,l,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+Dn(u,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Cr(t.substr(0,t.length-i.length))+i;if(a=t.match(Ay))return lb(a,u,f);if(t.match(/^#+0+$/))return f+Dn(u,t.length-t.indexOf("0"));if(a=t.match(Py))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Cr(a[1])).replace(/\.$/,"."+Cr(a[1])),i=i.replace(/\.(\d*)$/,function(x,_){return"."+_+Ct("0",Cr(a[1]).length-_.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return f+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return f+Ki(""+u);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Zn(e,t,-r):Ki(""+r)+"."+Ct("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Zn(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Zs(Zn(e,t.replace(/[\\-]/g,""),r)),o=0,Zs(Zs(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<i.length?i.charAt(o++):x==="0"?"0":""}));if(t.match(Ry))return i=Zn(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=Gu(u,Math.pow(10,o)-1,!1),i=""+f,d=xi("n",a[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=Hu(l[2],o),d.length<a[4].length&&(d=Cr(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=Gu(u,Math.pow(10,o)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?bp(l[1],o)+a[2]+"/"+a[3]+Hu(l[2],o):Ct(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Cr(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var m=t.indexOf(".")-o,p=t.length-i.length-m;return Cr(t.substr(0,m)+i+t.substr(t.length-p))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Zn(e,t,-r):Ki(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Dn(0,3-x.length):"")+x})+"."+Dn(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=Ki(""+u);return v!=="0"?f+v:"";default:if(t.match(/\.[0#?]*$/))return Zn(e,t.slice(0,t.lastIndexOf(".")),r)+Cr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function xi(e,t,r){return(r|0)===r?Zn(e,t,r):un(e,t,r)}function db(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Ly=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function uo(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Vu(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Ly))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function pb(e,t,r,n){for(var i=[],a="",o=0,l="",u="t",f,d,m,p="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!Vu(e,o))throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(m=e.charCodeAt(++o))!==34&&o<e.length;)a+=String.fromCharCode(m);i[i.length]={t:"t",v:a},++o;break;case"\\":var v=e.charAt(++o),x=v==="("||v===")"?v:"t";i[i.length]={t:x,v},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(f==null&&(f=La(t,r,e.charAt(o+1)==="2"),f==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},u=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=La(t,r),f==null))return"";for(a=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)a+=l;l==="m"&&u.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=p),i[i.length]={t:l,v:a},u=l;break;case"A":case"a":case"":var _={t:l,v:l};if(f==null&&(f=La(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(f!=null&&(_.v=f.H>=12?"P":"A"),_.t="T",p="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(f!=null&&(_.v=f.H>=12?"PM":"AM"),_.t="T",o+=5,p="h"):e.substr(o,5).toUpperCase()==="/"?(f!=null&&(_.v=f.H>=12?"":""),_.t="T",o+=5,p="h"):(_.t="t",++o),f==null&&_.t==="T")return"";i[i.length]=_,u=l;break;case"[":for(a=l;e.charAt(o++)!=="]"&&o<e.length;)a+=e.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(Ly)){if(f==null&&(f=La(t,r),f==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},u=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",uo(e)||(i[i.length]={t:"t",v:a}));break;case".":if(f!=null){for(a=l;++o<e.length&&(l=e.charAt(o))==="0";)a+=l;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)a+=l;i[i.length]={t:"n",v:a};break;case"?":for(a=l;e.charAt(++o)===l;)a+=l;i[i.length]={t:l,v:a},u=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)a+=e.charAt(o);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:l,v:l},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"t",v:l},++o;break}var S=0,w=0,k;for(o=i.length-1,u="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=p,u="h",S<1&&(S=1);break;case"s":(k=i[o].v.match(/\.0+$/))&&(w=Math.max(w,k[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":u=i[o].t;break;case"m":u==="s"&&(i[o].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&i[o].v.match(/[Hh]/)&&(S=1),S<2&&i[o].v.match(/[Mm]/)&&(S=2),S<3&&i[o].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var y="",b;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=ib(i[o].t.charCodeAt(0),i[o].v,f,w),i[o].t="t";break;case"n":case"?":for(b=o+1;i[b]!=null&&((l=i[b].t)==="?"||l==="D"||(l===" "||l==="t")&&i[b+1]!=null&&(i[b+1].t==="?"||i[b+1].t==="t"&&i[b+1].v==="/")||i[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(i[b].v==="/"||i[b].v===" "&&i[b+1]!=null&&i[b+1].t=="?"));)i[o].v+=i[b].v,i[b]={v:"",t:";"},++b;y+=i[o].v,o=b-1;break;case"G":i[o].t="t",i[o].v=Va(t,r);break}var O="",R,C;if(y.length>0){y.charCodeAt(0)==40?(R=t<0&&y.charCodeAt(0)===45?-t:t,C=xi("n",y,R)):(R=t<0&&n>1?-t:t,C=xi("n",y,R),R<0&&i[0]&&i[0].t=="t"&&(C=C.substr(1),i[0].v="-"+i[0].v)),b=C.length-1;var z=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){z=o;break}var M=i.length;if(z===i.length&&C.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(b>=i[o].v.length-1?(b-=i[o].v.length,i[o].v=C.substr(b+1,i[o].v.length)):b<0?i[o].v="":(i[o].v=C.substr(0,b+1),b=-1),i[o].t="t",M=o);b>=0&&M<i.length&&(i[M].v=C.substr(0,b+1)+i[M].v)}else if(z!==i.length&&C.indexOf("E")===-1){for(b=C.indexOf(".")-1,o=z;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(d=i[o].v.indexOf(".")>-1&&o===z?i[o].v.indexOf(".")-1:i[o].v.length-1,O=i[o].v.substr(d+1);d>=0;--d)b>=0&&(i[o].v.charAt(d)==="0"||i[o].v.charAt(d)==="#")&&(O=C.charAt(b--)+O);i[o].v=O,i[o].t="t",M=o}for(b>=0&&M<i.length&&(i[M].v=C.substr(0,b+1)+i[M].v),b=C.indexOf(".")+1,o=z;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==z)){for(d=i[o].v.indexOf(".")>-1&&o===z?i[o].v.indexOf(".")+1:0,O=i[o].v.substr(0,d);d<i[o].v.length;++d)b<C.length&&(O+=C.charAt(b++));i[o].v=O,i[o].t="t",M=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(R=n>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=xi(i[o].t,i[o].v,R),i[o].t="t");var K="";for(o=0;o!==i.length;++o)i[o]!=null&&(K+=i[o].v);return K}var Fg=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Lg(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function mb(e,t){var r=db(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Fg),l=r[1].match(Fg);return Lg(t,o)?[n,r[0]]:Lg(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,a]}function _n(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:He)[e],n==null&&(n=r.table&&r.table[Pg[e]]||He[Pg[e]]),n==null&&(n=YC[e]||"General");break}if(Vu(n,0))return Va(t,r);t instanceof Date&&(t=Ty(t,r.date1904));var i=mb(n,t);if(Vu(i[1]))return Va(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return pb(i[1],t,r,i[0])}function Ma(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(He[r]==null){t<0&&(t=r);continue}if(He[r]==e){t=r;break}}t<0&&(t=391)}return He[t]=e,t}function Iy(){He=XC()}var gb={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Ny=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function vb(e){var t=typeof e=="number"?He[e]:e;return t=t.replace(Ny,"(\\d+)"),new RegExp("^"+t+"$")}function _b(e,t,r){var n=-1,i=-1,a=-1,o=-1,l=-1,u=-1;(t.match(Ny)||[]).forEach(function(m,p){var v=parseInt(r[p+1],10);switch(m.toLowerCase().charAt(0)){case"y":n=v;break;case"d":a=v;break;case"h":o=v;break;case"s":u=v;break;case"m":o>=0?l=v:i=v;break}}),u>=0&&l==-1&&i>=0&&(l=i,i=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&l==-1&&u==-1?f:n==-1&&i==-1&&a==-1?d:f+"T"+d}var xb=function(){var e={};e.version="1.2.0";function t(){for(var C=0,z=new Array(256),M=0;M!=256;++M)C=M,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,z[M]=C;return typeof Int32Array<"u"?new Int32Array(z):z}var r=t();function n(C){var z=0,M=0,K=0,G=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(K=0;K!=256;++K)G[K]=C[K];for(K=0;K!=256;++K)for(M=C[K],z=256+K;z<4096;z+=256)M=G[z]=M>>>8^C[M&255];var X=[];for(K=1;K!=16;++K)X[K-1]=typeof Int32Array<"u"?G.subarray(K*256,K*256+256):G.slice(K*256,K*256+256);return X}var i=n(r),a=i[0],o=i[1],l=i[2],u=i[3],f=i[4],d=i[5],m=i[6],p=i[7],v=i[8],x=i[9],_=i[10],S=i[11],w=i[12],k=i[13],y=i[14];function b(C,z){for(var M=z^-1,K=0,G=C.length;K<G;)M=M>>>8^r[(M^C.charCodeAt(K++))&255];return~M}function O(C,z){for(var M=z^-1,K=C.length-15,G=0;G<K;)M=y[C[G++]^M&255]^k[C[G++]^M>>8&255]^w[C[G++]^M>>16&255]^S[C[G++]^M>>>24]^_[C[G++]]^x[C[G++]]^v[C[G++]]^p[C[G++]]^m[C[G++]]^d[C[G++]]^f[C[G++]]^u[C[G++]]^l[C[G++]]^o[C[G++]]^a[C[G++]]^r[C[G++]];for(K+=15;G<K;)M=M>>>8^r[(M^C[G++])&255];return~M}function R(C,z){for(var M=z^-1,K=0,G=C.length,X=0,Y=0;K<G;)X=C.charCodeAt(K++),X<128?M=M>>>8^r[(M^X)&255]:X<2048?(M=M>>>8^r[(M^(192|X>>6&31))&255],M=M>>>8^r[(M^(128|X&63))&255]):X>=55296&&X<57344?(X=(X&1023)+64,Y=C.charCodeAt(K++)&1023,M=M>>>8^r[(M^(240|X>>8&7))&255],M=M>>>8^r[(M^(128|X>>2&63))&255],M=M>>>8^r[(M^(128|Y>>6&15|(X&3)<<4))&255],M=M>>>8^r[(M^(128|Y&63))&255]):(M=M>>>8^r[(M^(224|X>>12&15))&255],M=M>>>8^r[(M^(128|X>>6&63))&255],M=M>>>8^r[(M^(128|X&63))&255]);return~M}return e.table=r,e.bstr=b,e.buf=O,e.str=R,e}(),Qe=function(){var t={};t.version="1.2.1";function r(A,B){for(var F=A.split("/"),I=B.split("/"),j=0,U=0,ne=Math.min(F.length,I.length);j<ne;++j){if(U=F[j].length-I[j].length)return U;if(F[j]!=I[j])return F[j]<I[j]?-1:1}return F.length-I.length}function n(A){if(A.charAt(A.length-1)=="/")return A.slice(0,-1).indexOf("/")===-1?A:n(A.slice(0,-1));var B=A.lastIndexOf("/");return B===-1?A:A.slice(0,B+1)}function i(A){if(A.charAt(A.length-1)=="/")return i(A.slice(0,-1));var B=A.lastIndexOf("/");return B===-1?A:A.slice(B+1)}function a(A,B){typeof B=="string"&&(B=new Date(B));var F=B.getHours();F=F<<6|B.getMinutes(),F=F<<5|B.getSeconds()>>>1,A.write_shift(2,F);var I=B.getFullYear()-1980;I=I<<4|B.getMonth()+1,I=I<<5|B.getDate(),A.write_shift(2,I)}function o(A){var B=A.read_shift(2)&65535,F=A.read_shift(2)&65535,I=new Date,j=F&31;F>>>=5;var U=F&15;F>>>=4,I.setMilliseconds(0),I.setFullYear(F+1980),I.setMonth(U-1),I.setDate(j);var ne=B&31;B>>>=5;var fe=B&63;return B>>>=6,I.setHours(B),I.setMinutes(fe),I.setSeconds(ne<<1),I}function l(A){ir(A,0);for(var B={},F=0;A.l<=A.length-4;){var I=A.read_shift(2),j=A.read_shift(2),U=A.l+j,ne={};switch(I){case 21589:F=A.read_shift(1),F&1&&(ne.mtime=A.read_shift(4)),j>5&&(F&2&&(ne.atime=A.read_shift(4)),F&4&&(ne.ctime=A.read_shift(4))),ne.mtime&&(ne.mt=new Date(ne.mtime*1e3));break}A.l=U,B[I]=ne}return B}var u;function f(){return u||(u={})}function d(A,B){if(A[0]==80&&A[1]==75)return mo(A,B);if((A[0]|32)==109&&(A[1]|32)==105)return go(A,B);if(A.length<512)throw new Error("CFB file size "+A.length+" < 512");var F=3,I=512,j=0,U=0,ne=0,fe=0,ae=0,se=[],le=A.slice(0,512);ir(le,0);var ye=m(le);switch(F=ye[0],F){case 3:I=512;break;case 4:I=4096;break;case 0:if(ye[1]==0)return mo(A,B);default:throw new Error("Major Version: Expected 3 or 4 saw "+F)}I!==512&&(le=A.slice(0,I),ir(le,28));var Se=A.slice(0,I);p(le,F);var Pe=le.read_shift(4,"i");if(F===3&&Pe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Pe);le.l+=4,ne=le.read_shift(4,"i"),le.l+=4,le.chk("00100000","Mini Stream Cutoff Size: "),fe=le.read_shift(4,"i"),j=le.read_shift(4,"i"),ae=le.read_shift(4,"i"),U=le.read_shift(4,"i");for(var ke=-1,Ce=0;Ce<109&&(ke=le.read_shift(4,"i"),!(ke<0));++Ce)se[Ce]=ke;var je=v(A,I);S(ae,U,je,I,se);var ft=k(je,ne,se,I);ft[ne].name="!Directory",j>0&&fe!==Y&&(ft[fe].name="!MiniFAT"),ft[se[0]].name="!FAT",ft.fat_addrs=se,ft.ssz=I;var ht={},Zt=[],ii=[],kn=[];y(ne,ft,je,Zt,j,ht,ii,fe),x(ii,kn,Zt),Zt.shift();var Fi={FileIndex:ii,FullPaths:kn};return B&&B.raw&&(Fi.raw={header:Se,sectors:je}),Fi}function m(A){if(A[A.l]==80&&A[A.l+1]==75)return[0,0];A.chk(de,"Header Signature: "),A.l+=16;var B=A.read_shift(2,"u");return[A.read_shift(2,"u"),B]}function p(A,B){var F=9;switch(A.l+=2,F=A.read_shift(2)){case 9:if(B!=3)throw new Error("Sector Shift: Expected 9 saw "+F);break;case 12:if(B!=4)throw new Error("Sector Shift: Expected 12 saw "+F);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+F)}A.chk("0600","Mini Sector Shift: "),A.chk("000000000000","Reserved: ")}function v(A,B){for(var F=Math.ceil(A.length/B)-1,I=[],j=1;j<F;++j)I[j-1]=A.slice(j*B,(j+1)*B);return I[F-1]=A.slice(F*B),I}function x(A,B,F){for(var I=0,j=0,U=0,ne=0,fe=0,ae=F.length,se=[],le=[];I<ae;++I)se[I]=le[I]=I,B[I]=F[I];for(;fe<le.length;++fe)I=le[fe],j=A[I].L,U=A[I].R,ne=A[I].C,se[I]===I&&(j!==-1&&se[j]!==j&&(se[I]=se[j]),U!==-1&&se[U]!==U&&(se[I]=se[U])),ne!==-1&&(se[ne]=I),j!==-1&&I!=se[I]&&(se[j]=se[I],le.lastIndexOf(j)<fe&&le.push(j)),U!==-1&&I!=se[I]&&(se[U]=se[I],le.lastIndexOf(U)<fe&&le.push(U));for(I=1;I<ae;++I)se[I]===I&&(U!==-1&&se[U]!==U?se[I]=se[U]:j!==-1&&se[j]!==j&&(se[I]=se[j]));for(I=1;I<ae;++I)if(A[I].type!==0){if(fe=I,fe!=se[fe])do fe=se[fe],B[I]=B[fe]+"/"+B[I];while(fe!==0&&se[fe]!==-1&&fe!=se[fe]);se[I]=-1}for(B[0]+="/",I=1;I<ae;++I)A[I].type!==2&&(B[I]+="/")}function _(A,B,F){for(var I=A.start,j=A.size,U=[],ne=I;F&&j>0&&ne>=0;)U.push(B.slice(ne*X,ne*X+X)),j-=X,ne=ba(F,ne*4);return U.length===0?Ut(0):Hi(U).slice(0,A.size)}function S(A,B,F,I,j){var U=Y;if(A===Y){if(B!==0)throw new Error("DIFAT chain shorter than expected")}else if(A!==-1){var ne=F[A],fe=(I>>>2)-1;if(!ne)return;for(var ae=0;ae<fe&&(U=ba(ne,ae*4))!==Y;++ae)j.push(U);S(ba(ne,I-4),B-1,F,I,j)}}function w(A,B,F,I,j){var U=[],ne=[];j||(j=[]);var fe=I-1,ae=0,se=0;for(ae=B;ae>=0;){j[ae]=!0,U[U.length]=ae,ne.push(A[ae]);var le=F[Math.floor(ae*4/I)];if(se=ae*4&fe,I<4+se)throw new Error("FAT boundary crossed: "+ae+" 4 "+I);if(!A[le])break;ae=ba(A[le],se)}return{nodes:U,data:Wg([ne])}}function k(A,B,F,I){var j=A.length,U=[],ne=[],fe=[],ae=[],se=I-1,le=0,ye=0,Se=0,Pe=0;for(le=0;le<j;++le)if(fe=[],Se=le+B,Se>=j&&(Se-=j),!ne[Se]){ae=[];var ke=[];for(ye=Se;ye>=0;){ke[ye]=!0,ne[ye]=!0,fe[fe.length]=ye,ae.push(A[ye]);var Ce=F[Math.floor(ye*4/I)];if(Pe=ye*4&se,I<4+Pe)throw new Error("FAT boundary crossed: "+ye+" 4 "+I);if(!A[Ce]||(ye=ba(A[Ce],Pe),ke[ye]))break}U[Se]={nodes:fe,data:Wg([ae])}}return U}function y(A,B,F,I,j,U,ne,fe){for(var ae=0,se=I.length?2:0,le=B[A].data,ye=0,Se=0,Pe;ye<le.length;ye+=128){var ke=le.slice(ye,ye+128);ir(ke,64),Se=ke.read_shift(2),Pe=Lp(ke,0,Se-se),I.push(Pe);var Ce={name:Pe,type:ke.read_shift(1),color:ke.read_shift(1),L:ke.read_shift(4,"i"),R:ke.read_shift(4,"i"),C:ke.read_shift(4,"i"),clsid:ke.read_shift(16),state:ke.read_shift(4,"i"),start:0,size:0},je=ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2);je!==0&&(Ce.ct=b(ke,ke.l-8));var ft=ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2);ft!==0&&(Ce.mt=b(ke,ke.l-8)),Ce.start=ke.read_shift(4,"i"),Ce.size=ke.read_shift(4,"i"),Ce.size<0&&Ce.start<0&&(Ce.size=Ce.type=0,Ce.start=Y,Ce.name=""),Ce.type===5?(ae=Ce.start,j>0&&ae!==Y&&(B[ae].name="!StreamData")):Ce.size>=4096?(Ce.storage="fat",B[Ce.start]===void 0&&(B[Ce.start]=w(F,Ce.start,B.fat_addrs,B.ssz)),B[Ce.start].name=Ce.name,Ce.content=B[Ce.start].data.slice(0,Ce.size)):(Ce.storage="minifat",Ce.size<0?Ce.size=0:ae!==Y&&Ce.start!==Y&&B[ae]&&(Ce.content=_(Ce,B[ae].data,(B[fe]||{}).data))),Ce.content&&ir(Ce.content,0),U[Pe]=Ce,ne.push(Ce)}}function b(A,B){return new Date((Gr(A,B+4)/1e7*Math.pow(2,32)+Gr(A,B)/1e7-11644473600)*1e3)}function O(A,B){return f(),d(u.readFileSync(A),B)}function R(A,B){var F=B&&B.type;switch(F||Ye&&Buffer.isBuffer(A)&&(F="buffer"),F||"base64"){case"file":return O(A,B);case"base64":return d(In(Qr(A)),B);case"binary":return d(In(A),B)}return d(A,B)}function C(A,B){var F=B||{},I=F.root||"Root Entry";if(A.FullPaths||(A.FullPaths=[]),A.FileIndex||(A.FileIndex=[]),A.FullPaths.length!==A.FileIndex.length)throw new Error("inconsistent CFB structure");A.FullPaths.length===0&&(A.FullPaths[0]=I+"/",A.FileIndex[0]={name:I,type:5}),F.CLSID&&(A.FileIndex[0].clsid=F.CLSID),z(A)}function z(A){var B="Sh33tJ5";if(!Qe.find(A,"/"+B)){var F=Ut(4);F[0]=55,F[1]=F[3]=50,F[2]=54,A.FileIndex.push({name:B,type:2,content:F,size:4,L:69,R:69,C:69}),A.FullPaths.push(A.FullPaths[0]+B),M(A)}}function M(A,B){C(A);for(var F=!1,I=!1,j=A.FullPaths.length-1;j>=0;--j){var U=A.FileIndex[j];switch(U.type){case 0:I?F=!0:(A.FileIndex.pop(),A.FullPaths.pop());break;case 1:case 2:case 5:I=!0,isNaN(U.R*U.L*U.C)&&(F=!0),U.R>-1&&U.L>-1&&U.R==U.L&&(F=!0);break;default:F=!0;break}}if(!(!F&&!B)){var ne=new Date(1987,1,19),fe=0,ae=Object.create?Object.create(null):{},se=[];for(j=0;j<A.FullPaths.length;++j)ae[A.FullPaths[j]]=!0,A.FileIndex[j].type!==0&&se.push([A.FullPaths[j],A.FileIndex[j]]);for(j=0;j<se.length;++j){var le=n(se[j][0]);I=ae[le],I||(se.push([le,{name:i(le).replace("/",""),type:1,clsid:me,ct:ne,mt:ne,content:null}]),ae[le]=!0)}for(se.sort(function(Pe,ke){return r(Pe[0],ke[0])}),A.FullPaths=[],A.FileIndex=[],j=0;j<se.length;++j)A.FullPaths[j]=se[j][0],A.FileIndex[j]=se[j][1];for(j=0;j<se.length;++j){var ye=A.FileIndex[j],Se=A.FullPaths[j];if(ye.name=i(Se).replace("/",""),ye.L=ye.R=ye.C=-(ye.color=1),ye.size=ye.content?ye.content.length:0,ye.start=0,ye.clsid=ye.clsid||me,j===0)ye.C=se.length>1?1:-1,ye.size=0,ye.type=5;else if(Se.slice(-1)=="/"){for(fe=j+1;fe<se.length&&n(A.FullPaths[fe])!=Se;++fe);for(ye.C=fe>=se.length?-1:fe,fe=j+1;fe<se.length&&n(A.FullPaths[fe])!=n(Se);++fe);ye.R=fe>=se.length?-1:fe,ye.type=1}else n(A.FullPaths[j+1]||"")==n(Se)&&(ye.R=j+1),ye.type=2}}}function K(A,B){var F=B||{};if(F.fileType=="mad")return O0(A,F);switch(M(A),F.fileType){case"zip":return cc(A,F)}var I=function(Pe){for(var ke=0,Ce=0,je=0;je<Pe.FileIndex.length;++je){var ft=Pe.FileIndex[je];if(ft.content){var ht=ft.content.length;ht>0&&(ht<4096?ke+=ht+63>>6:Ce+=ht+511>>9)}}for(var Zt=Pe.FullPaths.length+3>>2,ii=ke+7>>3,kn=ke+127>>7,Fi=ii+Ce+Zt+kn,zn=Fi+127>>7,ai=zn<=109?0:Math.ceil((zn-109)/127);Fi+zn+ai+127>>7>zn;)ai=++zn<=109?0:Math.ceil((zn-109)/127);var $e=[1,ai,zn,kn,Zt,Ce,ke,0];return Pe.FileIndex[0].size=ke<<6,$e[7]=(Pe.FileIndex[0].start=$e[0]+$e[1]+$e[2]+$e[3]+$e[4]+$e[5])+($e[6]+7>>3),$e}(A),j=Ut(I[7]<<9),U=0,ne=0;{for(U=0;U<8;++U)j.write_shift(1,he[U]);for(U=0;U<8;++U)j.write_shift(2,0);for(j.write_shift(2,62),j.write_shift(2,3),j.write_shift(2,65534),j.write_shift(2,9),j.write_shift(2,6),U=0;U<3;++U)j.write_shift(2,0);for(j.write_shift(4,0),j.write_shift(4,I[2]),j.write_shift(4,I[0]+I[1]+I[2]+I[3]-1),j.write_shift(4,0),j.write_shift(4,4096),j.write_shift(4,I[3]?I[0]+I[1]+I[2]-1:Y),j.write_shift(4,I[3]),j.write_shift(-4,I[1]?I[0]-1:Y),j.write_shift(4,I[1]),U=0;U<109;++U)j.write_shift(-4,U<I[2]?I[1]+U:-1)}if(I[1])for(ne=0;ne<I[1];++ne){for(;U<236+ne*127;++U)j.write_shift(-4,U<I[2]?I[1]+U:-1);j.write_shift(-4,ne===I[1]-1?Y:ne+1)}var fe=function(Pe){for(ne+=Pe;U<ne-1;++U)j.write_shift(-4,U+1);Pe&&(++U,j.write_shift(-4,Y))};for(ne=U=0,ne+=I[1];U<ne;++U)j.write_shift(-4,ge.DIFSECT);for(ne+=I[2];U<ne;++U)j.write_shift(-4,ge.FATSECT);fe(I[3]),fe(I[4]);for(var ae=0,se=0,le=A.FileIndex[0];ae<A.FileIndex.length;++ae)le=A.FileIndex[ae],le.content&&(se=le.content.length,!(se<4096)&&(le.start=ne,fe(se+511>>9)));for(fe(I[6]+7>>3);j.l&511;)j.write_shift(-4,ge.ENDOFCHAIN);for(ne=U=0,ae=0;ae<A.FileIndex.length;++ae)le=A.FileIndex[ae],le.content&&(se=le.content.length,!(!se||se>=4096)&&(le.start=ne,fe(se+63>>6)));for(;j.l&511;)j.write_shift(-4,ge.ENDOFCHAIN);for(U=0;U<I[4]<<2;++U){var ye=A.FullPaths[U];if(!ye||ye.length===0){for(ae=0;ae<17;++ae)j.write_shift(4,0);for(ae=0;ae<3;++ae)j.write_shift(4,-1);for(ae=0;ae<12;++ae)j.write_shift(4,0);continue}le=A.FileIndex[U],U===0&&(le.start=le.size?le.start-1:Y);var Se=U===0&&F.root||le.name;if(se=2*(Se.length+1),j.write_shift(64,Se,"utf16le"),j.write_shift(2,se),j.write_shift(1,le.type),j.write_shift(1,le.color),j.write_shift(-4,le.L),j.write_shift(-4,le.R),j.write_shift(-4,le.C),le.clsid)j.write_shift(16,le.clsid,"hex");else for(ae=0;ae<4;++ae)j.write_shift(4,0);j.write_shift(4,le.state||0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,le.start),j.write_shift(4,le.size),j.write_shift(4,0)}for(U=1;U<A.FileIndex.length;++U)if(le=A.FileIndex[U],le.size>=4096)if(j.l=le.start+1<<9,Ye&&Buffer.isBuffer(le.content))le.content.copy(j,j.l,0,le.size),j.l+=le.size+511&-512;else{for(ae=0;ae<le.size;++ae)j.write_shift(1,le.content[ae]);for(;ae&511;++ae)j.write_shift(1,0)}for(U=1;U<A.FileIndex.length;++U)if(le=A.FileIndex[U],le.size>0&&le.size<4096)if(Ye&&Buffer.isBuffer(le.content))le.content.copy(j,j.l,0,le.size),j.l+=le.size+63&-64;else{for(ae=0;ae<le.size;++ae)j.write_shift(1,le.content[ae]);for(;ae&63;++ae)j.write_shift(1,0)}if(Ye)j.l=j.length;else for(;j.l<j.length;)j.write_shift(1,0);return j}function G(A,B){var F=A.FullPaths.map(function(ae){return ae.toUpperCase()}),I=F.map(function(ae){var se=ae.split("/");return se[se.length-(ae.slice(-1)=="/"?2:1)]}),j=!1;B.charCodeAt(0)===47?(j=!0,B=F[0].slice(0,-1)+B):j=B.indexOf("/")!==-1;var U=B.toUpperCase(),ne=j===!0?F.indexOf(U):I.indexOf(U);if(ne!==-1)return A.FileIndex[ne];var fe=!U.match(Go);for(U=U.replace(Or,""),fe&&(U=U.replace(Go,"!")),ne=0;ne<F.length;++ne)if((fe?F[ne].replace(Go,"!"):F[ne]).replace(Or,"")==U||(fe?I[ne].replace(Go,"!"):I[ne]).replace(Or,"")==U)return A.FileIndex[ne];return null}var X=64,Y=-2,de="d0cf11e0a1b11ae1",he=[208,207,17,224,161,177,26,225],me="00000000000000000000000000000000",ge={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Y,FREESECT:-1,HEADER_SIGNATURE:de,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:me,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function J(A,B,F){f();var I=K(A,F);u.writeFileSync(B,I)}function q(A){for(var B=new Array(A.length),F=0;F<A.length;++F)B[F]=String.fromCharCode(A[F]);return B.join("")}function ce(A,B){var F=K(A,B);switch(B&&B.type||"buffer"){case"file":return f(),u.writeFileSync(B.filename,F),F;case"binary":return typeof F=="string"?F:q(F);case"base64":return Tg(typeof F=="string"?F:q(F));case"buffer":if(Ye)return Buffer.isBuffer(F)?F:Ya(F);case"array":return typeof F=="string"?In(F):F}return F}var _e;function N(A){try{var B=A.InflateRaw,F=new B;if(F._processChunk(new Uint8Array([3,0]),F._finishFlushFlag),F.bytesRead)_e=A;else throw new Error("zlib does not expose bytesRead")}catch(I){console.error("cannot use native zlib: "+(I.message||I))}}function Z(A,B){if(!_e)return sc(A,B);var F=_e.InflateRaw,I=new F,j=I._processChunk(A.slice(A.l),I._finishFlushFlag);return A.l+=I.bytesRead,j}function H(A){return _e?_e.deflateRawSync(A):Ve(A)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],xe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Te(A){var B=(A<<1|A<<11)&139536|(A<<5|A<<15)&558144;return(B>>16|B>>8|B)&255}for(var ee=typeof Uint8Array<"u",oe=ee?new Uint8Array(256):[],Ae=0;Ae<256;++Ae)oe[Ae]=Te(Ae);function D(A,B){var F=oe[A&255];return B<=8?F>>>8-B:(F=F<<8|oe[A>>8&255],B<=16?F>>>16-B:(F=F<<8|oe[A>>16&255],F>>>24-B))}function Ze(A,B){var F=B&7,I=B>>>3;return(A[I]|(F<=6?0:A[I+1]<<8))>>>F&3}function qe(A,B){var F=B&7,I=B>>>3;return(A[I]|(F<=5?0:A[I+1]<<8))>>>F&7}function nt(A,B){var F=B&7,I=B>>>3;return(A[I]|(F<=4?0:A[I+1]<<8))>>>F&15}function ze(A,B){var F=B&7,I=B>>>3;return(A[I]|(F<=3?0:A[I+1]<<8))>>>F&31}function Ee(A,B){var F=B&7,I=B>>>3;return(A[I]|(F<=1?0:A[I+1]<<8))>>>F&127}function it(A,B,F){var I=B&7,j=B>>>3,U=(1<<F)-1,ne=A[j]>>>I;return F<8-I||(ne|=A[j+1]<<8-I,F<16-I)||(ne|=A[j+2]<<16-I,F<24-I)||(ne|=A[j+3]<<24-I),ne&U}function Qt(A,B,F){var I=B&7,j=B>>>3;return I<=5?A[j]|=(F&7)<<I:(A[j]|=F<<I&255,A[j+1]=(F&7)>>8-I),B+3}function ur(A,B,F){var I=B&7,j=B>>>3;return F=(F&1)<<I,A[j]|=F,B+1}function fr(A,B,F){var I=B&7,j=B>>>3;return F<<=I,A[j]|=F&255,F>>>=8,A[j+1]=F,B+8}function yn(A,B,F){var I=B&7,j=B>>>3;return F<<=I,A[j]|=F&255,F>>>=8,A[j+1]=F&255,A[j+2]=F>>>8,B+16}function Ir(A,B){var F=A.length,I=2*F>B?2*F:B+5,j=0;if(F>=B)return A;if(Ye){var U=Cg(I);if(A.copy)A.copy(U);else for(;j<A.length;++j)U[j]=A[j];return U}else if(ee){var ne=new Uint8Array(I);if(ne.set)ne.set(A);else for(;j<F;++j)ne[j]=A[j];return ne}return A.length=I,A}function Vt(A){for(var B=new Array(A),F=0;F<A;++F)B[F]=0;return B}function Wr(A,B,F){var I=1,j=0,U=0,ne=0,fe=0,ae=A.length,se=ee?new Uint16Array(32):Vt(32);for(U=0;U<32;++U)se[U]=0;for(U=ae;U<F;++U)A[U]=0;ae=A.length;var le=ee?new Uint16Array(ae):Vt(ae);for(U=0;U<ae;++U)se[j=A[U]]++,I<j&&(I=j),le[U]=0;for(se[0]=0,U=1;U<=I;++U)se[U+16]=fe=fe+se[U-1]<<1;for(U=0;U<ae;++U)fe=A[U],fe!=0&&(le[U]=se[fe+16]++);var ye=0;for(U=0;U<ae;++U)if(ye=A[U],ye!=0)for(fe=D(le[U],I)>>I-ye,ne=(1<<I+4-ye)-1;ne>=0;--ne)B[fe|ne<<ye]=ye&15|U<<4;return I}var rn=ee?new Uint16Array(512):Vt(512),Ri=ee?new Uint16Array(32):Vt(32);if(!ee){for(var Gt=0;Gt<512;++Gt)rn[Gt]=0;for(Gt=0;Gt<32;++Gt)Ri[Gt]=0}(function(){for(var A=[],B=0;B<32;B++)A.push(5);Wr(A,Ri,32);var F=[];for(B=0;B<=143;B++)F.push(8);for(;B<=255;B++)F.push(9);for(;B<=279;B++)F.push(7);for(;B<=287;B++)F.push(8);Wr(F,rn,288)})();var nn=function(){for(var B=ee?new Uint8Array(32768):[],F=0,I=0;F<xe.length-1;++F)for(;I<xe[F+1];++I)B[I]=F;for(;I<32768;++I)B[I]=29;var j=ee?new Uint8Array(259):[];for(F=0,I=0;F<te.length-1;++F)for(;I<te[F+1];++I)j[I]=F;function U(fe,ae){for(var se=0;se<fe.length;){var le=Math.min(65535,fe.length-se),ye=se+le==fe.length;for(ae.write_shift(1,+ye),ae.write_shift(2,le),ae.write_shift(2,~le&65535);le-- >0;)ae[ae.l++]=fe[se++]}return ae.l}function ne(fe,ae){for(var se=0,le=0,ye=ee?new Uint16Array(32768):[];le<fe.length;){var Se=Math.min(65535,fe.length-le);if(Se<10){for(se=Qt(ae,se,+(le+Se==fe.length)),se&7&&(se+=8-(se&7)),ae.l=se/8|0,ae.write_shift(2,Se),ae.write_shift(2,~Se&65535);Se-- >0;)ae[ae.l++]=fe[le++];se=ae.l*8;continue}se=Qt(ae,se,+(le+Se==fe.length)+2);for(var Pe=0;Se-- >0;){var ke=fe[le];Pe=(Pe<<5^ke)&32767;var Ce=-1,je=0;if((Ce=ye[Pe])&&(Ce|=le&-32768,Ce>le&&(Ce-=32768),Ce<le))for(;fe[Ce+je]==fe[le+je]&&je<250;)++je;if(je>2){ke=j[je],ke<=22?se=fr(ae,se,oe[ke+1]>>1)-1:(fr(ae,se,3),se+=5,fr(ae,se,oe[ke-23]>>5),se+=3);var ft=ke<8?0:ke-4>>2;ft>0&&(yn(ae,se,je-te[ke]),se+=ft),ke=B[le-Ce],se=fr(ae,se,oe[ke]>>3),se-=3;var ht=ke<4?0:ke-2>>1;ht>0&&(yn(ae,se,le-Ce-xe[ke]),se+=ht);for(var Zt=0;Zt<je;++Zt)ye[Pe]=le&32767,Pe=(Pe<<5^fe[le])&32767,++le;Se-=je-1}else ke<=143?ke=ke+48:se=ur(ae,se,1),se=fr(ae,se,oe[ke]),ye[Pe]=le&32767,++le}se=fr(ae,se,0)-1}return ae.l=(se+7)/8|0,ae.l}return function(ae,se){return ae.length<8?U(ae,se):ne(ae,se)}}();function Ve(A){var B=Ut(50+Math.floor(A.length*1.1)),F=nn(A,B);return B.slice(0,F)}var mt=ee?new Uint16Array(32768):Vt(32768),Nr=ee?new Uint16Array(32768):Vt(32768),Et=ee?new Uint16Array(128):Vt(128),wn=1,po=1;function S0(A,B){var F=ze(A,B)+257;B+=5;var I=ze(A,B)+1;B+=5;var j=nt(A,B)+4;B+=4;for(var U=0,ne=ee?new Uint8Array(19):Vt(19),fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ae=1,se=ee?new Uint8Array(8):Vt(8),le=ee?new Uint8Array(8):Vt(8),ye=ne.length,Se=0;Se<j;++Se)ne[W[Se]]=U=qe(A,B),ae<U&&(ae=U),se[U]++,B+=3;var Pe=0;for(se[0]=0,Se=1;Se<=ae;++Se)le[Se]=Pe=Pe+se[Se-1]<<1;for(Se=0;Se<ye;++Se)(Pe=ne[Se])!=0&&(fe[Se]=le[Pe]++);var ke=0;for(Se=0;Se<ye;++Se)if(ke=ne[Se],ke!=0){Pe=oe[fe[Se]]>>8-ke;for(var Ce=(1<<7-ke)-1;Ce>=0;--Ce)Et[Pe|Ce<<ke]=ke&7|Se<<3}var je=[];for(ae=1;je.length<F+I;)switch(Pe=Et[Ee(A,B)],B+=Pe&7,Pe>>>=3){case 16:for(U=3+Ze(A,B),B+=2,Pe=je[je.length-1];U-- >0;)je.push(Pe);break;case 17:for(U=3+qe(A,B),B+=3;U-- >0;)je.push(0);break;case 18:for(U=11+Ee(A,B),B+=7;U-- >0;)je.push(0);break;default:je.push(Pe),ae<Pe&&(ae=Pe);break}var ft=je.slice(0,F),ht=je.slice(F);for(Se=F;Se<286;++Se)ft[Se]=0;for(Se=I;Se<30;++Se)ht[Se]=0;return wn=Wr(ft,mt,286),po=Wr(ht,Nr,30),B}function pa(A,B){if(A[0]==3&&!(A[1]&3))return[la(B),2];for(var F=0,I=0,j=Cg(B||1<<18),U=0,ne=j.length>>>0,fe=0,ae=0;!(I&1);){if(I=qe(A,F),F+=3,I>>>1)I>>1==1?(fe=9,ae=5):(F=S0(A,F),fe=wn,ae=po);else{F&7&&(F+=8-(F&7));var se=A[F>>>3]|A[(F>>>3)+1]<<8;if(F+=32,se>0)for(!B&&ne<U+se&&(j=Ir(j,U+se),ne=j.length);se-- >0;)j[U++]=A[F>>>3],F+=8;continue}for(;;){!B&&ne<U+32767&&(j=Ir(j,U+32767),ne=j.length);var le=it(A,F,fe),ye=I>>>1==1?rn[le]:mt[le];if(F+=ye&15,ye>>>=4,!(ye>>>8&255))j[U++]=ye;else{if(ye==256)break;ye-=257;var Se=ye<8?0:ye-4>>2;Se>5&&(Se=0);var Pe=U+te[ye];Se>0&&(Pe+=it(A,F,Se),F+=Se),le=it(A,F,ae),ye=I>>>1==1?Ri[le]:Nr[le],F+=ye&15,ye>>>=4;var ke=ye<4?0:ye-2>>1,Ce=xe[ye];for(ke>0&&(Ce+=it(A,F,ke),F+=ke),!B&&ne<Pe&&(j=Ir(j,Pe+100),ne=j.length);U<Pe;)j[U]=j[U-Ce],++U}}}return B?[j,F+7>>>3]:[j.slice(0,U),F+7>>>3]}function sc(A,B){var F=A.slice(A.l||0),I=pa(F,B);return A.l+=I[1],I[0]}function oc(A,B){if(A)typeof console<"u"&&console.error(B);else throw new Error(B)}function mo(A,B){var F=A;ir(F,0);var I=[],j=[],U={FileIndex:I,FullPaths:j};C(U,{root:B.root});for(var ne=F.length-4;(F[ne]!=80||F[ne+1]!=75||F[ne+2]!=5||F[ne+3]!=6)&&ne>=0;)--ne;F.l=ne+4,F.l+=4;var fe=F.read_shift(2);F.l+=6;var ae=F.read_shift(4);for(F.l=ae,ne=0;ne<fe;++ne){F.l+=20;var se=F.read_shift(4),le=F.read_shift(4),ye=F.read_shift(2),Se=F.read_shift(2),Pe=F.read_shift(2);F.l+=8;var ke=F.read_shift(4),Ce=l(F.slice(F.l+ye,F.l+ye+Se));F.l+=ye+Se+Pe;var je=F.l;F.l=ke+4,lc(F,se,le,U,Ce),F.l=je}return U}function lc(A,B,F,I,j){A.l+=2;var U=A.read_shift(2),ne=A.read_shift(2),fe=o(A);if(U&8257)throw new Error("Unsupported ZIP encryption");for(var ae=A.read_shift(4),se=A.read_shift(4),le=A.read_shift(4),ye=A.read_shift(2),Se=A.read_shift(2),Pe="",ke=0;ke<ye;++ke)Pe+=String.fromCharCode(A[A.l++]);if(Se){var Ce=l(A.slice(A.l,A.l+Se));(Ce[21589]||{}).mt&&(fe=Ce[21589].mt),((j||{})[21589]||{}).mt&&(fe=j[21589].mt)}A.l+=Se;var je=A.slice(A.l,A.l+se);switch(ne){case 8:je=Z(A,le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ne)}var ft=!1;U&8&&(ae=A.read_shift(4),ae==134695760&&(ae=A.read_shift(4),ft=!0),se=A.read_shift(4),le=A.read_shift(4)),se!=B&&oc(ft,"Bad compressed size: "+B+" != "+se),le!=F&&oc(ft,"Bad uncompressed size: "+F+" != "+le),vo(I,Pe,je,{unsafe:!0,mt:fe})}function cc(A,B){var F=B||{},I=[],j=[],U=Ut(1),ne=F.compression?8:0,fe=0,ae=0,se=0,le=0,ye=0,Se=A.FullPaths[0],Pe=Se,ke=A.FileIndex[0],Ce=[],je=0;for(ae=1;ae<A.FullPaths.length;++ae)if(Pe=A.FullPaths[ae].slice(Se.length),ke=A.FileIndex[ae],!(!ke.size||!ke.content||Pe=="Sh33tJ5")){var ft=le,ht=Ut(Pe.length);for(se=0;se<Pe.length;++se)ht.write_shift(1,Pe.charCodeAt(se)&127);ht=ht.slice(0,ht.l),Ce[ye]=xb.buf(ke.content,0);var Zt=ke.content;ne==8&&(Zt=H(Zt)),U=Ut(30),U.write_shift(4,67324752),U.write_shift(2,20),U.write_shift(2,fe),U.write_shift(2,ne),ke.mt?a(U,ke.mt):U.write_shift(4,0),U.write_shift(-4,Ce[ye]),U.write_shift(4,Zt.length),U.write_shift(4,ke.content.length),U.write_shift(2,ht.length),U.write_shift(2,0),le+=U.length,I.push(U),le+=ht.length,I.push(ht),le+=Zt.length,I.push(Zt),U=Ut(46),U.write_shift(4,33639248),U.write_shift(2,0),U.write_shift(2,20),U.write_shift(2,fe),U.write_shift(2,ne),U.write_shift(4,0),U.write_shift(-4,Ce[ye]),U.write_shift(4,Zt.length),U.write_shift(4,ke.content.length),U.write_shift(2,ht.length),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(4,0),U.write_shift(4,ft),je+=U.l,j.push(U),je+=ht.length,j.push(ht),++ye}return U=Ut(22),U.write_shift(4,101010256),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,ye),U.write_shift(2,ye),U.write_shift(4,je),U.write_shift(4,le),U.write_shift(2,0),Hi([Hi(I),Hi(j),U])}var ns={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function T0(A,B){if(A.ctype)return A.ctype;var F=A.name||"",I=F.match(/\.([^\.]+)$/);return I&&ns[I[1]]||B&&(I=(F=B).match(/[\.\\]([^\.\\])+$/),I&&ns[I[1]])?ns[I[1]]:"application/octet-stream"}function C0(A){for(var B=Tg(A),F=[],I=0;I<B.length;I+=76)F.push(B.slice(I,I+76));return F.join(`\r
`)+`\r
`}function b0(A){var B=A.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(se){var le=se.charCodeAt(0).toString(16).toUpperCase();return"="+(le.length==1?"0"+le:le)});B=B.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),B.charAt(0)==`
`&&(B="=0D"+B.slice(1)),B=B.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var F=[],I=B.split(`\r
`),j=0;j<I.length;++j){var U=I[j];if(U.length==0){F.push("");continue}for(var ne=0;ne<U.length;){var fe=76,ae=U.slice(ne,ne+fe);ae.charAt(fe-1)=="="?fe--:ae.charAt(fe-2)=="="?fe-=2:ae.charAt(fe-3)=="="&&(fe-=3),ae=U.slice(ne,ne+fe),ne+=fe,ne<U.length&&(ae+="="),F.push(ae)}}return F.join(`\r
`)}function A0(A){for(var B=[],F=0;F<A.length;++F){for(var I=A[F];F<=A.length&&I.charAt(I.length-1)=="=";)I=I.slice(0,I.length-1)+A[++F];B.push(I)}for(var j=0;j<B.length;++j)B[j]=B[j].replace(/[=][0-9A-Fa-f]{2}/g,function(U){return String.fromCharCode(parseInt(U.slice(1),16))});return In(B.join(`\r
`))}function P0(A,B,F){for(var I="",j="",U="",ne,fe=0;fe<10;++fe){var ae=B[fe];if(!ae||ae.match(/^\s*$/))break;var se=ae.match(/^(.*?):\s*([^\s].*)$/);if(se)switch(se[1].toLowerCase()){case"content-location":I=se[2].trim();break;case"content-type":U=se[2].trim();break;case"content-transfer-encoding":j=se[2].trim();break}}switch(++fe,j.toLowerCase()){case"base64":ne=In(Qr(B.slice(fe).join("")));break;case"quoted-printable":ne=A0(B.slice(fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+j)}var le=vo(A,I.slice(F.length),ne,{unsafe:!0});U&&(le.ctype=U)}function go(A,B){if(q(A.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var F=B&&B.root||"",I=(Ye&&Buffer.isBuffer(A)?A.toString("binary"):q(A)).split(`\r
`),j=0,U="";for(j=0;j<I.length;++j)if(U=I[j],!!/^Content-Location:/i.test(U)&&(U=U.slice(U.indexOf("file")),F||(F=U.slice(0,U.lastIndexOf("/")+1)),U.slice(0,F.length)!=F))for(;F.length>0&&(F=F.slice(0,F.length-1),F=F.slice(0,F.lastIndexOf("/")+1),U.slice(0,F.length)!=F););var ne=(I[1]||"").match(/boundary="(.*?)"/);if(!ne)throw new Error("MAD cannot find boundary");var fe="--"+(ne[1]||""),ae=[],se=[],le={FileIndex:ae,FullPaths:se};C(le);var ye,Se=0;for(j=0;j<I.length;++j){var Pe=I[j];Pe!==fe&&Pe!==fe+"--"||(Se++&&P0(le,I.slice(ye,j),F),ye=j)}return le}function O0(A,B){var F=B||{},I=F.boundary||"SheetJS";I="------="+I;for(var j=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+I.slice(2)+'"',"","",""],U=A.FullPaths[0],ne=U,fe=A.FileIndex[0],ae=1;ae<A.FullPaths.length;++ae)if(ne=A.FullPaths[ae].slice(U.length),fe=A.FileIndex[ae],!(!fe.size||!fe.content||ne=="Sh33tJ5")){ne=ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(je){return"_x"+je.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(je){return"_u"+je.charCodeAt(0).toString(16)+"_"});for(var se=fe.content,le=Ye&&Buffer.isBuffer(se)?se.toString("binary"):q(se),ye=0,Se=Math.min(1024,le.length),Pe=0,ke=0;ke<=Se;++ke)(Pe=le.charCodeAt(ke))>=32&&Pe<128&&++ye;var Ce=ye>=Se*4/5;j.push(I),j.push("Content-Location: "+(F.root||"file:///C:/SheetJS/")+ne),j.push("Content-Transfer-Encoding: "+(Ce?"quoted-printable":"base64")),j.push("Content-Type: "+T0(fe,ne)),j.push(""),j.push(Ce?b0(le):C0(le))}return j.push(I+`--\r
`),j.join(`\r
`)}function R0(A){var B={};return C(B,A),B}function vo(A,B,F,I){var j=I&&I.unsafe;j||C(A);var U=!j&&Qe.find(A,B);if(!U){var ne=A.FullPaths[0];B.slice(0,ne.length)==ne?ne=B:(ne.slice(-1)!="/"&&(ne+="/"),ne=(ne+B).replace("//","/")),U={name:i(B),type:2},A.FileIndex.push(U),A.FullPaths.push(ne),j||Qe.utils.cfb_gc(A)}return U.content=F,U.size=F?F.length:0,I&&(I.CLSID&&(U.clsid=I.CLSID),I.mt&&(U.mt=I.mt),I.ct&&(U.ct=I.ct)),U}function F0(A,B){C(A);var F=Qe.find(A,B);if(F){for(var I=0;I<A.FileIndex.length;++I)if(A.FileIndex[I]==F)return A.FileIndex.splice(I,1),A.FullPaths.splice(I,1),!0}return!1}function an(A,B,F){C(A);var I=Qe.find(A,B);if(I){for(var j=0;j<A.FileIndex.length;++j)if(A.FileIndex[j]==I)return A.FileIndex[j].name=i(F),A.FullPaths[j]=F,!0}return!1}function Fe(A){M(A,!0)}return t.find=G,t.read=R,t.parse=d,t.write=ce,t.writeFile=J,t.utils={cfb_new:R0,cfb_add:vo,cfb_del:F0,cfb_mov:an,cfb_gc:Fe,ReadShift:sl,CheckField:n2,prep_blob:ir,bconcat:Hi,use_zlib:N,_deflateRaw:Ve,_inflateRaw:sc,consts:ge},t}();function yb(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function ti(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Pp(e){for(var t=[],r=ti(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var Zu=new Date(1899,11,30,0,0,0);function Rr(e,t){var r=e.getTime(),n=Zu.getTime()+(e.getTimezoneOffset()-Zu.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Dy=new Date,wb=Zu.getTime()+(Dy.getTimezoneOffset()-Zu.getTimezoneOffset())*6e4,Ig=Dy.getTimezoneOffset();function y0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+wb),t.getTimezoneOffset()!==Ig&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Ig)*6e4),t}function kb(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(r=1,a>3&&(n=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[a],10)}return t}var Ng=new Date("2017-02-19T19:06:09.000Z"),My=isNaN(Ng.getFullYear())?new Date("2/19/17"):Ng,Eb=My.getFullYear()==2017;function Jt(e,t){var r=new Date(e);if(Eb)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(My.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Ga(e,t){if(Ye&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Ko(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ko(Ey(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Ko(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ko(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function sr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=sr(e[r]));return t}function Ct(e,t){for(var r="";r.length<t;)r+=e;return r}function jn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var Sb=["january","february","march","april","may","june","july","august","september","october","november","december"];function no(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&Sb.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Tb=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),o=[a[0]],l=1;l<a.length;++l)o.push(i),o.push(a[l]);return o}}();function By(e){return e?e.content&&e.type?Ga(e.content,!0):e.data?Vo(e.data):e.asNodeBuffer&&Ye?Vo(e.asNodeBuffer().toString("binary")):e.asBinary?Vo(e.asBinary()):e._data&&e._data.getContent?Vo(Ga(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function jy(e){if(!e)return null;if(e.data)return Eg(e.data);if(e.asNodeBuffer&&Ye)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Eg(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Cb(e){return e&&e.name.slice(-4)===".bin"?jy(e):By(e)}function fn(e,t){for(var r=e.FullPaths||ti(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var o=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function Op(e,t){var r=fn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Nt(e,t,r){if(!r)return Cb(Op(e,t));if(!t)return null;try{return Nt(e,t)}catch{return null}}function qr(e,t,r){if(!r)return By(Op(e,t));if(!t)return null;try{return qr(e,t)}catch{return null}}function bb(e,t,r){return jy(Op(e,t))}function Dg(e){for(var t=e.FullPaths||ti(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Ab(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ye?n=Ya(r):n=ZC(r),Qe.utils.cfb_add(e,t,n)}Qe.utils.cfb_add(e,t,r)}else e.file(t,r)}function Uy(e,t){switch(t.type){case"base64":return Qe.read(e,{type:"base64"});case"binary":return Qe.read(e,{type:"binary"});case"buffer":case"array":return Qe.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Zo(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var zy=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Pb=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Mg=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Ob=/<[^>]*>/g,kr=zy.match(Mg)?Mg:Ob,Rb=/<\w*:/,Fb=/<(\/?)\w+:/;function Be(e,t,r){for(var n={},i=0,a=0;i!==e.length&&!((a=e.charCodeAt(i))===32||a===10||a===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(Pb),l=0,u="",f=0,d="",m="",p=1;if(o)for(f=0;f!=o.length;++f){for(m=o[f],a=0;a!=m.length&&m.charCodeAt(a)!==61;++a);for(d=m.slice(0,a).trim();m.charCodeAt(a+1)==32;)++a;for(p=(i=m.charCodeAt(a+1))==34||i==39?1:0,u=m.slice(a+1+p,m.length-p),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=u,n[d.toLowerCase()]=u;else{var v=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(n[v]&&d.slice(l-3,l)=="ext")continue;n[v]=u,n[v.toLowerCase()]=u}}return n}function ri(e){return e.replace(Fb,"<$1")}var $y={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Lb=Pp($y),rt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",a=i.indexOf("<![CDATA[");if(a==-1)return i.replace(e,function(l,u){return $y[l]||String.fromCharCode(parseInt(u,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,u){return String.fromCharCode(parseInt(u,16))});var o=i.indexOf("]]>");return r(i.slice(0,a))+i.slice(a+9,o)+r(i.slice(o+3))}}(),Ib=/[&<>'"]/g,Nb=/[\u0000-\u001f]/g;function Rp(e){var t=e+"";return t.replace(Ib,function(r){return Lb[r]}).replace(/\n/g,"<br/>").replace(Nb,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Bg=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function gt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Wf(e){for(var t="",r=0,n=0,i=0,a=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function jg(e){var t=la(2*e.length),r,n,i=1,a=0,o=0,l;for(n=0;n<e.length;n+=i)i=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),i=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[a++]=o&255,t[a++]=o>>>8,o=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function Ug(e){return Ya(e,"binary").toString("utf8")}var qc="foo bar baz",ut=Ye&&(Ug(qc)==Wf(qc)&&Ug||jg(qc)==Wf(qc)&&jg)||Wf,Ko=Ye?function(e){return Ya(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Ul=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),Wy=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),Db=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Mb=/<\/?(?:vt:)?variant>/g,Bb=/<(?:vt:)([^>]*)>([\s\S]*)</;function zg(e,t){var r=Be(e),n=e.match(Db(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(a){var o=a.replace(Mb,"").match(Bb);o&&i.push({v:ut(o[2]),t:o[1]})}),i}var jb=/(^\s|\s$|\n)/;function Ub(e){return ti(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function zb(e,t,r){return"<"+e+(r!=null?Ub(r):"")+(t!=null?(t.match(jb)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Fp(e){if(Ye&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return ut(Ja(Cp(e)));throw new Error("Bad input format: expected Buffer or string")}var zl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,$b={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},Wb=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function Hb(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,a=5;a>=0;--a)i=i*256+e[t+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function Vb(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,o=n?-t:t;isFinite(o)?o==0?i=a=0:(i=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var l=0;l<=5;++l,a/=256)e[r+l]=a&255;e[r+6]=(i&15)<<4|a&15,e[r+7]=i>>4|n}var $g=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,a=e[0][n].length;i<a;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},Wg=Ye?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ya(t)})):$g(e)}:$g,Hg=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(vi(e,i)));return n.join("").replace(Or,"")},Lp=Ye?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Or,""):Hg(e,t,r)}:Hg,Vg=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},Hy=Ye?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Vg(e,t,r)}:Vg,Gg=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Ss(e,i)));return n.join("")},ec=Ye?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Gg(t,r,n)}:Gg,Vy=function(e,t){var r=Gr(e,t);return r>0?ec(e,t+4,t+4+r-1):""},Gy=Vy,Zy=function(e,t){var r=Gr(e,t);return r>0?ec(e,t+4,t+4+r-1):""},Ky=Zy,qy=function(e,t){var r=2*Gr(e,t);return r>0?ec(e,t+4,t+4+r-1):""},Xy=qy,Yy=function(t,r){var n=Gr(t,r);return n>0?Lp(t,r+4,r+4+n):""},Jy=Yy,Qy=function(e,t){var r=Gr(e,t);return r>0?ec(e,t+4,t+4+r):""},e2=Qy,t2=function(e,t){return Hb(e,t)},Ku=t2,r2=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ye&&(Gy=function(t,r){if(!Buffer.isBuffer(t))return Vy(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Ky=function(t,r){if(!Buffer.isBuffer(t))return Zy(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Xy=function(t,r){if(!Buffer.isBuffer(t))return qy(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Jy=function(t,r){if(!Buffer.isBuffer(t))return Yy(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},e2=function(t,r){if(!Buffer.isBuffer(t))return Qy(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Ku=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):t2(t,r)},r2=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ss=function(e,t){return e[t]},vi=function(e,t){return e[t+1]*256+e[t]},Gb=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Gr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ba=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Zb=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function sl(e,t){var r="",n,i,a=[],o,l,u,f;switch(t){case"dbcs":if(f=this.l,Ye&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)r+=String.fromCharCode(vi(this,f)),f+=2;e*=2;break;case"utf8":r=ec(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Lp(this,this.l,this.l+e);break;case"wstr":return sl.call(this,e,"dbcs");case"lpstr-ansi":r=Gy(this,this.l),e=4+Gr(this,this.l);break;case"lpstr-cp":r=Ky(this,this.l),e=4+Gr(this,this.l);break;case"lpwstr":r=Xy(this,this.l),e=4+2*Gr(this,this.l);break;case"lpp4":e=4+Gr(this,this.l),r=Jy(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Gr(this,this.l),r=e2(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Ss(this,this.l+e++))!==0;)a.push(Kc(o));r=a.join("");break;case"_wstr":for(e=0,r="";(o=vi(this,this.l+e))!==0;)a.push(Kc(o)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",f=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return o=Ss(this,f),this.l=f+1,l=sl.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(Kc(vi(this,f))),f+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return o=Ss(this,f),this.l=f+1,l=sl.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(Kc(Ss(this,f))),f+=1}r=a.join("");break;default:switch(e){case 1:return n=Ss(this,this.l),this.l++,n;case 2:return n=(t==="i"?Gb:vi)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?ba:Zb)(this,this.l),this.l+=4,n):(i=Gr(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Ku(this,this.l):i=Ku([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=Hy(this,this.l,e);break}}return this.l+=e,r}var Kb=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},qb=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Xb=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Yb(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)Xb(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,Kb(this,t,this.l);break;case 8:if(n=8,r==="f"){Vb(this,t,this.l);break}case 16:break;case-4:n=4,qb(this,t,this.l);break}return this.l+=n,this}function n2(e,t){var r=Hy(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ir(e,t){e.l=t,e.read_shift=sl,e.chk=n2,e.write_shift=Yb}function wr(e,t){e.l+=t}function Ut(e){var t=la(e);return ir(t,0),t}function Oi(e,t,r){if(e){var n,i,a;ir(e,e.l||0);for(var o=e.length,l=0,u=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var f=e0[l]||e0[65535];for(n=e.read_shift(1),a=n&127,i=1;i<4&&n&128;++i)a+=((n=e.read_shift(1))&127)<<7*i;u=e.l+a;var d=f.f&&f.f(e,a,r);if(e.l=u,t(d,f,l))return}}}function fd(){var e=[],t=Ye?256:2048,r=function(f){var d=Ut(f);return ir(d,0),d},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(f){return n&&f<n.length-n.l?n:(i(),n=r(Math.max(f+1,t)))},o=function(){return i(),Hi(e)},l=function(f){i(),n=f,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:l,end:o,_bufs:e}}function ol(e,t,r){var n=sr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Zg(e,t,r){var n=sr(e);return n.s=ol(n.s,t.s,r),n.e=ol(n.e,t.s,r),n}function ll(e,t){if(e.cRel&&e.c<0)for(e=sr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=sr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ue(e);return!e.cRel&&e.cRel!=null&&(r=eA(r)),!e.rRel&&e.rRel!=null&&(r=Jb(r)),r}function Hf(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Wt(e.s.c)+":"+(e.e.cRel?"":"$")+Wt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+or(e.s.r)+":"+(e.e.rRel?"":"$")+or(e.e.r):ll(e.s,t.biff)+":"+ll(e.e,t.biff)}function Ip(e){return parseInt(Qb(e),10)-1}function or(e){return""+(e+1)}function Jb(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Qb(e){return e.replace(/\$(\d+)$/,"$1")}function Np(e){for(var t=tA(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Wt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function eA(e){return e.replace(/^([A-Z])/,"$$$1")}function tA(e){return e.replace(/^\$([A-Z])/,"$1")}function rA(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ar(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Ue(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function fo(e){var t=e.indexOf(":");return t==-1?{s:Ar(e),e:Ar(e)}:{s:Ar(e.slice(0,t)),e:Ar(e.slice(t+1))}}function et(e,t){return typeof t>"u"||typeof t=="number"?et(e.s,e.e):(typeof e!="string"&&(e=Ue(e)),typeof t!="string"&&(t=Ue(t)),e==t?e:e+":"+t)}function bt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=e.length;for(r=0;n<a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===a||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function Kg(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=_n(e.z,r?Rr(t):t)}catch{}try{return e.w=_n((e.XF||{}).numFmtId||(r?14:0),r?Rr(t):t)}catch{return""+t}}function Ci(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ts[e.v]||e.v:t==null?Kg(e,e.v):Kg(e,t))}function da(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function i2(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,a=e||(i?[]:{}),o=0,l=0;if(a&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?Ar(n.origin):n.origin;o=u.r,l=u.c}a["!ref"]||(a["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=bt(a["!ref"]);f.s.c=d.s.c,f.s.r=d.s.r,f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),o==-1&&(f.e.r=o=d.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[m].length;++p)if(!(typeof t[m][p]>"u")){var v={v:t[m][p]},x=o+m,_=l+p;if(f.s.r>x&&(f.s.r=x),f.s.c>_&&(f.s.c=_),f.e.r<x&&(f.e.r=x),f.e.c<_&&(f.e.c=_),t[m][p]&&typeof t[m][p]=="object"&&!Array.isArray(t[m][p])&&!(t[m][p]instanceof Date))v=t[m][p];else if(Array.isArray(v.v)&&(v.f=t[m][p][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(n.nullError)v.t="e",v.v=0;else if(n.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=n.dateNF||He[14],n.cellDates?(v.t="d",v.w=_n(v.z,Rr(v.v))):(v.t="n",v.v=Rr(v.v),v.w=_n(v.z,v.v))):v.t="s";if(i)a[x]||(a[x]=[]),a[x][_]&&a[x][_].z&&(v.z=a[x][_].z),a[x][_]=v;else{var S=Ue({c:_,r:x});a[S]&&a[S].z&&(v.z=a[S].z),a[S]=v}}}return f.s.c<1e7&&(a["!ref"]=et(f)),a}function ho(e,t){return i2(null,e,t)}function nA(e){return e.read_shift(4,"i")}function xr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function iA(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Dp(e,t){var r=e.l,n=e.read_shift(1),i=xr(e),a=[],o={t:i,h:i};if(n&1){for(var l=e.read_shift(4),u=0;u!=l;++u)a.push(iA(e));o.r=a}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}var aA=Dp;function xn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Qa(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var sA=xr;function Mp(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var oA=xr,hd=Mp;function Bp(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?Ku([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ba(t,0)>>2;return r?i/100:i}function a2(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var es=a2;function vr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function lA(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),u=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var f=Ba[i];f&&(t.rgb=Wl(f));break;case 2:t.rgb=Wl([o,l,u]);break;case 3:t.theme=i;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function cA(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function s2(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function uA(e){return s2(e,1)}function fA(e){return s2(e,2)}var jp=2,Mr=3,Xc=11,qg=12,qu=19,Yc=64,hA=65,dA=71,pA=4108,mA=4126,qt=80,o2=81,gA=[qt,o2],vA={1:{n:"CodePage",t:jp},2:{n:"Category",t:qt},3:{n:"PresentationFormat",t:qt},4:{n:"ByteCount",t:Mr},5:{n:"LineCount",t:Mr},6:{n:"ParagraphCount",t:Mr},7:{n:"SlideCount",t:Mr},8:{n:"NoteCount",t:Mr},9:{n:"HiddenCount",t:Mr},10:{n:"MultimediaClipCount",t:Mr},11:{n:"ScaleCrop",t:Xc},12:{n:"HeadingPairs",t:pA},13:{n:"TitlesOfParts",t:mA},14:{n:"Manager",t:qt},15:{n:"Company",t:qt},16:{n:"LinksUpToDate",t:Xc},17:{n:"CharacterCount",t:Mr},19:{n:"SharedDoc",t:Xc},22:{n:"HyperlinksChanged",t:Xc},23:{n:"AppVersion",t:Mr,p:"version"},24:{n:"DigSig",t:hA},26:{n:"ContentType",t:qt},27:{n:"ContentStatus",t:qt},28:{n:"Language",t:qt},29:{n:"Version",t:qt},255:{},2147483648:{n:"Locale",t:qu},2147483651:{n:"Behavior",t:qu},1919054434:{}},_A={1:{n:"CodePage",t:jp},2:{n:"Title",t:qt},3:{n:"Subject",t:qt},4:{n:"Author",t:qt},5:{n:"Keywords",t:qt},6:{n:"Comments",t:qt},7:{n:"Template",t:qt},8:{n:"LastAuthor",t:qt},9:{n:"RevNumber",t:qt},10:{n:"EditTime",t:Yc},11:{n:"LastPrinted",t:Yc},12:{n:"CreatedDate",t:Yc},13:{n:"ModifiedDate",t:Yc},14:{n:"PageCount",t:Mr},15:{n:"WordCount",t:Mr},16:{n:"CharCount",t:Mr},17:{n:"Thumbnail",t:dA},18:{n:"Application",t:qt},19:{n:"DocSecurity",t:Mr},255:{},2147483648:{n:"Locale",t:qu},2147483651:{n:"Behavior",t:qu},1919054434:{}},Xg={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},xA=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function yA(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var wA=yA([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ba=sr(wA),ts={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},l2={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Yg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function kA(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function EA(e){var t=kA();if(!e||!e.match)return t;var r={};if((e.match(kr)||[]).forEach(function(n){var i=Be(n);switch(i[0].replace(Rb,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[Yg[i.ContentType]]!==void 0&&t[Yg[i.ContentType]].push(i.PartName);break}}),t.xmlns!==$b.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var js={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function dd(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function cl(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(kr)||[]).forEach(function(i){var a=Be(i);if(a[0]==="<Relationship"){var o={};o.Type=a.Type,o.Target=a.Target,o.Id=a.Id,a.TargetMode&&(o.TargetMode=a.TargetMode);var l=a.TargetMode==="External"?a.Target:Zo(a.Target,t);r[l]=o,n[a.Id]=o}}),r["!id"]=n,r}var SA="application/vnd.oasis.opendocument.spreadsheet";function TA(e,t){for(var r=Fp(e),n,i;n=zl.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Be(n[0],!1),i.path=="/"&&i.type!==SA)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var ul=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],CA=function(){for(var e=new Array(ul.length),t=0;t<ul.length;++t){var r=ul[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function c2(e){var t={};e=ut(e);for(var r=0;r<ul.length;++r){var n=ul[r],i=e.match(CA[r]);i!=null&&i.length>0&&(t[n[1]]=rt(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Jt(t[n[1]]))}return t}var bA=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function u2(e,t,r,n){var i=[];if(typeof e=="string")i=zg(e,n);else for(var a=0;a<e.length;++a)i=i.concat(e[a].map(function(d){return{v:d}}));var o=typeof t=="string"?zg(t,n).map(function(d){return d.v}):t,l=0,u=0;if(o.length>0)for(var f=0;f!==i.length;f+=2){switch(u=+i[f+1].v,i[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=o.slice(l,l+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=o.slice(l,l+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=o.slice(l,l+u);break}l+=u}}function AA(e,t,r){var n={};return t||(t={}),e=ut(e),bA.forEach(function(i){var a=(e.match(Ul(i[0]))||[])[1];switch(i[2]){case"string":a&&(t[i[1]]=rt(a));break;case"bool":t[i[1]]=a==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&u2(n.HeadingPairs,n.TitlesOfParts,t,r),t}var PA=/<[^>]+>[^<]*/g;function OA(e,t){var r={},n="",i=e.match(PA);if(i)for(var a=0;a!=i.length;++a){var o=i[a],l=Be(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=rt(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),f=u[0].slice(4),d=u[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[n]=rt(d);break;case"bool":r[n]=gt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Jt(d);break;case"cy":case"error":r[n]=rt(d);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,f,u)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}var RA={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Vf;function FA(e,t,r){Vf||(Vf=Pp(RA)),t=Vf[t]||t,e[t]=r}function Up(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function f2(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function h2(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function d2(e,t,r){return t===31?h2(e):f2(e,t,r)}function pd(e,t,r){return d2(e,t,r===!1?0:4)}function LA(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return d2(e,t,0)}function IA(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Or,""),e.l-i&2&&(e.l+=2)}return r}function NA(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Or,"");return r}function DA(e){var t=e.l,r=Xu(e,o2);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Xu(e,Mr);return[r,n]}function MA(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(DA(e));return r}function Jg(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var a=e.read_shift(4),o=e.read_shift(4);n[a]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Or,"").replace(Go,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function p2(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function BA(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Xu(e,t,r){var n=e.read_shift(2),i,a=r||{};if(e.l+=2,t!==qg&&n!==t&&gA.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===qg?n:t){case 2:return i=e.read_shift(2,"i"),a.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return f2(e,n,4).replace(Or,"");case 31:return h2(e);case 64:return Up(e);case 65:return p2(e);case 71:return BA(e);case 80:return pd(e,n,!a.raw).replace(Or,"");case 81:return LA(e,n).replace(Or,"");case 4108:return MA(e);case 4126:case 4127:return n==4127?IA(e):NA(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Qg(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),a=[],o=0,l=0,u=-1,f={};for(o=0;o!=i;++o){var d=e.read_shift(4),m=e.read_shift(4);a[o]=[d,m+r]}a.sort(function(k,y){return k[1]-y[1]});var p={};for(o=0;o!=i;++o){if(e.l!==a[o][1]){var v=!0;if(o>0&&t)switch(t[a[o-1][0]].t){case 2:e.l+2===a[o][1]&&(e.l+=2,v=!1);break;case 80:e.l<=a[o][1]&&(e.l=a[o][1],v=!1);break;case 4108:e.l<=a[o][1]&&(e.l=a[o][1],v=!1);break}if((!t||o==0)&&e.l<=a[o][1]&&(v=!1,e.l=a[o][1]),v)throw new Error("Read Error: Expected address "+a[o][1]+" at "+e.l+" :"+o)}if(t){var x=t[a[o][0]];if(p[x.n]=Xu(e,x.t,{raw:!0}),x.p==="version"&&(p[x.n]=String(p[x.n]>>16)+"."+("0000"+String(p[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(p[x.n]){case 0:p[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Nn(l=p[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[x.n])}}else if(a[o][0]===1){if(l=p.CodePage=Xu(e,jp),Nn(l),u!==-1){var _=e.l;e.l=a[u][1],f=Jg(e,l),e.l=_}}else if(a[o][0]===0){if(l===0){u=o,e.l=a[o+1][1];continue}f=Jg(e,l)}else{var S=f[a[o][0]],w;switch(e[e.l]){case 65:e.l+=4,w=p2(e);break;case 30:e.l+=4,w=pd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,w=pd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,w=e.read_shift(4,"i");break;case 19:e.l+=4,w=e.read_shift(4);break;case 5:e.l+=4,w=e.read_shift(8,"f");break;case 11:e.l+=4,w=Pt(e,4);break;case 64:e.l+=4,w=Jt(Up(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[S]=w}}return e.l=r+n,p}function ev(e,t,r){var n=e.content;if(!n)return{};ir(n,0);var i,a,o,l,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),d=n.read_shift(16);if(d!==Qe.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(a=n.read_shift(16),l=n.read_shift(4),i===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);i===2&&(o=n.read_shift(16),u=n.read_shift(4));var m=Qg(n,t),p={SystemIdentifier:f};for(var v in m)p[v]=m[v];if(p.FMTID=a,i===1)return p;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var x;try{x=Qg(n,null)}catch{}for(v in x)p[v]=x[v];return p.FMTID=[a,o],p}function Mi(e,t){return e.read_shift(t),null}function jA(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function Pt(e,t){return e.read_shift(t)===1}function Dt(e){return e.read_shift(2,"u")}function m2(e,t){return jA(e,t,Dt)}function UA(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function tc(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?e.read_shift(n,i):"";return o}function zA(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,a=1+(r&1),o=0,l,u={};i&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var f=a==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,f);return i&&(e.l+=4*o),n&&(e.l+=l),u.t=d,i||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function Za(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function rc(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Za(e,n,r)}function rs(e,t,r){if(r.biff>5)return rc(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function $A(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function WA(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Or,"");return n&&(e.l+=24),i}function HA(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(a>>1,"utf16le").replace(Or,"");return r+o}function VA(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return WA(e);case"0303000000000000c000000000000046":return HA(e);default:throw new Error("Unsupported Moniker "+r)}}function Jc(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Or,""):"";return r}function GA(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var a,o,l,u,f="",d,m;i&16&&(a=Jc(e,r-e.l)),i&128&&(o=Jc(e,r-e.l)),(i&257)===257&&(l=Jc(e,r-e.l)),(i&257)===1&&(u=VA(e,r-e.l)),i&8&&(f=Jc(e,r-e.l)),i&32&&(d=e.read_shift(16)),i&64&&(m=Up(e)),e.l=r;var p=o||l||u||"";p&&f&&(p+="#"+f),p||(p="#"+f),i&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var v={Target:p};return d&&(v.guid=d),m&&(v.time=m),a&&(v.Tooltip=a),v}function g2(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function v2(e,t){var r=g2(e);return r[3]=0,r}function ni(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function ZA(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function KA(e,t,r){return t===0?"":rs(e,t,r)}function qA(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),a=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[i,a,o]}function _2(e){var t=e.read_shift(2),r=Bp(e);return[t,r]}function XA(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=tc(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,i}function w0(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function x2(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var YA=x2;function y2(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function JA(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function QA(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function pr(e){e.l+=2,e.l+=e.read_shift(2)}var e5={0:pr,4:pr,5:pr,6:pr,7:QA,8:pr,9:pr,10:pr,11:pr,12:pr,13:JA,14:pr,15:pr,16:pr,17:pr,18:pr,19:pr,20:pr,21:y2};function t5(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(e5[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Qc(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function r5(e,t){return t===0||e.read_shift(2),1200}function n5(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=rs(e,0,r);return e.read_shift(t+n-e.l),i}function i5(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function a5(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var o=tc(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:a,name:o}}function s5(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),a=[],o=0;o!=i&&e.l<r;++o)a.push(zA(e));return a.Count=n,a.Unique=i,a}function o5(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function l5(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function c5(e){var t=ZA(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function u5(e){return e.read_shift(2),e.read_shift(4)}function tv(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,i]}function f5(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:a,CurTab:o,FirstTab:l,Selected:u,TabRatio:f}}function h5(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function d5(){}function p5(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=tc(e,0,r),n}function m5(e){var t=ni(e);return t.isst=e.read_shift(4),t}function g5(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=ni(e);r.biff==2&&e.l++;var a=rc(e,n-e.l,r);return i.val=a,i}function v5(e,t,r){var n=e.read_shift(2),i=rs(e,0,r);return[n,i]}var _5=rs;function rv(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,a=e.read_shift(i),o=e.read_shift(i),l=e.read_shift(2),u=e.read_shift(2);return e.l=n,{s:{r:a,c:l},e:{r:o,c:u}}}function x5(e){var t=e.read_shift(2),r=e.read_shift(2),n=_2(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function y5(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(_2(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(a.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:a}}function w5(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(a.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:a}}function k5(e,t,r,n){var i={},a=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),u=e.read_shift(2);return i.patternType=xA[l>>26],n.cellStyles&&(i.alc=a&7,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=l&127,i.icvBottom=l>>7&127,i.icvDiag=l>>14&127,i.dgDiag=l>>21&15,i.icvFore=u&127,i.icvBack=u>>7&127,i.fsxButton=u>>14&1),i}function E5(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=k5(e,t,n.fStyle,r),n}function S5(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function nv(e,t,r){var n=ni(e);(r.biff==2||t==9)&&++e.l;var i=UA(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function T5(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ni(e),i=vr(e);return n.val=i,n}var iv=KA;function C5(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var o=Za(e,a),l=[];n>e.l;)l.push(rc(e));return[a,i,o,l]}function av(e,t,r){var n=e.read_shift(2),i,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=XA(e,t-2,r)),a.body=i||e.read_shift(t-2),typeof i=="string"&&(a.Name=i),a}var b5=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function sv(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),u=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=Za(e,o,r);i&32&&(f=b5[f.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var m=n==e.l||l===0||!(d>0)?[]:lO(e,d,r,l);return{chKey:a,Name:f,itab:u,rgce:m}}function w2(e,t,r){if(r.biff<8)return A5(e,t,r);for(var n=[],i=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(qA(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function A5(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=tc(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function P5(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),a=Za(e,n,r),o=Za(e,i,r);return[a,o]}function O5(e,t,r){var n=x2(e);e.l++;var i=e.read_shift(1);return t-=8,[cO(e,t,r),i,n]}function ov(e,t,r){var n=YA(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,sO(e,t,r)]}function R5(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function F5(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=rs(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},l,o,a]}}function L5(e,t,r){return F5(e,t,r)}function I5(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(w0(e));return r}function N5(e,t,r){if(r&&r.biff<8)return M5(e,t,r);var n=y2(e),i=t5(e,t-22,n[1]);return{cmo:n,ft:i}}var D5={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function M5(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((D5[n]||wr)(e,t,r)),{cmo:[i,n,a],ft:o}}function B5(e,t,r){var n=e.l,i="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:o=$A(e,6,r);var l=e.read_shift(2);e.read_shift(2),Dt(e,2);var u=e.read_shift(2);e.l+=u;for(var f=1;f<e.lens.length-1;++f){if(e.l-n!=e.lens[f])throw new Error("TxO: bad continue record");var d=e[e.l],m=Za(e,e.lens[f+1]-e.lens[f]-1);if(i+=m,i.length>=(d?l:2*l))break}if(i.length!==l&&i.length!==l*2)throw new Error("cchText: "+l+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function j5(e,t){var r=w0(e);e.l+=16;var n=GA(e,t-24);return[r,n]}function U5(e,t){e.read_shift(2);var r=w0(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Or,""),[r,n]}function z5(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Xg[r]||r,r=e.read_shift(2),t[1]=Xg[r]||r,t}function $5(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(v2(e));return r}function W5(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(v2(e));return r}function H5(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function k2(e,t,r){if(!r.cellStyles)return wr(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),u=e.read_shift(2);n==2&&(e.l+=2);var f={s:i,e:a,w:o,ixfe:l,flags:u};return(r.biff>=5||!r.biff)&&(f.level=u>>8&7),f}function V5(e,t){var r={};return t<32||(e.l+=16,r.header=vr(e),r.footer=vr(e),e.l+=2),r}function G5(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var Z5=ni,K5=m2,q5=rc;function X5(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function Y5(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ni(e);++e.l;var i=rs(e,t-7,r);return n.t="str",n.val=i,n}function J5(e){var t=ni(e);++e.l;var r=vr(e);return t.t="n",t.val=r,t}function Q5(e){var t=ni(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function e8(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function t8(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function r8(e,t,r){var n=e.l+t,i=ni(e),a=e.read_shift(2),o=Za(e,a,r);return e.l=n,i.t="str",i.val=o,i}var n8=[2,3,48,49,131,139,140,245],lv=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Pp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,u){var f=[],d=la(1);switch(u.type){case"base64":d=In(Qr(l));break;case"binary":d=In(l);break;case"buffer":case"array":d=l;break}ir(d,0);var m=d.read_shift(1),p=!!(m&136),v=!1,x=!1;switch(m){case 2:break;case 3:break;case 48:v=!0,p=!0;break;case 49:v=!0,p=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var _=0,S=521;m==2&&(_=d.read_shift(2)),d.l+=3,m!=2&&(_=d.read_shift(4)),_>1048576&&(_=1e6),m!=2&&(S=d.read_shift(2));var w=d.read_shift(2),k=u.codepage||1252;m!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(k=e[d[d.l]]),d.l+=1,d.l+=2),x&&(d.l+=36);for(var y=[],b={},O=Math.min(d.length,m==2?521:S-10-(v?264:0)),R=x?32:11;d.l<O&&d[d.l]!=13;)switch(b={},b.name=Bl.utils.decode(k,d.slice(d.l,d.l+R)).replace(/[\u0000\r\n].*$/g,""),d.l+=R,b.type=String.fromCharCode(d.read_shift(1)),m!=2&&!x&&(b.offset=d.read_shift(4)),b.len=d.read_shift(1),m==2&&(b.offset=d.read_shift(2)),b.dec=d.read_shift(1),b.name.length&&y.push(b),m!=2&&(d.l+=x?13:14),b.type){case"B":(!v||b.len!=8)&&u.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(d[d.l]!==13&&(d.l=S-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=S;var C=0,z=0;for(f[0]=[],z=0;z!=y.length;++z)f[0][z]=y[z].name;for(;_-- >0;){if(d[d.l]===42){d.l+=w;continue}for(++d.l,f[++C]=[],z=0,z=0;z!=y.length;++z){var M=d.slice(d.l,d.l+y[z].len);d.l+=y[z].len,ir(M,0);var K=Bl.utils.decode(k,M);switch(y[z].type){case"C":K.trim().length&&(f[C][z]=K.replace(/\s+$/,""));break;case"D":K.length===8?f[C][z]=new Date(+K.slice(0,4),+K.slice(4,6)-1,+K.slice(6,8)):f[C][z]=K;break;case"F":f[C][z]=parseFloat(K.trim());break;case"+":case"I":f[C][z]=x?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(K.trim().toUpperCase()){case"Y":case"T":f[C][z]=!0;break;case"N":case"F":f[C][z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+K+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));f[C][z]="##MEMO##"+(x?parseInt(K.trim(),10):M.read_shift(4));break;case"N":K=K.replace(/\u0000/g,"").trim(),K&&K!="."&&(f[C][z]=+K||0);break;case"@":f[C][z]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":f[C][z]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":f[C][z]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[C][z]=-M.read_shift(-8,"f");break;case"B":if(v&&y[z].len==8){f[C][z]=M.read_shift(8,"f");break}case"G":case"P":M.l+=y[z].len;break;case"0":if(y[z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[z].type)}}}if(m!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u&&u.sheetRows&&(f=f.slice(0,u.sheetRows)),u.DBF=y,f}function n(l,u){var f=u||{};f.dateNF||(f.dateNF="yyyymmdd");var d=ho(r(l,f),f);return d["!cols"]=f.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete f.DBF,d}function i(l,u){try{return da(n(l,u),u)}catch(f){if(u&&u.WTF)throw f}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,u){var f=u||{};if(+f.codepage>=0&&Nn(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var d=fd(),m=wd(l,{header:1,raw:!0,cellDates:!0}),p=m[0],v=m.slice(1),x=l["!cols"]||[],_=0,S=0,w=0,k=1;for(_=0;_<p.length;++_){if(((x[_]||{}).DBF||{}).name){p[_]=x[_].DBF.name,++w;continue}if(p[_]!=null){if(++w,typeof p[_]=="number"&&(p[_]=p[_].toString(10)),typeof p[_]!="string")throw new Error("DBF Invalid column name "+p[_]+" |"+typeof p[_]+"|");if(p.indexOf(p[_])!==_){for(S=0;S<1024;++S)if(p.indexOf(p[_]+"_"+S)==-1){p[_]+="_"+S;break}}}}var y=bt(l["!ref"]),b=[],O=[],R=[];for(_=0;_<=y.e.c-y.s.c;++_){var C="",z="",M=0,K=[];for(S=0;S<v.length;++S)v[S][_]!=null&&K.push(v[S][_]);if(K.length==0||p[_]==null){b[_]="?";continue}for(S=0;S<K.length;++S){switch(typeof K[S]){case"number":z="B";break;case"string":z="C";break;case"boolean":z="L";break;case"object":z=K[S]instanceof Date?"D":"C";break;default:z="C"}M=Math.max(M,String(K[S]).length),C=C&&C!=z?"C":z}M>250&&(M=250),z=((x[_]||{}).DBF||{}).type,z=="C"&&x[_].DBF.len>M&&(M=x[_].DBF.len),C=="B"&&z=="N"&&(C="N",R[_]=x[_].DBF.dec,M=x[_].DBF.len),O[_]=C=="C"||z=="N"?M:a[C]||0,k+=O[_],b[_]=C}var G=d.next(32);for(G.write_shift(4,318902576),G.write_shift(4,v.length),G.write_shift(2,296+32*w),G.write_shift(2,k),_=0;_<4;++_)G.write_shift(4,0);for(G.write_shift(4,0|(+t[wy]||3)<<8),_=0,S=0;_<p.length;++_)if(p[_]!=null){var X=d.next(32),Y=(p[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);X.write_shift(1,Y,"sbcs"),X.write_shift(1,b[_]=="?"?"C":b[_],"sbcs"),X.write_shift(4,S),X.write_shift(1,O[_]||a[b[_]]||0),X.write_shift(1,R[_]||0),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(1,0),X.write_shift(4,0),X.write_shift(4,0),S+=O[_]||a[b[_]]||0}var de=d.next(264);for(de.write_shift(4,13),_=0;_<65;++_)de.write_shift(4,0);for(_=0;_<v.length;++_){var he=d.next(k);for(he.write_shift(1,0),S=0;S<p.length;++S)if(p[S]!=null)switch(b[S]){case"L":he.write_shift(1,v[_][S]==null?63:v[_][S]?84:70);break;case"B":he.write_shift(8,v[_][S]||0,"f");break;case"N":var me="0";for(typeof v[_][S]=="number"&&(me=v[_][S].toFixed(R[S]||0)),w=0;w<O[S]-me.length;++w)he.write_shift(1,32);he.write_shift(1,me,"sbcs");break;case"D":v[_][S]?(he.write_shift(4,("0000"+v[_][S].getFullYear()).slice(-4),"sbcs"),he.write_shift(2,("00"+(v[_][S].getMonth()+1)).slice(-2),"sbcs"),he.write_shift(2,("00"+v[_][S].getDate()).slice(-2),"sbcs")):he.write_shift(8,"00000000","sbcs");break;case"C":var ge=String(v[_][S]!=null?v[_][S]:"").slice(0,O[S]);for(he.write_shift(1,ge,"sbcs"),w=0;w<O[S]-ge.length;++w)he.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),i8=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ti(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,v){var x=e[v];return typeof x=="number"?Sg(x):x},n=function(p,v,x){var _=v.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return _==59?p:Sg(_)};e["|"]=254;function i(p,v){switch(v.type){case"base64":return a(Qr(p),v);case"binary":return a(p,v);case"buffer":return a(Ye&&Buffer.isBuffer(p)?p.toString("binary"):Ja(p),v);case"array":return a(Ga(p),v)}throw new Error("Unrecognized type "+v.type)}function a(p,v){var x=p.split(/[\n\r]+/),_=-1,S=-1,w=0,k=0,y=[],b=[],O=null,R={},C=[],z=[],M=[],K=0,G;for(+v.codepage>=0&&Nn(+v.codepage);w!==x.length;++w){K=0;var X=x[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),Y=X.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),de=Y[0],he;if(X.length>0)switch(de){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Y[1].charAt(0)=="P"&&b.push(X.slice(3).replace(/;;/g,";"));break;case"C":var me=!1,ge=!1,J=!1,q=!1,ce=-1,_e=-1;for(k=1;k<Y.length;++k)switch(Y[k].charAt(0)){case"A":break;case"X":S=parseInt(Y[k].slice(1))-1,ge=!0;break;case"Y":for(_=parseInt(Y[k].slice(1))-1,ge||(S=0),G=y.length;G<=_;++G)y[G]=[];break;case"K":he=Y[k].slice(1),he.charAt(0)==='"'?he=he.slice(1,he.length-1):he==="TRUE"?he=!0:he==="FALSE"?he=!1:isNaN(jn(he))?isNaN(no(he).getDate())||(he=Jt(he)):(he=jn(he),O!==null&&uo(O)&&(he=y0(he))),me=!0;break;case"E":q=!0;var N=Ks(Y[k].slice(1),{r:_,c:S});y[_][S]=[y[_][S],N];break;case"S":J=!0,y[_][S]=[y[_][S],"S5S"];break;case"G":break;case"R":ce=parseInt(Y[k].slice(1))-1;break;case"C":_e=parseInt(Y[k].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+X)}if(me&&(y[_][S]&&y[_][S].length==2?y[_][S][0]=he:y[_][S]=he,O=null),J){if(q)throw new Error("SYLK shared formula cannot have own formula");var Z=ce>-1&&y[ce][_e];if(!Z||!Z[1])throw new Error("SYLK shared formula cannot find base");y[_][S][1]=F2(Z[1],{r:_-ce,c:S-_e})}break;case"F":var H=0;for(k=1;k<Y.length;++k)switch(Y[k].charAt(0)){case"X":S=parseInt(Y[k].slice(1))-1,++H;break;case"Y":for(_=parseInt(Y[k].slice(1))-1,G=y.length;G<=_;++G)y[G]=[];break;case"M":K=parseInt(Y[k].slice(1))/20;break;case"F":break;case"G":break;case"P":O=b[parseInt(Y[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=Y[k].slice(1).split(" "),G=parseInt(M[0],10);G<=parseInt(M[1],10);++G)K=parseInt(M[2],10),z[G-1]=K===0?{hidden:!0}:{wch:K},io(z[G-1]);break;case"C":S=parseInt(Y[k].slice(1))-1,z[S]||(z[S]={});break;case"R":_=parseInt(Y[k].slice(1))-1,C[_]||(C[_]={}),K>0?(C[_].hpt=K,C[_].hpx=Hl(K)):K===0&&(C[_].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+X)}H<1&&(O=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+X)}}return C.length>0&&(R["!rows"]=C),z.length>0&&(R["!cols"]=z),v&&v.sheetRows&&(y=y.slice(0,v.sheetRows)),[y,R]}function o(p,v){var x=i(p,v),_=x[0],S=x[1],w=ho(_,v);return ti(S).forEach(function(k){w[k]=S[k]}),w}function l(p,v){return da(o(p,v),v)}function u(p,v,x,_){var S="C;Y"+(x+1)+";X"+(_+1)+";K";switch(p.t){case"n":S+=p.v||0,p.f&&!p.F&&(S+=";E"+H6(p.f,{r:x,c:_}));break;case"b":S+=p.v?"TRUE":"FALSE";break;case"e":S+=p.w||p.v;break;case"d":S+='"'+(p.w||p.v)+'"';break;case"s":S+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function f(p,v){v.forEach(function(x,_){var S="F;W"+(_+1)+" "+(_+1)+" ";x.hidden?S+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=Ju(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=Qu(x.wpx)),typeof x.wch=="number"&&(S+=Math.round(x.wch))),S.charAt(S.length-1)!=" "&&p.push(S)})}function d(p,v){v.forEach(function(x,_){var S="F;";x.hidden?S+="M0;":x.hpt?S+="M"+20*x.hpt+";":x.hpx&&(S+="M"+20*P2(x.hpx)+";"),S.length>2&&p.push(S+"R"+(_+1))})}function m(p,v){var x=["ID;PWXL;N;E"],_=[],S=bt(p["!ref"]),w,k=Array.isArray(p),y=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),p["!cols"]&&f(x,p["!cols"]),p["!rows"]&&d(x,p["!rows"]),x.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var b=S.s.r;b<=S.e.r;++b)for(var O=S.s.c;O<=S.e.c;++O){var R=Ue({r:b,c:O});w=k?(p[b]||[])[O]:p[R],!(!w||w.v==null&&(!w.f||w.F))&&_.push(u(w,p,b,O))}return x.join(y)+y+_.join(y)+y+"E"+y}return{to_workbook:l,to_sheet:o,from_sheet:m}}(),a8=function(){function e(a,o){switch(o.type){case"base64":return t(Qr(a),o);case"binary":return t(a,o);case"buffer":return t(Ye&&Buffer.isBuffer(a)?a.toString("binary"):Ja(a),o);case"array":return t(Ga(a),o)}throw new Error("Unrecognized type "+o.type)}function t(a,o){for(var l=a.split(`
`),u=-1,f=-1,d=0,m=[];d!==l.length;++d){if(l[d].trim()==="BOT"){m[++u]=[],f=0;continue}if(!(u<0)){var p=l[d].trim().split(","),v=p[0],x=p[1];++d;for(var _=l[d]||"";(_.match(/["]/g)||[]).length&1&&d<l.length-1;)_+=`
`+l[++d];switch(_=_.trim(),+v){case-1:if(_==="BOT"){m[++u]=[],f=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?m[u][f]=!0:_==="FALSE"?m[u][f]=!1:isNaN(jn(x))?isNaN(no(x).getDate())?m[u][f]=x:m[u][f]=Jt(x):m[u][f]=jn(x),++f;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),m[u][f++]=_!==""?_:null;break}if(_==="EOD")break}}return o&&o.sheetRows&&(m=m.slice(0,o.sheetRows)),m}function r(a,o){return ho(e(a,o),o)}function n(a,o){return da(r(a,o),o)}var i=function(){var a=function(u,f,d,m,p){u.push(f),u.push(d+","+m),u.push('"'+p.replace(/"/g,'""')+'"')},o=function(u,f,d,m){u.push(f+","+d),u.push(f==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(u){var f=[],d=bt(u["!ref"]),m,p=Array.isArray(u);a(f,"TABLE",0,1,"sheetjs"),a(f,"VECTORS",0,d.e.r-d.s.r+1,""),a(f,"TUPLES",0,d.e.c-d.s.c+1,""),a(f,"DATA",0,0,"");for(var v=d.s.r;v<=d.e.r;++v){o(f,-1,0,"BOT");for(var x=d.s.c;x<=d.e.c;++x){var _=Ue({r:v,c:x});if(m=p?(u[v]||[])[x]:u[_],!m){o(f,1,0,"");continue}switch(m.t){case"n":var S=m.w;!S&&m.v!=null&&(S=m.v),S==null?m.f&&!m.F?o(f,1,0,"="+m.f):o(f,1,0,""):o(f,0,S,"V");break;case"b":o(f,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":o(f,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=_n(m.z||He[14],Rr(Jt(m.v)))),o(f,0,m.w,"V");break;default:o(f,1,0,"")}}}o(f,-1,0,"EOD");var w=`\r
`,k=f.join(w);return k}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),s8=function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,p){for(var v=m.split(`
`),x=-1,_=-1,S=0,w=[];S!==v.length;++S){var k=v[S].trim().split(":");if(k[0]==="cell"){var y=Ar(k[1]);if(w.length<=y.r)for(x=w.length;x<=y.r;++x)w[x]||(w[x]=[]);switch(x=y.r,_=y.c,k[2]){case"t":w[x][_]=e(k[3]);break;case"v":w[x][_]=+k[3];break;case"vtf":var b=k[k.length-1];case"vtc":switch(k[3]){case"nl":w[x][_]=!!+k[4];break;default:w[x][_]=+k[4];break}k[2]=="vtf"&&(w[x][_]=[w[x][_],b])}}}return p&&p.sheetRows&&(w=w.slice(0,p.sheetRows)),w}function n(m,p){return ho(r(m,p),p)}function i(m,p){return da(n(m,p),p)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function f(m){if(!m||!m["!ref"])return"";for(var p=[],v=[],x,_="",S=fo(m["!ref"]),w=Array.isArray(m),k=S.s.r;k<=S.e.r;++k)for(var y=S.s.c;y<=S.e.c;++y)if(_=Ue({r:k,c:y}),x=w?(m[k]||[])[y]:m[_],!(!x||x.v==null||x.t==="z")){switch(v=["cell",_,"t"],x.t){case"s":case"str":v.push(t(x.v));break;case"n":x.f?(v[2]="vtf",v[3]="n",v[4]=x.v,v[5]=t(x.f)):(v[2]="v",v[3]=x.v);break;case"b":v[2]="vt"+(x.f?"f":"c"),v[3]="nl",v[4]=x.v?"1":"0",v[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var b=Rr(Jt(x.v));v[2]="vtc",v[3]="nd",v[4]=""+b,v[5]=x.w||_n(x.z||He[14],b);break;case"e":continue}p.push(v.join(":"))}return p.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function d(m){return[a,o,l,o,f(m),u].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),$l=function(){function e(d,m,p,v,x){x.raw?m[p][v]=d:d===""||(d==="TRUE"?m[p][v]=!0:d==="FALSE"?m[p][v]=!1:isNaN(jn(d))?isNaN(no(d).getDate())?m[p][v]=d:m[p][v]=Jt(d):m[p][v]=jn(d))}function t(d,m){var p=m||{},v=[];if(!d||d.length===0)return v;for(var x=d.split(/[\r\n]/),_=x.length-1;_>=0&&x[_].length===0;)--_;for(var S=10,w=0,k=0;k<=_;++k)w=x[k].indexOf(" "),w==-1?w=x[k].length:w++,S=Math.max(S,w);for(k=0;k<=_;++k){v[k]=[];var y=0;for(e(x[k].slice(0,S).trim(),v,k,y,p),y=1;y<=(x[k].length-S)/10+1;++y)e(x[k].slice(S+(y-1)*10,S+y*10).trim(),v,k,y,p)}return p.sheetRows&&(v=v.slice(0,p.sheetRows)),v}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var m={},p=!1,v=0,x=0;v<d.length;++v)(x=d.charCodeAt(v))==34?p=!p:!p&&x in r&&(m[x]=(m[x]||0)+1);x=[];for(v in m)Object.prototype.hasOwnProperty.call(m,v)&&x.push([m[v],v]);if(!x.length){m=n;for(v in m)Object.prototype.hasOwnProperty.call(m,v)&&x.push([m[v],v])}return x.sort(function(_,S){return _[0]-S[0]||n[_[1]]-n[S[1]]}),r[x.pop()[1]]||44}function a(d,m){var p=m||{},v="",x=p.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(v=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(v=d.charAt(4),d=d.slice(6)):v=i(d.slice(0,1024)):p&&p.FS?v=p.FS:v=i(d.slice(0,1024));var S=0,w=0,k=0,y=0,b=0,O=v.charCodeAt(0),R=!1,C=0,z=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var M=p.dateNF!=null?vb(p.dateNF):null;function K(){var G=d.slice(y,b),X={};if(G.charAt(0)=='"'&&G.charAt(G.length-1)=='"'&&(G=G.slice(1,-1).replace(/""/g,'"')),G.length===0)X.t="z";else if(p.raw)X.t="s",X.v=G;else if(G.trim().length===0)X.t="s",X.v=G;else if(G.charCodeAt(0)==61)G.charCodeAt(1)==34&&G.charCodeAt(G.length-1)==34?(X.t="s",X.v=G.slice(2,-1).replace(/""/g,'"')):G6(G)?(X.t="n",X.f=G.slice(1)):(X.t="s",X.v=G);else if(G=="TRUE")X.t="b",X.v=!0;else if(G=="FALSE")X.t="b",X.v=!1;else if(!isNaN(k=jn(G)))X.t="n",p.cellText!==!1&&(X.w=G),X.v=k;else if(!isNaN(no(G).getDate())||M&&G.match(M)){X.z=p.dateNF||He[14];var Y=0;M&&G.match(M)&&(G=_b(G,p.dateNF,G.match(M)||[]),Y=1),p.cellDates?(X.t="d",X.v=Jt(G,Y)):(X.t="n",X.v=Rr(Jt(G,Y))),p.cellText!==!1&&(X.w=_n(X.z,X.v instanceof Date?Rr(X.v):X.v)),p.cellNF||delete X.z}else X.t="s",X.v=G;if(X.t=="z"||(p.dense?(x[S]||(x[S]=[]),x[S][w]=X):x[Ue({c:w,r:S})]=X),y=b+1,z=d.charCodeAt(y),_.e.c<w&&(_.e.c=w),_.e.r<S&&(_.e.r=S),C==O)++w;else if(w=0,++S,p.sheetRows&&p.sheetRows<=S)return!0}e:for(;b<d.length;++b)switch(C=d.charCodeAt(b)){case 34:z===34&&(R=!R);break;case O:case 10:case 13:if(!R&&K())break e;break}return b-y>0&&K(),x["!ref"]=et(_),x}function o(d,m){return!(m&&m.PRN)||m.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,m):ho(t(d,m),m)}function l(d,m){var p="",v=m.type=="string"?[0,0,0,0]:Kp(d,m);switch(m.type){case"base64":p=Qr(d);break;case"binary":p=d;break;case"buffer":m.codepage==65001?p=d.toString("utf8"):m.codepage&&typeof Bl<"u"||(p=Ye&&Buffer.isBuffer(d)?d.toString("binary"):Ja(d));break;case"array":p=Ga(d);break;case"string":p=d;break;default:throw new Error("Unrecognized type "+m.type)}return v[0]==239&&v[1]==187&&v[2]==191?p=ut(p.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?p=ut(p):m.type=="binary"&&typeof Bl<"u",p.slice(0,19)=="socialcalc:version:"?s8.to_sheet(m.type=="string"?p:ut(p),m):o(p,m)}function u(d,m){return da(l(d,m),m)}function f(d){for(var m=[],p=bt(d["!ref"]),v,x=Array.isArray(d),_=p.s.r;_<=p.e.r;++_){for(var S=[],w=p.s.c;w<=p.e.c;++w){var k=Ue({r:_,c:w});if(v=x?(d[_]||[])[w]:d[k],!v||v.v==null){S.push("          ");continue}for(var y=(v.w||(Ci(v),v.w)||"").slice(0,10);y.length<10;)y+=" ";S.push(y+(w===0?" ":""))}m.push(S.join(""))}return m.join(`
`)}return{to_workbook:u,to_sheet:l,from_sheet:f}}();function o8(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=i8.to_workbook(e,r);return r.WTF=n,i}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return $l.to_workbook(e,t)}}var fl=function(){function e(N,Z,H){if(N){ir(N,N.l||0);for(var W=H.Enum||ce;N.l<N.length;){var te=N.read_shift(2),xe=W[te]||W[65535],Te=N.read_shift(2),ee=N.l+Te,oe=xe.f&&xe.f(N,Te,H);if(N.l=ee,Z(oe,xe,te))return}}}function t(N,Z){switch(Z.type){case"base64":return r(In(Qr(N)),Z);case"binary":return r(In(N),Z);case"buffer":case"array":return r(N,Z)}throw"Unsupported type "+Z.type}function r(N,Z){if(!N)return N;var H=Z||{},W=H.dense?[]:{},te="Sheet1",xe="",Te=0,ee={},oe=[],Ae=[],D={s:{r:0,c:0},e:{r:0,c:0}},Ze=H.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)H.Enum=ce,e(N,function(Ee,it,Qt){switch(Qt){case 0:H.vers=Ee,Ee>=4096&&(H.qpro=!0);break;case 6:D=Ee;break;case 204:Ee&&(xe=Ee);break;case 222:xe=Ee;break;case 15:case 51:H.qpro||(Ee[1].v=Ee[1].v.slice(1));case 13:case 14:case 16:Qt==14&&(Ee[2]&112)==112&&(Ee[2]&15)>1&&(Ee[2]&15)<15&&(Ee[1].z=H.dateNF||He[14],H.cellDates&&(Ee[1].t="d",Ee[1].v=y0(Ee[1].v))),H.qpro&&Ee[3]>Te&&(W["!ref"]=et(D),ee[te]=W,oe.push(te),W=H.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},Te=Ee[3],te=xe||"Sheet"+(Te+1),xe="");var ur=H.dense?(W[Ee[0].r]||[])[Ee[0].c]:W[Ue(Ee[0])];if(ur){ur.t=Ee[1].t,ur.v=Ee[1].v,Ee[1].z!=null&&(ur.z=Ee[1].z),Ee[1].f!=null&&(ur.f=Ee[1].f);break}H.dense?(W[Ee[0].r]||(W[Ee[0].r]=[]),W[Ee[0].r][Ee[0].c]=Ee[1]):W[Ue(Ee[0])]=Ee[1];break}},H);else if(N[2]==26||N[2]==14)H.Enum=_e,N[2]==14&&(H.qpro=!0,N.l=0),e(N,function(Ee,it,Qt){switch(Qt){case 204:te=Ee;break;case 22:Ee[1].v=Ee[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ee[3]>Te&&(W["!ref"]=et(D),ee[te]=W,oe.push(te),W=H.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},Te=Ee[3],te="Sheet"+(Te+1)),Ze>0&&Ee[0].r>=Ze)break;H.dense?(W[Ee[0].r]||(W[Ee[0].r]=[]),W[Ee[0].r][Ee[0].c]=Ee[1]):W[Ue(Ee[0])]=Ee[1],D.e.c<Ee[0].c&&(D.e.c=Ee[0].c),D.e.r<Ee[0].r&&(D.e.r=Ee[0].r);break;case 27:Ee[14e3]&&(Ae[Ee[14e3][0]]=Ee[14e3][1]);break;case 1537:Ae[Ee[0]]=Ee[1],Ee[0]==Te&&(te=Ee[1]);break}},H);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(W["!ref"]=et(D),ee[xe||te]=W,oe.push(xe||te),!Ae.length)return{SheetNames:oe,Sheets:ee};for(var qe={},nt=[],ze=0;ze<Ae.length;++ze)ee[oe[ze]]?(nt.push(Ae[ze]||oe[ze]),qe[Ae[ze]]=ee[Ae[ze]]||ee[oe[ze]]):(nt.push(Ae[ze]),qe[Ae[ze]]={"!ref":"A1"});return{SheetNames:nt,Sheets:qe}}function n(N,Z){var H=Z||{};if(+H.codepage>=0&&Nn(+H.codepage),H.type=="string")throw new Error("Cannot write WK1 to JS string");var W=fd(),te=bt(N["!ref"]),xe=Array.isArray(N),Te=[];bn(W,0,a(1030)),bn(W,6,u(te));for(var ee=Math.min(te.e.r,8191),oe=te.s.r;oe<=ee;++oe)for(var Ae=or(oe),D=te.s.c;D<=te.e.c;++D){oe===te.s.r&&(Te[D]=Wt(D));var Ze=Te[D]+Ae,qe=xe?(N[oe]||[])[D]:N[Ze];if(!(!qe||qe.t=="z"))if(qe.t=="n")(qe.v|0)==qe.v&&qe.v>=-32768&&qe.v<=32767?bn(W,13,v(oe,D,qe.v)):bn(W,14,_(oe,D,qe.v));else{var nt=Ci(qe);bn(W,15,m(oe,D,nt.slice(0,239)))}}return bn(W,1),W.end()}function i(N,Z){var H=Z||{};if(+H.codepage>=0&&Nn(+H.codepage),H.type=="string")throw new Error("Cannot write WK3 to JS string");var W=fd();bn(W,0,o(N));for(var te=0,xe=0;te<N.SheetNames.length;++te)(N.Sheets[N.SheetNames[te]]||{})["!ref"]&&bn(W,27,q(N.SheetNames[te],xe++));var Te=0;for(te=0;te<N.SheetNames.length;++te){var ee=N.Sheets[N.SheetNames[te]];if(!(!ee||!ee["!ref"])){for(var oe=bt(ee["!ref"]),Ae=Array.isArray(ee),D=[],Ze=Math.min(oe.e.r,8191),qe=oe.s.r;qe<=Ze;++qe)for(var nt=or(qe),ze=oe.s.c;ze<=oe.e.c;++ze){qe===oe.s.r&&(D[ze]=Wt(ze));var Ee=D[ze]+nt,it=Ae?(ee[qe]||[])[ze]:ee[Ee];if(!(!it||it.t=="z"))if(it.t=="n")bn(W,23,K(qe,ze,Te,it.v));else{var Qt=Ci(it);bn(W,22,C(qe,ze,Te,Qt.slice(0,239)))}}++Te}}return bn(W,1),W.end()}function a(N){var Z=Ut(2);return Z.write_shift(2,N),Z}function o(N){var Z=Ut(26);Z.write_shift(2,4096),Z.write_shift(2,4),Z.write_shift(4,0);for(var H=0,W=0,te=0,xe=0;xe<N.SheetNames.length;++xe){var Te=N.SheetNames[xe],ee=N.Sheets[Te];if(!(!ee||!ee["!ref"])){++te;var oe=fo(ee["!ref"]);H<oe.e.r&&(H=oe.e.r),W<oe.e.c&&(W=oe.e.c)}}return H>8191&&(H=8191),Z.write_shift(2,H),Z.write_shift(1,te),Z.write_shift(1,W),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(1,1),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(4,0),Z}function l(N,Z,H){var W={s:{c:0,r:0},e:{c:0,r:0}};return Z==8&&H.qpro?(W.s.c=N.read_shift(1),N.l++,W.s.r=N.read_shift(2),W.e.c=N.read_shift(1),N.l++,W.e.r=N.read_shift(2),W):(W.s.c=N.read_shift(2),W.s.r=N.read_shift(2),Z==12&&H.qpro&&(N.l+=2),W.e.c=N.read_shift(2),W.e.r=N.read_shift(2),Z==12&&H.qpro&&(N.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function u(N){var Z=Ut(8);return Z.write_shift(2,N.s.c),Z.write_shift(2,N.s.r),Z.write_shift(2,N.e.c),Z.write_shift(2,N.e.r),Z}function f(N,Z,H){var W=[{c:0,r:0},{t:"n",v:0},0,0];return H.qpro&&H.vers!=20768?(W[0].c=N.read_shift(1),W[3]=N.read_shift(1),W[0].r=N.read_shift(2),N.l+=2):(W[2]=N.read_shift(1),W[0].c=N.read_shift(2),W[0].r=N.read_shift(2)),W}function d(N,Z,H){var W=N.l+Z,te=f(N,Z,H);if(te[1].t="s",H.vers==20768){N.l++;var xe=N.read_shift(1);return te[1].v=N.read_shift(xe,"utf8"),te}return H.qpro&&N.l++,te[1].v=N.read_shift(W-N.l,"cstr"),te}function m(N,Z,H){var W=Ut(7+H.length);W.write_shift(1,255),W.write_shift(2,Z),W.write_shift(2,N),W.write_shift(1,39);for(var te=0;te<W.length;++te){var xe=H.charCodeAt(te);W.write_shift(1,xe>=128?95:xe)}return W.write_shift(1,0),W}function p(N,Z,H){var W=f(N,Z,H);return W[1].v=N.read_shift(2,"i"),W}function v(N,Z,H){var W=Ut(7);return W.write_shift(1,255),W.write_shift(2,Z),W.write_shift(2,N),W.write_shift(2,H,"i"),W}function x(N,Z,H){var W=f(N,Z,H);return W[1].v=N.read_shift(8,"f"),W}function _(N,Z,H){var W=Ut(13);return W.write_shift(1,255),W.write_shift(2,Z),W.write_shift(2,N),W.write_shift(8,H,"f"),W}function S(N,Z,H){var W=N.l+Z,te=f(N,Z,H);if(te[1].v=N.read_shift(8,"f"),H.qpro)N.l=W;else{var xe=N.read_shift(2);b(N.slice(N.l,N.l+xe),te),N.l+=xe}return te}function w(N,Z,H){var W=Z&32768;return Z&=-32769,Z=(W?N:0)+(Z>=8192?Z-16384:Z),(W?"":"$")+(H?Wt(Z):or(Z))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(N,Z){ir(N,0);for(var H=[],W=0,te="",xe="",Te="",ee="";N.l<N.length;){var oe=N[N.l++];switch(oe){case 0:H.push(N.read_shift(8,"f"));break;case 1:xe=w(Z[0].c,N.read_shift(2),!0),te=w(Z[0].r,N.read_shift(2),!1),H.push(xe+te);break;case 2:{var Ae=w(Z[0].c,N.read_shift(2),!0),D=w(Z[0].r,N.read_shift(2),!1);xe=w(Z[0].c,N.read_shift(2),!0),te=w(Z[0].r,N.read_shift(2),!1),H.push(Ae+D+":"+xe+te)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:H.push("("+H.pop()+")");break;case 5:H.push(N.read_shift(2));break;case 6:{for(var Ze="";oe=N[N.l++];)Ze+=String.fromCharCode(oe);H.push('"'+Ze.replace(/"/g,'""')+'"')}break;case 8:H.push("-"+H.pop());break;case 23:H.push("+"+H.pop());break;case 22:H.push("NOT("+H.pop()+")");break;case 20:case 21:ee=H.pop(),Te=H.pop(),H.push(["AND","OR"][oe-20]+"("+Te+","+ee+")");break;default:if(oe<32&&y[oe])ee=H.pop(),Te=H.pop(),H.push(Te+y[oe]+ee);else if(k[oe]){if(W=k[oe][1],W==69&&(W=N[N.l++]),W>H.length){console.error("WK1 bad formula parse 0x"+oe.toString(16)+":|"+H.join("|")+"|");return}var qe=H.slice(-W);H.length-=W,H.push(k[oe][0]+"("+qe.join(",")+")")}else return oe<=7?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=24?console.error("WK1 unsupported op "+oe.toString(16)):oe<=30?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=115?console.error("WK1 unsupported function opcode "+oe.toString(16)):console.error("WK1 unrecognized opcode "+oe.toString(16))}}H.length==1?Z[1].f=""+H[0]:console.error("WK1 bad formula parse |"+H.join("|")+"|")}function O(N){var Z=[{c:0,r:0},{t:"n",v:0},0];return Z[0].r=N.read_shift(2),Z[3]=N[N.l++],Z[0].c=N[N.l++],Z}function R(N,Z){var H=O(N);return H[1].t="s",H[1].v=N.read_shift(Z-4,"cstr"),H}function C(N,Z,H,W){var te=Ut(6+W.length);te.write_shift(2,N),te.write_shift(1,H),te.write_shift(1,Z),te.write_shift(1,39);for(var xe=0;xe<W.length;++xe){var Te=W.charCodeAt(xe);te.write_shift(1,Te>=128?95:Te)}return te.write_shift(1,0),te}function z(N,Z){var H=O(N);H[1].v=N.read_shift(2);var W=H[1].v>>1;if(H[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return H[1].v=W,H}function M(N,Z){var H=O(N),W=N.read_shift(4),te=N.read_shift(4),xe=N.read_shift(2);if(xe==65535)return W===0&&te===3221225472?(H[1].t="e",H[1].v=15):W===0&&te===3489660928?(H[1].t="e",H[1].v=42):H[1].v=0,H;var Te=xe&32768;return xe=(xe&32767)-16446,H[1].v=(1-Te*2)*(te*Math.pow(2,xe+32)+W*Math.pow(2,xe)),H}function K(N,Z,H,W){var te=Ut(14);if(te.write_shift(2,N),te.write_shift(1,H),te.write_shift(1,Z),W==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var xe=0,Te=0,ee=0,oe=0;return W<0&&(xe=1,W=-W),Te=Math.log2(W)|0,W/=Math.pow(2,Te-31),oe=W>>>0,oe&2147483648||(W/=2,++Te,oe=W>>>0),W-=oe,oe|=2147483648,oe>>>=0,W*=Math.pow(2,32),ee=W>>>0,te.write_shift(4,ee),te.write_shift(4,oe),Te+=16383+(xe?32768:0),te.write_shift(2,Te),te}function G(N,Z){var H=M(N);return N.l+=Z-14,H}function X(N,Z){var H=O(N),W=N.read_shift(4);return H[1].v=W>>6,H}function Y(N,Z){var H=O(N),W=N.read_shift(8,"f");return H[1].v=W,H}function de(N,Z){var H=Y(N);return N.l+=Z-10,H}function he(N,Z){return N[N.l+Z-1]==0?N.read_shift(Z,"cstr"):""}function me(N,Z){var H=N[N.l++];H>Z-1&&(H=Z-1);for(var W="";W.length<H;)W+=String.fromCharCode(N[N.l++]);return W}function ge(N,Z,H){if(!(!H.qpro||Z<21)){var W=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var te=N.read_shift(Z-21,"cstr");return[W,te]}}function J(N,Z){for(var H={},W=N.l+Z;N.l<W;){var te=N.read_shift(2);if(te==14e3){for(H[te]=[0,""],H[te][0]=N.read_shift(2);N[N.l];)H[te][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return H}function q(N,Z){var H=Ut(5+N.length);H.write_shift(2,14e3),H.write_shift(2,Z);for(var W=0;W<N.length;++W){var te=N.charCodeAt(W);H[H.l++]=te>127?95:te}return H[H.l++]=0,H}var ce={0:{n:"BOF",f:Dt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:he},222:{n:"SHEETNAMELP",f:me},65535:{n:""}},_e={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:z},25:{n:"FORMULA19",f:G},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:J},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:X},38:{n:"??"},39:{n:"NUMBER27",f:Y},40:{n:"FORMULA28",f:de},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:he},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ge},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function l8(e){var t={},r=e.match(kr),n=0,i=!1;if(r)for(;n!=r.length;++n){var a=Be(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=Sp[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+a[0])}}return t}var c8=function(){var e=Ul("t"),t=Ul("rPr");function r(a){var o=a.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:rt(o[1])},u=a.match(t);return u&&(l.s=l8(u[1])),l}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(l){return l.v})}}(),u8=function(){var t=/(\r\n|\n)/g;function r(i,a,o){var l=[];i.u&&l.push("text-decoration: underline;"),i.uval&&l.push("text-underline-style:"+i.uval+";"),i.sz&&l.push("font-size:"+i.sz+"pt;"),i.outline&&l.push("text-effect: outline;"),i.shadow&&l.push("text-shadow: auto;"),a.push('<span style="'+l.join("")+'">'),i.b&&(a.push("<b>"),o.push("</b>")),i.i&&(a.push("<i>"),o.push("</i>")),i.strike&&(a.push("<s>"),o.push("</s>"));var u=i.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(a.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),i}function n(i){var a=[[],i.v,[]];return i.v?(i.s&&r(i.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),f8=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,h8=/<(?:\w+:)?r>/,d8=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function zp(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=rt(ut(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=ut(e),r&&(n.h=Rp(n.t))):e.match(h8)&&(n.r=ut(e),n.t=rt(ut((e.replace(d8,"").match(f8)||[]).join("").replace(kr,""))),r&&(n.h=u8(c8(n.r)))),n):{t:""}}var p8=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,m8=/<(?:\w+:)?(?:si|sstItem)>/g,g8=/<\/(?:\w+:)?(?:si|sstItem)>/;function v8(e,t){var r=[],n="";if(!e)return r;var i=e.match(p8);if(i){n=i[2].replace(m8,"").split(g8);for(var a=0;a!=n.length;++a){var o=zp(n[a].trim(),t);o!=null&&(r[r.length]=o)}i=Be(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function _8(e){return[e.read_shift(4),e.read_shift(4)]}function x8(e,t){var r=[],n=!1;return Oi(e,function(a,o,l){switch(l){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function E2(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function yi(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function y8(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=yi(e,4),t.U=yi(e,4),t.W=yi(e,4),t}function w8(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),a=[];i-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function k8(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(w8(e));return t}function E8(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function S8(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=yi(e,4),t.U=yi(e,4),t.W=yi(e,4),t}function T8(e){var t=S8(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function S2(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function T2(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function C8(e){var t=yi(e);switch(t.Minor){case 2:return[t.Minor,b8(e)];case 3:return[t.Minor,A8()];case 4:return[t.Minor,P8(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function b8(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=S2(e,r),i=T2(e,e.length-e.l);return{t:"Std",h:n,v:i}}function A8(){throw new Error("File is password-protected: ECMA-376 Extensible")}function P8(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(kr,function(a){var o=Be(a);switch(ri(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function O8(e,t){var r={},n=r.EncryptionVersionInfo=yi(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=S2(e,i),t-=i,r.EncryptionVerifier=T2(e,t),r}function R8(e){var t={},r=t.EncryptionVersionInfo=yi(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function F8(e){var t=0,r,n=E2(e),i=n.length+1,a,o,l,u,f;for(r=la(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)o=r[a],l=t&16384?1:0,u=t<<1&32767,f=l|u,t=f^o;return t^52811}var C2=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,l){return n(o^l)},a=function(o){for(var l=t[o.length-1],u=104,f=o.length-1;f>=0;--f)for(var d=o[f],m=0;m!=7;++m)d&64&&(l^=r[u]),d*=2,--u;return l};return function(o){for(var l=E2(o),u=a(l),f=l.length,d=la(16),m=0;m!=16;++m)d[m]=0;var p,v,x;for((f&1)===1&&(p=u>>8,d[f]=i(e[0],p),--f,p=u&255,v=l[l.length-1],d[f]=i(v,p));f>0;)--f,p=u>>8,d[f]=i(l[f],p),--f,p=u&255,d[f]=i(l[f],p);for(f=15,x=15-l.length;x>0;)p=u>>8,d[f]=i(e[x],p),--f,--x,p=u&255,d[f]=i(l[f],p),--f,--x;return d}}(),L8=function(e,t,r,n,i){i||(i=t),n||(n=C2(e));var a,o;for(a=0;a!=t.length;++a)o=t[a],o^=n[r],o=(o>>5|o<<3)&255,i[a]=o,++r;return[i,r,n]},I8=function(e){var t=0,r=C2(e);return function(n){var i=L8("",n,t,r);return t=i[1],i[0]}};function N8(e,t,r,n){var i={key:Dt(e),verificationBytes:Dt(e)};return r.password&&(i.verifier=F8(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=I8(r.password)),i}function D8(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=R8(e):n.Data=O8(e,t),n}function M8(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?D8(e,t-2,n):N8(e,r.biff>=8?t:t-2,r,n),n}var B8=function(){function e(i,a){switch(a.type){case"base64":return t(Qr(i),a);case"binary":return t(i,a);case"buffer":return t(Ye&&Buffer.isBuffer(i)?i.toString("binary"):Ja(i),a);case"array":return t(Ga(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){var o=a||{},l=o.dense?[]:{},u=i.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(d,m){Array.isArray(l)&&(l[m]=[]);for(var p=/\\\w+\b/g,v=0,x,_=-1;x=p.exec(d);){switch(x[0]){case"\\cell":var S=d.slice(v,p.lastIndex-x[0].length);if(S[0]==" "&&(S=S.slice(1)),++_,S.length){var w={v:S,t:"s"};Array.isArray(l)?l[m][_]=w:l[Ue({r:m,c:_})]=w}break}v=p.lastIndex}_>f.e.c&&(f.e.c=_)}),l["!ref"]=et(f),l}function r(i,a){return da(e(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],o=bt(i["!ref"]),l,u=Array.isArray(i),f=o.s.r;f<=o.e.r;++f){a.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var m=Ue({r:f,c:d});l=u?(i[f]||[])[d]:i[m],!(!l||l.v==null&&(!l.f||l.F))&&(a.push(" "+(l.w||(Ci(l),l.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function j8(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Wl(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function U8(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),a=Math.min(t,r,n),o=i-a;if(o===0)return[0,0,t];var l=0,u=0,f=i+a;switch(u=o/(f>1?2-f:f),i){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,u,f/2]}function z8(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),a=n-i/2,o=[a,a,a],l=6*t,u;if(r!==0)switch(l|0){case 0:case 6:u=i*l,o[0]+=i,o[1]+=u;break;case 1:u=i*(2-l),o[0]+=u,o[1]+=i;break;case 2:u=i*(l-2),o[1]+=i,o[2]+=u;break;case 3:u=i*(4-l),o[1]+=u,o[2]+=i;break;case 4:u=i*(l-4),o[2]+=i,o[0]+=u;break;case 5:u=i*(6-l),o[2]+=u,o[0]+=i;break}for(var f=0;f!=3;++f)o[f]=Math.round(o[f]*255);return o}function Yu(e,t){if(t===0)return e;var r=U8(j8(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Wl(z8(r))}var b2=6,$8=15,W8=1,br=b2;function Ju(e){return Math.floor((e+Math.round(128/br)/256)*br)}function Qu(e){return Math.floor((e-5)/br*100+.5)/100}function md(e){return Math.round((e*br+5)/br*256)/256}function Gf(e){return md(Qu(Ju(e)))}function $p(e){var t=Math.abs(e-Gf(e)),r=br;if(t>.005)for(br=W8;br<$8;++br)Math.abs(e-Gf(e))<=t&&(t=Math.abs(e-Gf(e)),r=br);br=r}function io(e){e.width?(e.wpx=Ju(e.width),e.wch=Qu(e.wpx),e.MDW=br):e.wpx?(e.wch=Qu(e.wpx),e.width=md(e.wch),e.MDW=br):typeof e.wch=="number"&&(e.width=md(e.wch),e.wpx=Ju(e.width),e.MDW=br),e.customWidth&&delete e.customWidth}var H8=96,A2=H8;function P2(e){return e*96/A2}function Hl(e){return e*A2/96}var V8={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function G8(e,t,r,n){t.Borders=[];var i={},a=!1;(e[0].match(kr)||[]).forEach(function(o){var l=Be(o);switch(ri(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},l.diagonalUp&&(i.diagonalUp=gt(l.diagonalUp)),l.diagonalDown&&(i.diagonalDown=gt(l.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in borders")}})}function Z8(e,t,r,n){t.Fills=[];var i={},a=!1;(e[0].match(kr)||[]).forEach(function(o){var l=Be(o);switch(ri(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":l.patternType&&(i.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),l.indexed&&(i.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(i.bgColor.theme=parseInt(l.theme,10)),l.tint&&(i.bgColor.tint=parseFloat(l.tint)),l.rgb&&(i.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),l.theme&&(i.fgColor.theme=parseInt(l.theme,10)),l.tint&&(i.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(i.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fills")}})}function K8(e,t,r,n){t.Fonts=[];var i={},a=!1;(e[0].match(kr)||[]).forEach(function(o){var l=Be(o);switch(ri(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":l.val&&(i.name=ut(l.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=l.val?gt(l.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=l.val?gt(l.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(l.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=l.val?gt(l.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=l.val?gt(l.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=l.val?gt(l.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=l.val?gt(l.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=l.val?gt(l.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":l.val&&(i.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(i.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(i.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(i.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Sp[parseInt(l.val,10)];break;case"<color":if(i.color||(i.color={}),l.auto&&(i.color.auto=gt(l.auto)),l.rgb)i.color.rgb=l.rgb.slice(-6);else if(l.indexed){i.color.index=parseInt(l.indexed,10);var u=Ba[i.color.index];i.color.index==81&&(u=Ba[1]),u||(u=Ba[1]),i.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else l.theme&&(i.color.theme=parseInt(l.theme,10),l.tint&&(i.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Yu(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fonts")}})}function q8(e,t,r){t.NumberFmt=[];for(var n=ti(He),i=0;i<n.length;++i)t.NumberFmt[n[i]]=He[n[i]];var a=e[0].match(kr);if(a)for(i=0;i<a.length;++i){var o=Be(a[i]);switch(ri(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=rt(ut(o.formatCode)),u=parseInt(o.numFmtId,10);if(t.NumberFmt[u]=l,u>0){if(u>392){for(u=392;u>60&&t.NumberFmt[u]!=null;--u);t.NumberFmt[u]=l}Ma(l,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var eu=["numFmtId","fillId","fontId","borderId","xfId"],tu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function X8(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(kr)||[]).forEach(function(a){var o=Be(a),l=0;switch(ri(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<eu.length;++l)n[eu[l]]&&(n[eu[l]]=parseInt(n[eu[l]],10));for(l=0;l<tu.length;++l)n[tu[l]]&&(n[tu[l]]=gt(n[tu[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=gt(o.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var Y8=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,u,f){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=l.match(t))&&q8(m,d,f),(m=l.match(i))&&K8(m,d,u,f),(m=l.match(n))&&Z8(m,d,u,f),(m=l.match(a))&&G8(m,d,u,f),(m=l.match(r))&&X8(m,d,f),d}}();function J8(e,t){var r=e.read_shift(2),n=xr(e);return[r,n]}function Q8(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=cA(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var u=e.read_shift(1);switch(u>0&&(n.charset=u),e.l++,n.color=lA(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=xr(e),n}var e6=wr;function t6(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}var r6=wr;function n6(e,t,r){var n={};n.NumberFmt=[];for(var i in He)n.NumberFmt[i]=He[i];n.CellXf=[],n.Fonts=[];var a=[],o=!1;return Oi(e,function(u,f,d){switch(d){case 44:n.NumberFmt[u[0]]=u[1],Ma(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(u.color.rgb=Yu(t.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(d),o=!0;break;case 38:a.pop(),o=!1;break;default:if(f.T>0)a.push(d);else if(f.T<0)a.pop();else if(!o||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}var i6=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function a6(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(kr)||[]).forEach(function(i){var a=Be(i);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[i6.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function s6(){}function o6(){}var l6=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,c6=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,u6=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function f6(e,t,r){t.themeElements={};var n;[["clrScheme",l6,a6],["fontScheme",c6,s6],["fmtScheme",u6,o6]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var h6=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function O2(e,t){(!e||e.length===0)&&(e=d6());var r,n={};if(!(r=e.match(h6)))throw new Error("themeElements not found in theme");return f6(r[0],n,t),n.raw=e,n}function d6(e,t){var r=[zy];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function p6(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var o;try{o=Uy(a,{type:"array"})}catch{return}var l=qr(o,"theme/theme/theme1.xml",!0);if(l)return O2(l,r)}}function m6(e){return e.read_shift(4)}function g6(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=v6(e,4);break;case 2:t.xclrValue=g2(e);break;case 3:t.xclrValue=m6(e);break;case 4:e.l+=4;break}return e.l+=8,t}function v6(e,t){return wr(e,t)}function _6(e,t){return wr(e,t)}function x6(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=g6(e);break;case 6:n[1]=_6(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function y6(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),a=[];i-- >0;)a.push(x6(e,r-e.l));return{ixfe:n,ext:a}}function w6(e,t){t.forEach(function(r){switch(r[0]){}})}function k6(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:xr(e)}}function E6(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function S6(e){return e.l+=4,e.read_shift(4)!=0}function T6(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},a=[],o=!1,l=2;return Oi(e,function(u,f,d){switch(d){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(m){l==1?n.Cell.push({type:n.Types[m[0]-1].name,index:m[1]}):l==0&&n.Value.push({type:n.Types[m[0]-1].name,index:m[1]})});break;case 337:l=u?1:0;break;case 338:l=2;break;case 35:a.push(d),o=!0;break;case 36:a.pop(),o=!1;break;default:if(!f.T){if(!o||i.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function C6(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,a=2,o;return e.replace(kr,function(l){var u=Be(l);switch(ri(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==u.name&&(o=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):a==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return l}),n}function b6(e){var t=[];if(!e)return t;var r=1;return(e.match(kr)||[]).forEach(function(n){var i=Be(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function A6(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ue(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function P6(e,t,r){var n=[];return Oi(e,function(a,o,l){switch(l){case 63:n.push(a);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function O6(e,t,r,n){if(!e)return e;var i=n||{},a=!1;Oi(e,function(l,u,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!u.T){if(!a||i.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},i)}function R6(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function cv(e,t,r,n){var i=Array.isArray(e),a;t.forEach(function(o){var l=Ar(o.ref);if(i?(e[l.r]||(e[l.r]=[]),a=e[l.r][l.c]):a=e[o.ref],!a){a={t:"z"},i?e[l.r][l.c]=a:e[o.ref]=a;var u=bt(e["!ref"]||"BDWGO1000001:A1");u.s.r>l.r&&(u.s.r=l.r),u.e.r<l.r&&(u.e.r=l.r),u.s.c>l.c&&(u.s.c=l.c),u.e.c<l.c&&(u.e.c=l.c);var f=et(u);f!==e["!ref"]&&(e["!ref"]=f)}a.c||(a.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var m=a.c.length-1;m>=0;--m){if(!r&&a.c[m].T)return;r&&!a.c[m].T&&a.c.splice(m,1)}if(r&&n){for(m=0;m<n.length;++m)if(d.a==n[m].id){d.a=n[m].name||d.a;break}}a.c.push(d)})}function F6(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var u=Be(l[0]),f={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},d=Ar(u.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var m=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!m&&!!m[1]&&zp(m[1])||{r:"",t:"",h:""};f.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),f.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=p.h),n.push(f)}}}}),n}function L6(e,t){var r=[],n=!1,i={},a=0;return e.replace(kr,function(l,u){var f=Be(l);switch(ri(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":a=u+l.length;break;case"</text>":i.t=e.slice(a,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return l}),r}function I6(e,t){var r=[],n=!1;return e.replace(kr,function(a){var o=Be(a);switch(ri(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return a}),r}function N6(e){var t={};t.iauthor=e.read_shift(4);var r=es(e);return t.rfx=r.s,t.ref=Ue(r.s),e.l+=16,t}var D6=xr;function M6(e,t){var r=[],n=[],i={},a=!1;return Oi(e,function(l,u,f){switch(f){case 632:n.push(l);break;case 635:i=l;break;case 637:i.t=l.t,i.h=l.h,i.r=l.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}var B6="application/vnd.ms-office.vbaProject";function j6(e){var t=Qe.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Qe.utils.cfb_add(t,i,e.FileIndex[n].content)}}),Qe.write(t)}function U6(){return{"!type":"dialog"}}function z6(){return{"!type":"dialog"}}function $6(){return{"!type":"macro"}}function W6(){return{"!type":"macro"}}var Ks=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,a,o){var l=!1,u=!1;a.length==0?u=!0:a.charAt(0)=="["&&(u=!0,a=a.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var f=a.length>0?parseInt(a,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=t.c:--d,u?f+=t.r:--f,i+(l?"":"$")+Wt(d)+(u?"":"$")+or(f)}return function(i,a){return t=a,i.replace(e,r)}}(),R2=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,H6=function(){return function(t,r){return t.replace(R2,function(n,i,a,o,l,u){var f=Np(o)-(a?0:r.c),d=Ip(u)-(l?0:r.r),m=d==0?"":l?d+1:"["+d+"]",p=f==0?"":a?f+1:"["+f+"]";return i+"R"+m+"C"+p})}}();function F2(e,t){return e.replace(R2,function(r,n,i,a,o,l){return n+(i=="$"?i+a:Wt(Np(a)+t.c))+(o=="$"?o+l:or(Ip(l)+t.r))})}function V6(e,t,r){var n=fo(t),i=n.s,a=Ar(r),o={r:a.r-i.r,c:a.c-i.c};return F2(e,o)}function G6(e){return e.length!=1}function uv(e){return e.replace(/_xlfn\./g,"")}function It(e){e.l+=1}function ca(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function L2(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return I2(e);r.biff==12&&(n=4)}var i=e.read_shift(n),a=e.read_shift(n),o=ca(e),l=ca(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function I2(e){var t=ca(e),r=ca(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function Z6(e,t,r){if(r.biff<8)return I2(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),a=ca(e),o=ca(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function N2(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return K6(e);var n=e.read_shift(r&&r.biff==12?4:2),i=ca(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function K6(e){var t=ca(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function q6(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function X6(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Y6(e);var i=e.read_shift(n>=12?4:2),a=e.read_shift(2),o=(a&16384)>>14,l=(a&32768)>>15;if(a&=16383,l==1)for(;i>524287;)i-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:o,rRel:l}}function Y6(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function J6(e,t,r){var n=(e[e.l++]&96)>>5,i=L2(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function Q6(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var o=L2(e,a,r);return[n,i,o]}function eP(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function tP(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,i]}function rP(e,t,r){var n=(e[e.l++]&96)>>5,i=Z6(e,t-1,r);return[n,i]}function nP(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function fv(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function iP(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function aP(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function sP(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function oP(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function lP(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function D2(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function cP(e){return e.read_shift(2),D2(e)}function uP(e){return e.read_shift(2),D2(e)}function fP(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=N2(e,0,r);return[n,i]}function hP(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=X6(e,0,r);return[n,i]}function dP(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=N2(e,0,r);return[n,i,a]}function pP(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[mO[i],j2[i],n]}function mP(e,t,r){var n=e[e.l++],i=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:gP(e);return[i,(a[0]===0?j2:pO)[a[1]]]}function gP(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function vP(e,t,r){e.l+=r&&r.biff==2?3:4}function _P(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function xP(e){return e.l++,ts[e.read_shift(1)]}function yP(e){return e.l++,e.read_shift(2)}function wP(e){return e.l++,e.read_shift(1)!==0}function kP(e){return e.l++,vr(e)}function EP(e,t,r){return e.l++,tc(e,t-1,r)}function SP(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Pt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ts[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=vr(e);break;case 2:r[1]=rs(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function TP(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?es:w0)(e));return i}function CP(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,o=[];a!=n&&(o[a]=[]);++a)for(var l=0;l!=i;++l)o[a][l]=SP(e,r.biff);return o}function bP(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function AP(e,t,r){if(r.biff==5)return PP(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[n,i,a]}function PP(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function OP(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function RP(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function FP(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function LP(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,i]}var IP=wr,NP=wr,DP=wr;function nc(e,t,r){return e.l+=2,[q6(e)]}function Wp(e){return e.l+=6,[]}var MP=nc,BP=Wp,jP=Wp,UP=nc;function M2(e){return e.l+=2,[Dt(e),e.read_shift(2)&1]}var zP=nc,$P=M2,WP=Wp,HP=nc,VP=nc,GP=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function ZP(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),o=GP[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:i,C:a}}function KP(e){return e.l+=2,[e.read_shift(4)]}function qP(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function XP(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function YP(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function JP(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function QP(e){return e.l+=4,[0,0]}var hv={1:{n:"PtgExp",f:_P},2:{n:"PtgTbl",f:DP},3:{n:"PtgAdd",f:It},4:{n:"PtgSub",f:It},5:{n:"PtgMul",f:It},6:{n:"PtgDiv",f:It},7:{n:"PtgPower",f:It},8:{n:"PtgConcat",f:It},9:{n:"PtgLt",f:It},10:{n:"PtgLe",f:It},11:{n:"PtgEq",f:It},12:{n:"PtgGe",f:It},13:{n:"PtgGt",f:It},14:{n:"PtgNe",f:It},15:{n:"PtgIsect",f:It},16:{n:"PtgUnion",f:It},17:{n:"PtgRange",f:It},18:{n:"PtgUplus",f:It},19:{n:"PtgUminus",f:It},20:{n:"PtgPercent",f:It},21:{n:"PtgParen",f:It},22:{n:"PtgMissArg",f:It},23:{n:"PtgStr",f:EP},26:{n:"PtgSheet",f:qP},27:{n:"PtgEndSheet",f:XP},28:{n:"PtgErr",f:xP},29:{n:"PtgBool",f:wP},30:{n:"PtgInt",f:yP},31:{n:"PtgNum",f:kP},32:{n:"PtgArray",f:nP},33:{n:"PtgFunc",f:pP},34:{n:"PtgFuncVar",f:mP},35:{n:"PtgName",f:bP},36:{n:"PtgRef",f:fP},37:{n:"PtgArea",f:J6},38:{n:"PtgMemArea",f:OP},39:{n:"PtgMemErr",f:IP},40:{n:"PtgMemNoMem",f:NP},41:{n:"PtgMemFunc",f:RP},42:{n:"PtgRefErr",f:FP},43:{n:"PtgAreaErr",f:eP},44:{n:"PtgRefN",f:hP},45:{n:"PtgAreaN",f:rP},46:{n:"PtgMemAreaN",f:YP},47:{n:"PtgMemNoMemN",f:JP},57:{n:"PtgNameX",f:AP},58:{n:"PtgRef3d",f:dP},59:{n:"PtgArea3d",f:Q6},60:{n:"PtgRefErr3d",f:LP},61:{n:"PtgAreaErr3d",f:tP},255:{}},eO={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},tO={1:{n:"PtgElfLel",f:M2},2:{n:"PtgElfRw",f:HP},3:{n:"PtgElfCol",f:MP},6:{n:"PtgElfRwV",f:VP},7:{n:"PtgElfColV",f:UP},10:{n:"PtgElfRadical",f:zP},11:{n:"PtgElfRadicalS",f:WP},13:{n:"PtgElfColS",f:BP},15:{n:"PtgElfColSV",f:jP},16:{n:"PtgElfRadicalLel",f:$P},25:{n:"PtgList",f:ZP},29:{n:"PtgSxName",f:KP},255:{}},rO={0:{n:"PtgAttrNoop",f:QP},1:{n:"PtgAttrSemi",f:lP},2:{n:"PtgAttrIf",f:sP},4:{n:"PtgAttrChoose",f:iP},8:{n:"PtgAttrGoto",f:aP},16:{n:"PtgAttrSum",f:vP},32:{n:"PtgAttrBaxcel",f:fv},33:{n:"PtgAttrBaxcel",f:fv},64:{n:"PtgAttrSpace",f:cP},65:{n:"PtgAttrSpaceSemi",f:uP},128:{n:"PtgAttrIfError",f:oP},255:{}};function ic(e,t,r,n){if(n.biff<8)return wr(e,t);for(var i=e.l+t,a=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=CP(e,0,n),a.push(r[o][1]);break;case"PtgMemArea":r[o][2]=TP(e,r[o][1],n),a.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),a.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=i-e.l,t!==0&&a.push(wr(e,t)),a}function ac(e,t,r){for(var n=e.l+t,i,a,o=[];n!=e.l;)t=n-e.l,a=e[e.l],i=hv[a]||hv[eO[a]],(a===24||a===25)&&(i=(a===24?tO:rO)[e[e.l+1]]),!i||!i.f?wr(e,t):o.push([i.n,i.f(e,t,r)]);return o}function nO(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],a=0;a<n.length;++a){var o=n[a];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var iO={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function aO(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function B2(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function dv(e,t,r){var n=B2(e,t,r);return n=="#REF"?n:aO(n,r)}function mr(e,t,r,n,i){var a=i&&i.biff||8,o={s:{c:0,r:0}},l=[],u,f,d,m=0,p=0,v,x="";if(!e[0]||!e[0][0])return"";for(var _=-1,S="",w=0,k=e[0].length;w<k;++w){var y=e[0][w];switch(y[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=l.pop(),f=l.pop(),_>=0){switch(e[0][_][1][0]){case 0:S=Ct(" ",e[0][_][1][1]);break;case 1:S=Ct("\r",e[0][_][1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}f=f+S,_=-1}l.push(f+iO[y[0]]+u);break;case"PtgIsect":u=l.pop(),f=l.pop(),l.push(f+" "+u);break;case"PtgUnion":u=l.pop(),f=l.pop(),l.push(f+","+u);break;case"PtgRange":u=l.pop(),f=l.pop(),l.push(f+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=ol(y[1][1],o,i),l.push(ll(d,a));break;case"PtgRefN":d=r?ol(y[1][1],r,i):y[1][1],l.push(ll(d,a));break;case"PtgRef3d":m=y[1][1],d=ol(y[1][2],o,i),x=dv(n,m,i),l.push(x+"!"+ll(d,a));break;case"PtgFunc":case"PtgFuncVar":var b=y[1][0],O=y[1][1];b||(b=0),b&=127;var R=b==0?[]:l.slice(-b);l.length-=b,O==="User"&&(O=R.shift()),l.push(O+"("+R.join(",")+")");break;case"PtgBool":l.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(y[1]);break;case"PtgNum":l.push(String(y[1]));break;case"PtgStr":l.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(y[1]);break;case"PtgAreaN":v=Zg(y[1][1],r?{s:r}:o,i),l.push(Hf(v,i));break;case"PtgArea":v=Zg(y[1][1],o,i),l.push(Hf(v,i));break;case"PtgArea3d":m=y[1][1],v=y[1][2],x=dv(n,m,i),l.push(x+"!"+Hf(v,i));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=y[1][2];var C=(n.names||[])[p-1]||(n[0]||[])[p],z=C?C.Name:"SH33TJSNAME"+String(p);z&&z.slice(0,6)=="_xlfn."&&!i.xlfn&&(z=z.slice(6)),l.push(z);break;case"PtgNameX":var M=y[1][1];p=y[1][2];var K;if(i.biff<=5)M<0&&(M=-M),n[M]&&(K=n[M][p]);else{var G="";if(((n[M]||[])[0]||[])[0]==14849||(((n[M]||[])[0]||[])[0]==1025?n[M][p]&&n[M][p].itab>0&&(G=n.SheetNames[n[M][p].itab-1]+"!"):G=n.SheetNames[p-1]+"!"),n[M]&&n[M][p])G+=n[M][p].Name;else if(n[0]&&n[0][p])G+=n[0][p].Name;else{var X=(B2(n,M,i)||"").split(";;");X[p-1]?G=X[p-1]:G+="SH33TJSERRX"}l.push(G);break}K||(K={Name:"SH33TJSERRY"}),l.push(K.Name);break;case"PtgParen":var Y="(",de=")";if(_>=0){switch(S="",e[0][_][1][0]){case 2:Y=Ct(" ",e[0][_][1][1])+Y;break;case 3:Y=Ct("\r",e[0][_][1][1])+Y;break;case 4:de=Ct(" ",e[0][_][1][1])+de;break;case 5:de=Ct("\r",e[0][_][1][1])+de;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}_=-1}l.push(Y+l.pop()+de);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:y[1][1],r:y[1][0]};var he={c:r.c,r:r.r};if(n.sharedf[Ue(d)]){var me=n.sharedf[Ue(d)];l.push(mr(me,o,he,n,i))}else{var ge=!1;for(u=0;u!=n.arrayf.length;++u)if(f=n.arrayf[u],!(d.c<f[0].s.c||d.c>f[0].e.c)&&!(d.r<f[0].s.r||d.r>f[0].e.r)){l.push(mr(f[1],o,he,n,i)),ge=!0;break}ge||l.push(y[1])}break;case"PtgArray":l.push("{"+nO(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var J=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&_>=0&&J.indexOf(e[0][w][0])==-1){y=e[0][_];var q=!0;switch(y[1][0]){case 4:q=!1;case 0:S=Ct(" ",y[1][1]);break;case 5:q=!1;case 1:S=Ct("\r",y[1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}l.push((q?S:"")+l.pop()+(q?"":S)),_=-1}}if(l.length>1&&i.WTF)throw new Error("bad formula stack");return l[0]}function sO(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,o=e.read_shift(i);if(o==65535)return[[],wr(e,t-2)];var l=ac(e,o,r);return t!==o+i&&(a=ic(e,t-o-i,l,r)),e.l=n,[l,a]}function oO(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,o=e.read_shift(i);if(o==65535)return[[],wr(e,t-2)];var l=ac(e,o,r);return t!==o+i&&(a=ic(e,t-o-i,l,r)),e.l=n,[l,a]}function lO(e,t,r,n){var i=e.l+t,a=ac(e,n,r),o;return i!==e.l&&(o=ic(e,i-e.l,a,r)),[a,o]}function cO(e,t,r){var n=e.l+t,i,a=e.read_shift(2),o=ac(e,a,r);return a==65535?[[],wr(e,t-2)]:(t!==a+2&&(i=ic(e,n-a-2,o,r)),[o,i])}function uO(e){var t;if(vi(e,e.l+6)!==65535)return[vr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Zf(e,t,r){var n=e.l+t,i=ni(e);r.biff==2&&++e.l;var a=uO(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=oO(e,n-e.l,r);return{cell:i,val:a[0],formula:l,shared:o>>3&1,tt:a[1]}}function k0(e,t,r){var n=e.read_shift(4),i=ac(e,n,r),a=e.read_shift(4),o=a>0?ic(e,a,i,r):null;return[i,o]}var fO=k0,E0=k0,hO=k0,dO=k0,pO={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},j2={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},mO={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function pv(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Kf(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var hl={},qs={};function dl(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function U2(e,t,r,n,i,a){try{n.cellNF&&(e.z=He[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Jt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(He[t]==null&&Ma(gb[t]||"General",t),e.t==="e")e.w=e.w||ts[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=jl(e.v);else if(e.t==="d"){var o=Rr(e.v);(o|0)===o?e.w=o.toString(10):e.w=jl(o)}else{if(e.v===void 0)return"";e.w=Va(e.v,qs)}else e.t==="d"?e.w=_n(t,Rr(e.v),qs):e.w=_n(t,e.v,qs)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Yu(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Yu(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&a.Fills)throw l}}}function gO(e,t){var r=bt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=et(r))}var vO=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,_O=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,xO=/<(?:\w:)?hyperlink [^>]*>/mg,yO=/"(\w*:\w*)"/,wO=/<(?:\w:)?col\b[^>]*[\/]?>/g,kO=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,EO=/<(?:\w:)?pageMargins[^>]*\/>/g,z2=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,SO=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,TO=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function CO(e,t,r,n,i,a,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",d="",m=e.match(_O);m?(f=e.slice(0,m.index),d=e.slice(m.index+m[0].length)):f=d=e;var p=f.match(z2);p?Hp(p[0],l,i,r):(p=f.match(SO))&&bO(p[0],p[1]||"",l,i,r);var v=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var x=f.slice(v,v+50).match(yO);x&&gO(l,x[1])}var _=f.match(TO);_&&_[1]&&LO(_[1],i);var S=[];if(t.cellStyles){var w=f.match(wO);w&&OO(S,w)}m&&IO(m[1],l,t,u,a,o);var k=d.match(kO);k&&(l["!autofilter"]=RO(k[0]));var y=[],b=d.match(vO);if(b)for(v=0;v!=b.length;++v)y[v]=bt(b[v].slice(b[v].indexOf('"')+1));var O=d.match(xO);O&&AO(l,O,n);var R=d.match(EO);if(R&&(l["!margins"]=PO(Be(R[0]))),!l["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(l["!ref"]=et(u)),t.sheetRows>0&&l["!ref"]){var C=bt(l["!ref"]);t.sheetRows<=+C.e.r&&(C.e.r=t.sheetRows-1,C.e.r>u.e.r&&(C.e.r=u.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>u.e.c&&(C.e.c=u.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),l["!fullref"]=l["!ref"],l["!ref"]=et(C))}return S.length>0&&(l["!cols"]=S),y.length>0&&(l["!merges"]=y),l}function Hp(e,t,r,n){var i=Be(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=rt(ut(i.codeName)))}function bO(e,t,r,n,i){Hp(e.slice(0,e.indexOf(">")),r,n,i)}function AO(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var a=Be(ut(t[i]),!0);if(!a.ref)return;var o=((r||{})["!id"]||[])[a.id];o?(a.Target=o.Target,a.location&&(a.Target+="#"+rt(a.location))):(a.Target="#"+rt(a.location),o={Target:a.Target,TargetMode:"Internal"}),a.Rel=o,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var l=bt(a.ref),u=l.s.r;u<=l.e.r;++u)for(var f=l.s.c;f<=l.e.c;++f){var d=Ue({c:f,r:u});n?(e[u]||(e[u]=[]),e[u][f]||(e[u][f]={t:"z",v:void 0}),e[u][f].l=a):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=a)}}}function PO(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function OO(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=Be(t[n],!0);i.hidden&&(i.hidden=gt(i.hidden));var a=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,$p(i.width)),io(i);a<=o;)e[a++]=sr(i)}}function RO(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var FO=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function LO(e,t){t.Views||(t.Views=[{}]),(e.match(FO)||[]).forEach(function(r,n){var i=Be(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),gt(i.rightToLeft)&&(t.Views[n].RTL=!0)})}var IO=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,a=Ul("v"),o=Ul("f");return function(u,f,d,m,p,v){for(var x=0,_="",S=[],w=[],k=0,y=0,b=0,O="",R,C,z=0,M=0,K,G,X=0,Y=0,de=Array.isArray(v.CellXf),he,me=[],ge=[],J=Array.isArray(f),q=[],ce={},_e=!1,N=!!d.sheetStubs,Z=u.split(t),H=0,W=Z.length;H!=W;++H){_=Z[H].trim();var te=_.length;if(te!==0){var xe=0;e:for(x=0;x<te;++x)switch(_[x]){case">":if(_[x-1]!="/"){++x;break e}if(d&&d.cellStyles){if(C=Be(_.slice(xe,x),!0),z=C.r!=null?parseInt(C.r,10):z+1,M=-1,d.sheetRows&&d.sheetRows<z)continue;ce={},_e=!1,C.ht&&(_e=!0,ce.hpt=parseFloat(C.ht),ce.hpx=Hl(ce.hpt)),C.hidden=="1"&&(_e=!0,ce.hidden=!0),C.outlineLevel!=null&&(_e=!0,ce.level=+C.outlineLevel),_e&&(q[z-1]=ce)}break;case"<":xe=x;break}if(xe>=x)break;if(C=Be(_.slice(xe,x),!0),z=C.r!=null?parseInt(C.r,10):z+1,M=-1,!(d.sheetRows&&d.sheetRows<z)){m.s.r>z-1&&(m.s.r=z-1),m.e.r<z-1&&(m.e.r=z-1),d&&d.cellStyles&&(ce={},_e=!1,C.ht&&(_e=!0,ce.hpt=parseFloat(C.ht),ce.hpx=Hl(ce.hpt)),C.hidden=="1"&&(_e=!0,ce.hidden=!0),C.outlineLevel!=null&&(_e=!0,ce.level=+C.outlineLevel),_e&&(q[z-1]=ce)),S=_.slice(x).split(e);for(var Te=0;Te!=S.length&&S[Te].trim().charAt(0)=="<";++Te);for(S=S.slice(Te),x=0;x!=S.length;++x)if(_=S[x].trim(),_.length!==0){if(w=_.match(r),k=x,y=0,b=0,_="<c "+(_.slice(0,1)=="<"?">":"")+_,w!=null&&w.length===2){for(k=0,O=w[1],y=0;y!=O.length&&!((b=O.charCodeAt(y)-64)<1||b>26);++y)k=26*k+b;--k,M=k}else++M;for(y=0;y!=_.length&&_.charCodeAt(y)!==62;++y);if(++y,C=Be(_.slice(0,y),!0),C.r||(C.r=Ue({r:z-1,c:M})),O=_.slice(y),R={t:""},(w=O.match(a))!=null&&w[1]!==""&&(R.v=rt(w[1])),d.cellFormula){if((w=O.match(o))!=null&&w[1]!==""){if(R.f=rt(ut(w[1])).replace(/\r\n/g,`
`),d.xlfn||(R.f=uv(R.f)),w[0].indexOf('t="array"')>-1)R.F=(O.match(i)||[])[1],R.F.indexOf(":")>-1&&me.push([bt(R.F),R.F]);else if(w[0].indexOf('t="shared"')>-1){G=Be(w[0]);var ee=rt(ut(w[1]));d.xlfn||(ee=uv(ee)),ge[parseInt(G.si,10)]=[G,ee,C.r]}}else(w=O.match(/<f[^>]*\/>/))&&(G=Be(w[0]),ge[G.si]&&(R.f=V6(ge[G.si][1],ge[G.si][2],C.r)));var oe=Ar(C.r);for(y=0;y<me.length;++y)oe.r>=me[y][0].s.r&&oe.r<=me[y][0].e.r&&oe.c>=me[y][0].s.c&&oe.c<=me[y][0].e.c&&(R.F=me[y][1])}if(C.t==null&&R.v===void 0)if(R.f||R.F)R.v=0,R.t="n";else if(N)R.t="z";else continue;else R.t=C.t||"n";switch(m.s.c>M&&(m.s.c=M),m.e.c<M&&(m.e.c=M),R.t){case"n":if(R.v==""||R.v==null){if(!N)continue;R.t="z"}else R.v=parseFloat(R.v);break;case"s":if(typeof R.v>"u"){if(!N)continue;R.t="z"}else K=hl[parseInt(R.v,10)],R.v=K.t,R.r=K.r,d.cellHTML&&(R.h=K.h);break;case"str":R.t="s",R.v=R.v!=null?ut(R.v):"",d.cellHTML&&(R.h=Rp(R.v));break;case"inlineStr":w=O.match(n),R.t="s",w!=null&&(K=zp(w[1]))?(R.v=K.t,d.cellHTML&&(R.h=K.h)):R.v="";break;case"b":R.v=gt(R.v);break;case"d":d.cellDates?R.v=Jt(R.v,1):(R.v=Rr(Jt(R.v,1)),R.t="n");break;case"e":(!d||d.cellText!==!1)&&(R.w=R.v),R.v=l2[R.v];break}if(X=Y=0,he=null,de&&C.s!==void 0&&(he=v.CellXf[C.s],he!=null&&(he.numFmtId!=null&&(X=he.numFmtId),d.cellStyles&&he.fillId!=null&&(Y=he.fillId))),U2(R,X,Y,d,p,v),d.cellDates&&de&&R.t=="n"&&uo(He[X])&&(R.t="d",R.v=y0(R.v)),C.cm&&d.xlmeta){var Ae=(d.xlmeta.Cell||[])[+C.cm-1];Ae&&Ae.type=="XLDAPR"&&(R.D=!0)}if(J){var D=Ar(C.r);f[D.r]||(f[D.r]=[]),f[D.r][D.c]=R}else f[C.r]=R}}}}q.length>0&&(f["!rows"]=q)}}();function NO(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}var DO=es;function MO(){}function BO(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=sA(e),r}function jO(e){var t=xn(e);return[t]}function UO(e){var t=Qa(e);return[t]}function zO(e){var t=xn(e),r=e.read_shift(1);return[t,r,"b"]}function $O(e){var t=Qa(e),r=e.read_shift(1);return[t,r,"b"]}function WO(e){var t=xn(e),r=e.read_shift(1);return[t,r,"e"]}function HO(e){var t=Qa(e),r=e.read_shift(1);return[t,r,"e"]}function VO(e){var t=xn(e),r=e.read_shift(4);return[t,r,"s"]}function GO(e){var t=Qa(e),r=e.read_shift(4);return[t,r,"s"]}function ZO(e){var t=xn(e),r=vr(e);return[t,r,"n"]}function $2(e){var t=Qa(e),r=vr(e);return[t,r,"n"]}function KO(e){var t=xn(e),r=Bp(e);return[t,r,"n"]}function qO(e){var t=Qa(e),r=Bp(e);return[t,r,"n"]}function XO(e){var t=xn(e),r=Dp(e);return[t,r,"is"]}function YO(e){var t=xn(e),r=xr(e);return[t,r,"str"]}function JO(e){var t=Qa(e),r=xr(e);return[t,r,"str"]}function QO(e,t,r){var n=e.l+t,i=xn(e);i.r=r["!row"];var a=e.read_shift(1),o=[i,a,"b"];if(r.cellFormula){e.l+=2;var l=E0(e,n-e.l,r);o[3]=mr(l,null,i,r.supbooks,r)}else e.l=n;return o}function eR(e,t,r){var n=e.l+t,i=xn(e);i.r=r["!row"];var a=e.read_shift(1),o=[i,a,"e"];if(r.cellFormula){e.l+=2;var l=E0(e,n-e.l,r);o[3]=mr(l,null,i,r.supbooks,r)}else e.l=n;return o}function tR(e,t,r){var n=e.l+t,i=xn(e);i.r=r["!row"];var a=vr(e),o=[i,a,"n"];if(r.cellFormula){e.l+=2;var l=E0(e,n-e.l,r);o[3]=mr(l,null,i,r.supbooks,r)}else e.l=n;return o}function rR(e,t,r){var n=e.l+t,i=xn(e);i.r=r["!row"];var a=xr(e),o=[i,a,"str"];if(r.cellFormula){e.l+=2;var l=E0(e,n-e.l,r);o[3]=mr(l,null,i,r.supbooks,r)}else e.l=n;return o}var nR=es;function iR(e,t){var r=e.l+t,n=es(e),i=Mp(e),a=xr(e),o=xr(e),l=xr(e);e.l=r;var u={rfx:n,relId:i,loc:a,display:l};return o&&(u.Tooltip=o),u}function aR(){}function sR(e,t,r){var n=e.l+t,i=a2(e),a=e.read_shift(1),o=[i];if(o[2]=a,r.cellFormula){var l=fO(e,n-e.l,r);o[1]=l}else e.l=n;return o}function oR(e,t,r){var n=e.l+t,i=es(e),a=[i];if(r.cellFormula){var o=dO(e,n-e.l,r);a[1]=o,e.l=n}else e.l=n;return a}var lR=["left","right","top","bottom","header","footer"];function cR(e){var t={};return lR.forEach(function(r){t[r]=vr(e)}),t}function uR(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function fR(){}function hR(){}function dR(e,t,r,n,i,a,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var u=l.dense?[]:{},f,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,p=!1,v,x,_,S,w,k,y,b,O,R=[];l.biff=12,l["!row"]=0;var C=0,z=!1,M=[],K={},G=l.supbooks||i.supbooks||[[]];if(G.sharedf=K,G.arrayf=M,G.SheetNames=i.SheetNames||i.Sheets.map(function(J){return J.name}),!l.supbooks&&(l.supbooks=G,i.Names))for(var X=0;X<i.Names.length;++X)G[0][X+1]=i.Names[X];var Y=[],de=[],he=!1;e0[16]={n:"BrtShortReal",f:$2};var me;if(Oi(e,function(q,ce,_e){if(!p)switch(_e){case 148:f=q;break;case 0:v=q,l.sheetRows&&l.sheetRows<=v.r&&(p=!0),b=or(S=v.r),l["!row"]=v.r,(q.hidden||q.hpt||q.level!=null)&&(q.hpt&&(q.hpx=Hl(q.hpt)),de[q.r]=q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:q[2]},q[2]){case"n":x.v=q[1];break;case"s":y=hl[q[1]],x.v=y.t,x.r=y.r;break;case"b":x.v=!!q[1];break;case"e":x.v=q[1],l.cellText!==!1&&(x.w=ts[x.v]);break;case"str":x.t="s",x.v=q[1];break;case"is":x.t="s",x.v=q[1].t;break}if((_=o.CellXf[q[0].iStyleRef])&&U2(x,_.numFmtId,null,l,a,o),w=q[0].c==-1?w+1:q[0].c,l.dense?(u[S]||(u[S]=[]),u[S][w]=x):u[Wt(w)+b]=x,l.cellFormula){for(z=!1,C=0;C<M.length;++C){var N=M[C];v.r>=N[0].s.r&&v.r<=N[0].e.r&&w>=N[0].s.c&&w<=N[0].e.c&&(x.F=et(N[0]),z=!0)}!z&&q.length>3&&(x.f=q[3])}if(d.s.r>v.r&&(d.s.r=v.r),d.s.c>w&&(d.s.c=w),d.e.r<v.r&&(d.e.r=v.r),d.e.c<w&&(d.e.c=w),l.cellDates&&_&&x.t=="n"&&uo(He[_.numFmtId])){var Z=La(x.v);Z&&(x.t="d",x.v=new Date(Z.y,Z.m-1,Z.d,Z.H,Z.M,Z.S,Z.u))}me&&(me.type=="XLDAPR"&&(x.D=!0),me=void 0);break;case 1:case 12:if(!l.sheetStubs||m)break;x={t:"z",v:void 0},w=q[0].c==-1?w+1:q[0].c,l.dense?(u[S]||(u[S]=[]),u[S][w]=x):u[Wt(w)+b]=x,d.s.r>v.r&&(d.s.r=v.r),d.s.c>w&&(d.s.c=w),d.e.r<v.r&&(d.e.r=v.r),d.e.c<w&&(d.e.c=w),me&&(me.type=="XLDAPR"&&(x.D=!0),me=void 0);break;case 176:R.push(q);break;case 49:me=((l.xlmeta||{}).Cell||[])[q-1];break;case 494:var H=n["!id"][q.relId];for(H?(q.Target=H.Target,q.loc&&(q.Target+="#"+q.loc),q.Rel=H):q.relId==""&&(q.Target="#"+q.loc),S=q.rfx.s.r;S<=q.rfx.e.r;++S)for(w=q.rfx.s.c;w<=q.rfx.e.c;++w)l.dense?(u[S]||(u[S]=[]),u[S][w]||(u[S][w]={t:"z",v:void 0}),u[S][w].l=q):(k=Ue({c:w,r:S}),u[k]||(u[k]={t:"z",v:void 0}),u[k].l=q);break;case 426:if(!l.cellFormula)break;M.push(q),O=l.dense?u[S][w]:u[Wt(w)+b],O.f=mr(q[1],d,{r:v.r,c:w},G,l),O.F=et(q[0]);break;case 427:if(!l.cellFormula)break;K[Ue(q[0].s)]=q[1],O=l.dense?u[S][w]:u[Wt(w)+b],O.f=mr(q[1],d,{r:v.r,c:w},G,l);break;case 60:if(!l.cellStyles)break;for(;q.e>=q.s;)Y[q.e--]={width:q.w/256,hidden:!!(q.flags&1),level:q.level},he||(he=!0,$p(q.w/256)),io(Y[q.e+1]);break;case 161:u["!autofilter"]={ref:et(q)};break;case 476:u["!margins"]=q;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),q.name&&(i.Sheets[r].CodeName=q.name),(q.above||q.left)&&(u["!outline"]={above:q.above,left:q.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),q.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!ce.T){if(!m||l.WTF)throw new Error("Unexpected record 0x"+_e.toString(16))}}},l),delete l.supbooks,delete l["!row"],!u["!ref"]&&(d.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(u["!ref"]=et(f||d)),l.sheetRows&&u["!ref"]){var ge=bt(u["!ref"]);l.sheetRows<=+ge.e.r&&(ge.e.r=l.sheetRows-1,ge.e.r>d.e.r&&(ge.e.r=d.e.r),ge.e.r<ge.s.r&&(ge.s.r=ge.e.r),ge.e.c>d.e.c&&(ge.e.c=d.e.c),ge.e.c<ge.s.c&&(ge.s.c=ge.e.c),u["!fullref"]=u["!ref"],u["!ref"]=et(ge))}return R.length>0&&(u["!merges"]=R),Y.length>0&&(u["!cols"]=Y),de.length>0&&(u["!rows"]=de),u}function pR(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var o=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var i=rt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,i,n]}function mR(e,t,r,n,i,a){var o=a||{"!type":"chart"};if(!e)return a;var l=0,u=0,f="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var p=pR(m);d.s.r=d.s.c=0,d.e.c=l,f=Wt(l),p[0].forEach(function(v,x){o[f+or(x)]={t:"n",v,z:p[1]},u=x}),d.e.r<u&&(d.e.r=u),++l}),l>0&&(o["!ref"]=et(d)),o}function gR(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(z2);return l&&Hp(l[0],a,i,r),(o=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=o[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function vR(e,t){e.l+=10;var r=xr(e);return{name:r}}function _R(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Oi(e,function(u,f,d){switch(d){case 550:a["!rel"]=u;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),u.name&&(i.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var W2=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],xR=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],yR=[],wR=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function mv(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var a=t[i];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=gt(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function gv(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=gt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function H2(e){gv(e.WBProps,W2),gv(e.CalcPr,wR),mv(e.WBView,xR),mv(e.Sheets,yR),qs.date1904=gt(e.WBProps.date1904)}var kR="][*?/\\".split("");function ER(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return kR.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var SR=/<\w+:workbook/;function TR(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",a={},o=0;if(e.replace(kr,function(u,f){var d=Be(u);switch(ri(d[0])){case"<?xml":break;case"<workbook":u.match(SR)&&(i="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":W2.forEach(function(m){if(d[m[0]]!=null)switch(m[2]){case"bool":r.WBProps[m[0]]=gt(d[m[0]]);break;case"int":r.WBProps[m[0]]=parseInt(d[m[0]],10);break;default:r.WBProps[m[0]]=d[m[0]]}}),d.codeName&&(r.WBProps.CodeName=ut(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=rt(ut(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=ut(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),gt(d.hidden||"0")&&(a.Hidden=!0),o=f+u.length;break;case"</definedName>":a.Ref=rt(ut(e.slice(o,f))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return u}),Wb.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return H2(r),r}function CR(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=hd(e),r.name=xr(e),r}function bR(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?xr(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function AR(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function PR(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),a=oA(e),o=hO(e,0,r),l=Mp(e);e.l=n;var u={Name:a,Ptg:o};return i<268435455&&(u.Sheet=i),l&&(u.Comment=l),u}function OR(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var a=[],o=[[]];return o.SheetNames=[],o.XTI=[],e0[16]={n:"BrtFRTArchID$",f:AR},Oi(e,function(u,f,d){switch(d){case 156:o.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(t.SID=u.Sheet),u.Ref=mr(u.Ptg,null,null,o,t),delete t.SID,delete u.Ptg,a.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,u]):o[0]=[d,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!f.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),H2(r),r.Names=a,r.supbooks=o,r}function RR(e,t,r){return t.slice(-4)===".bin"?OR(e,r):TR(e,r)}function FR(e,t,r,n,i,a,o,l){return t.slice(-4)===".bin"?dR(e,n,r,i,a,o,l):CO(e,n,r,i,a,o,l)}function LR(e,t,r,n,i,a,o,l){return t.slice(-4)===".bin"?_R(e,n,r,i,a):gR(e,n,r,i,a)}function IR(e,t,r,n,i,a,o,l){return t.slice(-4)===".bin"?$6():W6()}function NR(e,t,r,n,i,a,o,l){return t.slice(-4)===".bin"?U6():z6()}function DR(e,t,r,n){return t.slice(-4)===".bin"?n6(e,r,n):Y8(e,r,n)}function MR(e,t,r){return O2(e,r)}function BR(e,t,r){return t.slice(-4)===".bin"?x8(e,r):v8(e,r)}function jR(e,t,r){return t.slice(-4)===".bin"?M6(e,r):F6(e,r)}function UR(e,t,r){return t.slice(-4)===".bin"?P6(e):b6(e)}function zR(e,t,r,n){return r.slice(-4)===".bin"?O6(e,t,r,n):void 0}function $R(e,t,r){return t.slice(-4)===".bin"?T6(e,t,r):C6(e,t,r)}var V2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,G2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Cn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(V2),a,o,l,u;if(i)for(u=0;u!=i.length;++u)a=i[u].match(G2),(o=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),n[l]=a[2].slice(1,a[2].length-1));return n}function WR(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(V2),i,a,o,l;if(n)for(l=0;l!=n.length;++l)i=n[l].match(G2),(a=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),r[o]=i[2].slice(1,i[2].length-1));return r}var pl;function HR(e,t){var r=pl[e]||rt(e);return r==="General"?Va(t):_n(r,t)}function VR(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=gt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Jt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[rt(t)]=i}function GR(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ts[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=jl(e.v):e.w=Va(e.v):e.w=HR(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=pl[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&uo(n)){var i=La(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(a){if(r.WTF)throw a}}}function ZR(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=V8[n.Pattern]||n.Pattern)}e[t.ID]=t}function KR(e,t,r,n,i,a,o,l,u,f){var d="General",m=n.StyleID,p={};f=f||{};var v=[],x=0;for(m===void 0&&l&&(m=l.StyleID),m===void 0&&o&&(m=o.StyleID);a[m]!==void 0&&(a[m].nf&&(d=a[m].nf),a[m].Interior&&v.push(a[m].Interior),!!a[m].Parent);)m=a[m].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=gt(e);break;case"String":n.t="s",n.r=Bg(rt(e)),n.v=e.indexOf("<")>-1?rt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Jt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=rt(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=l2[e],f.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Bg(t||e));break}if(GR(n,d,f),f.cellFormula!==!1)if(n.Formula){var _=rt(n.Formula);_.charCodeAt(0)==61&&(_=_.slice(1)),n.f=Ks(_,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Ks("RC:RC",i):n.ArrayRange&&(n.F=Ks(n.ArrayRange,i),u.push([bt(n.F),n.F]))}else for(x=0;x<u.length;++x)i.r>=u[x][0].s.r&&i.r<=u[x][0].e.r&&i.c>=u[x][0].s.c&&i.c<=u[x][0].e.c&&(n.F=u[x][1]);f.cellStyles&&(v.forEach(function(S){!p.patternType&&S.patternType&&(p.patternType=S.patternType)}),n.s=p),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function qR(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function qf(e,t){var r=t||{};Iy();var n=Vo(Fp(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=ut(n));var i=n.slice(0,1024).toLowerCase(),a=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=sr(r);return o.type="string",$l.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(it){i.indexOf("<"+it)>=0&&(a=!0)}),a)return iF(n,r);pl={"General Number":"General","General Date":He[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":He[15],"Short Date":He[14],"Long Time":He[19],"Medium Time":He[18],"Short Time":He[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:He[2],Standard:He[4],Percent:He[10],Scientific:He[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,u=[],f,d={},m=[],p=r.dense?[]:{},v="",x={},_={},S=Cn('<Data ss:Type="String">'),w=0,k=0,y=0,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},O={},R={},C="",z=0,M=[],K={},G={},X=0,Y=[],de=[],he={},me=[],ge,J=!1,q=[],ce=[],_e={},N=0,Z=0,H={Sheets:[],WBProps:{date1904:!1}},W={};zl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var te="";l=zl.exec(n);)switch(l[3]=(te=l[3]).toLowerCase()){case"data":if(te=="data"){if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break}if(u[u.length-1][1])break;l[1]==="/"?KR(n.slice(w,l.index),C,S,u[u.length-1][0]=="comment"?he:x,{c:k,r:y},O,me[k],_,q,r):(C="",S=Cn(l[0]),w=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(de.length>0&&(x.c=de),(!r.sheetRows||r.sheetRows>y)&&x.v!==void 0&&(r.dense?(p[y]||(p[y]=[]),p[y][k]=x):p[Wt(k)+or(y)]=x),x.HRef&&(x.l={Target:rt(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(N=k+(parseInt(x.MergeAcross,10)|0),Z=y+(parseInt(x.MergeDown,10)|0),M.push({s:{c:k,r:y},e:{c:N,r:Z}})),!r.sheetStubs)x.MergeAcross?k=N+1:++k;else if(x.MergeAcross||x.MergeDown){for(var xe=k;xe<=N;++xe)for(var Te=y;Te<=Z;++Te)(xe>k||Te>y)&&(r.dense?(p[Te]||(p[Te]=[]),p[Te][xe]={t:"z"}):p[Wt(xe)+or(Te)]={t:"z"});k=N+1}else++k;else x=WR(l[0]),x.Index&&(k=+x.Index-1),k<b.s.c&&(b.s.c=k),k>b.e.c&&(b.e.c=k),l[0].slice(-2)==="/>"&&++k,de=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(y<b.s.r&&(b.s.r=y),y>b.e.r&&(b.e.r=y),l[0].slice(-2)==="/>"&&(_=Cn(l[0]),_.Index&&(y=+_.Index-1)),k=0,++y):(_=Cn(l[0]),_.Index&&(y=+_.Index-1),_e={},(_.AutoFitHeight=="0"||_.Height)&&(_e.hpx=parseInt(_.Height,10),_e.hpt=P2(_e.hpx),ce[y]=_e),_.Hidden=="1"&&(_e.hidden=!0,ce[y]=_e));break;case"worksheet":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"));m.push(v),b.s.r<=b.e.r&&b.s.c<=b.e.c&&(p["!ref"]=et(b),r.sheetRows&&r.sheetRows<=b.e.r&&(p["!fullref"]=p["!ref"],b.e.r=r.sheetRows-1,p["!ref"]=et(b))),M.length&&(p["!merges"]=M),me.length>0&&(p["!cols"]=me),ce.length>0&&(p["!rows"]=ce),d[v]=p}else b={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=k=0,u.push([l[3],!1]),f=Cn(l[0]),v=rt(f.Name),p=r.dense?[]:{},M=[],q=[],ce=[],W={name:v,Hidden:0},H.Sheets.push(W);break;case"table":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else{if(l[0].slice(-2)=="/>")break;u.push([l[3],!1]),me=[],J=!1}break;case"style":l[1]==="/"?ZR(O,R,r):R=Cn(l[0]);break;case"numberformat":R.nf=rt(Cn(l[0]).Format||"General"),pl[R.nf]&&(R.nf=pl[R.nf]);for(var ee=0;ee!=392&&He[ee]!=R.nf;++ee);if(ee==392){for(ee=57;ee!=392;++ee)if(He[ee]==null){Ma(R.nf,ee);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(ge=Cn(l[0]),ge.Hidden&&(ge.hidden=!0,delete ge.Hidden),ge.Width&&(ge.wpx=parseInt(ge.Width,10)),!J&&ge.wpx>10){J=!0,br=b2;for(var oe=0;oe<me.length;++oe)me[oe]&&io(me[oe])}J&&io(ge),me[ge.Index-1||me.length]=ge;for(var Ae=0;Ae<+ge.Span;++Ae)me[me.length]=sr(ge);break;case"namedrange":if(l[1]==="/")break;H.Names||(H.Names=[]);var D=Be(l[0]),Ze={Name:D.Name,Ref:Ks(D.RefersTo.slice(1),{r:0,c:0})};H.Sheets.length>0&&(Ze.Sheet=H.Sheets.length-1),H.Names.push(Ze);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?C+=n.slice(z,l.index):z=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;R.Interior=Cn(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?FA(K,te,n.slice(X,l.index)):X=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else u.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"));qR(he),de.push(he)}else u.push([l[3],!1]),f=Cn(l[0]),he={a:f.Author};break;case"autofilter":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var qe=Cn(l[0]);p["!autofilter"]={ref:Ks(qe.Range).replace(/\$/g,"")},u.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break;case"null":break;default:if(u.length==0&&l[3]=="document"||u.length==0&&l[3]=="uof")return kv(n,r);var nt=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:nt=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:nt=!1}break;case"excelworkbook":switch(l[3]){case"date1904":H.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:nt=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:nt=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(X,l.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else X=l.index+l[0].length;break;case"header":p["!margins"]||dl(p["!margins"]={},"xlml"),isNaN(+Be(l[0]).Margin)||(p["!margins"].header=+Be(l[0]).Margin);break;case"footer":p["!margins"]||dl(p["!margins"]={},"xlml"),isNaN(+Be(l[0]).Margin)||(p["!margins"].footer=+Be(l[0]).Margin);break;case"pagemargins":var ze=Be(l[0]);p["!margins"]||dl(p["!margins"]={},"xlml"),isNaN(+ze.Top)||(p["!margins"].top=+ze.Top),isNaN(+ze.Left)||(p["!margins"].left=+ze.Left),isNaN(+ze.Right)||(p["!margins"].right=+ze.Right),isNaN(+ze.Bottom)||(p["!margins"].bottom=+ze.Bottom);break;case"displayrighttoleft":H.Views||(H.Views=[]),H.Views[0]||(H.Views[0]={}),H.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:nt=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:nt=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:nt=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:nt=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:nt=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:nt=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:nt=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:nt=!1}break;case"smarttags":break;default:nt=!1;break}if(nt||l[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?VR(G,te,Y,n.slice(X,l.index)):(Y=l,X=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+u.join("|")}var Ee={};return!r.bookSheets&&!r.bookProps&&(Ee.Sheets=d),Ee.SheetNames=m,Ee.Workbook=H,Ee.SSF=sr(He),Ee.Props=K,Ee.Custprops=G,Ee}function gd(e,t){switch(Zp(t=t||{}),t.type||"base64"){case"base64":return qf(Qr(e),t);case"binary":case"buffer":case"file":return qf(e,t);case"array":return qf(Ja(e),t)}}function XR(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=uA(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=fA(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var YR=[60,1084,2066,2165,2175];function JR(e,t,r,n,i){var a=n,o=[],l=r.slice(r.l,r.l+a);if(i&&i.enc&&i.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(l)}o.push(l),r.l+=a;for(var u=vi(r,r.l),f=vd[u],d=0;f!=null&&YR.indexOf(u)>-1;)a=vi(r,r.l+2),d=r.l+4,u==2066?d+=4:(u==2165||u==2175)&&(d+=12),l=r.slice(d,r.l+4+a),o.push(l),r.l+=4+a,f=vd[u=vi(r,r.l)];var m=Hi(o);ir(m,0);var p=0;m.lens=[];for(var v=0;v<o.length;++v)m.lens.push(p),p+=o[v].length;if(m.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+n;return t.f(m,m.length,i)}function Gn(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=He[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ts[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=jl(e.v):e.w=Va(e.v):e.w=_n(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&uo(He[n]||String(n))){var i=La(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function ru(e,t,r){return{v:e,ixfe:t,t:r}}function QR(e,t){var r={opts:{}},n={},i=t.dense?[]:{},a={},o={},l=null,u=[],f="",d={},m,p="",v,x,_,S,w={},k=[],y,b,O=[],R=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},z={},M=function(Ve){return Ve<8?Ba[Ve]:Ve<64&&R[Ve-8]||Ba[Ve]},K=function(Ve,mt,Nr){var Et=mt.XF.data;if(!(!Et||!Et.patternType||!Nr||!Nr.cellStyles)){mt.s={},mt.s.patternType=Et.patternType;var wn;(wn=Wl(M(Et.icvFore)))&&(mt.s.fgColor={rgb:wn}),(wn=Wl(M(Et.icvBack)))&&(mt.s.bgColor={rgb:wn})}},G=function(Ve,mt,Nr){if(!(_e>1)&&!(Nr.sheetRows&&Ve.r>=Nr.sheetRows)){if(Nr.cellStyles&&mt.XF&&mt.XF.data&&K(Ve,mt,Nr),delete mt.ixfe,delete mt.XF,m=Ve,p=Ue(Ve),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Ve.r<o.s.r&&(o.s.r=Ve.r),Ve.c<o.s.c&&(o.s.c=Ve.c),Ve.r+1>o.e.r&&(o.e.r=Ve.r+1),Ve.c+1>o.e.c&&(o.e.c=Ve.c+1),Nr.cellFormula&&mt.f){for(var Et=0;Et<k.length;++Et)if(!(k[Et][0].s.c>Ve.c||k[Et][0].s.r>Ve.r)&&!(k[Et][0].e.c<Ve.c||k[Et][0].e.r<Ve.r)){mt.F=et(k[Et][0]),(k[Et][0].s.c!=Ve.c||k[Et][0].s.r!=Ve.r)&&delete mt.f,mt.f&&(mt.f=""+mr(k[Et][1],o,Ve,q,X));break}}Nr.dense?(i[Ve.r]||(i[Ve.r]=[]),i[Ve.r][Ve.c]=mt):i[p]=mt}},X={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(X.password=t.password);var Y,de=[],he=[],me=[],ge=[],J=!1,q=[];q.SheetNames=X.snames,q.sharedf=X.sharedf,q.arrayf=X.arrayf,q.names=[],q.XTI=[];var ce=0,_e=0,N=0,Z=[],H=[],W;X.codepage=1200,Nn(1200);for(var te=!1;e.l<e.length-1;){var xe=e.l,Te=e.read_shift(2);if(Te===0&&ce===10)break;var ee=e.l===e.length?0:e.read_shift(2),oe=vd[Te];if(oe&&oe.f){if(t.bookSheets&&ce===133&&Te!==133)break;if(ce=Te,oe.r===2||oe.r==12){var Ae=e.read_shift(2);if(ee-=2,!X.enc&&Ae!==Te&&((Ae&255)<<8|Ae>>8)!==Te)throw new Error("rt mismatch: "+Ae+"!="+Te);oe.r==12&&(e.l+=10,ee-=10)}var D={};if(Te===10?D=oe.f(e,ee,X):D=JR(Te,oe,e,ee,X),_e==0&&[9,521,1033,2057].indexOf(ce)===-1)continue;switch(Te){case 34:r.opts.Date1904=C.WBProps.date1904=D;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(X.enc||(e.l=0),X.enc=D,!t.password)throw new Error("File is password-protected");if(D.valid==null)throw new Error("Encryption scheme unsupported");if(!D.valid)throw new Error("Password is incorrect");break;case 92:X.lastuser=D;break;case 66:var Ze=Number(D);switch(Ze){case 21010:Ze=1200;break;case 32768:Ze=1e4;break;case 32769:Ze=1252;break}Nn(X.codepage=Ze),te=!0;break;case 317:X.rrtabid=D;break;case 25:X.winlocked=D;break;case 439:r.opts.RefreshAll=D;break;case 12:r.opts.CalcCount=D;break;case 16:r.opts.CalcDelta=D;break;case 17:r.opts.CalcIter=D;break;case 13:r.opts.CalcMode=D;break;case 14:r.opts.CalcPrecision=D;break;case 95:r.opts.CalcSaveRecalc=D;break;case 15:X.CalcRefMode=D;break;case 2211:r.opts.FullCalc=D;break;case 129:D.fDialog&&(i["!type"]="dialog"),D.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),D.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:O.push(D);break;case 430:q.push([D]),q[q.length-1].XTI=[];break;case 35:case 547:q[q.length-1].push(D);break;case 24:case 536:W={Name:D.Name,Ref:mr(D.rgce,o,null,q,X)},D.itab>0&&(W.Sheet=D.itab-1),q.names.push(W),q[0]||(q[0]=[],q[0].XTI=[]),q[q.length-1].push(D),D.Name=="_xlnm._FilterDatabase"&&D.itab>0&&D.rgce&&D.rgce[0]&&D.rgce[0][0]&&D.rgce[0][0][0]=="PtgArea3d"&&(H[D.itab-1]={ref:et(D.rgce[0][0][1][2])});break;case 22:X.ExternCount=D;break;case 23:q.length==0&&(q[0]=[],q[0].XTI=[]),q[q.length-1].XTI=q[q.length-1].XTI.concat(D),q.XTI=q.XTI.concat(D);break;case 2196:if(X.biff<8)break;W!=null&&(W.Comment=D[1]);break;case 18:i["!protect"]=D;break;case 19:D!==0&&X.WTF&&console.error("Password verifier: "+D);break;case 133:a[D.pos]=D,X.snames.push(D.name);break;case 10:{if(--_e)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=et(o),t.sheetRows&&t.sheetRows<=o.e.r){var qe=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=et(o),o.e.r=qe}o.e.r++,o.e.c++}de.length>0&&(i["!merges"]=de),he.length>0&&(i["!objects"]=he),me.length>0&&(i["!cols"]=me),ge.length>0&&(i["!rows"]=ge),C.Sheets.push(z)}f===""?d=i:n[f]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(X.biff===8&&(X.biff={9:2,521:3,1033:4}[Te]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[D.BIFFVer]||8),X.biffguess=D.BIFFVer==0,D.BIFFVer==0&&D.dt==4096&&(X.biff=5,te=!0,Nn(X.codepage=28591)),X.biff==8&&D.BIFFVer==0&&D.dt==16&&(X.biff=2),_e++)break;if(i=t.dense?[]:{},X.biff<8&&!te&&(te=!0,Nn(X.codepage=t.codepage||1252)),X.biff<5||D.BIFFVer==0&&D.dt==4096){f===""&&(f="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var nt={pos:e.l-ee,name:f};a[nt.pos]=nt,X.snames.push(f)}else f=(a[xe]||{name:""}).name;D.dt==32&&(i["!type"]="chart"),D.dt==64&&(i["!type"]="macro"),de=[],he=[],X.arrayf=k=[],me=[],ge=[],J=!1,z={Hidden:(a[xe]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[D.r]||[])[D.c]:i[Ue({c:D.c,r:D.r})])&&++D.c,y={ixfe:D.ixfe,XF:O[D.ixfe]||{},v:D.val,t:"n"},N>0&&(y.z=Z[y.ixfe>>8&63]),Gn(y,t,r.opts.Date1904),G({c:D.c,r:D.r},y,t);break;case 5:case 517:y={ixfe:D.ixfe,XF:O[D.ixfe],v:D.val,t:D.t},N>0&&(y.z=Z[y.ixfe>>8&63]),Gn(y,t,r.opts.Date1904),G({c:D.c,r:D.r},y,t);break;case 638:y={ixfe:D.ixfe,XF:O[D.ixfe],v:D.rknum,t:"n"},N>0&&(y.z=Z[y.ixfe>>8&63]),Gn(y,t,r.opts.Date1904),G({c:D.c,r:D.r},y,t);break;case 189:for(var ze=D.c;ze<=D.C;++ze){var Ee=D.rkrec[ze-D.c][0];y={ixfe:Ee,XF:O[Ee],v:D.rkrec[ze-D.c][1],t:"n"},N>0&&(y.z=Z[y.ixfe>>8&63]),Gn(y,t,r.opts.Date1904),G({c:ze,r:D.r},y,t)}break;case 6:case 518:case 1030:{if(D.val=="String"){l=D;break}if(y=ru(D.val,D.cell.ixfe,D.tt),y.XF=O[y.ixfe],t.cellFormula){var it=D.formula;if(it&&it[0]&&it[0][0]&&it[0][0][0]=="PtgExp"){var Qt=it[0][0][1][0],ur=it[0][0][1][1],fr=Ue({r:Qt,c:ur});w[fr]?y.f=""+mr(D.formula,o,D.cell,q,X):y.F=((t.dense?(i[Qt]||[])[ur]:i[fr])||{}).F}else y.f=""+mr(D.formula,o,D.cell,q,X)}N>0&&(y.z=Z[y.ixfe>>8&63]),Gn(y,t,r.opts.Date1904),G(D.cell,y,t),l=D}break;case 7:case 519:if(l)l.val=D,y=ru(D,l.cell.ixfe,"s"),y.XF=O[y.ixfe],t.cellFormula&&(y.f=""+mr(l.formula,o,l.cell,q,X)),N>0&&(y.z=Z[y.ixfe>>8&63]),Gn(y,t,r.opts.Date1904),G(l.cell,y,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(D);var yn=Ue(D[0].s);if(v=t.dense?(i[D[0].s.r]||[])[D[0].s.c]:i[yn],t.cellFormula&&v){if(!l||!yn||!v)break;v.f=""+mr(D[1],o,D[0],q,X),v.F=et(D[0])}}break;case 1212:{if(!t.cellFormula)break;if(p){if(!l)break;w[Ue(l.cell)]=D[0],v=t.dense?(i[l.cell.r]||[])[l.cell.c]:i[Ue(l.cell)],(v||{}).f=""+mr(D[0],o,m,q,X)}}break;case 253:y=ru(u[D.isst].t,D.ixfe,"s"),u[D.isst].h&&(y.h=u[D.isst].h),y.XF=O[y.ixfe],N>0&&(y.z=Z[y.ixfe>>8&63]),Gn(y,t,r.opts.Date1904),G({c:D.c,r:D.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:D.ixfe,XF:O[D.ixfe],t:"z"},N>0&&(y.z=Z[y.ixfe>>8&63]),Gn(y,t,r.opts.Date1904),G({c:D.c,r:D.r},y,t));break;case 190:if(t.sheetStubs)for(var Ir=D.c;Ir<=D.C;++Ir){var Vt=D.ixfe[Ir-D.c];y={ixfe:Vt,XF:O[Vt],t:"z"},N>0&&(y.z=Z[y.ixfe>>8&63]),Gn(y,t,r.opts.Date1904),G({c:Ir,r:D.r},y,t)}break;case 214:case 516:case 4:y=ru(D.val,D.ixfe,"s"),y.XF=O[y.ixfe],N>0&&(y.z=Z[y.ixfe>>8&63]),Gn(y,t,r.opts.Date1904),G({c:D.c,r:D.r},y,t);break;case 0:case 512:_e===1&&(o=D);break;case 252:u=D;break;case 1054:if(X.biff==4){Z[N++]=D[1];for(var Wr=0;Wr<N+163&&He[Wr]!=D[1];++Wr);Wr>=163&&Ma(D[1],N+163)}else Ma(D[1],D[0]);break;case 30:{Z[N++]=D;for(var rn=0;rn<N+163&&He[rn]!=D;++rn);rn>=163&&Ma(D,N+163)}break;case 229:de=de.concat(D);break;case 93:he[D.cmo[0]]=X.lastobj=D;break;case 438:X.lastobj.TxO=D;break;case 127:X.lastobj.ImData=D;break;case 440:for(S=D[0].s.r;S<=D[0].e.r;++S)for(_=D[0].s.c;_<=D[0].e.c;++_)v=t.dense?(i[S]||[])[_]:i[Ue({c:_,r:S})],v&&(v.l=D[1]);break;case 2048:for(S=D[0].s.r;S<=D[0].e.r;++S)for(_=D[0].s.c;_<=D[0].e.c;++_)v=t.dense?(i[S]||[])[_]:i[Ue({c:_,r:S})],v&&v.l&&(v.l.Tooltip=D[1]);break;case 28:{if(X.biff<=5&&X.biff>=2)break;v=t.dense?(i[D[0].r]||[])[D[0].c]:i[Ue(D[0])];var Ri=he[D[2]];v||(t.dense?(i[D[0].r]||(i[D[0].r]=[]),v=i[D[0].r][D[0].c]={t:"z"}):v=i[Ue(D[0])]={t:"z"},o.e.r=Math.max(o.e.r,D[0].r),o.s.r=Math.min(o.s.r,D[0].r),o.e.c=Math.max(o.e.c,D[0].c),o.s.c=Math.min(o.s.c,D[0].c)),v.c||(v.c=[]),x={a:D[1],t:Ri.TxO.t},v.c.push(x)}break;case 2173:w6(O[D.ixfe],D.ext);break;case 125:{if(!X.cellStyles)break;for(;D.e>=D.s;)me[D.e--]={width:D.w/256,level:D.level||0,hidden:!!(D.flags&1)},J||(J=!0,$p(D.w/256)),io(me[D.e+1])}break;case 520:{var Gt={};D.level!=null&&(ge[D.r]=Gt,Gt.level=D.level),D.hidden&&(ge[D.r]=Gt,Gt.hidden=!0),D.hpt&&(ge[D.r]=Gt,Gt.hpt=D.hpt,Gt.hpx=Hl(D.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||dl(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Te]]=D;break;case 161:i["!margins"]||dl(i["!margins"]={}),i["!margins"].header=D.header,i["!margins"].footer=D.footer;break;case 574:D.RTL&&(C.Views[0].RTL=!0);break;case 146:R=D;break;case 2198:Y=D;break;case 140:b=D;break;case 442:f?z.CodeName=D||z.name:C.WBProps.CodeName=D||"ThisWorkbook";break}}else oe||console.error("Missing Info for XLS Record 0x"+Te.toString(16)),e.l+=ee}return r.SheetNames=ti(a).sort(function(nn,Ve){return Number(nn)-Number(Ve)}).map(function(nn){return a[nn].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&H.forEach(function(nn,Ve){r.Sheets[r.SheetNames[Ve]]["!autofilter"]=nn}),r.Strings=u,r.SSF=sr(He),X.enc&&(r.Encryption=X.enc),Y&&(r.Themes=Y),r.Metadata={},b!==void 0&&(r.Metadata.Country=b),q.names.length>0&&(C.Names=q.names),r.Workbook=C,r}var vv={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function eF(e,t,r){var n=Qe.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=ev(n,vA,vv.DSI);for(var a in i)t[a]=i[a]}catch(f){if(r.WTF)throw f}var o=Qe.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=ev(o,_A,vv.SI);for(var u in l)t[u]==null&&(t[u]=l[u])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(u2(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Z2(e,t){t||(t={}),Zp(t),ky(),t.codepage&&Tp(t.codepage);var r,n;if(e.FullPaths){if(Qe.find(e,"/encryption"))throw new Error("File is password-protected");r=Qe.find(e,"!CompObj"),n=Qe.find(e,"/Workbook")||Qe.find(e,"/Book")}else{switch(t.type){case"base64":e=In(Qr(e));break;case"binary":e=In(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}ir(e,0),n={content:e}}var i,a;if(r&&XR(r),t.bookProps&&!t.bookSheets)i={};else{var o=Ye?"buffer":"array";if(n&&n.content)i=QR(n.content,t);else if((a=Qe.find(e,"PerfectOffice_MAIN"))&&a.content)i=fl.to_workbook(a.content,(t.type=o,t));else if((a=Qe.find(e,"NativeContent_MAIN"))&&a.content)i=fl.to_workbook(a.content,(t.type=o,t));else throw(a=Qe.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Qe.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=j6(e))}var l={};return e.FullPaths&&eF(e,l,t),i.Props=i.Custprops=l,t.bookFiles&&(i.cfb=e),i}var e0={0:{f:NO},1:{f:jO},2:{f:KO},3:{f:WO},4:{f:zO},5:{f:ZO},6:{f:YO},7:{f:VO},8:{f:rR},9:{f:tR},10:{f:QO},11:{f:eR},12:{f:UO},13:{f:qO},14:{f:HO},15:{f:$O},16:{f:$2},17:{f:JO},18:{f:GO},19:{f:Dp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:PR},40:{},42:{},43:{f:Q8},44:{f:J8},45:{f:e6},46:{f:r6},47:{f:t6},48:{},49:{f:nA},50:{},51:{f:E6},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:k2},62:{f:XO},63:{f:A6},64:{f:fR},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:wr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:uR},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:BO},148:{f:DO,p:16},151:{f:aR},152:{},153:{f:bR},154:{},155:{},156:{f:CR},157:{},158:{},159:{T:1,f:_8},160:{T:-1},161:{T:1,f:es},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:nR},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:k6},336:{T:-1},337:{f:S6,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:hd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:w2},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:sR},427:{f:oR},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:cR},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:MO},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:iR},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:hd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:D6},633:{T:1},634:{T:-1},635:{T:1,f:N6},636:{T:-1},637:{f:aA},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:vR},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:hR},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},vd={6:{f:Zf},10:{f:Mi},12:{f:Dt},13:{f:Dt},14:{f:Pt},15:{f:Pt},16:{f:vr},17:{f:Pt},18:{f:Pt},19:{f:Dt},20:{f:iv},21:{f:iv},23:{f:w2},24:{f:sv},25:{f:Pt},26:{},27:{},28:{f:L5},29:{},34:{f:Pt},35:{f:av},38:{f:vr},39:{f:vr},40:{f:vr},41:{f:vr},42:{f:Pt},43:{f:Pt},47:{f:M8},49:{f:p5},51:{f:Dt},60:{},61:{f:f5},64:{f:Pt},65:{f:d5},66:{f:Dt},77:{},80:{},81:{},82:{},85:{f:Dt},89:{},90:{},91:{},92:{f:n5},93:{f:N5},94:{},95:{f:Pt},96:{},97:{},99:{f:Pt},125:{f:k2},128:{f:S5},129:{f:i5},130:{f:Dt},131:{f:Pt},132:{f:Pt},133:{f:a5},134:{},140:{f:z5},141:{f:Dt},144:{},146:{f:W5},151:{},152:{},153:{},154:{},155:{},156:{f:Dt},157:{},158:{},160:{f:K5},161:{f:V5},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:y5},190:{f:w5},193:{f:Mi},197:{},198:{},199:{},200:{},201:{},202:{f:Pt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Dt},220:{},221:{f:Pt},222:{},224:{f:E5},225:{f:r5},226:{f:Mi},227:{},229:{f:I5},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:s5},253:{f:m5},255:{f:o5},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:m2},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Pt},353:{f:Mi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:C5},431:{f:Pt},432:{},433:{},434:{},437:{},438:{f:B5},439:{f:Pt},440:{f:j5},441:{},442:{f:rc},443:{},444:{f:Dt},445:{},446:{},448:{f:Mi},449:{f:u5,r:2},450:{f:Mi},512:{f:rv},513:{f:Z5},515:{f:T5},516:{f:g5},517:{f:nv},519:{f:q5},520:{f:l5},523:{},545:{f:ov},549:{f:tv},566:{},574:{f:h5},638:{f:x5},659:{},1048:{},1054:{f:v5},1084:{},1212:{f:O5},2048:{f:U5},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Qc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Mi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:H5,r:12},2173:{f:y6,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Pt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:P5,r:12},2197:{},2198:{f:p6,r:12},2199:{},2200:{},2201:{},2202:{f:R5,r:12},2203:{f:Mi},2204:{},2205:{},2206:{},2207:{},2211:{f:c5},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Dt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:G5},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:$5},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:rv},1:{},2:{f:Q5},3:{f:J5},4:{f:Y5},5:{f:nv},7:{f:e8},8:{},9:{f:Qc},11:{},22:{f:Dt},30:{f:_5},31:{},32:{},33:{f:ov},36:{},37:{f:tv},50:{f:t8},62:{},52:{},67:{},68:{f:Dt},69:{},86:{},126:{},127:{f:X5},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:r8},223:{},234:{},354:{},421:{},518:{f:Zf},521:{f:Qc},536:{f:sv},547:{f:av},561:{},579:{},1030:{f:Zf},1033:{f:Qc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function bn(e,t,r,n){var i=t;if(!isNaN(i)){var a=(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,a),a>0&&r2(r)&&e.push(r)}}function _v(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),o=i.index,l=a&&a.index||e.length,u=Tb(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,d=0,m=0,p=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(o=0;o<u.length;++o){var _=u[o].trim(),S=_.slice(0,3).toLowerCase();if(S=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}d=0;continue}if(!(S!="<td"&&S!="<th")){var w=_.split(/<\/t[dh]>/i);for(l=0;l<w.length;++l){var k=w[l].trim();if(k.match(/<t[dh]/i)){for(var y=k,b=0;y.charAt(0)=="<"&&(b=y.indexOf(">"))>-1;)y=y.slice(b+1);for(var O=0;O<x.length;++O){var R=x[O];R.s.c==d&&R.s.r<f&&f<=R.e.r&&(d=R.e.c+1,O=-1)}var C=Be(k.slice(0,k.indexOf(">")));p=C.colspan?+C.colspan:1,((m=+C.rowspan)>1||p>1)&&x.push({s:{r:f,c:d},e:{r:f+(m||1)-1,c:d+p-1}});var z=C.t||C["data-t"]||"";if(!y.length){d+=p;continue}if(y=Wy(y),v.s.r>f&&(v.s.r=f),v.e.r<f&&(v.e.r=f),v.s.c>d&&(v.s.c=d),v.e.c<d&&(v.e.c=d),!y.length){d+=p;continue}var M={t:"s",v:y};r.raw||!y.trim().length||z=="s"||(y==="TRUE"?M={t:"b",v:!0}:y==="FALSE"?M={t:"b",v:!1}:isNaN(jn(y))?isNaN(no(y).getDate())||(M={t:"d",v:Jt(y)},r.cellDates||(M={t:"n",v:Rr(M.v)}),M.z=r.dateNF||He[14]):M={t:"n",v:jn(y)}),r.dense?(n[f]||(n[f]=[]),n[f][d]=M):n[Ue({r:f,c:d})]=M,d+=p}}}}return n["!ref"]=et(v),x.length&&(n["!merges"]=x),n}function tF(e,t,r,n){for(var i=e["!merges"]||[],a=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,u=0,f=0;f<i.length;++f)if(!(i[f].s.r>r||i[f].s.c>o)&&!(i[f].e.r<r||i[f].e.c<o)){if(i[f].s.r<r||i[f].s.c<o){l=-1;break}l=i[f].e.r-i[f].s.r+1,u=i[f].e.c-i[f].s.c+1;break}if(!(l<0)){var d=Ue({r,c:o}),m=n.dense?(e[r]||[])[o]:e[d],p=m&&m.v!=null&&(m.h||Rp(m.w||(Ci(m),m.w)||""))||"",v={};l>1&&(v.rowspan=l),u>1&&(v.colspan=u),n.editable?p='<span contenteditable="true">'+p+"</span>":m&&(v["data-t"]=m&&m.t||"z",m.v!=null&&(v["data-v"]=m.v),m.z!=null&&(v["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+m.l.Target+'">'+p+"</a>")),v.id=(n.id||"sjs")+"-"+d,a.push(zb("td",p,v))}}var x="<tr>";return x+a.join("")+"</tr>"}var rF='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',nF="</body></html>";function iF(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return da(_v(r[0],t),t);var n=qp();return r.forEach(function(i,a){Xp(n,_v(i,t),"Sheet"+(a+1))}),n}function aF(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function sF(e,t){var r=t||{},n=r.header!=null?r.header:rF,i=r.footer!=null?r.footer:nF,a=[n],o=fo(e["!ref"]);r.dense=Array.isArray(e),a.push(aF(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)a.push(tF(e,o,l,r));return a.push("</table>"+i),a.join("")}function K2(e,t,r){var n=r||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?Ar(n.origin):n.origin;i=o.r,a=o.c}var l=t.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,l.length),f={s:{r:0,c:0},e:{r:i,c:a}};if(e["!ref"]){var d=fo(e["!ref"]);f.s.r=Math.min(f.s.r,d.s.r),f.s.c=Math.min(f.s.c,d.s.c),f.e.r=Math.max(f.e.r,d.e.r),f.e.c=Math.max(f.e.c,d.e.c),i==-1&&(f.e.r=i=d.e.r+1)}var m=[],p=0,v=e["!rows"]||(e["!rows"]=[]),x=0,_=0,S=0,w=0,k=0,y=0;for(e["!cols"]||(e["!cols"]=[]);x<l.length&&_<u;++x){var b=l[x];if(xv(b)){if(n.display)continue;v[_]={hidden:!0}}var O=b.children;for(S=w=0;S<O.length;++S){var R=O[S];if(!(n.display&&xv(R))){var C=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):Wy(R.innerHTML),z=R.getAttribute("data-z")||R.getAttribute("z");for(p=0;p<m.length;++p){var M=m[p];M.s.c==w+a&&M.s.r<_+i&&_+i<=M.e.r&&(w=M.e.c+1-a,p=-1)}y=+R.getAttribute("colspan")||1,((k=+R.getAttribute("rowspan")||1)>1||y>1)&&m.push({s:{r:_+i,c:w+a},e:{r:_+i+(k||1)-1,c:w+a+(y||1)-1}});var K={t:"s",v:C},G=R.getAttribute("data-t")||R.getAttribute("t")||"";C!=null&&(C.length==0?K.t=G||"z":n.raw||C.trim().length==0||G=="s"||(C==="TRUE"?K={t:"b",v:!0}:C==="FALSE"?K={t:"b",v:!1}:isNaN(jn(C))?isNaN(no(C).getDate())||(K={t:"d",v:Jt(C)},n.cellDates||(K={t:"n",v:Rr(K.v)}),K.z=n.dateNF||He[14]):K={t:"n",v:jn(C)})),K.z===void 0&&z!=null&&(K.z=z);var X="",Y=R.getElementsByTagName("A");if(Y&&Y.length)for(var de=0;de<Y.length&&!(Y[de].hasAttribute("href")&&(X=Y[de].getAttribute("href"),X.charAt(0)!="#"));++de);X&&X.charAt(0)!="#"&&(K.l={Target:X}),n.dense?(e[_+i]||(e[_+i]=[]),e[_+i][w+a]=K):e[Ue({c:w+a,r:_+i})]=K,f.e.c<w+a&&(f.e.c=w+a),w+=y}}++_}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),f.e.r=Math.max(f.e.r,_-1+i),e["!ref"]=et(f),_>=u&&(e["!fullref"]=et((f.e.r=l.length-x+_-1+i,f))),e}function q2(e,t){var r=t||{},n=r.dense?[]:{};return K2(n,e,t)}function oF(e,t){return da(q2(e,t),t)}function xv(e){var t="",r=lF(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function lF(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function cF(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=rt(t.replace(/<[^>]*>/g,""));return[r]}var yv={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function X2(e,t){var r=t||{},n=Fp(e),i=[],a,o,l={name:""},u="",f=0,d,m,p={},v=[],x=r.dense?[]:{},_,S,w={value:""},k="",y=0,b=[],O=-1,R=-1,C={s:{r:1e6,c:1e7},e:{r:0,c:0}},z=0,M={},K=[],G={},X=0,Y=0,de=[],he=1,me=1,ge=[],J={Names:[]},q={},ce=["",""],_e=[],N={},Z="",H=0,W=!1,te=!1,xe=0;for(zl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");_=zl.exec(n);)switch(_[3]=_[3].replace(/_.*$/,"")){case"table":case"":_[1]==="/"?(C.e.c>=C.s.c&&C.e.r>=C.s.r?x["!ref"]=et(C):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=C.e.r&&(x["!fullref"]=x["!ref"],C.e.r=r.sheetRows-1,x["!ref"]=et(C)),K.length&&(x["!merges"]=K),de.length&&(x["!rows"]=de),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),v.push(d.name),p[d.name]=x,te=!1):_[0].charAt(_[0].length-2)!=="/"&&(d=Be(_[0],!1),O=R=-1,C.s.r=C.s.c=1e7,C.e.r=C.e.c=0,x=r.dense?[]:{},K=[],de=[],te=!0);break;case"table-row-group":_[1]==="/"?--z:++z;break;case"table-row":case"":if(_[1]==="/"){O+=he,he=1;break}if(m=Be(_[0],!1),m.?O=m.-1:O==-1&&(O=0),he=+m["number-rows-repeated"]||1,he<10)for(xe=0;xe<he;++xe)z>0&&(de[O+xe]={level:z});R=-1;break;case"covered-table-cell":_[1]!=="/"&&++R,r.sheetStubs&&(r.dense?(x[O]||(x[O]=[]),x[O][R]={t:"z"}):x[Ue({r:O,c:R})]={t:"z"}),k="",b=[];break;case"table-cell":case"":if(_[0].charAt(_[0].length-2)==="/")++R,w=Be(_[0],!1),me=parseInt(w["number-columns-repeated"]||"1",10),S={t:"z",v:null},w.formula&&r.cellFormula!=!1&&(S.f=pv(rt(w.formula))),(w.||w["value-type"])=="string"&&(S.t="s",S.v=rt(w["string-value"]||""),r.dense?(x[O]||(x[O]=[]),x[O][R]=S):x[Ue({r:O,c:R})]=S),R+=me-1;else if(_[1]!=="/"){++R,k="",y=0,b=[],me=1;var Te=he?O+he-1:O;if(R>C.e.c&&(C.e.c=R),R<C.s.c&&(C.s.c=R),O<C.s.r&&(C.s.r=O),Te>C.e.r&&(C.e.r=Te),w=Be(_[0],!1),_e=[],N={},S={t:w.||w["value-type"],v:null},r.cellFormula)if(w.formula&&(w.formula=rt(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(X=parseInt(w["number-matrix-rows-spanned"],10)||0,Y=parseInt(w["number-matrix-columns-spanned"],10)||0,G={s:{r:O,c:R},e:{r:O+X-1,c:R+Y-1}},S.F=et(G),ge.push([G,S.F])),w.formula)S.f=pv(w.formula);else for(xe=0;xe<ge.length;++xe)O>=ge[xe][0].s.r&&O<=ge[xe][0].e.r&&R>=ge[xe][0].s.c&&R<=ge[xe][0].e.c&&(S.F=ge[xe][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(X=parseInt(w["number-rows-spanned"],10)||0,Y=parseInt(w["number-columns-spanned"],10)||0,G={s:{r:O,c:R},e:{r:O+X-1,c:R+Y-1}},K.push(G)),w["number-columns-repeated"]&&(me=parseInt(w["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=gt(w["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(w.value);break;case"percentage":S.t="n",S.v=parseFloat(w.value);break;case"currency":S.t="n",S.v=parseFloat(w.value);break;case"date":S.t="d",S.v=Jt(w["date-value"]),r.cellDates||(S.t="n",S.v=Rr(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=kb(w["time-value"])/86400,r.cellDates&&(S.t="d",S.v=y0(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(w.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",w["string-value"]!=null&&(k=rt(w["string-value"]),b=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(W=!1,S.t==="s"&&(S.v=k||"",b.length&&(S.R=b),W=y==0),q.Target&&(S.l=q),_e.length>0&&(S.c=_e,_e=[]),k&&r.cellText!==!1&&(S.w=k),W&&(S.t="z",delete S.v),(!W||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=O))for(var ee=0;ee<he;++ee){if(me=parseInt(w["number-columns-repeated"]||"1",10),r.dense)for(x[O+ee]||(x[O+ee]=[]),x[O+ee][R]=ee==0?S:sr(S);--me>0;)x[O+ee][R+me]=sr(S);else for(x[Ue({r:O+ee,c:R})]=S;--me>0;)x[Ue({r:O+ee,c:R+me})]=sr(S);C.e.c<=R&&(C.e.c=R)}me=parseInt(w["number-columns-repeated"]||"1",10),R+=me-1,me=0,S={},k="",b=[]}q={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(_[1]==="/"){if((a=i.pop())[0]!==_[3])throw"Bad state: "+a}else _[0].charAt(_[0].length-2)!=="/"&&i.push([_[3],!0]);break;case"annotation":if(_[1]==="/"){if((a=i.pop())[0]!==_[3])throw"Bad state: "+a;N.t=k,b.length&&(N.R=b),N.a=Z,_e.push(N)}else _[0].charAt(_[0].length-2)!=="/"&&i.push([_[3],!1]);Z="",H=0,k="",y=0,b=[];break;case"creator":_[1]==="/"?Z=n.slice(H,_.index):H=_.index+_[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(_[1]==="/"){if((a=i.pop())[0]!==_[3])throw"Bad state: "+a}else _[0].charAt(_[0].length-2)!=="/"&&i.push([_[3],!1]);k="",y=0,b=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(_[1]==="/"){if(M[l.name]=u,(a=i.pop())[0]!==_[3])throw"Bad state: "+a}else _[0].charAt(_[0].length-2)!=="/"&&(u="",l=Be(_[0],!1),i.push([_[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Be(_[0],!1),u+=yv[_[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Be(_[0],!1),u+=yv[_[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(_[0].slice(-2)==="/>")break;if(_[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(f,_.index);break}else f=_.index+_[0].length;break;case"named-range":o=Be(_[0],!1),ce=Kf(o["cell-range-address"]);var oe={Name:o.name,Ref:ce[0]+"!"+ce[1]};te&&(oe.Sheet=v.length),J.Names.push(oe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(_[1]==="/"&&(!w||!w["string-value"])){var Ae=cF(n.slice(y,_.index));k=(k.length>0?k+`
`:"")+Ae[0]}else Be(_[0],!1),y=_.index+_[0].length;break;case"s":break;case"database-range":if(_[1]==="/")break;try{ce=Kf(Be(_[0])["target-range-address"]),p[ce[0]]["!autofilter"]={ref:ce[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(_[1]!=="/"){if(q=Be(_[0],!1),!q.href)break;q.Target=rt(q.href),delete q.href,q.Target.charAt(0)=="#"&&q.Target.indexOf(".")>-1?(ce=Kf(q.Target.slice(1)),q.Target="#"+ce[0]+"!"+ce[1]):q.Target.match(/^\.\.[\\\/]/)&&(q.Target=q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(_[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(_)}}var D={Sheets:p,SheetNames:v,Workbook:J};return r.bookSheets&&delete D.Sheets,D}function wv(e,t){t=t||{},fn(e,"META-INF/manifest.xml")&&TA(Nt(e,"META-INF/manifest.xml"),t);var r=qr(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=X2(ut(r),t);return fn(e,"meta.xml")&&(n.Props=c2(Nt(e,"meta.xml"))),n}function kv(e,t){return X2(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Vp(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function _d(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):ut(Ja(e))}function xd(e){var t=e.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function Ev(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function uF(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Vl(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Ht(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function _r(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=Vl(e,r),a=i&7;i=Math.floor(i/8);var o=0,l;if(i==0)break;switch(a){case 0:{for(var u=r[0];e[r[0]++]>=128;);l=e.slice(u,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Vl(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var f={data:l,type:a};t[i]==null?t[i]=[f]:t[i].push(f)}return t}function Gp(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function fF(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=Vl(e,n),a=_r(e.slice(n[0],n[0]+i));n[0]+=i;var o={id:Ht(a[1][0].data),messages:[]};a[2].forEach(function(l){var u=_r(l.data),f=Ht(u[3][0].data);o.messages.push({meta:u,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(t=a[3])!=null&&t[0]&&(o.merge=Ht(a[3][0].data)>>>0>0),r.push(o)}return r}function hF(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Vl(t,r),i=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}i.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var u=0,f=0;if(a==1?(f=(t[r[0]]>>2&7)+4,u=(t[r[0]++]&224)<<3,u|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,a==2?(u=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(u=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[xd(i)],u==0)throw new Error("Invalid offset 0");if(u>i[0].length)throw new Error("Invalid offset beyond length");if(f>=u)for(i.push(i[0].slice(-u)),f-=u;f>=i[i.length-1].length;)i.push(i[i.length-1]),f-=i[i.length-1].length;i.push(i[0].slice(-u,-u+f))}}var d=xd(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function dF(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(hF(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return xd(t)}function pF(e,t,r,n){var i=Vp(e),a=i.getUint32(4,!0),o=(n>1?12:8)+Ev(a&(n>1?3470:398))*4,l=-1,u=-1,f=NaN,d=new Date(2001,0,1);a&512&&(l=i.getUint32(o,!0),o+=4),o+=Ev(a&(n>1?12288:4096))*4,a&16&&(u=i.getUint32(o,!0),o+=4),a&32&&(f=i.getFloat64(o,!0),o+=8),a&64&&(d.setTime(d.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:f};break;case 3:m={t:"s",v:t[u]};break;case 5:m={t:"d",v:d};break;case 6:m={t:"b",v:f>0};break;case 7:m={t:"n",v:f/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:r[l]};else if(u>-1)m={t:"s",v:t[u]};else if(!isNaN(f))m={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function mF(e,t,r){var n=Vp(e),i=n.getUint32(8,!0),a=12,o=-1,l=-1,u=NaN,f=NaN,d=new Date(2001,0,1);i&1&&(u=uF(e,a),a+=16),i&2&&(f=n.getFloat64(a,!0),a+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),i&8&&(l=n.getUint32(a,!0),a+=4),i&16&&(o=n.getUint32(a,!0),a+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:u};break;case 3:m={t:"s",v:t[l]};break;case 5:m={t:"d",v:d};break;case 6:m={t:"b",v:f>0};break;case 7:m={t:"n",v:f/86400};break;case 8:m={t:"e",v:0};break;case 9:if(o>-1)m={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return m}function gF(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return pF(e,t,r,e[0]);case 5:return mF(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function aa(e){var t=_r(e);return Vl(t[1][0].data)}function Sv(e,t){var r=_r(t.data),n=Ht(r[1][0].data),i=r[3],a=[];return(i||[]).forEach(function(o){var l=_r(o.data),u=Ht(l[1][0].data)>>>0;switch(n){case 1:a[u]=_d(l[3][0].data);break;case 8:{var f=e[aa(l[9][0].data)][0],d=_r(f.data),m=e[aa(d[1][0].data)][0],p=Ht(m.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var v=_r(m.data);a[u]=v[3].map(function(x){return _d(x.data)}).join("")}break}}),a}function vF(e,t){var r,n,i,a,o,l,u,f,d,m,p,v,x,_,S=_r(e),w=Ht(S[1][0].data)>>>0,k=Ht(S[2][0].data)>>>0,y=((n=(r=S[8])==null?void 0:r[0])==null?void 0:n.data)&&Ht(S[8][0].data)>0||!1,b,O;if((a=(i=S[7])==null?void 0:i[0])!=null&&a.data&&t!=0)b=(l=(o=S[7])==null?void 0:o[0])==null?void 0:l.data,O=(f=(u=S[6])==null?void 0:u[0])==null?void 0:f.data;else if((m=(d=S[4])==null?void 0:d[0])!=null&&m.data&&t!=1)b=(v=(p=S[4])==null?void 0:p[0])==null?void 0:v.data,O=(_=(x=S[3])==null?void 0:x[0])==null?void 0:_.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var R=y?4:1,C=Vp(b),z=[],M=0;M<b.length/2;++M){var K=C.getUint16(M*2,!0);K<65535&&z.push([M,K])}if(z.length!=k)throw"Expected ".concat(k," cells, found ").concat(z.length);var G=[];for(M=0;M<z.length-1;++M)G[z[M][0]]=O.subarray(z[M][1]*R,z[M+1][1]*R);return z.length>=1&&(G[z[z.length-1][0]]=O.subarray(z[z.length-1][1]*R)),{R:w,cells:G}}function _F(e,t){var r,n=_r(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Ht(n[7][0].data)>>>0>0?1:0:-1,a=Gp(n[5],function(o){return vF(o,i)});return{nrows:Ht(n[4][0].data)>>>0,data:a.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(u,f){if(o[l.R][f])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(f));o[l.R][f]=u}),o},[])}}function xF(e,t,r){var n,i=_r(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Ht(i[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(a.e.c=(Ht(i[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=et(a);var o=_r(i[4][0].data),l=Sv(e,e[aa(o[4][0].data)][0]),u=(n=o[17])!=null&&n[0]?Sv(e,e[aa(o[17][0].data)][0]):[],f=_r(o[3][0].data),d=0;f[1].forEach(function(m){var p=_r(m.data),v=e[aa(p[2][0].data)][0],x=Ht(v.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var _=_F(e,v);_.data.forEach(function(S,w){S.forEach(function(k,y){var b=Ue({r:d+w,c:y}),O=gF(k,l,u);O&&(r[b]=O)})}),d+=_.nrows})}function yF(e,t){var r=_r(t.data),n={"!ref":"A1"},i=e[aa(r[2][0].data)],a=Ht(i[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return xF(e,i[0],n),n}function wF(e,t){var r,n=_r(t.data),i={name:(r=n[1])!=null&&r[0]?_d(n[1][0].data):"",sheets:[]},a=Gp(n[2],aa);return a.forEach(function(o){e[o].forEach(function(l){var u=Ht(l.meta[1][0].data);u==6e3&&i.sheets.push(yF(e,l))})}),i}function kF(e,t){var r=qp(),n=_r(t.data),i=Gp(n[1],aa);if(i.forEach(function(a){e[a].forEach(function(o){var l=Ht(o.meta[1][0].data);if(l==2){var u=wF(e,o);u.sheets.forEach(function(f,d){Xp(r,f,d==0?u.name:u.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Xf(e){var t,r,n,i,a={},o=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var f;try{f=dF(u.content)}catch(m){return console.log("?? "+u.content.length+" "+(m.message||m))}var d;try{d=fF(f)}catch(m){return console.log("## "+(m.message||m))}d.forEach(function(m){a[m.id]=m.messages,o.push(m.id)})}}),!o.length)throw new Error("File has no messages");var l=((i=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Ht(a[1][0].meta[1][0].data)==1&&a[1][0];if(l||o.forEach(function(u){a[u].forEach(function(f){var d=Ht(f.meta[1][0].data)>>>0;if(d==1)if(!l)l=f;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return kF(a,l)}function EF(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Zp(e){EF([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function SF(e){return js.WS.indexOf(e)>-1?"sheet":e==js.CS?"chart":e==js.DS?"dialog":e==js.MS?"macro":e&&e.length?e:"sheet"}function TF(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,SF(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function CF(e,t,r,n,i,a,o,l,u,f,d,m){try{a[n]=cl(qr(e,r,!0),t);var p=Nt(e,t),v;switch(l){case"sheet":v=FR(p,t,i,u,a[n],f,d,m);break;case"chart":if(v=LR(p,t,i,u,a[n],f,d,m),!v||!v["!drawel"])break;var x=Zo(v["!drawel"].Target,t),_=dd(x),S=R6(qr(e,x,!0),cl(qr(e,_,!0),x)),w=Zo(S,x),k=dd(w);v=mR(qr(e,w,!0),w,u,cl(qr(e,k,!0),w),f,v);break;case"macro":v=IR(p,t,i,u,a[n],f,d,m);break;case"dialog":v=NR(p,t,i,u,a[n],f,d,m);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=v;var y=[];a&&a[n]&&ti(a[n]).forEach(function(b){var O="";if(a[n][b].Type==js.CMNT){O=Zo(a[n][b].Target,t);var R=jR(Nt(e,O,!0),O,u);if(!R||!R.length)return;cv(v,R,!1)}a[n][b].Type==js.TCMNT&&(O=Zo(a[n][b].Target,t),y=y.concat(L6(Nt(e,O,!0),u)))}),y&&y.length&&cv(v,y,!0,u.people||[])}catch(b){if(u.WTF)throw b}}function cn(e){return e.charAt(0)=="/"?e.slice(1):e}function bF(e,t){if(Iy(),t=t||{},Zp(t),fn(e,"META-INF/manifest.xml")||fn(e,"objectdata.xml"))return wv(e,t);if(fn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Xf<"u"){if(e.FileIndex)return Xf(e);var r=Qe.utils.cfb_new();return Dg(e).forEach(function(de){Ab(r,de,bb(e,de))}),Xf(r)}throw new Error("Unsupported NUMBERS file")}if(!fn(e,"[Content_Types].xml"))throw fn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):fn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Dg(e),i=EA(qr(e,"[Content_Types].xml")),a=!1,o,l;if(i.workbooks.length===0&&(l="xl/workbook.xml",Nt(e,l,!0)&&i.workbooks.push(l)),i.workbooks.length===0){if(l="xl/workbook.bin",!Nt(e,l,!0))throw new Error("Could not find workbook");i.workbooks.push(l),a=!0}i.workbooks[0].slice(-3)=="bin"&&(a=!0);var u={},f={};if(!t.bookSheets&&!t.bookProps){if(hl=[],i.sst)try{hl=BR(Nt(e,cn(i.sst)),i.sst,t)}catch(de){if(t.WTF)throw de}t.cellStyles&&i.themes.length&&(u=MR(qr(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(f=DR(Nt(e,cn(i.style)),i.style,u,t))}i.links.map(function(de){try{var he=cl(qr(e,dd(cn(de))),de);return zR(Nt(e,cn(de)),he,de,t)}catch{}});var d=RR(Nt(e,cn(i.workbooks[0])),i.workbooks[0],t),m={},p="";i.coreprops.length&&(p=Nt(e,cn(i.coreprops[0]),!0),p&&(m=c2(p)),i.extprops.length!==0&&(p=Nt(e,cn(i.extprops[0]),!0),p&&AA(p,m,t)));var v={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(p=qr(e,cn(i.custprops[0]),!0),p&&(v=OA(p,t)));var x={};if((t.bookSheets||t.bookProps)&&(d.Sheets?o=d.Sheets.map(function(he){return he.name}):m.Worksheets&&m.SheetNames.length>0&&(o=m.SheetNames),t.bookProps&&(x.Props=m,x.Custprops=v),t.bookSheets&&typeof o<"u"&&(x.SheetNames=o),t.bookSheets?x.SheetNames:t.bookProps))return x;o={};var _={};t.bookDeps&&i.calcchain&&(_=UR(Nt(e,cn(i.calcchain)),i.calcchain));var S=0,w={},k,y;{var b=d.Sheets;m.Worksheets=b.length,m.SheetNames=[];for(var O=0;O!=b.length;++O)m.SheetNames[O]=b[O].name}var R=a?"bin":"xml",C=i.workbooks[0].lastIndexOf("/"),z=(i.workbooks[0].slice(0,C+1)+"_rels/"+i.workbooks[0].slice(C+1)+".rels").replace(/^\//,"");fn(e,z)||(z="xl/_rels/workbook."+R+".rels");var M=cl(qr(e,z,!0),z.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=$R(Nt(e,cn(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=I6(Nt(e,cn(i.people[0])),t)),M&&(M=TF(M,d.Sheets));var K=Nt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=m.Worksheets;++S){var G="sheet";if(M&&M[S]?(k="xl/"+M[S][1].replace(/[\/]?xl\//,""),fn(e,k)||(k=M[S][1]),fn(e,k)||(k=z.replace(/_rels\/.*$/,"")+M[S][1]),G=M[S][2]):(k="xl/worksheets/sheet"+(S+1-K)+"."+R,k=k.replace(/sheet0\./,"sheet.")),y=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(S!=t.sheets)continue e;break;case"string":if(m.SheetNames[S].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var X=!1,Y=0;Y!=t.sheets.length;++Y)typeof t.sheets[Y]=="number"&&t.sheets[Y]==S&&(X=1),typeof t.sheets[Y]=="string"&&t.sheets[Y].toLowerCase()==m.SheetNames[S].toLowerCase()&&(X=1);if(!X)continue e}}CF(e,k,y,m.SheetNames[S],S,w,o,G,t,d,u,f)}return x={Directory:i,Workbook:d,Props:m,Custprops:v,Deps:_,Sheets:o,SheetNames:m.SheetNames,Strings:hl,Styles:f,Themes:u,SSF:sr(He)},t&&t.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(de,he){de=de.replace(/^Root Entry[\/]/,""),x.keys.push(de),x.files[de]=e.FileIndex[he]}))),t&&t.bookVBA&&(i.vba.length>0?x.vbaraw=Nt(e,cn(i.vba[0]),!0):i.defaults&&i.defaults.bin===B6&&(x.vbaraw=Nt(e,"xl/vbaProject.bin",!0))),x}function AF(e,t){var r=t||{},n="Workbook",i=Qe.find(e,n);try{if(n="/!DataSpaces/Version",i=Qe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(y8(i.content),n="/!DataSpaces/DataSpaceMap",i=Qe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=k8(i.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Qe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=E8(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Qe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);T8(i.content)}catch{}if(n="/EncryptionInfo",i=Qe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=C8(i.content);if(n="/EncryptedPackage",i=Qe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],i.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function Kp(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Qr(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function PF(e,t){return Qe.find(e,"EncryptedPackage")?AF(e,t):Z2(e,t)}function OF(e,t){var r,n=e,i=t||{};return i.type||(i.type=Ye&&Buffer.isBuffer(e)?"buffer":"base64"),r=Uy(n,i),bF(r,i)}function Y2(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return gd(e.slice(r),t);default:break e}return $l.to_workbook(e,t)}function RF(e,t){var r="",n=Kp(e,t);switch(t.type){case"base64":r=Qr(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ga(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=ut(r)),t.type="binary",Y2(r,t)}function FF(e,t){var r=e;return t.type=="base64"&&(r=Qr(r)),r=Bl.utils.decode(1200,r.slice(2),"str"),t.type="binary",Y2(r,t)}function LF(e){return e.match(/[^\x00-\x7F]/)?Ko(e):e}function Yf(e,t,r,n){return n?(r.type="string",$l.to_workbook(e,r)):$l.to_workbook(t,r)}function yd(e,t){ky();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return yd(new Uint8Array(e),(r=sr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),qs={},r.dateNF&&(qs.dateNF=r.dateNF),r.type||(r.type=Ye&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ye?"buffer":"binary",n=yb(e),typeof Uint8Array<"u"&&!Ye&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=LF(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=sr(r),r.type="array",yd(Cp(n),r)}switch((i=Kp(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return PF(Qe.read(n,r),r);break;case 9:if(i[1]<=8)return Z2(n,r);break;case 60:return gd(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return o8(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return a8.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?OF(n,r):Yf(e,n,r,a);case 239:return i[3]===60?gd(n,r):Yf(e,n,r,a);case 255:if(i[1]===254)return FF(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return fl.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return fl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return lv.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return B8.to_workbook(n,r);break;case 10:case 13:case 32:return RF(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return n8.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?lv.to_workbook(n,r):Yf(e,n,r,a)}function IF(e,t,r,n,i,a,o,l){var u=or(r),f=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),m=!0,p=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!o||e[r])for(var v=t.s.c;v<=t.e.c;++v){var x=o?e[r][v]:e[n[v]+u];if(x===void 0||x.t===void 0){if(f===void 0)continue;a[v]!=null&&(p[a[v]]=f);continue}var _=x.v;switch(x.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(a[v]!=null){if(_==null)if(x.t=="e"&&_===null)p[a[v]]=null;else if(f!==void 0)p[a[v]]=f;else if(d&&_===null)p[a[v]]=null;else continue;else p[a[v]]=d&&(x.t!=="n"||x.t==="n"&&l.rawNumbers!==!1)?_:Ci(x,_,l);_!=null&&(m=!1)}}return{row:p,isempty:m}}function wd(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],o=0,l="",u={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},d=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof d){case"string":u=bt(d);break;case"number":u=bt(e["!ref"]),u.s.r=d;break;default:u=d}n>0&&(i=0);var m=or(u.s.r),p=[],v=[],x=0,_=0,S=Array.isArray(e),w=u.s.r,k=0,y={};S&&!e[w]&&(e[w]=[]);var b=f.skipHidden&&e["!cols"]||[],O=f.skipHidden&&e["!rows"]||[];for(k=u.s.c;k<=u.e.c;++k)if(!(b[k]||{}).hidden)switch(p[k]=Wt(k),r=S?e[w][k]:e[p[k]+m],n){case 1:a[k]=k-u.s.c;break;case 2:a[k]=p[k];break;case 3:a[k]=f.header[k-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=Ci(r,null,f),_=y[o]||0,!_)y[o]=1;else{do l=o+"_"+_++;while(y[l]);y[o]=_,y[l]=1}a[k]=l}for(w=u.s.r+i;w<=u.e.r;++w)if(!(O[w]||{}).hidden){var R=IF(e,u,w,p,n,a,S,f);(R.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(v[x++]=R.row)}return v.length=x,v}var Tv=/"/g;function NF(e,t,r,n,i,a,o,l){for(var u=!0,f=[],d="",m=or(r),p=t.s.c;p<=t.e.c;++p)if(n[p]){var v=l.dense?(e[r]||[])[p]:e[n[p]+m];if(v==null)d="";else if(v.v!=null){u=!1,d=""+(l.rawNumbers&&v.t=="n"?v.v:Ci(v,null,l));for(var x=0,_=0;x!==d.length;++x)if((_=d.charCodeAt(x))===i||_===a||_===34||l.forceQuotes){d='"'+d.replace(Tv,'""')+'"';break}d=="ID"&&(d='"ID"')}else v.f!=null&&!v.F?(u=!1,d="="+v.f,d.indexOf(",")>=0&&(d='"'+d.replace(Tv,'""')+'"')):d="";f.push(d)}return l.blankrows===!1&&u?null:f.join(o)}function J2(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=bt(e["!ref"]),a=n.FS!==void 0?n.FS:",",o=a.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,u=l.charCodeAt(0),f=new RegExp((a=="|"?"\\|":a)+"+$"),d="",m=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],v=n.skipHidden&&e["!rows"]||[],x=i.s.c;x<=i.e.c;++x)(p[x]||{}).hidden||(m[x]=Wt(x));for(var _=0,S=i.s.r;S<=i.e.r;++S)(v[S]||{}).hidden||(d=NF(e,i,S,m,o,u,a,n),d!=null&&(n.strip&&(d=d.replace(f,"")),(d||n.blankrows!==!1)&&r.push((_++?l:"")+d)));return delete n.dense,r.join("")}function DF(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=J2(e,t);return r}function MF(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=bt(e["!ref"]),a="",o=[],l,u=[],f=Array.isArray(e);for(l=i.s.c;l<=i.e.c;++l)o[l]=Wt(l);for(var d=i.s.r;d<=i.e.r;++d)for(a=or(d),l=i.s.c;l<=i.e.c;++l)if(t=o[l]+a,r=f?(e[d]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=t+"="+n}return u}function Q2(e,t,r){var n=r||{},i=+!n.skipHeader,a=e||{},o=0,l=0;if(a&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?Ar(n.origin):n.origin;o=u.r,l=u.c}var f,d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+i}};if(a["!ref"]){var m=bt(a["!ref"]);d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),o==-1&&(o=m.e.r+1,d.e.r=o+t.length-1+i)}else o==-1&&(o=0,d.e.r=t.length-1+i);var p=n.header||[],v=0;t.forEach(function(_,S){ti(_).forEach(function(w){(v=p.indexOf(w))==-1&&(p[v=p.length]=w);var k=_[w],y="z",b="",O=Ue({c:l+v,r:o+S+i});f=Gl(a,O),k&&typeof k=="object"&&!(k instanceof Date)?a[O]=k:(typeof k=="number"?y="n":typeof k=="boolean"?y="b":typeof k=="string"?y="s":k instanceof Date?(y="d",n.cellDates||(y="n",k=Rr(k)),b=n.dateNF||He[14]):k===null&&n.nullError&&(y="e",k=0),f?(f.t=y,f.v=k,delete f.w,delete f.R,b&&(f.z=b)):a[O]=f={t:y,v:k},b&&(f.z=b))})}),d.e.c=Math.max(d.e.c,l+p.length-1);var x=or(o);if(i)for(v=0;v<p.length;++v)a[Wt(v+l)+x]={t:"s",v:p[v]};return a["!ref"]=et(d),a}function BF(e,t){return Q2(null,e,t)}function Gl(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Ar(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Gl(e,Ue(t)):Gl(e,Ue({r:t,c:r||0}))}function jF(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function qp(){return{SheetNames:[],Sheets:{}}}function Xp(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var o=a&&a[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=o+i)!=-1;++i);}if(ER(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function UF(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=jF(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function zF(e,t){return e.z=t,e}function ew(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function $F(e,t,r){return ew(e,"#"+t,r)}function WF(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function HF(e,t,r,n){for(var i=typeof t!="string"?t:bt(t),a=typeof t=="string"?t:et(t),o=i.s.r;o<=i.e.r;++o)for(var l=i.s.c;l<=i.e.c;++l){var u=Gl(e,o,l);u.t="n",u.F=a,delete u.v,o==i.s.r&&l==i.s.c&&(u.f=r,n&&(u.D=!0))}return e}var VF={encode_col:Wt,encode_row:or,encode_cell:Ue,encode_range:et,decode_col:Np,decode_row:Ip,split_cell:rA,decode_cell:Ar,decode_range:fo,format_cell:Ci,sheet_add_aoa:i2,sheet_add_json:Q2,sheet_add_dom:K2,aoa_to_sheet:ho,json_to_sheet:BF,table_to_sheet:q2,table_to_book:oF,sheet_to_csv:J2,sheet_to_txt:DF,sheet_to_json:wd,sheet_to_html:sF,sheet_to_formulae:MF,sheet_to_row_object_array:wd,sheet_get_cell:Gl,book_new:qp,book_append_sheet:Xp,book_set_sheet_visibility:UF,cell_set_number_format:zF,cell_set_hyperlink:ew,cell_set_internal_link:$F,cell_add_comment:WF,sheet_set_array_formula:HF,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};async function Cv(e){return new Promise((t,r)=>{const n=new FileReader;n.onload=i=>{var a;try{const o=(a=i.target)==null?void 0:a.result,l=yd(o,{type:"array"}),u=l.Sheets[l.SheetNames[0]],d=VF.sheet_to_json(u).map(m=>({name:m.name||m.Name||m.title||m.Title||m.NAME||"Untitled Source",url:m.url||m.URL||m.link||m.Link||m.LINK||"",country:m.country||m.Country||m.COUNTRY||null,enabled:m.enabled!==void 0?m.enabled:!0}));t(d)}catch(o){r(o)}},n.onerror=()=>r(new Error("Failed to read file")),n.readAsArrayBuffer(e)})}function GF({onUploadComplete:e,accessToken:t}){const[r,n]=ie.useState(!1),[i,a]=ie.useState(null),[o,l]=ie.useState([]),[u,f]=ie.useState(null),d=async p=>{var x;const v=(x=p.target.files)==null?void 0:x[0];if(v){console.log("File selected:",v.name,v.type,v.size),a(null),f(null),l([]);try{console.log("Starting to parse Excel file...");const _=await Cv(v);if(console.log("Parsed sources:",_),_.length===0){a("No sources found in the Excel file. Make sure it has columns: name, url, country");return}l(_.slice(0,5)),console.log(`Successfully parsed ${_.length} sources from Excel`)}catch(_){console.error("Parse error:",_),a(`Failed to parse Excel file: ${_.message}`)}}},m=async()=>{var p;if(console.log("=== STARTING UPLOAD ==="),o.length===0){a("No sources to upload");return}n(!0),a(null),f(null);try{const v=document.getElementById("excel-upload"),x=(p=v==null?void 0:v.files)==null?void 0:p[0];if(!x)throw new Error("File not found");console.log("Re-parsing file for upload...");const _=await Cv(x);console.log("Uploading",_.length,"sources to backend..."),console.log("Sources data:",JSON.stringify(_,null,2));const S=await MC(_,t);if(console.log("Upload result:",S),S.ok){const w=`Successfully uploaded ${S.count} sources!`;f(w),l([]),v.value="",console.log("Upload successful!"),e==null||e(S.count)}else throw new Error(S.error||"Upload failed - no error message")}catch(v){console.error("Upload error:",v),a(`Upload failed: ${v.message}`)}finally{n(!1),console.log("=== UPLOAD COMPLETE ===")}};return T.jsxs("div",{style:{padding:"1rem",border:"1px solid #ddd",borderRadius:"8px",marginBottom:"1rem",backgroundColor:"#f9f9f9"},children:[T.jsx("h3",{style:{marginTop:0},children:"Bulk Upload Sources (Excel)"}),T.jsxs("div",{style:{marginBottom:"1rem"},children:[T.jsx("input",{id:"excel-upload",type:"file",accept:".xlsx,.xls",onChange:d,disabled:r,style:{marginBottom:"0.5rem",padding:"0.5rem"}}),T.jsxs("p",{style:{fontSize:"0.875rem",color:"#666",margin:"0.5rem 0"},children:["Upload an Excel file with columns: ",T.jsx("strong",{children:"name"}),", ",T.jsx("strong",{children:"url"}),", ",T.jsx("strong",{children:"country"})," (optional)"]})]}),o.length>0&&T.jsxs("div",{style:{marginBottom:"1rem",padding:"1rem",backgroundColor:"#fff",borderRadius:"4px",border:"1px solid #e0e0e0"},children:[T.jsxs("h4",{style:{marginTop:0},children:["Preview (",o.length," of ",o.length," sources shown):"]}),T.jsx("ul",{style:{fontSize:"0.875rem",maxHeight:"200px",overflow:"auto",margin:"0.5rem 0"},children:o.map((p,v)=>T.jsxs("li",{style:{marginBottom:"0.5rem"},children:[T.jsx("strong",{children:p.name})," - ",T.jsx("code",{style:{fontSize:"0.8rem",backgroundColor:"#f0f0f0",padding:"2px 4px"},children:p.url}),p.country&&` (${p.country})`]},v))}),T.jsx("button",{onClick:m,disabled:r,style:{padding:"0.75rem 1.5rem",backgroundColor:r?"#ccc":"#4CAF50",color:"white",border:"none",borderRadius:"4px",cursor:r?"not-allowed":"pointer",fontSize:"1rem",fontWeight:"bold"},children:r?"Uploading...":`Upload ${o.length} Sources`})]}),u&&T.jsx("div",{style:{padding:"0.75rem",backgroundColor:"#d4edda",color:"#155724",borderRadius:"4px",marginTop:"1rem",border:"1px solid #c3e6cb"},children:u}),i&&T.jsx("div",{style:{padding:"0.75rem",backgroundColor:"#f8d7da",color:"#721c24",borderRadius:"4px",marginTop:"1rem",border:"1px solid #f5c6cb"},children:i})]})}const ZF="https://gnobnyzezkuyptuakztf.supabase.co/functions/v1/clever-function";function tw(){const[e,t]=ie.useState(null);return ie.useEffect(()=>{const r=setInterval(async()=>{const n=await fetch(`${ZF}/scour/status`);n.ok&&t(await n.json())},5e3);return()=>clearInterval(r)},[]),e!=null&&e.job?T.jsxs("div",{className:"p-2 bg-gray-100 border rounded text-sm",children:["Scour: ",e.job.processed,"/",e.job.total," processed"]}):null}function KF({sources:e,onSourceUpdated:t,accessToken:r}){const[n,i]=ie.useState(new Set),[a,o]=ie.useState(new Map),[l,u]=ie.useState(1),f=20,d=Math.ceil(e.length/f),m=(l-1)*f,p=e.slice(m,m+f),v=async(_,S)=>{try{await _y(`/sources/${_}`,{enabled:!S},r),t()}catch(w){console.error("Failed to toggle source:",w),alert("Failed to update source status")}},x=async(_,S)=>{i(w=>new Set(w).add(_));try{const w=await fetch(S,{method:"HEAD",mode:"no-cors"});o(k=>new Map(k).set(_,{ok:!0,status:w.status}))}catch{o(k=>new Map(k).set(_,{ok:!1}))}finally{i(w=>{const k=new Set(w);return k.delete(_),k})}};return e.length===0?T.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"#666"},children:"No sources configured. Use bulk upload to add sources."}):T.jsxs("div",{children:[T.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.875rem"},children:[T.jsx("thead",{children:T.jsxs("tr",{style:{backgroundColor:"#f3f4f6",borderBottom:"2px solid #e5e7eb"},children:[T.jsx("th",{style:{padding:"0.75rem",textAlign:"left"},children:"Name"}),T.jsx("th",{style:{padding:"0.75rem",textAlign:"left"},children:"URL"}),T.jsx("th",{style:{padding:"0.75rem",textAlign:"left"},children:"Country"}),T.jsx("th",{style:{padding:"0.75rem",textAlign:"center"},children:"Status"}),T.jsx("th",{style:{padding:"0.75rem",textAlign:"center"},children:"Actions"})]})}),T.jsx("tbody",{children:p.map(_=>{const S=a.get(_.id),w=n.has(_.id);return T.jsxs("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[T.jsx("td",{style:{padding:"0.75rem"},children:_.name}),T.jsx("td",{style:{padding:"0.75rem",maxWidth:"300px",overflow:"hidden",textOverflow:"ellipsis"},children:T.jsx("a",{href:_.url,target:"_blank",rel:"noopener noreferrer",style:{color:"#3b82f6"},children:_.url})}),T.jsx("td",{style:{padding:"0.75rem"},children:_.country||"-"}),T.jsxs("td",{style:{padding:"0.75rem",textAlign:"center"},children:[T.jsx("span",{style:{padding:"0.25rem 0.5rem",borderRadius:"0.25rem",fontSize:"0.75rem",fontWeight:"bold",backgroundColor:_.enabled?"#dcfce7":"#fee2e2",color:_.enabled?"#166534":"#991b1b"},children:_.enabled?"ENABLED":"DISABLED"}),S&&T.jsx("div",{style:{marginTop:"0.25rem",fontSize:"0.75rem"},children:S.ok?T.jsxs("span",{style:{color:"#16a34a"},children:[" OK ",S.status?`(${S.status})`:""]}):T.jsx("span",{style:{color:"#dc2626"},children:" UNREACHABLE"})})]}),T.jsxs("td",{style:{padding:"0.75rem",textAlign:"center"},children:[T.jsx("button",{onClick:()=>v(_.id,_.enabled),style:{padding:"0.25rem 0.75rem",marginRight:"0.5rem",fontSize:"0.75rem",borderRadius:"0.25rem",border:"1px solid #d1d5db",backgroundColor:"#fff",cursor:"pointer"},children:_.enabled?"Disable":"Enable"}),T.jsx("button",{onClick:()=>x(_.id,_.url),disabled:w,style:{padding:"0.25rem 0.75rem",fontSize:"0.75rem",borderRadius:"0.25rem",border:"1px solid #d1d5db",backgroundColor:w?"#e5e7eb":"#fff",cursor:w?"not-allowed":"pointer"},children:w?"Testing...":"Test"})]})]},_.id)})})]}),d>1&&T.jsxs("div",{style:{marginTop:"1rem",display:"flex",justifyContent:"center",gap:"0.5rem"},children:[T.jsx("button",{onClick:()=>u(_=>Math.max(1,_-1)),disabled:l===1,style:{padding:"0.5rem 1rem",borderRadius:"0.25rem",border:"1px solid #d1d5db",backgroundColor:l===1?"#e5e7eb":"#fff",cursor:l===1?"not-allowed":"pointer"},children:"Previous"}),T.jsxs("span",{style:{padding:"0.5rem 1rem"},children:["Page ",l," of ",d]}),T.jsx("button",{onClick:()=>u(_=>Math.min(d,_+1)),disabled:l===d,style:{padding:"0.5rem 1rem",borderRadius:"0.25rem",border:"1px solid #d1d5db",backgroundColor:l===d?"#e5e7eb":"#fff",cursor:l===d?"not-allowed":"pointer"},children:"Next"})]})]})}function qF({accessToken:e,isAdmin:t}){const[r,n]=ie.useState(null),[i,a]=ie.useState(!0),[o,l]=ie.useState(!1),[u,f]=ie.useState(!1),d=async()=>{try{a(!0);const O=await ei("/auto-scour/status",e);O.ok&&n({enabled:O.enabled,intervalMinutes:O.intervalMinutes,lastRun:O.lastRun,envEnabled:O.envEnabled})}catch(O){console.error("Failed to load auto-scour status:",O)}finally{a(!1)}};ie.useEffect(()=>{t&&d()},[t,e]);const m=async()=>{if(r)try{l(!0);const O=await Ha("/auto-scour/toggle",{enabled:!r.enabled,intervalMinutes:r.intervalMinutes},e);O.ok&&(n({...r,enabled:O.enabled}),alert(O.message))}catch(O){console.error("Failed to toggle auto-scour:",O),alert("Failed to toggle auto-scour: "+O.message)}finally{l(!1)}},p=async()=>{try{f(!0);const O=await Ha("/auto-scour/run-now",{},e);O.ok&&(alert(O.message+`
Job ID: `+O.jobId),await d())}catch(O){console.error("Failed to run auto-scour:",O),alert("Failed to run auto-scour: "+O.message)}finally{f(!1)}};if(!t)return null;if(i)return T.jsx("div",{style:{padding:"1.5rem",backgroundColor:"#f9fafb",borderRadius:"0.5rem",border:"1px solid #e5e7eb"},children:T.jsx("div",{style:{color:"#6b7280"},children:"Loading auto-scour settings..."})});if(!r)return null;const v={padding:"1.5rem",backgroundColor:r.enabled?"#ecfdf5":"#f9fafb",borderRadius:"0.5rem",border:`2px solid ${r.enabled?"#10b981":"#e5e7eb"}`,marginBottom:"2rem"},x={display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"},_={fontSize:"1.125rem",fontWeight:"600",display:"flex",alignItems:"center",gap:"0.5rem"},S={padding:"0.25rem 0.75rem",borderRadius:"9999px",fontSize:"0.75rem",fontWeight:"600",backgroundColor:r.enabled?"#10b981":"#6b7280",color:"white"},w={display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"1rem",fontSize:"0.875rem",color:"#4b5563"},k={padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",fontSize:"0.875rem",fontWeight:"600",cursor:"pointer",marginRight:"0.5rem"},y={...k,backgroundColor:r.enabled?"#ef4444":"#10b981",color:"white"},b={...k,backgroundColor:"#3b82f6",color:"white"};return T.jsxs("div",{style:v,children:[T.jsx("div",{style:x,children:T.jsxs("div",{style:_,children:[T.jsx("span",{}),T.jsx("span",{children:"Auto Scour (Admin)"}),T.jsx("span",{style:S,children:r.enabled?"ENABLED":"DISABLED"})]})}),T.jsxs("div",{style:w,children:[T.jsxs("div",{children:[T.jsx("strong",{children:"Interval:"})," Every ",r.intervalMinutes," minutes"]}),T.jsxs("div",{children:[T.jsx("strong",{children:"Last Run:"})," ",r.lastRun?new Date(r.lastRun).toLocaleString():"Never"]}),T.jsxs("div",{children:[T.jsx("strong",{children:"Env Status:"})," ",T.jsx("span",{style:{color:r.envEnabled?"#10b981":"#ef4444"},children:r.envEnabled?" Enabled":" Disabled"})]})]}),T.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[T.jsx("button",{onClick:m,disabled:o,style:{...y,opacity:o?.6:1,cursor:o?"not-allowed":"pointer"},children:o?" Toggling...":r.enabled?" Disable Auto Scour":" Enable Auto Scour"}),r.enabled&&T.jsx("button",{onClick:p,disabled:u,style:{...b,opacity:u?.6:1,cursor:u?"not-allowed":"pointer"},children:u?" Running...":" Run Now"}),T.jsx("div",{style:{marginLeft:"auto",fontSize:"0.75rem",color:"#6b7280"},children:r.enabled?" Automatically scouring sources":" Manual scour only"})]}),!r.envEnabled&&T.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",backgroundColor:"#fef3c7",color:"#92400e",borderRadius:"0.375rem",fontSize:"0.875rem"},children:[T.jsx("strong",{children:"Warning:"}),' AUTO_SCOUR_ENABLED environment variable is disabled in edge function. Set it to "true" in Supabase dashboard for cron to work.']})]})}const XF=({accessToken:e,permissions:t})=>{const[r,n]=ie.useState(""),[i,a]=ie.useState([]),[o,l]=ie.useState(!0),[u,f]=ie.useState(null),{isScouring:d,startScour:m}=$C(),p=(t==null?void 0:t.canManageSources)!==!1,v=(t==null?void 0:t.canScour)!==!1,x=p,_=async()=>{try{l(!0),f(null);const O=await ei("/sources",e);O.ok&&Array.isArray(O.sources)?(a(O.sources),console.log(`Loaded ${O.sources.length} sources`)):a([])}catch(O){console.error("Failed to load sources:",O),f((O==null?void 0:O.message)||"Failed to load sources"),a([])}finally{l(!1)}};ie.useEffect(()=>{_()},[e]);const S=async()=>{if(!v){alert("You do not have permission to run scour operations.");return}const R=i.filter(C=>C.enabled).filter(C=>[C.name,C.country].join(" ").toLowerCase().includes(r.toLowerCase()));if(R.length===0){alert("No enabled sources match the current filter.");return}try{await m(e,{sourceIds:R.map(C=>C.id),daysBack:14})}catch(C){console.error("Start scour error:",C),alert(`Failed to start scour: ${C.message}`)}},w={maxWidth:"1200px",margin:"0 auto",padding:"24px"},k={fontSize:"18px",fontWeight:600,marginBottom:"12px",color:"#111827"},y={padding:"10px 20px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:600,cursor:"pointer"},b={padding:"10px 20px",background:"white",color:"#374151",border:"1px solid #D1D5DB",borderRadius:"8px",fontSize:"14px",fontWeight:500,cursor:"pointer"};return T.jsxs("div",{style:w,children:[x&&T.jsx(qF,{accessToken:e,isAdmin:x}),p&&T.jsxs(T.Fragment,{children:[T.jsx("h2",{style:k,children:"Bulk Upload Sources"}),T.jsx(GF,{accessToken:e,onUploadComplete:_})]}),T.jsx(tw,{}),T.jsxs("div",{style:{marginBottom:"16px",display:"flex",gap:"12px",alignItems:"center"},children:[T.jsx("button",{onClick:S,disabled:d||!v,style:{...y,opacity:d||!v?.5:1},children:d?"Scouring...":"Start Scour"}),T.jsx("button",{onClick:_,disabled:o,style:{...b,opacity:o?.5:1},children:"Refresh Sources"}),i.length>0&&T.jsxs("span",{style:{fontSize:"14px",color:"#6B7280"},children:[i.filter(O=>O.enabled).length," of ",i.length," enabled"]})]}),u&&T.jsx("div",{style:{color:"#991B1B",marginBottom:"12px"},children:u}),o?T.jsx("div",{style:{padding:"40px",textAlign:"center"},children:"Loading sources..."}):T.jsxs(T.Fragment,{children:[T.jsxs("h2",{style:k,children:["Sources (",i.length,")"]}),i.length===0?T.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#6B7280"},children:"No sources configured"}):T.jsx(KF,{sources:i,onSourceUpdated:_,accessToken:e})]})]})};function YF(e){return Array.isArray(e)?e:[]}function JF(e){const t=new Date(e),r=t.getDay(),n=t.getDate()-r+(r===0?-6:1);return t.setDate(n),t.setHours(0,0,0,0),t}function QF(e){return new Date(e.getFullYear(),e.getMonth(),1,0,0,0,0)}function eL(e){return new Date(e.getFullYear(),0,1,0,0,0,0)}function Jf(e,t){const r=new Map;for(const n of e){const i=t(n)||"Unknown";r.set(i,(r.get(i)??0)+1)}return r}function Qf(e){return Array.from(e.entries()).sort((t,r)=>r[1]-t[1])}function di(e){return e.toLocaleString()}function bv(e,t){if(t===0)return{value:e>0?100:0,direction:e>0?"up":"same"};const r=(e-t)/t*100;return{value:Math.abs(Math.round(r)),direction:r>0?"up":r<0?"down":"same"}}const De={bg:"#F9F8F6",card:"#FFFFFF",border:"#E5E7EB",text:"#192622",muted:"#6B7280",primary:"#144334",accent:"#F88A35",success:"#059669",warning:"#D97706",danger:"#DC2626",info:"#2563EB"},tL={critical:De.danger,warning:De.warning,caution:De.info,informative:De.muted,unknown:"#9CA3AF"};function eh({title:e,subtitle:t,total:r,posted:n,comparison:i,isActive:a,onClick:o}){return T.jsxs("div",{onClick:o,style:{backgroundColor:a?De.primary:De.card,borderRadius:"12px",padding:"1.25rem",border:`2px solid ${a?De.primary:De.border}`,cursor:"pointer",transition:"all 0.2s ease",minWidth:"180px"},children:[T.jsx("div",{style:{fontSize:"0.75rem",color:a?"rgba(255,255,255,0.7)":De.muted,textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.25rem"},children:e}),T.jsx("div",{style:{fontSize:"0.7rem",color:a?"rgba(255,255,255,0.5)":De.muted,marginBottom:"0.75rem"},children:t}),T.jsx("div",{style:{fontSize:"2.5rem",fontWeight:700,color:a?"white":De.primary,lineHeight:1},children:di(r)}),T.jsxs("div",{style:{fontSize:"0.75rem",color:a?"rgba(255,255,255,0.7)":De.muted,marginTop:"0.5rem"},children:[di(n)," posted to WP"]}),i&&i.value>0&&T.jsxs("div",{style:{marginTop:"0.5rem",fontSize:"0.7rem",color:a?"rgba(255,255,255,0.8)":i.direction==="up"?De.success:i.direction==="down"?De.danger:De.muted,display:"flex",alignItems:"center",gap:"4px"},children:[(i.direction==="up"||i.direction==="down",""),i.value,"% ",i.label]})]})}function th({title:e,icon:t,data:r,total:n,colorFn:i,maxRows:a=10}){const o=r.slice(0,a),l=r.length>a;return T.jsxs("div",{style:{backgroundColor:De.card,borderRadius:"12px",border:`1px solid ${De.border}`,overflow:"hidden"},children:[T.jsx("div",{style:{padding:"1rem 1.25rem",borderBottom:`1px solid ${De.border}`,backgroundColor:"#FAFAFA"},children:T.jsxs("h3",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:De.text,display:"flex",alignItems:"center",gap:"0.5rem"},children:[T.jsx("span",{children:t})," ",e]})}),T.jsx("div",{style:{padding:"0.5rem 0"},children:o.length===0?T.jsx("div",{style:{padding:"1.5rem",textAlign:"center",color:De.muted,fontSize:"0.875rem"},children:"No data for this period"}):T.jsxs(T.Fragment,{children:[T.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 100px",padding:"0.5rem 1.25rem",fontSize:"0.7rem",color:De.muted,textTransform:"uppercase",letterSpacing:"0.05em",borderBottom:`1px solid ${De.border}`},children:[T.jsx("div",{children:"Name"}),T.jsx("div",{style:{textAlign:"right"},children:"Count"}),T.jsx("div",{style:{textAlign:"right"},children:"% of Total"})]}),o.map(([u,f],d)=>{const m=n>0?Math.round(f/n*100):0,p=i?i(u.toLowerCase()):De.primary;return T.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 100px",padding:"0.75rem 1.25rem",alignItems:"center",borderBottom:d<o.length-1?`1px solid ${De.border}`:"none",backgroundColor:d%2===0?"white":"#FAFAFA"},children:[T.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[T.jsx("div",{style:{width:"12px",height:"12px",borderRadius:"3px",backgroundColor:p,flexShrink:0}}),T.jsx("span",{style:{fontSize:"0.875rem",color:De.text,fontWeight:500},children:u})]}),T.jsx("div",{style:{textAlign:"right",fontSize:"0.875rem",fontWeight:600,color:De.text},children:di(f)}),T.jsxs("div",{style:{textAlign:"right",display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"0.5rem"},children:[T.jsx("div",{style:{width:"60px",height:"8px",backgroundColor:De.border,borderRadius:"4px",overflow:"hidden"},children:T.jsx("div",{style:{width:`${m}%`,height:"100%",backgroundColor:p,borderRadius:"4px"}})}),T.jsxs("span",{style:{fontSize:"0.75rem",color:De.muted,minWidth:"35px"},children:[m,"%"]})]})]},u)}),l&&T.jsxs("div",{style:{padding:"0.75rem 1.25rem",fontSize:"0.75rem",color:De.muted,textAlign:"center",backgroundColor:"#FAFAFA"},children:["+",r.length-a," more items"]})]})})]})}function Mo({label:e,value:t,icon:r,color:n=De.primary}){return T.jsxs("div",{style:{backgroundColor:De.card,borderRadius:"10px",padding:"1rem",border:`1px solid ${De.border}`,textAlign:"center"},children:[T.jsx("div",{style:{fontSize:"1.25rem",marginBottom:"0.25rem"},children:r}),T.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:n},children:t}),T.jsx("div",{style:{fontSize:"0.7rem",color:De.muted,textTransform:"uppercase"},children:e})]})}function rL({apiBase:e,accessToken:t,permissions:r}){const[n,i]=ie.useState([]),[a,o]=ie.useState(!0),[l,u]=ie.useState(null),[f,d]=ie.useState("month");if(!r.canAccessAnalytics)return T.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:pe.gray500},children:[T.jsx("p",{style:{fontSize:"1.125rem",marginBottom:"0.5rem"},children:" Access Restricted"}),T.jsx("p",{children:"You don't have permission to view analytics."})]});const m=ie.useCallback(async()=>{o(!0),u(null);try{const J=await ei("/alerts?limit=5000",t).catch(()=>[]),q=Array.isArray(J)?J:(J==null?void 0:J.alerts)??[];i(YF(q).filter(ce=>typeof ce.id=="string"))}catch(J){const q=J instanceof Error?J.message:"Failed to load analytics data";u(q)}finally{o(!1)}},[t]);ie.useEffect(()=>{m()},[m]);const p=new Date,v=JF(p),x=QF(p),_=eL(p),S=new Date(v);S.setDate(S.getDate()-7);const w=new Date(v);w.setMilliseconds(-1);const k=new Date(x);k.setMonth(k.getMonth()-1);const y=new Date(x);y.setMilliseconds(-1);const b=ie.useMemo(()=>n.filter(J=>J.created_at&&new Date(J.created_at)>=v),[n,v]),O=ie.useMemo(()=>n.filter(J=>{if(!J.created_at)return!1;const q=new Date(J.created_at);return q>=S&&q<=w}),[n,S,w]),R=ie.useMemo(()=>n.filter(J=>J.created_at&&new Date(J.created_at)>=x),[n,x]),C=ie.useMemo(()=>n.filter(J=>{if(!J.created_at)return!1;const q=new Date(J.created_at);return q>=k&&q<=y}),[n,k,y]),z=ie.useMemo(()=>n.filter(J=>J.created_at&&new Date(J.created_at)>=_),[n,_]),M=ie.useMemo(()=>{switch(f){case"week":return b;case"month":return R;case"ytd":return z;default:return R}},[f,b,R,z]),K=ie.useMemo(()=>{const J=Qf(Jf(M,W=>{const te=(W.severity??"unknown").toLowerCase();return te.charAt(0).toUpperCase()+te.slice(1)})),q=Qf(Jf(M,W=>W.event_type??"Unknown")),ce=Qf(Jf(M,W=>W.country??"Unknown")),_e=M.filter(W=>W.wordpress_post_id!=null).length,N=M.filter(W=>W.status==="draft").length,Z=M.filter(W=>W.status==="approved").length,H=M.filter(W=>W.status==="dismissed").length;return{bySeverity:J,byEventType:q,byCountry:ce,total:M.length,posted:_e,draft:N,approved:Z,dismissed:H}},[M]),G=`${v.toLocaleDateString("en-US",{month:"short",day:"numeric"})} - ${p.toLocaleDateString("en-US",{month:"short",day:"numeric"})}`,X=p.toLocaleDateString("en-US",{month:"long",year:"numeric"}),Y=`Jan 1 - ${p.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`,de=bv(b.length,O.length),he=bv(R.length,C.length),me={padding:"1.5rem",backgroundColor:De.bg,minHeight:"100%"},ge={display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem",flexWrap:"wrap",gap:"1rem"};return a?T.jsx("div",{style:me,children:T.jsx("div",{style:{textAlign:"center",padding:"3rem",color:De.muted},children:"Loading analytics..."})}):T.jsxs("div",{style:me,children:[T.jsxs("div",{style:ge,children:[T.jsxs("div",{children:[T.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:600,color:De.primary,margin:0,marginBottom:"0.25rem"},children:"Analytics Dashboard"}),T.jsx("p",{style:{margin:0,fontSize:"0.875rem",color:De.muted},children:"Alert metrics by time period"})]}),T.jsx("button",{onClick:m,disabled:a,style:{...pi.secondary,display:"flex",alignItems:"center",gap:"0.5rem"},children:"Refresh"})]}),l&&T.jsxs("div",{style:{padding:"1rem",backgroundColor:"#FEF2F2",border:`1px solid ${De.danger}`,borderRadius:"8px",color:De.danger,marginBottom:"1.5rem"},children:[T.jsx("strong",{children:"Error:"})," ",l]}),T.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[T.jsx(eh,{title:"This Week",subtitle:G,total:b.length,posted:b.filter(J=>J.wordpress_post_id).length,comparison:{...de,label:"vs last week"},isActive:f==="week",onClick:()=>d("week")}),T.jsx(eh,{title:"This Month",subtitle:X,total:R.length,posted:R.filter(J=>J.wordpress_post_id).length,comparison:{...he,label:"vs last month"},isActive:f==="month",onClick:()=>d("month")}),T.jsx(eh,{title:"Year to Date",subtitle:Y,total:z.length,posted:z.filter(J=>J.wordpress_post_id).length,isActive:f==="ytd",onClick:()=>d("ytd")})]}),T.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"0.75rem",marginBottom:"2rem"},children:[T.jsx(Mo,{label:"Total Alerts",value:di(K.total),icon:"",color:De.primary}),T.jsx(Mo,{label:"Posted to WP",value:di(K.posted),icon:"",color:De.success}),T.jsx(Mo,{label:"Drafts",value:di(K.draft),icon:"",color:De.warning}),T.jsx(Mo,{label:"Approved",value:di(K.approved),icon:"",color:De.info}),T.jsx(Mo,{label:"Dismissed",value:di(K.dismissed),icon:"",color:De.muted})]}),T.jsxs("div",{style:{marginBottom:"1rem",padding:"0.75rem 1rem",backgroundColor:De.primary,color:"white",borderRadius:"8px",fontSize:"0.875rem",fontWeight:500},children:["Breakdown for: ",f==="week"?`This Week (${G})`:f==="month"?X:`Year to Date (${Y})`]}),T.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem"},children:[T.jsx(th,{title:"By Severity",icon:"",data:K.bySeverity,total:K.total,colorFn:J=>tL[J]??De.muted,maxRows:5}),T.jsx(th,{title:"By Event Type",icon:"",data:K.byEventType,total:K.total,colorFn:()=>De.accent,maxRows:10}),T.jsx(th,{title:"By Country",icon:"",data:K.byCountry,total:K.total,colorFn:()=>De.info,maxRows:15})]}),T.jsxs("div",{style:{marginTop:"2rem",padding:"1rem",textAlign:"center",fontSize:"0.75rem",color:De.muted,borderTop:`1px solid ${De.border}`},children:["Data refreshed: ",new Date().toLocaleString(),"  Total alerts in database: ",di(n.length)]})]})}const Bo={operator:{label:"Operator",description:"Create, review, approve, post, delete, dismiss alerts. Full trend access.",color:pe.gray700,bgColor:pe.gray200},analyst:{label:"Analyst",description:"All operator permissions plus source management.",color:pe.blue700,bgColor:pe.blue100},admin:{label:"Administrator",description:"Full access including analytics and user management.",color:pe.purple700,bgColor:pe.purple100}},rh="@magnus.co.il";function nL({accessToken:e,currentUserRole:t,permissions:r}){const[n,i]=ie.useState([]),[a,o]=ie.useState(!0),[l,u]=ie.useState(null),[f,d]=ie.useState(null),[m,p]=ie.useState(!1),[v,x]=ie.useState(null),[_,S]=ie.useState({name:"",email:"",password:"",role:"operator"}),[w,k]=ie.useState(null),[y,b]=ie.useState(!1);if(!r.canManageUsers||t!=="admin")return T.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:pe.gray500},children:[T.jsx("p",{style:{fontSize:"1.125rem",marginBottom:"0.5rem"},children:" Access Restricted"}),T.jsx("p",{children:"Only administrators can manage users."})]});const O=ie.useCallback(async()=>{o(!0),u(null);try{const Z=await ei("/admin/users",e);Z.ok&&Z.users?i(Z.users):(u(Z.error||"Failed to load users"),i([]))}catch{u("Network error"),i([])}finally{o(!1)}},[e]);ie.useEffect(()=>{O()},[O]);const R=()=>{S({name:"",email:"",password:"",role:"operator"}),k(null),x(null),p(!1)},C=async Z=>{if(Z.preventDefault(),k(null),!_.name.trim()){k("Name is required");return}if(!_.email.trim()){k("Email is required");return}if(!_.email.endsWith(rh)){k(`Email must be from ${rh} domain`);return}if(!v&&_.password.length<8){k("Password must be at least 8 characters");return}b(!0);try{const H=await Ha("/admin/users",{name:_.name,email:_.email,password:_.password,role:_.role},e);H.ok?(R(),O()):k(H.error||"Failed to create user")}catch{k("Network error")}finally{b(!1)}},z=async(Z,H)=>{d(Z);try{const W=await _y(`/admin/users/${Z}`,{role:H},e);W.ok?i(te=>te.map(xe=>xe.id===Z?{...xe,role:H}:xe)):u(W.error||"Failed to update role")}catch{u("Network error")}finally{d(null)}},M=async Z=>{if(confirm("Are you sure you want to delete this user?")){d(Z);try{const H=await ei(`/admin/users/${Z}`,e,{method:"DELETE"});H.ok?i(W=>W.filter(te=>te.id!==Z)):u(H.error||"Failed to delete user")}catch{u("Network error")}finally{d(null)}}},K={padding:"1.5rem",backgroundColor:pe.magnusLightBg,minHeight:"100%"},G={display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem",flexWrap:"wrap",gap:"1rem"},X={fontSize:"1.5rem",fontWeight:"700",color:pe.magnusDarkGreen,margin:0},Y={padding:"0.5rem 1rem",borderRadius:"0.5rem",border:"none",cursor:"pointer",fontSize:"0.875rem",fontWeight:"600",transition:"all 0.2s"},de={...Y,backgroundColor:pe.magnusAccentGreen,color:pe.white},he={...Y,backgroundColor:pe.gray100,color:pe.gray700,border:`1px solid ${pe.gray300}`},me={...Y,backgroundColor:pe.red600,color:pe.white},ge={backgroundColor:pe.white,borderRadius:"0.75rem",border:`1px solid ${pe.gray200}`,marginBottom:"1.5rem",overflow:"hidden"},J={width:"100%",padding:"0.625rem 0.875rem",borderRadius:"0.5rem",border:`1px solid ${pe.gray300}`,fontSize:"0.875rem",outline:"none"},q={display:"block",fontSize:"0.8125rem",fontWeight:"600",color:pe.gray700,marginBottom:"0.375rem"},ce={width:"100%",borderCollapse:"collapse"},_e={textAlign:"left",padding:"0.75rem 1rem",backgroundColor:pe.gray50,fontSize:"0.75rem",fontWeight:"700",color:pe.gray600,textTransform:"uppercase",letterSpacing:"0.05em",borderBottom:`1px solid ${pe.gray200}`},N={padding:"0.75rem 1rem",borderBottom:`1px solid ${pe.gray100}`,fontSize:"0.875rem",color:pe.gray700};return T.jsxs("div",{style:K,children:[T.jsxs("div",{style:G,children:[T.jsx("h2",{style:X,children:" User Management"}),T.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[T.jsx("button",{style:he,onClick:O,disabled:a,children:"Refresh"}),T.jsx("button",{style:de,onClick:()=>p(!0),children:"Add User"})]})]}),l&&T.jsx("div",{style:{padding:"1rem",backgroundColor:pe.red50,border:`1px solid ${pe.red200}`,borderRadius:"0.5rem",color:pe.red700,marginBottom:"1rem"},children:l}),m&&T.jsxs("div",{style:ge,children:[T.jsx("div",{style:{padding:"1rem",borderBottom:`1px solid ${pe.gray200}`,backgroundColor:pe.gray50},children:T.jsx("h3",{style:{margin:0,fontSize:"1rem",fontWeight:"600",color:pe.gray800},children:"Add New User"})}),T.jsxs("form",{onSubmit:C,style:{padding:"1.5rem"},children:[T.jsxs("div",{style:{display:"grid",gap:"1rem",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))"},children:[T.jsxs("div",{children:[T.jsx("label",{style:q,children:"Name *"}),T.jsx("input",{type:"text",style:J,value:_.name,onChange:Z=>S({..._,name:Z.target.value}),placeholder:"John Doe"})]}),T.jsxs("div",{children:[T.jsx("label",{style:q,children:"Email *"}),T.jsx("input",{type:"email",style:J,value:_.email,onChange:Z=>S({..._,email:Z.target.value}),placeholder:`user${rh}`})]}),T.jsxs("div",{children:[T.jsx("label",{style:q,children:"Password *"}),T.jsx("input",{type:"password",style:J,value:_.password,onChange:Z=>S({..._,password:Z.target.value}),placeholder:"Min 8 characters"})]}),T.jsxs("div",{children:[T.jsx("label",{style:q,children:"Role *"}),T.jsx("select",{style:J,value:_.role,onChange:Z=>S({..._,role:Z.target.value}),children:Object.entries(Bo).map(([Z,H])=>T.jsx("option",{value:Z,children:H.label},Z))})]})]}),w&&T.jsx("div",{style:{marginTop:"1rem",color:pe.red600,fontSize:"0.875rem"},children:w}),T.jsxs("div",{style:{marginTop:"1.5rem",display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:[T.jsx("button",{type:"button",style:he,onClick:R,children:"Cancel"}),T.jsx("button",{type:"submit",style:de,disabled:y,children:y?"Creating...":"Create User"})]})]})]}),T.jsxs("div",{style:ge,children:[T.jsx("div",{style:{padding:"1rem",borderBottom:`1px solid ${pe.gray200}`,backgroundColor:pe.gray50},children:T.jsxs("h3",{style:{margin:0,fontSize:"1rem",fontWeight:"600",color:pe.gray800},children:["Users (",n.length,")"]})}),a?T.jsx("div",{style:{padding:"2rem",textAlign:"center",color:pe.gray500},children:"Loading users..."}):n.length===0?T.jsx("div",{style:{padding:"2rem",textAlign:"center",color:pe.gray500},children:"No users found"}):T.jsx("div",{style:{overflowX:"auto"},children:T.jsxs("table",{style:ce,children:[T.jsx("thead",{children:T.jsxs("tr",{children:[T.jsx("th",{style:_e,children:"User"}),T.jsx("th",{style:_e,children:"Role"}),T.jsx("th",{style:_e,children:"Created"}),T.jsx("th",{style:_e,children:"Last Sign In"}),T.jsx("th",{style:{..._e,textAlign:"right"},children:"Actions"})]})}),T.jsx("tbody",{children:n.map(Z=>{var H,W;return T.jsxs("tr",{style:{opacity:f===Z.id?.5:1},children:[T.jsxs("td",{style:N,children:[T.jsx("div",{style:{fontWeight:"600",color:pe.gray800},children:Z.name||"No name"}),T.jsx("div",{style:{fontSize:"0.75rem",color:pe.gray500},children:Z.email})]}),T.jsx("td",{style:N,children:T.jsx("select",{value:Z.role,onChange:te=>z(Z.id,te.target.value),disabled:f===Z.id,style:{padding:"0.25rem 0.5rem",borderRadius:"0.375rem",border:`1px solid ${pe.gray300}`,backgroundColor:((H=Bo[Z.role])==null?void 0:H.bgColor)||pe.gray100,color:((W=Bo[Z.role])==null?void 0:W.color)||pe.gray700,fontWeight:"600",fontSize:"0.75rem",cursor:"pointer"},children:Object.entries(Bo).map(([te,xe])=>T.jsx("option",{value:te,children:xe.label},te))})}),T.jsx("td",{style:N,children:Z.created_at?new Date(Z.created_at).toLocaleDateString():"-"}),T.jsx("td",{style:N,children:Z.last_sign_in_at?new Date(Z.last_sign_in_at).toLocaleDateString():"Never"}),T.jsx("td",{style:{...N,textAlign:"right"},children:T.jsx("button",{style:{...me,padding:"0.25rem 0.5rem",fontSize:"0.75rem"},onClick:()=>M(Z.id),disabled:f===Z.id,children:"Delete"})})]},Z.id)})})]})})]}),T.jsxs("div",{style:ge,children:[T.jsx("div",{style:{padding:"1rem",borderBottom:`1px solid ${pe.gray200}`,backgroundColor:pe.gray50},children:T.jsx("h3",{style:{margin:0,fontSize:"1rem",fontWeight:"600",color:pe.gray800},children:"Role Descriptions"})}),T.jsx("div",{style:{padding:"1rem"},children:T.jsx("div",{style:{display:"grid",gap:"1rem",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))"},children:Object.entries(Bo).map(([Z,H])=>T.jsxs("div",{style:{padding:"1rem",backgroundColor:H.bgColor,borderRadius:"0.5rem",border:`1px solid ${H.color}20`},children:[T.jsx("div",{style:{fontWeight:"700",color:H.color,marginBottom:"0.25rem"},children:H.label}),T.jsx("div",{style:{fontSize:"0.8125rem",color:pe.gray600},children:H.description})]},Z))})})]})]})}function iL({accessToken:e,permissions:t}){const[r,n]=ie.useState([]),[i,a]=ie.useState(!0),[o,l]=ie.useState(null),[u,f]=ie.useState("all"),[d,m]=ie.useState(null),[p,v]=ie.useState(null),x=ie.useCallback(async()=>{a(!0),l(null);try{const Y=await ei("/trends",e);n(Array.isArray(Y)?Y:[])}catch(Y){const de=Y instanceof Error?Y.message:"Failed to load trends";l(de),n([])}finally{a(!1)}},[e]);ie.useEffect(()=>{x()},[x]);const _=r.filter(Y=>u==="all"?!0:Y.status===u),S=async Y=>{m(Y);try{const de=await Ha(`/trends/${Y}/generate-brief`,{},e);if(!de.ok||!de.html)throw new Error(de.error??"Failed to generate report");const he=new Blob([de.html],{type:"text/html"}),me=URL.createObjectURL(he),ge=document.createElement("a");ge.href=me,ge.download=`MAGNUS-Situational-Brief-${de.reportId??Y}.html`,document.body.appendChild(ge),ge.click(),document.body.removeChild(ge),URL.revokeObjectURL(me)}catch(de){const he=de instanceof Error?de.message:"Export failed";alert(`Export failed: ${he}`)}finally{m(null)}},w={padding:"1rem"},k={display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem",flexWrap:"wrap",gap:"1rem"},y={fontSize:"1.5rem",fontWeight:600,color:pe.magnusDarkGreen,margin:0},b={display:"flex",gap:"0.5rem",marginBottom:"1rem"},O=Y=>({padding:"0.5rem 1rem",borderRadius:"20px",border:`1px solid ${Y?pe.magnusDarkGreen:pe.gray300}`,backgroundColor:Y?pe.magnusDarkGreen:"white",color:Y?"white":pe.gray700,cursor:"pointer",fontSize:"0.875rem",fontWeight:500,transition:"all 0.2s ease"}),R={...xy.base,marginBottom:"1rem",padding:"1.25rem"},C={display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},z={fontSize:"1.125rem",fontWeight:600,color:pe.magnusDarkText,margin:0,flex:1},M={display:"flex",flexWrap:"wrap",gap:"0.75rem",marginBottom:"0.5rem",fontSize:"0.875rem",color:pe.gray600},K=Y=>{const de={padding:"4px 10px",borderRadius:"12px",fontSize:"0.75rem",fontWeight:600,textTransform:"uppercase"};switch(Y){case"open":return{...de,backgroundColor:pe.danger+"20",color:pe.danger};case"monitoring":return{...de,backgroundColor:pe.warning+"20",color:pe.warning};case"closed":return{...de,backgroundColor:pe.gray200,color:pe.gray600};default:return{...de,backgroundColor:pe.blue100,color:pe.blue700}}},G={padding:"1rem",backgroundColor:pe.red50,border:`1px solid ${pe.red200}`,borderRadius:"8px",color:pe.red700,marginBottom:"1rem"},X={textAlign:"center",padding:"3rem",color:pe.gray500,backgroundColor:pe.gray100,borderRadius:"12px"};return T.jsxs("div",{style:w,children:[T.jsxs("div",{style:k,children:[T.jsx("h2",{style:y,children:"Trends"}),T.jsx("button",{onClick:x,disabled:i,style:pi.secondary,children:i?"Loading...":"Refresh"})]}),T.jsx("div",{style:b,children:["all","open","monitoring","closed"].map(Y=>T.jsxs("button",{onClick:()=>f(Y),style:O(u===Y),children:[Y.charAt(0).toUpperCase()+Y.slice(1),Y!=="all"&&T.jsxs("span",{style:{marginLeft:"4px",opacity:.8},children:["(",r.filter(de=>de.status===Y).length,")"]})]},Y))}),o&&T.jsxs("div",{style:G,children:[T.jsx("strong",{children:"Error:"})," ",o]}),i?T.jsx("div",{style:{textAlign:"center",padding:"3rem",color:pe.gray500},children:"Loading trends..."}):_.length===0?T.jsxs("div",{style:X,children:[T.jsx("p",{style:{fontSize:"1.125rem",marginBottom:"0.5rem"},children:"No trends found"}),T.jsx("p",{style:{fontSize:"0.875rem"},children:u!=="all"?`No ${u} trends. Try selecting a different filter.`:"Trends will appear here as patterns are detected across alerts."})]}):T.jsxs("div",{children:[T.jsxs("p",{style:{marginBottom:"1rem",color:pe.gray600},children:[_.length," trend",_.length!==1?"s":""]}),_.map(Y=>T.jsxs("div",{style:R,children:[T.jsxs("div",{style:C,children:[T.jsx("h3",{style:z,children:Y.title||"Untitled Trend"}),T.jsx("span",{style:K(Y.status),children:Y.status||"unknown"})]}),Y.description&&T.jsx("p",{style:{margin:"0 0 0.75rem",color:pe.gray600,lineHeight:1.5},children:Y.description}),T.jsxs("div",{style:M,children:[Y.country&&T.jsxs("span",{children:[" ",Y.country]}),Y.region&&T.jsxs("span",{children:[" ",Y.region]}),Y.event_type&&T.jsxs("span",{children:[" ",Y.event_type]}),Y.incident_count!=null&&T.jsxs("span",{children:[" ",Y.incident_count," incidents"]}),Y.severity&&T.jsx("span",{style:{padding:"2px 6px",backgroundColor:pe.warning+"20",borderRadius:"4px"},children:Y.severity})]}),T.jsxs("div",{style:{fontSize:"0.75rem",color:pe.gray500,display:"flex",gap:"1rem",marginTop:"0.5rem"},children:[Y.first_seen&&T.jsxs("span",{children:["First seen: ",new Date(Y.first_seen).toLocaleDateString()]}),Y.last_seen&&T.jsxs("span",{children:["Last seen: ",new Date(Y.last_seen).toLocaleDateString()]}),Y.updated_at&&T.jsxs("span",{children:["Updated: ",new Date(Y.updated_at).toLocaleDateString()]})]}),Y.predictive_analysis&&T.jsxs("div",{style:{marginTop:"0.75rem",padding:"0.75rem",backgroundColor:pe.blue50,borderRadius:"8px",fontSize:"0.875rem",color:pe.blue800},children:[T.jsx("strong",{children:"Predictive Analysis:"})," ",Y.predictive_analysis]}),Y.countries&&Y.countries.length>1&&T.jsxs("div",{style:{marginTop:"0.5rem",fontSize:"0.75rem",color:pe.gray600},children:["Countries involved: ",Y.countries.join(", ")]}),T.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"1rem",paddingTop:"0.75rem",borderTop:`1px solid ${pe.gray200}`},children:[T.jsx("button",{onClick:()=>v(p===Y.id?null:Y.id),style:{...pi.secondary,fontSize:"0.75rem",padding:"0.5rem 0.75rem"},children:p===Y.id?" Collapse":" Details"}),T.jsx("button",{onClick:()=>S(Y.id),disabled:d===Y.id,style:{...pi.primary,fontSize:"0.75rem",padding:"0.5rem 0.75rem",opacity:d===Y.id?.7:1},children:d===Y.id?" Generating...":" Export Report"})]}),p===Y.id&&T.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",backgroundColor:pe.gray50,borderRadius:"8px",fontSize:"0.875rem"},children:[T.jsxs("div",{style:{marginBottom:"0.5rem"},children:[T.jsx("strong",{children:"Trend ID:"})," ",Y.id]}),Y.alert_ids&&T.jsxs("div",{style:{marginBottom:"0.5rem"},children:[T.jsx("strong",{children:"Alert IDs:"})," ",Y.alert_ids.length," alerts"]}),Y.auto_generated&&T.jsx("div",{style:{display:"inline-block",padding:"2px 8px",backgroundColor:pe.magnusDarkGreen+"20",color:pe.magnusDarkGreen,borderRadius:"4px",fontSize:"0.7rem"},children:"Auto-generated by AI"})]})]},Y.id))]})]})}const aL="",sL="sb_publishable_1iNgvQzTvtYKqWCdE3oIKg_rjsRMwGG",oL="https://gnobnyzezkuyptuakztf.supabase.co/functions/v1/clever-function",nu=t3(aL,sL);function lL(e){return{...{canReview:e!=="operator",canCreate:!0,canManageSources:e==="admin",canScour:e!=="operator",canAccessAnalytics:e!=="operator",canManageUsers:e==="admin"},canApproveAndPost:e==="admin"||e==="analyst",canDismiss:e!=="operator",canDelete:e==="admin",canEditAlerts:e!=="operator"}}function cL(){const[e,t]=ie.useState(null),[r,n]=ie.useState("operator"),[i,a]=ie.useState("review"),[o,l]=ie.useState(!0),u=ie.useMemo(()=>lL(r),[r]);return ie.useEffect(()=>{let f=!0;async function d(){var p;try{const{data:v}=await nu.auth.getSession();if(!f)return;v.session?(t(v.session.access_token),n(((p=v.session.user.user_metadata)==null?void 0:p.role)??"operator")):(t(null),n("operator"))}finally{f&&l(!1)}}d();const{data:m}=nu.auth.onAuthStateChange((p,v)=>{var x;f&&(v?(t(v.access_token),n(((x=v.user.user_metadata)==null?void 0:x.role)??"operator")):(t(null),n("operator")))});return()=>{f=!1,m.subscription.unsubscribe()}},[]),o?T.jsx("div",{className:"p-6",children:"Loading..."}):e?T.jsx(WC,{accessToken:e,children:T.jsxs("main",{className:"p-4 space-y-4",children:[T.jsx(tw,{}),T.jsxs("div",{className:"flex flex-wrap gap-2 border-b pb-2",children:[u.canReview&&T.jsx("button",{className:`px-3 py-1 rounded border ${i==="review"?"bg-gray-100":"bg-white"}`,onClick:()=>a("review"),children:"Review"}),u.canCreate&&T.jsx("button",{className:`px-3 py-1 rounded border ${i==="create"?"bg-gray-100":"bg-white"}`,onClick:()=>a("create"),children:"Create"}),u.canManageSources&&T.jsx("button",{className:`px-3 py-1 rounded border ${i==="sources"?"bg-gray-100":"bg-white"}`,onClick:()=>a("sources"),children:"Sources"}),T.jsx("button",{className:`px-3 py-1 rounded border ${i==="trends"?"bg-gray-100":"bg-white"}`,onClick:()=>a("trends"),children:"Trends"}),u.canAccessAnalytics&&T.jsx("button",{className:`px-3 py-1 rounded border ${i==="analytics"?"bg-gray-100":"bg-white"}`,onClick:()=>a("analytics"),children:"Analytics"}),u.canManageUsers&&T.jsx("button",{className:`px-3 py-1 rounded border ${i==="admin"?"bg-gray-100":"bg-white"}`,onClick:()=>a("admin"),children:"Admin"}),T.jsx("div",{className:"flex-1"}),T.jsx("button",{className:"px-3 py-1 rounded border bg-white",onClick:()=>nu.auth.signOut(),title:"Sign out",children:"Sign out"})]}),i==="review"&&T.jsx(FC,{permissions:u}),i==="create"&&T.jsx(zC,{accessToken:e,permissions:{canCreate:u.canCreate}}),i==="sources"&&T.jsx(XF,{accessToken:e,permissions:{canManageSources:u.canManageSources,canScour:u.canScour}}),i==="trends"&&T.jsx(iL,{}),i==="analytics"&&T.jsx(rL,{apiBase:oL,permissions:{canAccessAnalytics:u.canAccessAnalytics}}),i==="admin"&&T.jsx(nL,{currentUserRole:r,permissions:{canManageUsers:u.canManageUsers}})]})}):T.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-6",children:T.jsxs("div",{className:"w-full max-w-md bg-white border rounded-lg p-6 shadow-sm",children:[T.jsx("div",{className:"text-lg font-semibold mb-2",children:"MAGNUS Intelligence"}),T.jsx("div",{className:"text-sm text-gray-600 mb-4",children:"Sign in to continue."}),T.jsx(co,{supabaseClient:nu,appearance:{theme:R3},providers:[]})]})})}nh.createRoot(document.getElementById("root")).render(T.jsx(Q.StrictMode,{children:T.jsx(cL,{})}));
//# sourceMappingURL=index-CamFp9CL.js.map
